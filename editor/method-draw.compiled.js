function touchHandler(a){var s=a.changedTouches,f=s[0],b="";switch(a.type){case "touchstart":b="mousedown";break;case "touchmove":b="mousemove";break;case "touchend":b="mouseup";break;default:return}var p=document.createEvent("MouseEvent");p.initMouseEvent(b,true,true,window,1,f.screenX,f.screenY,f.clientX,f.clientY,false,false,false,false,0,null);if(s.length<2){f.target.dispatchEvent(p);a.preventDefault()}};(function(a){function s(f){if(typeof f.data==="string"){var b=f.handler,p=f.data.toLowerCase().split(" ");f.handler=function(A){if(!(this!==A.target&&(/textarea|select/i.test(A.target.nodeName)||A.target.type==="text"))){var d=A.type!=="keypress"&&a.hotkeys.specialKeys[A.which],g=String.fromCharCode(A.which).toLowerCase(),c="",n={};if(A.altKey&&d!=="alt")c+="alt+";if(A.ctrlKey&&d!=="ctrl")c+="ctrl+";if(A.metaKey&&!A.ctrlKey&&d!=="meta")c+="meta+";if(A.shiftKey&&d!=="shift")c+="shift+";if(d)n[c+d]=
true;else{n[c+g]=true;n[c+a.hotkeys.shiftNums[g]]=true;if(c==="shift+")n[a.hotkeys.shiftNums[g]]=true}d=0;for(g=p.length;d<g;d++)if(n[p[d]])return b.apply(this,arguments)}}}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta",219:"[",221:"]"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:s}})})(jQuery);(function(a,s){function f(da){return typeof da==="string"}function b(da){var S=c.call(arguments,1);return function(){return da.apply(this,S.concat(c.call(arguments)))}}function p(da,S,V,na,oa){var la;if(na!==g){S=V.match(da?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);V=S[3]||"";if(oa===2&&f(na))na=na.replace(da?ea:W,"");else{la=q(S[2]);na=f(na)?q[da?ha:O](na):na;na=oa===2?na:oa===1?a.extend({},na,la):a.extend({},la,na);na=v(na);if(da)na=na.replace(Ea,n)}da=S[1]+(da?"#":na||!S[1]?"?":"")+na+V}else da=
S(V!==g?V:s[pa][Y]);return da}function A(da,S,V){if(S===g||typeof S==="boolean"){V=S;S=v[da?ha:O]()}else S=f(S)?S.replace(da?ea:W,""):S;return q(S,V)}function d(da,S,V,na){if(!f(V)&&typeof V!=="object"){na=V;V=S;S=g}return this.each(function(){var oa=a(this),la=S||Z()[(this.nodeName||"").toLowerCase()]||"",ka=la&&oa.attr(la)||"";oa.attr(la,v[da](ka,V,na))})}var g,c=Array.prototype.slice,n=decodeURIComponent,v=a.param,C,q,M,Q=a.bbq=a.bbq||{},L,J,Z,X=a.event.special,O="querystring",ha="fragment",pa=
"location",Y="href",W=/^.*\?|#.*$/g,ea=/^.*\#/,Ea,ma={};v[O]=b(p,0,function(da){return da.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")});v[ha]=C=b(p,1,function(da){return da.replace(/^[^#]*#?(.*)$/,"$1")});C.noEscape=function(da){da=da||"";da=a.map(da.split(""),encodeURIComponent);Ea=RegExp(da.join("|"),"g")};C.noEscape(",/");a.deparam=q=function(da,S){var V={},na={"true":true,"false":false,"null":null};a.each(da.replace(/\+/g," ").split("&"),function(oa,la){var ka=la.split("="),ya=n(ka[0]),za=V,Ja=
0,Ia=ya.split("]["),Fa=Ia.length-1;if(/\[/.test(Ia[0])&&/\]$/.test(Ia[Fa])){Ia[Fa]=Ia[Fa].replace(/\]$/,"");Ia=Ia.shift().split("[").concat(Ia);Fa=Ia.length-1}else Fa=0;if(ka.length===2){ka=n(ka[1]);if(S)ka=ka&&!isNaN(ka)?+ka:ka==="undefined"?g:na[ka]!==g?na[ka]:ka;if(Fa)for(;Ja<=Fa;Ja++){ya=Ia[Ja]===""?za.length:Ia[Ja];za=za[ya]=Ja<Fa?za[ya]||(Ia[Ja+1]&&isNaN(Ia[Ja+1])?{}:[]):ka}else if(a.isArray(V[ya]))V[ya].push(ka);else V[ya]=V[ya]!==g?[V[ya],ka]:ka}else if(ya)V[ya]=S?g:""});return V};q[O]=b(A,
0);q[ha]=M=b(A,1);a.elemUrlAttr||(a.elemUrlAttr=function(da){return a.extend(ma,da)})({a:Y,base:Y,iframe:"src",img:"src",input:"src",form:"action",link:Y,script:"src"});Z=a.elemUrlAttr;a.fn[O]=b(d,O);a.fn[ha]=b(d,ha);Q.pushState=L=function(da,S){if(f(da)&&/^#/.test(da)&&S===g)S=2;var V=da!==g;V=C(s[pa][Y],V?da:{},V?S:2);s[pa][Y]=V+(/#/.test(V)?"":"#")};Q.getState=J=function(da,S){return da===g||typeof da==="boolean"?M(da):M(S)[da]};Q.removeState=function(da){var S={};if(da!==g){S=J();a.each(a.isArray(da)?
da:arguments,function(V,na){delete S[na]})}L(S,2)};X.hashchange=a.extend(X.hashchange,{add:function(da){function S(na){var oa=na[ha]=C();na.getState=function(la,ka){return la===g||typeof la==="boolean"?q(oa,la):q(oa,ka)[la]};V.apply(this,arguments)}var V;if(a.isFunction(da)){V=da;return S}else{V=da.handler;da.handler=S}}})})(jQuery,this);
(function(a,s,f){function b(C){C=C||s[d][g];return C.replace(/^[^#]*#?(.*)$/,"$1")}var p,A=a.event.special,d="location",g="href",c=document.documentMode,n=a.browser.msie&&(c===f||c<8),v="onhashchange"in s&&!n;a.hashchangeDelay=100;A.hashchange=a.extend(A.hashchange,{setup:function(){if(v)return false;a(p.start)},teardown:function(){if(v)return false;a(p.stop)}});p=function(){function C(){L=J=function(Z){return Z};if(n){Q=a('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;
J=function(){return b(Q.document[d][g])};L=function(Z,X){if(Z!==X){var O=Q.document;O.open().close();O[d].hash="#"+Z}};L(b())}}var q={},M,Q,L,J;q.start=function(){if(!M){var Z=b();L||C();(function X(){var O=b(),ha=J(Z);if(O!==Z){L(Z=O,ha);a(s).trigger("hashchange")}else if(ha!==Z)s[d][g]=s[d][g].replace(/#.*/,"")+"#"+ha;M=setTimeout(X,a.hashchangeDelay)})()}};q.stop=function(){if(!Q){M&&clearTimeout(M);M=0}};return q}()})(jQuery,this);(function(a){var s={},f;a.svgIcons=function(b,p){function A(da,S){if(da!=="ajax"){if(Z)return;var V=(Q=Y[0].contentDocument)&&Q.getElementById("svg_eof");if(!V&&!(S&&V)){X++;if(X<50)setTimeout(A,20);else{g();Z=true}return}Z=true}M=a(Q.firstChild).children();if(p.no_img)setTimeout(function(){J||d()},500);else{V=pa+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzUiIGhlaWdodD0iMjc1Ij48L3N2Zz4%3D";L=a(new Image).attr({src:V,width:0,height:0}).appendTo("body").load(function(){d(true)}).error(function(){d()})}}
function d(da,S){if(!J){if(p.no_img)da=false;if(da){var V=a(document.createElement("div"));V.hide().appendTo("body")}if(S){var na=p.fallback_path?p.fallback_path:"";a.each(S,function(Fa,Ma){a("#"+Fa);var Ca=a(new Image).attr({"class":"svg_icon",src:na+Ma,width:C,height:q,alt:"icon"});ma(Ca,Fa)})}else for(var oa=M.length,la=0;la<oa;la++){var ka=M[la],ya=ka.id;if(ya==="svg_eof")break;a("#"+ya);ka=ka.getElementsByTagNameNS(n,"svg")[0];var za=document.createElementNS(n,"svg");za.setAttributeNS(n,"viewBox",
[0,0,C,q].join(" "));var Ja=ka.getAttribute("width"),Ia=ka.getAttribute("height");ka.removeAttribute("width");ka.removeAttribute("height");ka.getAttribute("viewBox")||ka.setAttribute("viewBox",[0,0,Ja,Ia].join(" "));za.setAttribute("xmlns",n);za.setAttribute("width",C);za.setAttribute("height",q);za.setAttribute("xmlns:xlink",v);za.setAttribute("class","svg_icon");ha||(ka=ka.cloneNode(true));za.appendChild(ka);if(da){ha||za.cloneNode(true);V.empty().append(za);ka=pa+c(V.html());ka=a(new Image).attr({"class":"svg_icon",
src:ka})}else ka=f(a(za),la);ma(ka,ya)}p.placement&&a.each(p.placement,function(Fa,Ma){s[Ma]&&a(Fa).each(function(Ca){var wa=s[Ma].clone();if(Ca>0&&!da)wa=f(wa,Ca,true);Ea(a(this),wa,Ma)})});if(!S){da&&V.remove();Y&&Y.remove();L&&L.remove()}p.resize&&a.resizeSvgIcons(p.resize);J=true;p.callback&&p.callback(s)}}function g(){if(b.indexOf(".svgz")!=-1){var da=b.replace(".svgz",".svg");window.console&&console.log(".svgz failed, trying with .svg");a.svgIcons(da,p)}else p.fallback&&d(false,p.fallback)}
function c(da){if(window.btoa)return window.btoa(da);var S=Array(Math.floor((da.length+2)/3)*4),V,na,oa,la,ka,ya,za=0,Ja=0;do{V=da.charCodeAt(za++);na=da.charCodeAt(za++);oa=da.charCodeAt(za++);la=V>>2;V=(V&3)<<4|na>>4;ka=(na&15)<<2|oa>>6;ya=oa&63;if(isNaN(na))ka=ya=64;else if(isNaN(oa))ya=64;S[Ja++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(la);S[Ja++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(V);S[Ja++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(ka);
S[Ja++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(ya)}while(za<da.length);return S.join("")}var n="http://www.w3.org/2000/svg",v="http://www.w3.org/1999/xlink",C=p.w?p.w:24,q=p.h?p.h:24,M,Q,L,J=false,Z=false,X=0,O=navigator.userAgent,ha=!!window.opera;O.indexOf("Safari/")>-1&&O.indexOf("Chrome/");var pa="data:image/svg+xml;charset=utf-8;base64,";if(p.svgz){var Y=a('<object data="'+b+'" type=image/svg+xml>').appendTo("body").hide();try{Q=Y[0].contentDocument;Y.load(A);
A(0,true)}catch(W){g()}}else{var ea=new DOMParser;a.ajax({url:b,dataType:"string",success:function(da){if(da){Q=ea.parseFromString(da,"text/xml");a(function(){A("ajax")})}else a(g)},error:function(da){if(window.opera)a(function(){g()});else if(da.responseText){Q=ea.parseFromString(da.responseText,"text/xml");Q.childNodes.length||a(g);a(function(){A("ajax")})}else a(g)}})}var Ea=function(da,S,V,na){ha&&S.css("visibility","hidden");if(p.replace){na&&S.attr("id",V);(V=da.attr("class"))&&S.attr("class",
"svg_icon "+V);da.replaceWith(S)}else da.append(S);ha&&setTimeout(function(){S.removeAttr("style")},1)},ma=function(da,S){if(p.id_match===undefined||p.id_match!==false)Ea(holder,da,S,true);s[S]=da};f=function(da,S){var V=da.find("defs");if(!V.length)return da;V=ha?V.find("*").filter(function(){return!!this.id}):V.find("[id]");var na=da[0].getElementsByTagName("*"),oa=na.length;V.each(function(la){var ka=this.id;a(Q).find("#"+ka);this.id=la="x"+ka+S+la;ka="url(#"+ka+")";var ya="url(#"+la+")";for(la=
0;la<oa;la++){var za=na[la];za.getAttribute("fill")===ka&&za.setAttribute("fill",ya);za.getAttribute("stroke")===ka&&za.setAttribute("stroke",ya);za.getAttribute("filter")===ka&&za.setAttribute("filter",ya)}});return da}};a.getSvgIcon=function(b,p){var A=s[b];if(p&&A)A=f(A,0,true).clone(true);return A};a.resizeSvgIcons=function(b){var p=!a(".svg_icon:first").length;a.each(b,function(A,d){var g=a.isArray(d),c=g?d[0]:d,n=g?d[1]:d;if(p)A=A.replace(/\.svg_icon/g,"svg");a(A).each(function(){this.setAttribute("width",
c);this.setAttribute("height",n);if(window.opera&&window.widget){this.parentNode.style.width=c+"px";this.parentNode.style.height=n+"px"}})})}})(jQuery);(function(){function a(b,p,A){b=document.createElementNS(s.svg,b);if(f)for(var d in p)b.setAttribute(d,p[d]);else for(d in p){var g=p[d],c=b[d];if(c&&c.constructor==="SVGLength")c.baseVal.value=g;else b.setAttribute(d,g)}A&&A.appendChild(b);return b}var s={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};if(!window.console)window.console=new function(){this.log=function(){};this.dir=function(){}};$.jGraduate={Paint:function(b){b=b||{};this.alpha=isNaN(b.alpha)?100:b.alpha;if(b.copy){this.type=
b.copy.type;this.alpha=b.copy.alpha;this.radialGradient=this.linearGradient=this.solidColor=null;switch(this.type){case "solidColor":this.solidColor=b.copy.solidColor;break;case "linearGradient":this.linearGradient=b.copy.linearGradient.cloneNode(true);break;case "radialGradient":this.radialGradient=b.copy.radialGradient.cloneNode(true)}}else if(b.linearGradient){this.type="linearGradient";this.radialGradient=this.solidColor=null;this.linearGradient=b.linearGradient.cloneNode(true)}else if(b.radialGradient){this.type=
"radialGradient";this.linearGradient=this.solidColor=null;this.radialGradient=b.radialGradient.cloneNode(true)}else if(b.solidColor){this.type="solidColor";this.solidColor=b.solidColor}else{this.type="none";this.radialGradient=this.linearGradient=this.solidColor=null}}};jQuery.fn.jGraduateDefaults={paint:new $.jGraduate.Paint,window:{pickerTitle:"Drag markers to pick a paint"},images:{clientPath:"images/"},newstop:"inverse"};var f=navigator.userAgent.indexOf("Gecko/")>=0;jQuery.fn.jGraduate=function(b){var p=
arguments;return this.each(function(){function A(ia,aa,ja,K,P){var ca=P||a("stop",{"stop-color":aa,"stop-opacity":ja,offset:ia},ea);if(P){aa=P.getAttribute("stop-color");ja=P.getAttribute("stop-opacity");ia=P.getAttribute("offset")}else ea.appendChild(ca);if(ja===null)ja=1;P=a("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:"url(#jGraduate_trans)",transform:"translate("+(10+ia*ha)+", 26)"},kb);var Da=
a("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:aa,"fill-opacity":ja,transform:"translate("+(10+ia*ha)+", 26)",stroke:"#000","stroke-width":1.5},kb);$(Da).mousedown(function(Oa){d(this);Va=cb;Z.mousemove(n).mouseup(g);ta=vb.offset();Oa.preventDefault();return false}).data("stop",ca).data("bg",P).dblclick(function(){$("div.jGraduate_LightBox").show();for(var Oa=this,Wa=+ca.getAttribute("stop-opacity")||
1,Za=ca.getAttribute("stop-color")||1,nb=(parseFloat(Wa)*255).toString(16);nb.length<2;)nb="0"+nb;aa=Za.substr(1)+nb;$("#"+q+"_jGraduate_stopPicker").css({left:100,bottom:15}).jPicker({window:{title:"Pick the start color and opacity for the gradient"},images:{clientPath:C.images.clientPath},color:{active:aa,alphaSupport:true}},function(Ra){Za=Ra.val("hex")?"#"+Ra.val("hex"):"none";Wa=Ra.val("a")!==null?Ra.val("a")/256:1;Oa.setAttribute("fill",Za);Oa.setAttribute("fill-opacity",Wa);ca.setAttribute("stop-color",
Za);ca.setAttribute("stop-opacity",Wa);$("div.jGraduate_LightBox").hide();$("#"+q+"_jGraduate_stopPicker").hide()},null,function(){$("div.jGraduate_LightBox").hide();$("#"+q+"_jGraduate_stopPicker").hide()})});$(ea).find("stop").each(function(){var Oa=$(this);if(+this.getAttribute("offset")>ia){if(!aa){var Wa=this.getAttribute("stop-color"),Za=this.getAttribute("stop-opacity");ca.setAttribute("stop-color",Wa);Da.setAttribute("fill",Wa);ca.setAttribute("stop-opacity",Za===null?1:Za);Da.setAttribute("fill-opacity",
Za===null?1:Za)}Oa.before(ca);return false}});K&&d(Da);return ca}function d(ia){cb&&cb.setAttribute("stroke","#000");ia.setAttribute("stroke","blue");cb=ia;cb.parentNode.appendChild(cb)}function g(){Z.unbind("mousemove",n);if(Ga.getAttribute("display")!=="none"){Ga.setAttribute("display","none");var ia=$(cb),aa=ia.data("stop");ia=ia.data("bg");$([cb,aa,ia]).remove()}Va=null}function c(){var ia=Sa?"rotate("+Sa+","+Ha+","+db+") ":"";$a===1&&Ka===1?ea.removeAttribute("gradientTransform"):ea.setAttribute("gradientTransform",
ia+"translate("+-Ha*($a-1)+","+-db*(Ka-1)+") scale("+$a+","+Ka+")")}function n(ia){var aa=ia.pageX-ta.left;ia=ia.pageY-ta.top;aa=aa<10?10:aa>ha+10?ha+10:aa;var ja="translate("+aa+", 26)";if(ia<-60||ia>130){Ga.setAttribute("display","block");Ga.setAttribute("transform",ja)}else Ga.setAttribute("display","none");Va.setAttribute("transform",ja);$.data(Va,"bg").setAttribute("transform",ja);$.data(Va,"stop").setAttribute("offset",(aa-10)/ha);var K=0;$(ea).find("stop").each(function(){var P=this.getAttribute("offset"),
ca=$(this);if(P<K){ca.prev().before(ca);va=$(ea).find("stop")}K=P})}var v=$(this),C=$.extend(true,{},jQuery.fn.jGraduateDefaults,b),q=v.attr("id"),M="#"+v.attr("id")+" ";if(M){var Q=function(){switch(v.paint.type){case "radialGradient":v.paint.linearGradient=null;break;case "linearGradient":v.paint.radialGradient=null;break;case "solidColor":v.paint.radialGradient=v.paint.linearGradient=null}$.isFunction(v.okCallback)&&v.okCallback(v.paint);v.hide()},L=function(){$.isFunction(v.cancelCallback)&&v.cancelCallback();
v.hide()};$.extend(true,v,{paint:new $.jGraduate.Paint({copy:C.paint}),okCallback:$.isFunction(p[1])&&p[1]||null,cancelCallback:$.isFunction(p[2])&&p[2]||null});v.position();var J=null,Z=$(window);if(v.paint.type=="none")v.paint=$.jGraduate.Paint({solidColor:"ffffff"});v.addClass("jGraduate_Picker");v.html('<ul class="jGraduate_tabs"><li class="jGraduate_tab_color jGraduate_tab_current" data-type="col">Solid Color</li><li class="jGraduate_tab_lingrad" data-type="lg">Linear Gradient</li><li class="jGraduate_tab_radgrad" data-type="rg">Radial Gradient</li></ul><div class="jGraduate_colPick"></div><div class="jGraduate_gradPick"></div><div class="jGraduate_LightBox"></div><div id="'+
q+'_jGraduate_stopPicker" class="jGraduate_stopPicker"></div>');var X=$(M+"> .jGraduate_colPick"),O=$(M+"> .jGraduate_gradPick");O.html('<div id="'+q+'_jGraduate_Swatch" class="jGraduate_Swatch"><h2 class="jGraduate_Title">'+C.window.pickerTitle+'</h2><div id="'+q+'_jGraduate_GradContainer" class="jGraduate_GradContainer"></div><div id="'+q+'_jGraduate_StopSlider" class="jGraduate_StopSlider"></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_lg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Begin Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+
q+'_jGraduate_x1" size="3" title="Enter starting x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+q+'_jGraduate_y1" size="3" title="Enter starting y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">End Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+q+'_jGraduate_x2" size="3" title="Enter ending x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+
q+'_jGraduate_y2" size="3" title="Enter ending y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_rg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Center Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+q+'_jGraduate_cx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+q+'_jGraduate_cy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Focal Point</label><div class="jGraduate_Form_Section"><label>Match center: <input type="checkbox" checked="checked" id="'+
q+'_jGraduate_match_ctr"/></label><br/><label>x:</label><input type="text" id="'+q+'_jGraduate_fx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+q+'_jGraduate_fy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_StopSection jGraduate_SpreadMethod"><label class="jGraduate_Form_Heading">Spread method</label><div class="jGraduate_Form_Section"><select class="jGraduate_spreadMethod"><option value=pad selected>Pad</option><option value=reflect>Reflect</option><option value=repeat>Repeat</option></select></div></div><div class="jGraduate_Form"><div class="jGraduate_Slider jGraduate_RadiusField jGraduate_rg_field"><label class="prelabel">Radius:</label><div id="'+
q+'_jGraduate_Radius" class="jGraduate_SliderBar jGraduate_Radius" title="Click to set radius"><img id="'+q+'_jGraduate_RadiusArrows" class="jGraduate_RadiusArrows" src="'+C.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_RadiusInput" size="3" value="100"/>%</label></div><div class="jGraduate_Slider jGraduate_EllipField jGraduate_rg_field"><label class="prelabel">Ellip:</label><div id="'+q+'_jGraduate_Ellip" class="jGraduate_SliderBar jGraduate_Ellip" title="Click to set Ellip"><img id="'+
q+'_jGraduate_EllipArrows" class="jGraduate_EllipArrows" src="'+C.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_EllipInput" size="3" value="0"/>%</label></div><div class="jGraduate_Slider jGraduate_AngleField jGraduate_rg_field"><label class="prelabel">Angle:</label><div id="'+q+'_jGraduate_Angle" class="jGraduate_SliderBar jGraduate_Angle" title="Click to set Angle"><img id="'+q+'_jGraduate_AngleArrows" class="jGraduate_AngleArrows" src="'+C.images.clientPath+
'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_AngleInput" size="3" value="0"/>\u00ba&nbsp;</label></div><div class="jGraduate_Slider jGraduate_OpacField"><label class="prelabel">Opac:</label><div id="'+q+'_jGraduate_Opac" class="jGraduate_SliderBar jGraduate_Opac" title="Click to set Opac"><img id="'+q+'_jGraduate_OpacArrows" class="jGraduate_OpacArrows" src="'+C.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_OpacInput" size="3" value="100"/>%</label></div></div><div class="jGraduate_OkCancel"><input type="button" id="'+
q+'_jGraduate_Ok" class="jGraduate_Ok" value="OK"/><input type="button" id="'+q+'_jGraduate_Cancel" class="jGraduate_Cancel" value="Cancel"/></div>');var ha=256,pa=ha-0,Y=ha-0,W,ea,Ea,ma={};$(".jGraduate_SliderBar").width(145);var da=$("#"+q+"_jGraduate_GradContainer")[0],S=a("svg",{id:q+"_jgraduate_svg",width:ha,height:ha,xmlns:s.svg},da);W=W||v.paint.type;var V=ea=v.paint[W],na=v.paint.alpha,oa=W==="solidColor";switch(W){case "solidColor":case "linearGradient":if(!oa){ea.id=q+"_lg_jgraduate_grad";
V=ea=S.appendChild(ea)}a("radialGradient",{id:q+"_rg_jgraduate_grad"},S);if(W==="linearGradient")break;case "radialGradient":if(!oa){ea.id=q+"_rg_jgraduate_grad";V=ea=S.appendChild(ea)}a("linearGradient",{id:q+"_lg_jgraduate_grad"},S)}if(oa){V=ea=$("#"+q+"_lg_jgraduate_grad")[0];J=v.paint[W];A(0,"#"+J,1);var la=typeof C.newstop;if(la==="string")switch(C.newstop){case "same":A(1,"#"+J,1);break;case "inverse":la="";for(var ka=0;ka<6;ka+=2){J.substr(ka,2);var ya=(255-parseInt(J.substr(ka,2),16)).toString(16);
if(ya.length<2)ya=0+ya;la+=ya}A(1,"#"+la,1);break;case "white":A(1,"#ffffff",1);break;case "black":A(1,"#000000",1)}else if(la==="object")A(1,C.newstop.color||"#"+J,"opac"in C.newstop?C.newstop.opac:1)}J=parseFloat(V.getAttribute("x1")||0);la=parseFloat(V.getAttribute("y1")||0);ka=parseFloat(V.getAttribute("x2")||1);ya=parseFloat(V.getAttribute("y2")||0);var za=parseFloat(V.getAttribute("cx")||0.5),Ja=parseFloat(V.getAttribute("cy")||0.5),Ia=parseFloat(V.getAttribute("fx")||za),Fa=parseFloat(V.getAttribute("fy")||
Ja);Ea=a("rect",{id:q+"_jgraduate_rect",x:0,y:0,width:pa,height:Y,fill:"url(#"+q+"_jgraduate_grad)","fill-opacity":na/100},S);var Ma=$("<div/>").attr({"class":"grad_coord jGraduate_lg_field",title:"Begin Stop"}).text(1).css({top:la*ha,left:J*ha}).data("coord","start").appendTo(da),Ca=Ma.clone().text(2).css({top:ya*ha,left:ka*ha}).attr("title","End stop").data("coord","end").appendTo(da),wa=$("<div/>").attr({"class":"grad_coord jGraduate_rg_field",title:"Center stop"}).text("C").css({top:Ja*ha,left:za*
ha}).data("coord","center").appendTo(da),ra=wa.clone().text("F").css({top:Fa*ha,left:Ia*ha,display:"none"}).attr("title","Focus point").data("coord","focus").appendTo(da);ra[0].id=q+"_jGraduate_focusCoord";$(M+" .grad_coord");$.each(["x1","y1","x2","y2","cx","cy","fx","fy"],function(ia,aa){var ja=ea.getAttribute(aa),K=isNaN(aa[1]);ja||(ja=K?"0.5":aa==="x2"?"1.0":"0.0");ma[aa]=$("#"+q+"_jGraduate_"+aa).val(ja).change(function(){if(isNaN(parseFloat(this.value))||this.value<0)this.value=0;else if(this.value>
1)this.value=1;if(!(aa[0]==="f"&&!eb))if(K&&W==="radialGradient"||!K&&W==="linearGradient")ea.setAttribute(aa,this.value);var P=K?aa[0]==="c"?wa:ra:aa[1]==="1"?Ma:Ca,ca=aa.indexOf("x")>=0?"left":"top";P.css(ca,this.value*ha)}).change()});var va,kb,vb=$("#"+q+"_jGraduate_StopSlider"),cb,Ta,Va,Ga=a("path",{d:"m9.75,-6l-19.5,19.5m0,-19.5l19.5,19.5",fill:"none",stroke:"#D00","stroke-width":5,display:"none"},Ta),ta,$a=1,Ka=1,Sa=0,Ha=za,db=Ja;Ta=a("svg",{width:"100%",height:45},vb[0]);da=a("pattern",{width:16,
height:16,patternUnits:"userSpaceOnUse",id:"jGraduate_trans"},Ta);a("image",{width:16,height:16},da).setAttributeNS(s.xlink,"xlink:href",C.images.clientPath+"map-opacity.png");$(Ta).on("click touchstart",function(ia){ta=vb.offset();if(ia.target.tagName!=="path"){var aa=ia.pageX-ta.left-8;aa=aa<10?10:aa>ha+10?ha+10:aa;A(aa/ha,0,0,true);ia.stopPropagation()}});$(Ta).mouseover(function(){Ta.appendChild(Ga)});kb=a("g",{},Ta);a("line",{x1:10,y1:15,x2:ha+10,y2:15,"stroke-width":2,stroke:"#000"},Ta);var lb=
O.find(".jGraduate_spreadMethod").change(function(){ea.setAttribute("spreadMethod",$(this).val())}),Ua=null,Xa=function(ia){var aa=ia.pageX-hb.left,ja=ia.pageY-hb.top;aa=aa<0?0:aa>ha?ha:aa;ja=ja<0?0:ja>ha?ha:ja;Ua.css("left",aa).css("top",ja);aa=aa/pa;ja=ja/Y;var K=Ua.data("coord"),P=ea;switch(K){case "start":ma.x1.val(aa);ma.y1.val(ja);P.setAttribute("x1",aa);P.setAttribute("y1",ja);break;case "end":ma.x2.val(aa);ma.y2.val(ja);P.setAttribute("x2",aa);P.setAttribute("y2",ja);break;case "center":ma.cx.val(aa);
ma.cy.val(ja);P.setAttribute("cx",aa);P.setAttribute("cy",ja);Ha=aa;db=ja;c();break;case "focus":ma.fx.val(aa);ma.fy.val(ja);P.setAttribute("fx",aa);P.setAttribute("fy",ja);c()}ia.preventDefault()},wb=function(){Ua=null;Z.unbind("mousemove",Xa).unbind("mouseup",wb)};va=ea.getElementsByTagNameNS(s.svg,"stop");if(sa<2){for(;sa<2;){ea.appendChild(document.createElementNS(s.svg,"stop"));++sa}va=ea.getElementsByTagNameNS(s.svg,"stop")}var sa=va.length;for(ka=0;ka<sa;ka++)A(0,0,0,0,va[ka]);lb.val(ea.getAttribute("spreadMethod")||
"pad");var hb,eb=false;Ea.setAttribute("fill-opacity",na/100);$("#"+q+" div.grad_coord").mousedown(function(ia){ia.preventDefault();Ua=$(this);Ua.offset();hb=Ua.parent().offset();Z.mousemove(Xa).mouseup(wb)});$("#"+q+"_jGraduate_Ok").bind("click touchstart",function(){v.paint.type=W;v.paint[W]=ea.cloneNode(true);v.paint.solidColor=null;Q()});$("#"+q+"_jGraduate_Cancel").bind("click touchstart",function(){L()});if(W==="radialGradient")if(eb)ra.show();else{ra.hide();ma.fx.val("");ma.fy.val("")}$("#"+
q+"_jGraduate_match_ctr")[0].checked=!eb;var sb,ib;$("#"+q+"_jGraduate_match_ctr").change(function(){eb=!this.checked;ra.toggle(eb);ma.fx.val("");ma.fy.val("");var ia=ea;if(eb){var aa=sb||0.5,ja=ib||0.5;ia.setAttribute("fx",aa);ia.setAttribute("fy",ja);ma.fx.val(aa);ma.fy.val(ja)}else{sb=ia.getAttribute("fx");ib=ia.getAttribute("fy");ia.removeAttribute("fx");ia.removeAttribute("fy")}});va=ea.getElementsByTagNameNS(s.svg,"stop");sa=va.length;if(sa<2){for(;sa<2;){ea.appendChild(document.createElementNS(s.svg,
"stop"));++sa}va=ea.getElementsByTagNameNS(s.svg,"stop")}var ab;na=O=0;if(W==="radialGradient"){S=ea.gradientTransform.baseVal;if(S.numberOfItems===2){sa=S.getItem(0);S=S.getItem(1);if(sa.type===2&&S.type===3){sa=S.matrix;if(sa.a!==1)O=Math.round(-(1-sa.a)*100);else if(sa.d!==1)O=Math.round((1-sa.d)*100)}}else if(S.numberOfItems===3){da=S.getItem(0);sa=S.getItem(1);S=S.getItem(2);if(da.type===4&&sa.type===2&&S.type===3){na=Math.round(da.angle);sa=S.matrix;if(sa.a!==1)O=Math.round(-(1-sa.a)*100);else if(sa.d!==
1)O=Math.round((1-sa.d)*100)}}}O={radius:{handle:"#"+q+"_jGraduate_RadiusArrows",input:"#"+q+"_jGraduate_RadiusInput",val:(ea.getAttribute("r")||0.5)*100},opacity:{handle:"#"+q+"_jGraduate_OpacArrows",input:"#"+q+"_jGraduate_OpacInput",val:v.paint.alpha||100},ellip:{handle:"#"+q+"_jGraduate_EllipArrows",input:"#"+q+"_jGraduate_EllipInput",val:O},angle:{handle:"#"+q+"_jGraduate_AngleArrows",input:"#"+q+"_jGraduate_AngleInput",val:na}};$.each(O,function(ia,aa){var ja=$(aa.handle);ja.mousedown(function(K){var P=
ja.parent();ab={type:ia,elem:ja,input:$(aa.input),parent:P,offset:P.offset()};Z.mousemove(ob).mouseup(pb);K.preventDefault()});$(aa.input).val(aa.val).change(function(){var K=+this.value,P=0,ca=W==="radialGradient";switch(ia){case "radius":ca&&ea.setAttribute("r",K/100);P=Math.pow(K/100,0.4)/2*145;break;case "opacity":v.paint.alpha=K;Ea.setAttribute("fill-opacity",K/100);P=K*1.45;break;case "ellip":$a=Ka=1;if(K===0){P=72.5;break}if(K>99.5)K=99.5;if(K>0)Ka=1-K/100;else $a=-(K/100)-1;P=145*((K+100)/
2)/100;ca&&c();break;case "angle":Sa=K;P=Sa/180;P+=0.5;P*=145;ca&&c()}if(P>145)P=145;else if(P<0)P=0;ja.css({"margin-left":P-5})}).change()});var ob=function(ia){var aa=ia.pageX-ab.offset.left-parseInt(ab.parent.css("border-left-width"));if(aa>145)aa=145;if(aa<=0)aa=0;var ja=aa-5;aa/=145;switch(ab.type){case "radius":aa=Math.pow(aa*2,2.5);if(aa>0.98&&aa<1.02)aa=1;if(aa<=0.01)aa=0.01;ea.setAttribute("r",aa);break;case "opacity":v.paint.alpha=parseInt(aa*100);Ea.setAttribute("fill-opacity",aa);break;
case "ellip":Ka=$a=1;if(aa<0.5){aa/=0.5;$a=aa<=0?0.01:aa}else if(aa>0.5){aa/=0.5;aa=2-aa;Ka=aa<=0?0.01:aa}c();aa-=1;if(Ka===aa+1)aa=Math.abs(aa);break;case "angle":aa-=0.5;Sa=aa*=180;c();aa/=100}ab.elem.css({"margin-left":ja});aa=Math.round(aa*100);ab.input.val(aa);ia.preventDefault()},pb=function(){Z.unbind("mousemove",ob).unbind("mouseup",pb);ab=null};for(O=(v.paint.alpha*255/100).toString(16);O.length<2;)O="0"+O;O=O.split(".")[0];J=v.paint.solidColor=="none"?"":v.paint.solidColor+O;oa||(J=va[0].getAttribute("stop-color"));
$.extend($.fn.jPicker.defaults.window,{alphaSupport:true,effects:{type:"show",speed:0}});X.jPicker({window:{title:C.window.pickerTitle},images:{clientPath:C.images.clientPath},color:{active:J,alphaSupport:true}},function(ia){v.paint.type="solidColor";v.paint.alpha=ia.val("ahex")?Math.round(ia.val("a")/255*100):100;v.paint.solidColor=ia.val("hex")?ia.val("hex"):"none";v.paint.radialGradient=null;Q()},null,function(){L()});var fb=$(M+" .jGraduate_tabs li");fb.on("click touchstart",function(){fb.removeClass("jGraduate_tab_current");
$(this).addClass("jGraduate_tab_current");$(M+" > div").hide();var ia=$(this).attr("data-type");$(M+" .jGraduate_gradPick").show();if(ia==="rg"||ia==="lg"){$(".jGraduate_"+ia+"_field").show();$(".jGraduate_"+(ia==="lg"?"rg":"lg")+"_field").hide();$("#"+q+"_jgraduate_rect")[0].setAttribute("fill","url(#"+q+"_"+ia+"_jgraduate_grad)");W=ia==="lg"?"linearGradient":"radialGradient";$("#"+q+"_jGraduate_OpacInput").val(v.paint.alpha).change();var aa=$("#"+q+"_"+ia+"_jgraduate_grad")[0];if(ea!==aa){var ja=
$(ea).find("stop");$(aa).empty().append(ja);ea=aa;aa=lb.val();ea.setAttribute("spreadMethod",aa)}eb=ia==="rg"&&ea.getAttribute("fx")!=null&&!(za==Ia&&Ja==Fa);$("#"+q+"_jGraduate_focusCoord").toggle(eb);if(eb)$("#"+q+"_jGraduate_match_ctr")[0].checked=false}else{$(M+" .jGraduate_gradPick").hide();$(M+" .jGraduate_colPick").show()}});$(M+" > div").hide();fb.removeClass("jGraduate_tab_current");var tb;switch(v.paint.type){case "linearGradient":tb=$(M+" .jGraduate_tab_lingrad");break;case "radialGradient":tb=
$(M+" .jGraduate_tab_radgrad");break;default:tb=$(M+" .jGraduate_tab_color")}v.show();setTimeout(function(){tb.addClass("jGraduate_tab_current").click()},10)}else alert("Container element must have an id attribute to maintain unique id strings for sub-elements.")})}})();jQuery&&function(){var a=$(window),s=$(document);$.extend($.fn,{contextMenu:function(f,b){if(f.menu==undefined)return false;if(f.inSpeed==undefined)f.inSpeed=150;if(f.outSpeed==undefined)f.outSpeed=75;if(f.inSpeed==0)f.inSpeed=-1;if(f.outSpeed==0)f.outSpeed=-1;$(this).each(function(){var p=$(this),A=$(p).offset(),d=$("#"+f.menu);d.addClass("contextMenu");$(this).bind("mousedown",function(c){$(this).on("mouseup",function(n){var v=$(this);v.unbind("mouseup");$(".contextMenu").hide();if(c.button===2||
f.allowLeft||c.ctrlKey&&svgedit.browser.isMac())svgedit.browser.isTouch()||g(n,c,v)})});svgedit.browser.isTouch()&&$(this).bind("taphold",function(c){var n=$(this);n.unbind("mouseup");g(c,c,n)});var g=function(c,n,v){if(typeof n=="undefined")n=c;c.stopPropagation();if(p.hasClass("disabled")||n.altKey)return false;var C=c.pageX,q=c.pageY;if(svgedit.browser.isTouch()){C=c.originalEvent.touches[0].pageX;q=c.originalEvent.touches[0].pageY}c=a.width()-d.width();n=a.height()-d.height();if(C>c-15)C=c-15;
if(q>n-30)q=n-30;if(svgedit.browser.isTouch())q-=d.height()/2;s.unbind("click");d.css({top:q,left:C}).fadeIn(f.inSpeed);d.find("A").mouseover(function(){d.find("LI.hover").removeClass("hover");$(this).parent().addClass("hover")}).mouseout(function(){d.find("LI.hover").removeClass("hover")});s.keypress(function(M){switch(M.keyCode){case 38:if(d.find("LI.hover").length){d.find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover");d.find("LI.hover").length||d.find("LI:last").addClass("hover")}else d.find("LI:last").addClass("hover");
break;case 40:if(d.find("LI.hover").length==0)d.find("LI:first").addClass("hover");else{d.find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover");d.find("LI.hover").length||d.find("LI:first").addClass("hover")}break;case 13:d.find("LI.hover A").trigger("click");break;case 27:s.trigger("click")}});d.find("A").unbind("mouseup");d.find("LI:not(.disabled) A").mouseup(function(){s.unbind("click").unbind("keypress");$(".contextMenu").hide();b&&b($(this).attr("href").substr(1),
$(v),{x:C-A.left,y:q-A.top,docX:C,docY:q});return false});setTimeout(function(){s.click(function(){s.unbind("click").unbind("keypress");d.fadeOut(f.outSpeed);return false})},0)};if($.browser.mozilla)$("#"+f.menu).each(function(){$(this).css({MozUserSelect:"none"})});else $.browser.msie?$("#"+f.menu).each(function(){$(this).bind("selectstart.disableTextSelect",function(){return false})}):$("#"+f.menu).each(function(){$(this).bind("mousedown.disableTextSelect",function(){return false})});$(p).add($("UL.contextMenu")).bind("contextmenu",
function(){return false})});return $(this)},disableContextMenuItems:function(f){if(f==undefined){$(this).find("LI").addClass("disabled");return $(this)}$(this).each(function(){if(f!=undefined)for(var b=f.split(","),p=0;p<b.length;p++)$(this).find('A[href="'+b[p]+'"]').parent().addClass("disabled")});return $(this)},enableContextMenuItems:function(f){if(f==undefined){$(this).find("LI.disabled").removeClass("disabled");return $(this)}$(this).each(function(){if(f!=undefined)for(var b=f.split(","),p=
0;p<b.length;p++)$(this).find('A[href="'+b[p]+'"]').parent().removeClass("disabled")});return $(this)},disableContextMenu:function(){$(this).each(function(){$(this).addClass("disabled")});return $(this)},enableContextMenu:function(){$(this).each(function(){$(this).removeClass("disabled")});return $(this)},destroyContextMenu:function(){$(this).each(function(){$(this).unbind("mousedown").unbind("mouseup")});return $(this)}})}(jQuery);var svgedit=svgedit||{};
(function(){if(!svgedit.browser)svgedit.browser={};var a=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;svgedit.browser.supportsSvg=function(){return a};if(svgedit.browser.supportsSvg()){var s=navigator.userAgent,f=document.createElementNS("http://www.w3.org/2000/svg","svg"),b=!!window.opera,p=s.indexOf("AppleWebKit")>=0,A=s.indexOf("Gecko/")>=0,d=s.indexOf("MSIE")>=0,g=s.indexOf("Chrome/")>=0,c=s.indexOf("Windows")>=0,n=s.indexOf("Macintosh")>=
0,v="ontouchstart"in window,C=!!f.querySelector,q=!!document.evaluate,M=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","path");pa.setAttribute("d","M0,0 10,10");var Y=pa.pathSegList;pa=pa.createSVGPathSegLinetoAbs(5,5);try{Y.replaceItem(pa,0);return true}catch(W){}return false}(),Q=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","path");pa.setAttribute("d","M0,0 10,10");var Y=pa.pathSegList;pa=pa.createSVGPathSegLinetoAbs(5,5);try{Y.insertItemBefore(pa,
0);return true}catch(W){}return false}(),L=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","svg"),Y=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(pa);Y.setAttribute("x",5);pa.appendChild(Y);var W=document.createElementNS("http://www.w3.org/2000/svg","text");W.textContent="a";Y.appendChild(W);Y=W.getStartPositionOfChar(0);Y=Y.x;document.documentElement.removeChild(pa);return Y===0}(),J=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg",
"svg");document.documentElement.appendChild(pa);var Y=document.createElementNS("http://www.w3.org/2000/svg","path");Y.setAttribute("d","M0,0 C0,0 10,10 10,0");pa.appendChild(Y);Y=Y.getBBox();document.documentElement.removeChild(pa);return Y.height>4&&Y.height<5}(),Z=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(pa);var Y=document.createElementNS("http://www.w3.org/2000/svg","path");Y.setAttribute("d","M0,0 10,0");var W=document.createElementNS("http://www.w3.org/2000/svg",
"path");W.setAttribute("d","M5,0 15,0");var ea=document.createElementNS("http://www.w3.org/2000/svg","g");ea.appendChild(Y);ea.appendChild(W);pa.appendChild(ea);Y=ea.getBBox();document.documentElement.removeChild(pa);return Y.width==15}(),X=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","rect");pa.setAttribute("x",0.1);(pa=pa.cloneNode(false).getAttribute("x").indexOf(",")==-1)||$.alert("NOTE: This version of Opera is known to contain bugs in SVG-edit.\n\t\tPlease upgrade to the <a href='http://opera.com'>latest version</a> in which the problems have been fixed.");
return pa}(),O=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","rect");pa.setAttribute("style","vector-effect:non-scaling-stroke");return pa.style.vectorEffect==="non-scaling-stroke"}(),ha=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","rect").transform.baseVal,Y=f.createSVGTransform();pa.appendItem(Y);return pa.getItem(0)==Y}();svgedit.browser.isOpera=function(){return b};svgedit.browser.isWebkit=function(){return p};svgedit.browser.isGecko=function(){return A};
svgedit.browser.isIE=function(){return d};svgedit.browser.isChrome=function(){return g};svgedit.browser.isWindows=function(){return c};svgedit.browser.isMac=function(){return n};svgedit.browser.isTouch=function(){return v};svgedit.browser.supportsSelectors=function(){return C};svgedit.browser.supportsXpath=function(){return q};svgedit.browser.supportsPathReplaceItem=function(){return M};svgedit.browser.supportsPathInsertItemBefore=function(){return Q};svgedit.browser.supportsPathBBox=function(){return J};
svgedit.browser.supportsHVLineContainerBBox=function(){return Z};svgedit.browser.supportsGoodTextCharPos=function(){return L};svgedit.browser.supportsEditableText=function(){return b};svgedit.browser.supportsGoodDecimals=function(){return X};svgedit.browser.supportsNonScalingStroke=function(){return O};svgedit.browser.supportsNativeTransformLists=function(){return ha}}else window.location="browser-not-supported.html"})();svgedit=svgedit||{};
(function(){if(!svgedit.transformlist)svgedit.transformlist={};var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),s={};svgedit.transformlist.SVGTransformList=function(f){this._elem=f||null;this._xforms=[];this._update=function(){var b="";a.createSVGMatrix();for(var p=0;p<this.numberOfItems;++p){var A=this._list.getItem(p);b=b;A=A;var d=A.matrix,g="";switch(A.type){case 1:g="matrix("+[d.a,d.b,d.c,d.d,d.e,d.f].join(",")+")";break;case 2:g="translate("+d.e+","+d.f+")";break;case 3:g=
d.a==d.d?"scale("+d.a+")":"scale("+d.a+","+d.d+")";break;case 4:var c=0;g=0;if(A.angle!=0){c=1-d.a;g=(c*d.f+d.b*d.e)/(c*c+d.b*d.b);c=(d.e-d.b*g)/c}g="rotate("+A.angle+" "+c+","+g+")"}b=b+(g+" ")}this._elem.setAttribute("transform",b)};this._list=this;this._init=function(){var b=this._elem.getAttribute("transform");if(b)for(var p=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,A=true;A;){A=b.match(p);b=b.replace(p,"");if(A&&A[1]){var d=A[1].split(/\s*\(/),g=d[0];d=d[1].match(/\s*(.*?)\s*\)/);
d[1]=d[1].replace(/(\d)-/g,"$1 -");var c=d[1].split(/[, ]+/),n="abcdef".split(""),v=a.createSVGMatrix();$.each(c,function(M,Q){c[M]=parseFloat(Q);if(g=="matrix")v[n[M]]=c[M]});d=a.createSVGTransform();var C="set"+g.charAt(0).toUpperCase()+g.slice(1),q=g=="matrix"?[v]:c;if(g=="scale"&&q.length==1)q.push(q[0]);else if(g=="translate"&&q.length==1)q.push(0);else if(g=="rotate"&&q.length==1){q.push(0);q.push(0)}d[C].apply(d,q);this._list.appendItem(d)}}};this._removeFromOtherLists=function(b){if(b){var p=
false,A;for(A in s){for(var d=s[A],g=0,c=d._xforms.length;g<c;++g)if(d._xforms[g]==b){p=true;d.removeItem(g);break}if(p)break}}};this.numberOfItems=0;this.clear=function(){this.numberOfItems=0;this._xforms=[]};this.initialize=function(b){this.numberOfItems=1;this._removeFromOtherLists(b);this._xforms=[b]};this.getItem=function(b){if(b<this.numberOfItems&&b>=0)return this._xforms[b];throw{code:1};};this.insertItemBefore=function(b,p){var A=null;if(p>=0)if(p<this.numberOfItems){this._removeFromOtherLists(b);
A=Array(this.numberOfItems+1);for(var d=0;d<p;++d)A[d]=this._xforms[d];A[d]=b;for(var g=d+1;d<this.numberOfItems;++g,++d)A[g]=this._xforms[d];this.numberOfItems++;this._xforms=A;A=b;this._list._update()}else A=this._list.appendItem(b);return A};this.replaceItem=function(b,p){var A=null;if(p<this.numberOfItems&&p>=0){this._removeFromOtherLists(b);A=this._xforms[p]=b;this._list._update()}return A};this.removeItem=function(b){if(b<this.numberOfItems&&b>=0){for(var p=this._xforms[b],A=Array(this.numberOfItems-
1),d=0;d<b;++d)A[d]=this._xforms[d];for(b=d;b<this.numberOfItems-1;++b,++d)A[b]=this._xforms[d+1];this.numberOfItems--;this._xforms=A;this._list._update();return p}else throw{code:1};};this.appendItem=function(b){this._removeFromOtherLists(b);this._xforms.push(b);this.numberOfItems++;this._list._update();return b}};svgedit.transformlist.resetListMap=function(){s={}};svgedit.transformlist.removeElementFromListMap=function(f){f.id&&s[f.id]&&delete s[f.id]};svgedit.transformlist.getTransformList=function(f){if(svgedit.browser.supportsNativeTransformLists())if(f.transform)return f.transform.baseVal;
else if(f.gradientTransform)return f.gradientTransform.baseVal;else{if(f.patternTransform)return f.patternTransform.baseVal}else{var b=f.id;b||(b="temp");var p=s[b];if(!p||b=="temp"){s[b]=new svgedit.transformlist.SVGTransformList(f);s[b]._init();p=s[b]}return p}return null}})();svgedit=svgedit||{};
(function(){if(!svgedit.math)svgedit.math={};var a=document.createElementNS("http://www.w3.org/2000/svg","svg");svgedit.math.transformPoint=function(s,f,b){return{x:b.a*s+b.c*f+b.e,y:b.b*s+b.d*f+b.f}};svgedit.math.isIdentity=function(s){return s.a===1&&s.b===0&&s.c===0&&s.d===1&&s.e===0&&s.f===0};svgedit.math.matrixMultiply=function(){for(var s=arguments,f=s.length,b=s[f-1];f-- >1;)b=s[f-1].multiply(b);if(Math.abs(b.a)<1.0E-14)b.a=0;if(Math.abs(b.b)<1.0E-14)b.b=0;if(Math.abs(b.c)<1.0E-14)b.c=0;if(Math.abs(b.d)<
1.0E-14)b.d=0;if(Math.abs(b.e)<1.0E-14)b.e=0;if(Math.abs(b.f)<1.0E-14)b.f=0;return b};svgedit.math.hasMatrixTransform=function(s){if(!s)return false;for(var f=s.numberOfItems;f--;){var b=s.getItem(f);if(b.type==1&&!svgedit.math.isIdentity(b.matrix))return true}return false};svgedit.math.transformBox=function(s,f,b,p,A){var d={x:s,y:f},g={x:s+b,y:f};b={x:s+b,y:f+p};s={x:s,y:f+p};f=svgedit.math.transformPoint;d=f(d.x,d.y,A);var c=p=d.x,n=d.y,v=d.y;g=f(g.x,g.y,A);p=Math.min(p,g.x);c=Math.max(c,g.x);
n=Math.min(n,g.y);v=Math.max(v,g.y);s=f(s.x,s.y,A);p=Math.min(p,s.x);c=Math.max(c,s.x);n=Math.min(n,s.y);v=Math.max(v,s.y);b=f(b.x,b.y,A);p=Math.min(p,b.x);c=Math.max(c,b.x);n=Math.min(n,b.y);v=Math.max(v,b.y);return{tl:d,tr:g,bl:s,br:b,aabox:{x:p,y:n,width:c-p,height:v-n}}};svgedit.math.transformListToTransform=function(s,f,b){if(s==null)return a.createSVGTransformFromMatrix(a.createSVGMatrix());f=f==undefined?0:f;b=b==undefined?s.numberOfItems-1:b;f=parseInt(f);b=parseInt(b);if(f>b){var p=b;b=f;
f=p}p=a.createSVGMatrix();for(f=f;f<=b;++f){var A=f>=0&&f<s.numberOfItems?s.getItem(f).matrix:a.createSVGMatrix();p=svgedit.math.matrixMultiply(p,A)}return a.createSVGTransformFromMatrix(p)};svgedit.math.getMatrix=function(s){s=svgedit.transformlist.getTransformList(s);return svgedit.math.transformListToTransform(s).matrix};svgedit.math.snapToAngle=function(s,f,b,p){var A=Math.PI/4;b=b-s;var d=p-f;p=Math.sqrt(b*b+d*d);A=Math.round(Math.atan2(d,b)/A)*A;return{x:s+p*Math.cos(A),y:f+p*Math.sin(A),a:A}};
svgedit.math.rectsIntersect=function(s,f){if(!s||!f)return false;return f.x<s.x+s.width&&f.x+f.width>s.x&&f.y<s.y+s.height&&f.y+f.height>s.y}})();svgedit=svgedit||{};
(function(){if(!svgedit.units)svgedit.units={};var a=["x","x1","cx","rx","width"],s=["y","y1","cy","ry","height"],f=$.merge(["r","radius"],a);$.merge(f,s);var b,p={px:1};svgedit.units.init=function(d){b=d;d=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(d);var g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("width","1em");g.setAttribute("height","1ex");g.setAttribute("x","1in");d.appendChild(g);g=g.getBBox();document.body.removeChild(d);
d=g.x;p.em=g.width;p.ex=g.height;p["in"]=d;p.cm=d/2.54;p.mm=d/25.4;p.pt=d/72;p.pc=d/6;p["%"]=0};svgedit.units.getTypeMap=function(){return p};svgedit.units.shortFloat=function(d){var g=b.getRoundDigits();if(isNaN(d)){if($.isArray(d))return svgedit.units.shortFloat(d[0])+","+svgedit.units.shortFloat(d[1])}else return+(+d).toFixed(g);return parseFloat(d).toFixed(g)-0};svgedit.units.convertUnit=function(d,g){g=g||b.getBaseUnit();return svgedit.unit.shortFloat(d/p[g])};svgedit.units.setUnitAttr=function(d,
g,c){isNaN(c)||d.getAttribute(g);d.setAttribute(g,c)};var A={line:["x1","x2","y1","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],foreignObject:["x","y","width","height"],rect:["x","y","width","height"],image:["x","y","width","height"],use:["x","y","width","height"],text:["x","y"]};svgedit.units.convertAttrs=function(d){var g=d.tagName,c=b.getBaseUnit();if(g=A[g])for(var n=g.length,v=0;v<n;v++){var C=g[v],q=d.getAttribute(C);if(q)isNaN(q)||d.setAttribute(C,q/p[c]+c)}};svgedit.units.convertToNum=
function(d,g){if(!isNaN(g))return g-0;if(g.substr(-1)==="%"){var c=g.substr(0,g.length-1)/100,n=b.getWidth(),v=b.getHeight();return a.indexOf(d)>=0?c*n:s.indexOf(d)>=0?c*v:c*Math.sqrt(n*n+v*v)/Math.sqrt(2)}else{n=g.substr(-2);c=g.substr(0,g.length-2);return c*p[n]}};svgedit.units.isValidUnit=function(d,g,c){var n=false;if(f.indexOf(d)>=0)if(isNaN(g)){g=g.toLowerCase();$.each(p,function(q){if(!n)if(RegExp("^-?[\\d\\.]+"+q+"$").test(g))n=true})}else n=true;else if(d=="id"){d=false;try{var v=b.getElement(g);
d=v==null||v===c}catch(C){}return d}else n=true;return n}})();svgedit=svgedit||{};
(function(){function a(d){if(svgedit.browser.supportsHVLineContainerBBox())try{return d.getBBox()}catch(g){}var c=$.data(d,"ref"),n=null;if(c){var v=$(c).children().clone().attr("visibility","hidden");$(A).append(v);n=v.filter("line, path")}else n=$(d).find("line, path");var C=false;if(n.length){n.each(function(){var q=this.getBBox();if(!q.width||!q.height)C=true});if(C){d=c?v:$(d).children();ret=getStrokedBBox(d)}else ret=d.getBBox()}else ret=d.getBBox();c&&v.remove();return ret}if(!svgedit.utilities)svgedit.utilities=
{};var s="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),f=null,b=null,p=null,A=null;svgedit.utilities.init=function(d){f=d;b=d.getDOMDocument();p=d.getDOMContainer();A=d.getSVGRoot()};svgedit.utilities.toXml=function(d){return $("<p/>").text(d).html()};svgedit.utilities.fromXml=function(d){return $("<p/>").html(d).text()};svgedit.utilities.encode64=function(d){d=svgedit.utilities.convertToXMLReferences(d);if(window.btoa)return window.btoa(d);
var g=Array(Math.floor((d.length+2)/3)*4),c,n,v,C,q,M,Q=0,L=0;do{c=d.charCodeAt(Q++);n=d.charCodeAt(Q++);v=d.charCodeAt(Q++);C=c>>2;c=(c&3)<<4|n>>4;q=(n&15)<<2|v>>6;M=v&63;if(isNaN(n))q=M=64;else if(isNaN(v))M=64;g[L++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(C);g[L++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c);g[L++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(q);g[L++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(M)}while(Q<
d.length);return g.join("")};svgedit.utilities.decode64=function(d){if(window.atob)return window.atob(d);var g="",c,n,v="",C,q="",M=0;d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(M++));n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(M++));C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(M++));q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(M++));
c=c<<2|n>>4;n=(n&15)<<4|C>>2;v=(C&3)<<6|q;g+=String.fromCharCode(c);if(C!=64)g+=String.fromCharCode(n);if(q!=64)g+=String.fromCharCode(v)}while(M<d.length);return unescape(g)};svgedit.utilities.convertToXMLReferences=function(d){for(var g="",c=0;c<d.length;c++){var n=d.charCodeAt(c);if(n<128)g+=d[c];else if(n>127)g+="&#"+n+";"}return g};svgedit.utilities.text2xml=function(d){if(d.indexOf("<svg:svg")>=0)d=d.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns");var g;try{var c=window.DOMParser?
new DOMParser:new ActiveXObject("Microsoft.XMLDOM");c.async=false}catch(n){throw Error("XML Parser could not be instantiated");}try{g=c.loadXML?c.loadXML(d)?c:false:c.parseFromString(d,"text/xml")}catch(v){throw Error("Error parsing XML string");}return g};svgedit.utilities.bboxToObj=function(d){return{x:d.x,y:d.y,width:d.width,height:d.height}};svgedit.utilities.walkTree=function(d,g){if(d&&d.nodeType==1){g(d);for(var c=d.childNodes.length;c--;)svgedit.utilities.walkTree(d.childNodes.item(c),g)}};
svgedit.utilities.walkTreePost=function(d,g){if(d&&d.nodeType==1){for(var c=d.childNodes.length;c--;)svgedit.utilities.walkTree(d.childNodes.item(c),g);g(d)}};svgedit.utilities.getUrlFromAttr=function(d){if(d)if(d.indexOf('url("')===0)return d.substring(5,d.indexOf('"',6));else if(d.indexOf("url('")===0)return d.substring(5,d.indexOf("'",6));else if(d.indexOf("url(")===0)return d.substring(4,d.indexOf(")"));return null};svgedit.utilities.getHref=function(d){if(d)return d.getAttributeNS("http://www.w3.org/1999/xlink",
"href")};svgedit.utilities.setHref=function(d,g){d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g)};svgedit.utilities.findDefs=function(d){d=f.getSVGContent().documentElement;var g=d.getElementsByTagNameNS("http://www.w3.org/2000/svg","defs");return g=g.length>0?g[0]:d.insertBefore(d.ownerDocument.createElementNS("http://www.w3.org/2000/svg","defs"),d.firstChild.nextSibling)};svgedit.utilities.getPathBBox=function(d){var g=d.pathSegList,c=g.numberOfItems;d=[[],[]];var n=g.getItem(0),
v=[n.x,n.y];for(n=0;n<c;n++){var C=g.getItem(n);if(typeof C.x!="undefined"){d[0].push(v[0]);d[1].push(v[1]);if(C.x1){for(var q=[C.x1,C.y1],M=[C.x2,C.y2],Q=[C.x,C.y],L=0;L<2;L++){C=function(ha){return Math.pow(1-ha,3)*v[L]+3*Math.pow(1-ha,2)*ha*q[L]+3*(1-ha)*Math.pow(ha,2)*M[L]+Math.pow(ha,3)*Q[L]};var J=6*v[L]-12*q[L]+6*M[L],Z=-3*v[L]+9*q[L]-9*M[L]+3*Q[L],X=3*q[L]-3*v[L];if(Z==0){if(J!=0){J=-X/J;0<J&&J<1&&d[L].push(C(J))}}else{X=Math.pow(J,2)-4*X*Z;if(!(X<0)){var O=(-J+Math.sqrt(X))/(2*Z);0<O&&O<
1&&d[L].push(C(O));J=(-J-Math.sqrt(X))/(2*Z);0<J&&J<1&&d[L].push(C(J))}}}v=Q}else{d[0].push(C.x);d[1].push(C.y)}}}g=Math.min.apply(null,d[0]);c=Math.max.apply(null,d[0])-g;n=Math.min.apply(null,d[1]);d=Math.max.apply(null,d[1])-n;return{x:g,y:n,width:c,height:d}};svgedit.utilities.getBBox=function(d){var g=d||f.getSelectedElements()[0];if(d.nodeType!=1)return null;d=null;var c=g.nodeName;switch(c){case "text":if(g.textContent===""){g.textContent="a";d=g.getBBox();g.textContent=""}else try{d=g.getBBox()}catch(n){}break;
case "path":if(svgedit.browser.supportsPathBBox())try{d=g.getBBox()}catch(v){}else d=svgedit.utilities.getPathBBox(g);break;case "g":case "a":d=a(g);break;default:if(c==="use")d=a(g,true);if(c==="use")d||(d=g.getBBox());else if(~s.indexOf(c))try{d=g.getBBox()}catch(C){g=$(g).closest("foreignObject");if(g.length)try{d=g[0].getBBox()}catch(q){d=null}else d=null}}if(d)d=svgedit.utilities.bboxToObj(d);return d};svgedit.utilities.getRotationAngle=function(d,g){var c=d||f.getSelectedElements()[0];c=svgedit.transformlist.getTransformList(c);
if(!c)return 0;for(var n=c.numberOfItems,v=0;v<n;++v){var C=c.getItem(v);if(C.type==4)return g?C.angle*Math.PI/180:C.angle}return 0};svgedit.utilities.getElem=svgedit.browser.supportsSelectors()?function(d){return A.querySelector("#"+d)}:svgedit.browser.supportsXpath()?function(d){return b.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+d+'"]',p,function(){return"http://www.w3.org/2000/svg"},9,null).singleNodeValue}:function(d){return $(A).find("[id="+d+"]")[0]};svgedit.utilities.assignAttributes=
function(d,g,c,n){c||(c=0);svgedit.browser.isOpera()||A.suspendRedraw(c);for(var v in g)if(c=v.substr(0,4)==="xml:"?"http://www.w3.org/XML/1998/namespace":v.substr(0,6)==="xlink:"?"http://www.w3.org/1999/xlink":null)d.setAttributeNS(c,v,g[v]);else n?svgedit.units.setUnitAttr(d,v,g[v]):d.setAttribute(v,g[v]);svgedit.browser.isOpera()||A.unsuspendRedraw(null)};svgedit.utilities.cleanupElement=function(d){var g=A.suspendRedraw(60),c={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none",
"stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0},n;for(n in c){var v=c[n];d.getAttribute(n)==v&&d.removeAttribute(n)}A.unsuspendRedraw(g)}})();svgedit=svgedit||{};
(function(){if(!svgedit.sanitize)svgedit.sanitize={};var a={};a["http://www.w3.org/1999/xlink"]="xlink";a["http://www.w3.org/XML/1998/namespace"]="xml";a["http://www.w3.org/2000/xmlns/"]="xmlns";a["http://svg-edit.googlecode.com"]="se";a["http://www.w3.org/1999/xhtml"]="xhtml";a["http://www.w3.org/1998/Math/MathML"]="mathml";var s={};$.each(a,function(p,A){s[A]=p});var f={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray",
"stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],clipPath:["class",
"clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],feGaussianBlur:["class","color-interpolation-filters","id","requiredFeatures","stdDeviation"],filter:["class","color-interpolation-filters",
"filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage",
"transform","font-family","font-size","font-style","font-weight","text-anchor","data-locked"],image:["class","clip-path","clip-rule","filter","height","id","mask","opacity","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y"],line:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x",
"y"],metadata:["class","id"],path:["class","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox",
"width","x","xlink:href","y"],polygon:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid",
"marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask",
"opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se",
"xmlns:xlink","y"],"switch":["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule",
"filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","xml:space","y"],textPath:["class","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","clip-path","clip-rule","dx","dy","fill",
"fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","xml:space","y"],use:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],
mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],
semantics:[]},b={};$.each(f,function(p,A){var d={};$.each(A,function(g,c){if(c.indexOf(":")>=0){var n=c.split(":");d[n[1]]=s[n[0]]}else d[c]=c=="xmlns"?"http://www.w3.org/2000/xmlns/":null});b[p]=d});svgedit.sanitize.getNSMap=function(){return a};svgedit.sanitize.sanitizeSvg=function(p){if(p.nodeType==3){p.nodeValue=p.nodeValue.replace(/^\s+|\s+$/g,"");p.nodeValue.length||p.parentNode.removeChild(p)}if(p.nodeType==1){var A=p.parentNode;if(p.ownerDocument&&A){var d=f[p.nodeName],g=b[p.nodeName];if(d!=
undefined){for(var c=[],n=p.attributes.length;n--;){var v=p.attributes.item(n),C=v.nodeName,q=v.localName,M=v.namespaceURI;if(!(g.hasOwnProperty(q)&&M==g[q]&&M!="http://www.w3.org/2000/xmlns/")&&!(M=="http://www.w3.org/2000/xmlns/"&&a[v.nodeValue])){C.indexOf("se:")==0&&c.push([C,v.nodeValue]);p.removeAttributeNS(M,q)}if(svgedit.browser.isGecko())switch(C){case "transform":case "gradientTransform":case "patternTransform":q=v.nodeValue.replace(/(\d)-/g,"$1 -");p.setAttribute(C,q)}if(C=="style"){v=
v.nodeValue.split(";");for(C=v.length;C--;){q=v[C].split(":");d.indexOf(q[0])>=0&&p.setAttribute(q[0],q[1])}p.removeAttribute("style")}}$.each(c,function(Q,L){p.setAttributeNS("http://svg-edit.googlecode.com",L[0],L[1])});if((n=svgedit.utilities.getHref(p))&&["filter","linearGradient","pattern","radialGradient","textPath","use"].indexOf(p.nodeName)>=0)if(n[0]!="#"){svgedit.utilities.setHref(p,"");p.removeAttributeNS("http://www.w3.org/1999/xlink","href")}if(p.nodeName=="use"&&!svgedit.utilities.getHref(p))A.removeChild(p);
else{$.each(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(Q,L){var J=p.getAttribute(L);if(J)if((J=svgedit.utilities.getUrlFromAttr(J))&&J[0]!=="#"){p.setAttribute(L,"");p.removeAttribute(L)}});for(n=p.childNodes.length;n--;)svgedit.sanitize.sanitizeSvg(p.childNodes.item(n))}}else{for(d=[];p.hasChildNodes();)d.push(A.insertBefore(p.firstChild,p));A.removeChild(p);for(n=d.length;n--;)svgedit.sanitize.sanitizeSvg(d[n])}}}}})();svgedit=svgedit||{};
(function(){if(!svgedit.history)svgedit.history={};svgedit.history.HistoryEventTypes={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"};svgedit.history.MoveElementCommand=function(a,s,f,b){this.elem=a;this.text=b?"Move "+a.tagName+" to "+b:"Move "+a.tagName;this.oldNextSibling=s;this.oldParent=f;this.newNextSibling=a.nextSibling;this.newParent=a.parentNode};svgedit.history.MoveElementCommand.type=function(){return"svgedit.history.MoveElementCommand"};svgedit.history.MoveElementCommand.prototype.type=
svgedit.history.MoveElementCommand.type;svgedit.history.MoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.MoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.MoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.MoveElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.InsertElementCommand=function(a,s){this.elem=a;this.text=s||"Create "+a.tagName;this.parent=a.parentNode;this.nextSibling=this.elem.nextSibling};svgedit.history.InsertElementCommand.type=function(){return"svgedit.history.InsertElementCommand"};svgedit.history.InsertElementCommand.prototype.type=
svgedit.history.InsertElementCommand.type;svgedit.history.InsertElementCommand.prototype.getText=function(){return this.text};svgedit.history.InsertElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.parent.insertBefore(this.elem,this.nextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.InsertElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.parent=this.elem.parentNode;this.elem=this.elem.parentNode.removeChild(this.elem);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.InsertElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.RemoveElementCommand=function(a,s,f,b){this.elem=a;this.text=b||"Delete "+a.tagName;this.nextSibling=s;this.parent=f;svgedit.transformlist.removeElementFromListMap(a)};svgedit.history.RemoveElementCommand.type=function(){return"svgedit.history.RemoveElementCommand"};
svgedit.history.RemoveElementCommand.prototype.type=svgedit.history.RemoveElementCommand.type;svgedit.history.RemoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.RemoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.parent=this.elem.parentNode;this.elem=this.parent.removeChild(this.elem);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,
this)};svgedit.history.RemoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.nextSibling==null&&window.console&&console.log("Error: reference element was lost");this.parent.insertBefore(this.elem,this.nextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.RemoveElementCommand.prototype.elements=function(){return[this.elem]};
svgedit.history.ChangeElementCommand=function(a,s,f){this.elem=a;this.text=f?"Change "+a.tagName+" "+f:"Change "+a.tagName;this.newValues={};this.oldValues=s;for(var b in s)this.newValues[b]=b=="#text"?a.textContent:b=="#href"?svgedit.utilities.getHref(a):a.getAttribute(b)};svgedit.history.ChangeElementCommand.type=function(){return"svgedit.history.ChangeElementCommand"};svgedit.history.ChangeElementCommand.prototype.type=svgedit.history.ChangeElementCommand.type;svgedit.history.ChangeElementCommand.prototype.getText=
function(){return this.text};svgedit.history.ChangeElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);var s=false,f;for(f in this.newValues){if(this.newValues[f])if(f=="#text")this.elem.textContent=this.newValues[f];else f=="#href"?svgedit.utilities.setHref(this.elem,this.newValues[f]):this.elem.setAttribute(f,this.newValues[f]);else if(f=="#text")this.elem.textContent="";else{this.elem.setAttribute(f,"");this.elem.removeAttribute(f)}if(f==
"transform")s=true}if(!s)if(s=svgedit.utilities.getRotationAngle(this.elem)){f=elem.getBBox();s=["rotate(",s," ",f.x+f.width/2,",",f.y+f.height/2,")"].join("");s!=elem.getAttribute("transform")&&elem.setAttribute("transform",s)}a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);var s=false,f;for(f in this.oldValues){if(this.oldValues[f])if(f==
"#text")this.elem.textContent=this.oldValues[f];else f=="#href"?svgedit.utilities.setHref(this.elem,this.oldValues[f]):this.elem.setAttribute(f,this.oldValues[f]);else if(f=="#text")this.elem.textContent="";else this.elem.removeAttribute(f);if(f=="transform")s=true}if(!s)if(s=svgedit.utilities.getRotationAngle(this.elem)){f=this.elem.getBBox();s=["rotate(",s," ",f.x+f.width/2,",",f.y+f.height/2,")"].join("");s!=this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",s)}svgedit.transformlist.removeElementFromListMap(this.elem);
a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.BatchCommand=function(a){this.text=a||"Batch Command";this.stack=[]};svgedit.history.BatchCommand.type=function(){return"svgedit.history.BatchCommand"};svgedit.history.BatchCommand.prototype.type=svgedit.history.BatchCommand.type;svgedit.history.BatchCommand.prototype.getText=function(){return this.text};svgedit.history.BatchCommand.prototype.apply=
function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);for(var s=this.stack.length,f=0;f<s;++f)this.stack[f].apply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.BatchCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);for(var s=this.stack.length-1;s>=0;s--)this.stack[s].unapply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,
this)};svgedit.history.BatchCommand.prototype.elements=function(){for(var a=[],s=this.stack.length;s--;)for(var f=this.stack[s].elements(),b=f.length;b--;)a.indexOf(f[b])==-1&&a.push(f[b]);return a};svgedit.history.BatchCommand.prototype.addSubCommand=function(a){this.stack.push(a)};svgedit.history.BatchCommand.prototype.isEmpty=function(){return this.stack.length==0};svgedit.history.UndoManager=function(a){this.handler_=a||null;this.undoStackPointer=0;this.undoStack=[];this.undoChangeStackPointer=
-1;this.undoableChangeStack=[]};svgedit.history.UndoManager.prototype.resetUndoStack=function(){this.undoStack=[];this.undoStackPointer=0};svgedit.history.UndoManager.prototype.getUndoStackSize=function(){return this.undoStackPointer};svgedit.history.UndoManager.prototype.getRedoStackSize=function(){return this.undoStack.length-this.undoStackPointer};svgedit.history.UndoManager.prototype.getNextUndoCommandText=function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():
""};svgedit.history.UndoManager.prototype.getNextRedoCommandText=function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""};svgedit.history.UndoManager.prototype.undo=function(){this.undoStackPointer>0&&this.undoStack[--this.undoStackPointer].unapply(this.handler_)};svgedit.history.UndoManager.prototype.redo=function(){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&this.undoStack[this.undoStackPointer++].apply(this.handler_)};
svgedit.history.UndoManager.prototype.addCommandToHistory=function(a){if(this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0)this.undoStack=this.undoStack.splice(0,this.undoStackPointer);this.undoStack.push(a);this.undoStackPointer=this.undoStack.length};svgedit.history.UndoManager.prototype.beginUndoableChange=function(a,s){for(var f=++this.undoChangeStackPointer,b=s.length,p=Array(b),A=Array(b);b--;){var d=s[b];if(d!=null){A[b]=d;p[b]=d.getAttribute(a)}}this.undoableChangeStack[f]=
{attrName:a,oldValues:p,elements:A}};svgedit.history.UndoManager.prototype.finishUndoableChange=function(){for(var a=this.undoChangeStackPointer--,s=this.undoableChangeStack[a],f=s.elements.length,b=s.attrName,p=new svgedit.history.BatchCommand("Change "+b);f--;){var A=s.elements[f];if(A!=null){var d={};d[b]=s.oldValues[f];d[b]!=A.getAttribute(b)&&p.addSubCommand(new svgedit.history.ChangeElementCommand(A,d,b))}}this.undoableChangeStack[a]=null;return p}})();svgedit=svgedit||{};
(function(){if(!svgedit.select)svgedit.select={};var a,s,f;svgedit.select.Selector=function(b,p){this.id=b;this.selectedElement=p;this.locked=true;this.selectorGroup=a.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}});this.selectorRect=this.selectorGroup.appendChild(a.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#4F80FF","stroke-width":"1","shape-rendering":"crispEdges",style:"pointer-events:none"}}));svgedit.browser.isTouch()&&this.selectorRect.setAttribute("stroke-opacity",
0.3);this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};this.reset(this.selectedElement)};svgedit.select.Selector.prototype.reset=function(b){this.locked=true;this.selectedElement=b;this.resize();this.selectorGroup.setAttribute("display","inline")};svgedit.select.Selector.prototype.updateGripCursors=function(b){var p=[];b=Math.round(b/45);if(b<0)b+=8;for(var A in f.selectorGrips)p.push(A);for(;b>0;){p.push(p.shift());b--}b=0;for(A in f.selectorGrips){f.selectorGrips[A].setAttribute("style",
"cursor:"+p[b]+"-resize");b++}};svgedit.select.Selector.prototype.showGrips=function(b){f.selectorGripsGroup.setAttribute("display",b?"inline":"none");var p=this.selectedElement;this.hasGrips=b;if(p&&b){this.selectorGroup.appendChild(f.selectorGripsGroup);this.updateGripCursors(svgedit.utilities.getRotationAngle(p))}};svgedit.select.Selector.prototype.resize=function(){var b=this.selectorRect,p=f,A=p.selectorGrips,d=this.selectedElement,g=d.getAttribute("stroke-width"),c=a.currentZoom(),n=1/c;if(d.getAttribute("stroke")!==
"none"&&!isNaN(g))n+=g/2;var v=d.tagName;if(v==="text")n+=2/c;g=svgedit.transformlist.getTransformList(d);g=svgedit.math.transformListToTransform(g).matrix;g.e*=c;g.f*=c;var C=svgedit.utilities.getBBox(d);if(v==="g"&&!$.data(d,"gsvg"))if(v=a.getStrokedBBox(d.childNodes))C=v;v=C.x;var q=C.y,M=C.width;C=C.height;n*=c;c=svgedit.math.transformBox(v*c,q*c,M*c,C*c,g);g=c.aabox;v=g.x-n;q=g.y-n;M=g.width+n*2;var Q=g.height+n*2;g=v+M/2;C=q+Q/2;if(d=svgedit.utilities.getRotationAngle(d)){v=a.svgRoot().createSVGTransform();
v.setRotate(-d,g,C);v=v.matrix;c.tl=svgedit.math.transformPoint(c.tl.x,c.tl.y,v);c.tr=svgedit.math.transformPoint(c.tr.x,c.tr.y,v);c.bl=svgedit.math.transformPoint(c.bl.x,c.bl.y,v);c.br=svgedit.math.transformPoint(c.br.x,c.br.y,v);v=c.tl;M=v.x;Q=v.y;var L=v.x,J=v.y;v=Math.min;q=Math.max;M=v(M,v(c.tr.x,v(c.bl.x,c.br.x)))-n;Q=v(Q,v(c.tr.y,v(c.bl.y,c.br.y)))-n;L=q(L,q(c.tr.x,q(c.bl.x,c.br.x)))+n;J=q(J,q(c.tr.y,q(c.bl.y,c.br.y)))+n;v=M;q=Q;M=L-M;Q=J-Q}n=a.svgRoot().suspendRedraw(100);b.setAttribute("d",
"M"+v+","+q+" L"+(v+M)+","+q+" "+(v+M)+","+(q+Q)+" "+v+","+(q+Q)+"z");this.selectorGroup.setAttribute("transform",d?"rotate("+[d,g,C].join(",")+")":"");if(svgedit.browser.isTouch()){v-=15.75;q-=15.75}else{v-=4;q-=4}this.gripCoords={nw:[v,q].map(Math.round),ne:[v+M,q].map(Math.round),sw:[v,q+Q].map(Math.round),se:[v+M,q+Q].map(Math.round),n:[v+M/2,q].map(Math.round),w:[v,q+Q/2].map(Math.round),e:[v+M,q+Q/2].map(Math.round),s:[v+M/2,q+Q].map(Math.round)};for(var Z in this.gripCoords){b=this.gripCoords[Z];
A[Z].setAttribute("x",b[0]);A[Z].setAttribute("y",b[1])}this.rotateCoords={nw:[v,q],ne:[v+M+8,q],sw:[v,q+Q+8],se:[v+M+8,q+Q+8]};for(Z in this.rotateCoords){b=this.rotateCoords[Z];p.rotateGrips[Z].setAttribute("cx",b[0]);p.rotateGrips[Z].setAttribute("cy",b[1])}a.svgRoot().unsuspendRedraw(n)};svgedit.select.SelectorManager=function(){this.rubberBandBox=this.selectorParentGroup=null;this.selectors=[];this.selectorMap={};this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};
this.selectorGripsGroup=null;this.rotateGrips={nw:null,ne:null,se:null,sw:null};this.initGroup()};svgedit.select.SelectorManager.prototype.initGroup=function(){this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.parentNode.removeChild(this.selectorParentGroup);this.selectorParentGroup=a.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}});this.selectorGripsGroup=a.createSVGElement({element:"g",attr:{display:"none"}});this.selectorParentGroup.appendChild(this.selectorGripsGroup);
a.svgRoot().appendChild(this.selectorParentGroup);this.selectorMap={};this.selectors=[];this.rubberBandBox=null;for(var b in this.rotateGrips){var p=a.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate_"+b,fill:"#000",r:8,stroke:"#000","fill-opacity":0,"stroke-opacity":0,"stroke-width":0,style:"cursor:url("+s.imgPath+"rotate.png) 12 12, auto;"}});$.data(p,"dir",b);$.data(p,"type","rotate");this.rotateGrips[b]=this.selectorGripsGroup.appendChild(p)}for(b in this.selectorGrips){p=a.createSVGElement({element:"rect",
attr:{id:"selectorGrip_resize_"+b,width:8,height:8,fill:"#4F80FF",stroke:"rgba(0,0,0,0)","stroke-width":1,style:"cursor:"+b+"-resize","pointer-events":"all"}});if(svgedit.browser.isTouch()){p.setAttribute("width",30.5);p.setAttribute("height",30.5);p.setAttribute("fill-opacity",0.3)}$.data(p,"dir",b);$.data(p,"type","resize");this.selectorGrips[b]=this.selectorGripsGroup.appendChild(p)}if(!$("#canvasBackground").length){b=s.dimensions;b=a.createSVGElement({element:"svg",attr:{id:"canvasBackground",
width:b[0],height:b[1],x:0,y:0,overflow:svgedit.browser.isWebkit()?"none":"visible",style:"pointer-events:none"}});p=a.createSVGElement({element:"defs",attr:{id:"placeholder_defs"}});var A=a.createSVGElement({element:"pattern",attr:{id:"checkerPattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20,viewBox:"0 0 10 10"}}),d=a.createSVGElement({element:"rect",attr:{x:0,y:0,width:10,height:10,fill:"#fff"}}),g=a.createSVGElement({element:"rect",attr:{x:0,y:0,width:5,height:5,fill:"#eee"}}),
c=a.createSVGElement({element:"rect",attr:{x:5,y:5,width:5,height:5,fill:"#eee"}}),n=a.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":1,stroke:"#000",fill:"url(#checkerPattern)",style:"pointer-events:none"}});b.appendChild(p);p.appendChild(A);A.appendChild(d);A.appendChild(g);A.appendChild(c);b.appendChild(n);a.svgRoot().insertBefore(b,a.svgContent())}};svgedit.select.SelectorManager.prototype.requestSelector=function(b){if(b==null)return null;var p=this.selectors.length;
if(typeof this.selectorMap[b.id]=="object"){this.selectorMap[b.id].locked=true;return this.selectorMap[b.id]}for(var A=0;A<p;++A)if(this.selectors[A]&&!this.selectors[A].locked){this.selectors[A].locked=true;this.selectors[A].reset(b);this.selectorMap[b.id]=this.selectors[A];return this.selectors[A]}this.selectors[p]=new svgedit.select.Selector(p,b);this.selectorParentGroup.appendChild(this.selectors[p].selectorGroup);this.selectorMap[b.id]=this.selectors[p];return this.selectors[p]};svgedit.select.SelectorManager.prototype.releaseSelector=
function(b){if(b!=null)for(var p=this.selectors.length,A=this.selectorMap[b.id],d=0;d<p;++d)if(this.selectors[d]&&this.selectors[d]==A){A.locked==false&&console.log("WARNING! selector was released but was already unlocked");delete this.selectorMap[b.id];A.locked=false;A.selectedElement=null;A.showGrips(false);try{A.selectorGroup.setAttribute("display","none")}catch(g){}break}};svgedit.select.SelectorManager.prototype.getRubberBandBox=function(){if(!this.rubberBandBox)this.rubberBandBox=this.selectorParentGroup.appendChild(a.createSVGElement({element:"rect",
attr:{id:"selectorRubberBand",fill:"none",stroke:"#666","stroke-width":1,"stroke-dasharray":"3,2",display:"none",style:"pointer-events:none"}}));return this.rubberBandBox};svgedit.select.init=function(b,p){s=b;a=p;f=new svgedit.select.SelectorManager;a.createSVGElement({element:"g",attr:{id:"hover_group"}})};svgedit.select.getSelectorManager=function(){return f}})();svgedit=svgedit||{};
(function(){if(!svgedit.draw)svgedit.draw={};var a="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),s={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},f=s.LET_DOCUMENT_DECIDE;svgedit.draw.Layer=function(b,p){this.name_=b;this.group_=p};svgedit.draw.Layer.prototype.getName=function(){return this.name_};svgedit.draw.Layer.prototype.getGroup=function(){return this.group_};svgedit.draw.randomizeIds=function(b,p){f=b==false?s.NEVER_RANDOMIZE:
s.ALWAYS_RANDOMIZE;if(f==s.ALWAYS_RANDOMIZE&&!p.getNonce())p.setNonce(Math.floor(Math.random()*100001));else f==s.NEVER_RANDOMIZE&&p.getNonce()&&p.clearNonce()};svgedit.draw.Drawing=function(b,p){if(!b||!b.tagName||!b.namespaceURI||b.tagName!="svg"||b.namespaceURI!="http://www.w3.org/2000/svg")throw"Error: svgedit.draw.Drawing instance initialized without a <svg> element";this.svgElem_=b;this.obj_num=0;this.idPrefix=p||"svg_";this.releasedNums=[];this.all_layers=[];this.current_layer=null;this.nonce_=
"";var A=this.svgElem_.getAttributeNS("http://svg-edit.googlecode.com","nonce");if(A&&f!=s.NEVER_RANDOMIZE)this.nonce_=A;else f==s.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(Math.random()*100001))};svgedit.draw.Drawing.prototype.getElem_=function(b){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+b):$(this.svgElem_).find("[id="+b+"]")[0]};svgedit.draw.Drawing.prototype.getSvgElem=function(){return this.svgElem_};svgedit.draw.Drawing.prototype.getNonce=function(){return this.nonce_};
svgedit.draw.Drawing.prototype.setNonce=function(b){this.svgElem_.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:se","http://svg-edit.googlecode.com");this.svgElem_.setAttributeNS("http://svg-edit.googlecode.com","se:nonce",b);this.nonce_=b};svgedit.draw.Drawing.prototype.clearNonce=function(){this.nonce_=""};svgedit.draw.Drawing.prototype.getId=function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num};svgedit.draw.Drawing.prototype.getNextId=function(){var b=
this.obj_num,p=false;if(this.releasedNums.length>0){this.obj_num=this.releasedNums.pop();p=true}else this.obj_num++;for(var A=this.getId();this.getElem_(A);){if(p){this.obj_num=b;p=false}this.obj_num++;A=this.getId()}if(p)this.obj_num=b;return A};svgedit.draw.Drawing.prototype.releaseId=function(b){var p=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if(typeof b!="string"||b.indexOf(p)!=0)return false;b=parseInt(b.substr(p.length));if(typeof b!="number"||b<=0||this.releasedNums.indexOf(b)!=-1)return false;
this.releasedNums.push(b);return true};svgedit.draw.Drawing.prototype.getNumLayers=function(){return this.all_layers.length};svgedit.draw.Drawing.prototype.hasLayer=function(b){for(var p=0;p<this.getNumLayers();p++)if(this.all_layers[p][0]==b)return true;return false};svgedit.draw.Drawing.prototype.getLayerName=function(b){if(b>=0&&b<this.getNumLayers())return this.all_layers[b][0];return""};svgedit.draw.Drawing.prototype.getCurrentLayer=function(){return this.current_layer};svgedit.draw.Drawing.prototype.getCurrentLayerName=
function(){for(var b=0;b<this.getNumLayers();++b)if(this.all_layers[b][1]==this.current_layer)return this.getLayerName(b);return""};svgedit.draw.Drawing.prototype.setCurrentLayer=function(b){for(var p=0;p<this.getNumLayers();++p)if(b==this.getLayerName(p)){if(this.current_layer!=this.all_layers[p][1]){this.current_layer.setAttribute("style","pointer-events:none");this.current_layer=this.all_layers[p][1];this.current_layer.setAttribute("style","pointer-events:all")}return true}return false};svgedit.draw.Drawing.prototype.deleteCurrentLayer=
function(){if(this.current_layer&&this.getNumLayers()>1){var b=this.current_layer.parentNode.removeChild(this.current_layer);this.identifyLayers();return b}return null};svgedit.draw.Drawing.prototype.identifyLayers=function(){this.all_layers=[];for(var b=this.svgElem_.childNodes.length,p=[],A=[],d=null,g=false,c=0;c<b;++c){var n=this.svgElem_.childNodes.item(c);if(n&&n.nodeType==1)if(n.tagName=="g"){g=true;var v=$("title",n).text();if(!v&&svgedit.browser.isOpera()&&n.querySelectorAll)v=$(n.querySelectorAll("title")).text();
if(v){A.push(v);this.all_layers.push([v,n]);d=n;svgedit.utilities.walkTree(n,function(C){C.setAttribute("style","pointer-events:inherit")});d.setAttribute("style","pointer-events:none")}else p.push(n)}else if(~a.indexOf(n.nodeName)){svgedit.utilities.getBBox(n);p.push(n)}}b=this.svgElem_.ownerDocument;if(p.length>0||!g){for(c=1;A.indexOf("Layer "+c)>=0;)c++;A="Layer "+c;d=b.createElementNS("http://www.w3.org/2000/svg","g");g=b.createElementNS("http://www.w3.org/2000/svg","title");g.textContent=A;
d.appendChild(g);for(g=0;g<p.length;++g)d.appendChild(p[g]);this.svgElem_.appendChild(d);this.all_layers.push([A,d])}svgedit.utilities.walkTree(d,function(C){C.setAttribute("style","pointer-events:inherit")});this.current_layer=d.getAttribute("data-locked")==="true"?this.all_layers.slice(-2)[0][1]:d;this.current_layer.setAttribute("style","pointer-events:all")};svgedit.draw.Drawing.prototype.createLayer=function(b){var p=this.svgElem_.ownerDocument,A=p.createElementNS("http://www.w3.org/2000/svg",
"g");p=p.createElementNS("http://www.w3.org/2000/svg","title");p.textContent=b;A.appendChild(p);this.svgElem_.appendChild(A);this.identifyLayers();return A};svgedit.draw.Drawing.prototype.getLayerVisibility=function(b){for(var p=null,A=0;A<this.getNumLayers();++A)if(this.getLayerName(A)==b){p=this.all_layers[A][1];break}if(!p)return false;return p.getAttribute("display")!="none"};svgedit.draw.Drawing.prototype.setLayerVisibility=function(b,p){if(typeof p!="boolean")return null;for(var A=null,d=0;d<
this.getNumLayers();++d)if(this.getLayerName(d)==b){A=this.all_layers[d][1];break}if(!A)return null;A.getAttribute("display");A.setAttribute("display",p?"inline":"none");return A};svgedit.draw.Drawing.prototype.getLayerOpacity=function(b){for(var p=0;p<this.getNumLayers();++p)if(this.getLayerName(p)==b){(b=this.all_layers[p][1].getAttribute("opacity"))||(b="1.0");return parseFloat(b)}return null};svgedit.draw.Drawing.prototype.setLayerOpacity=function(b,p){if(!(typeof p!="number"||p<0||p>1))for(var A=
0;A<this.getNumLayers();++A)if(this.getLayerName(A)==b){this.all_layers[A][1].setAttribute("opacity",p);break}}})();svgedit=svgedit||{};
(function(){if(!svgedit.path)svgedit.path={};var a={pathNodeTooltip:"Drag node to move it. Double-click node to change segment type",pathCtrlPtTooltip:"Drag control point to adjust curve properties"},s={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},f=[],b=false,p={};svgedit.path.setLinkControlPoints=function(g){b=g};var A=svgedit.path.path=null;svgedit.path.init=
function(g){A=g;f=[0,"ClosePath"];$.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],function(c,n){f.push(n+"Abs");f.push(n+"Rel")})};svgedit.path.insertItemBefore=function(g,c,n){g=g.pathSegList;if(svgedit.browser.supportsPathInsertItemBefore())g.insertItemBefore(c,n);else{for(var v=g.numberOfItems,C=[],q=0;q<v;q++){var M=g.getItem(q);C.push(M)}g.clear();for(q=0;q<v;q++){q==n&&g.appendItem(c);g.appendItem(C[q])}}};
svgedit.path.ptObjToArr=function(g,c){for(var n=s[g],v=n.length,C=Array(v),q=0;q<v;q++)C[q]=c[n[q]];return C};svgedit.path.getGripPt=function(g,c){var n={x:c?c.x:g.item.x,y:c?c.y:g.item.y},v=g.path;if(v.matrix)n=svgedit.math.transformPoint(n.x,n.y,v.matrix);n.x*=A.getCurrentZoom();n.y*=A.getCurrentZoom();return n};svgedit.path.getPointFromGrip=function(g,c){var n={x:g.x,y:g.y};if(c.matrix){g=svgedit.math.transformPoint(n.x,n.y,c.imatrix);n.x=g.x;n.y=g.y}n.x/=A.getCurrentZoom();n.y/=A.getCurrentZoom();
return n};svgedit.path.addPointGrip=function(g,c,n){var v=svgedit.path.getGripContainer(),C=svgedit.utilities.getElem("pathpointgrip_"+g);if(!C){C=document.createElementNS("http://www.w3.org/2000/svg","rect");svgedit.utilities.assignAttributes(C,{id:"pathpointgrip_"+g,display:"none",width:svgedit.browser.isTouch()?30:5,height:svgedit.browser.isTouch()?30:5,fill:"#fff",stroke:"#4F80FF","shape-rendering":"crispEdges","stroke-width":1,cursor:"move",style:"pointer-events:all","xlink:title":a.pathNodeTooltip});
C=v.appendChild(C);$("#pathpointgrip_"+g).dblclick(function(){svgedit.path.path&&svgedit.path.path.setSegType()})}if(c&&n)svgedit.utilities.assignAttributes(C,{x:c-(svgedit.browser.isTouch()?15:2.5),y:n-(svgedit.browser.isTouch()?15:2.5),display:"inline"});return C};svgedit.path.getGripContainer=function(){var g=svgedit.utilities.getElem("pathpointgrip_container");if(!g){g=svgedit.utilities.getElem("selectorParentGroup").appendChild(document.createElementNS("http://www.w3.org/2000/svg","g"));g.id=
"pathpointgrip_container"}return g};svgedit.path.addCtrlGrip=function(g){var c=svgedit.utilities.getElem("ctrlpointgrip_"+g);if(c)return c;c=document.createElementNS("http://www.w3.org/2000/svg","circle");svgedit.utilities.assignAttributes(c,{id:"ctrlpointgrip_"+g,display:"none",r:svgedit.browser.isTouch()?15:3,fill:"#4F80FF",stroke:"#4F80FF","stroke-opacity":0,"stroke-width":"3",cursor:"move",style:"pointer-events:all","xlink:title":a.pathCtrlPtTooltip});svgedit.path.getGripContainer().appendChild(c);
return c};svgedit.path.getCtrlLine=function(g){var c=svgedit.utilities.getElem("ctrlLine_"+g);if(c)return c;c=document.createElementNS("http://www.w3.org/2000/svg","line");svgedit.utilities.assignAttributes(c,{id:"ctrlLine_"+g,stroke:"#4F80FF","stroke-width":1,style:"pointer-events:none"});svgedit.path.getGripContainer().appendChild(c);return c};svgedit.path.getPointGrip=function(g,c){var n=svgedit.path.addPointGrip(g.index);if(c){var v=svgedit.path.getGripPt(g);svgedit.utilities.assignAttributes(n,
{x:v.x-(svgedit.browser.isTouch()?15:2.5),y:v.y-(svgedit.browser.isTouch()?15:2.5),display:"inline"})}return n};svgedit.path.getControlPoints=function(g){var c=g.item,n=g.index;if(!c||!("x1"in c)||!("x2"in c))return null;var v={};svgedit.path.getGripContainer();for(var C=[svgedit.path.path.segs[n-1].item,c],q=1;q<3;q++){var M=n+"c"+q,Q=v["c"+q+"_line"]=svgedit.path.getCtrlLine(M),L=svgedit.path.getGripPt(g,{x:c["x"+q],y:c["y"+q]}),J=svgedit.path.getGripPt(g,{x:C[q-1].x,y:C[q-1].y});svgedit.utilities.assignAttributes(Q,
{x1:L.x,y1:L.y,x2:J.x,y2:J.y,display:"inline"});v["c"+q+"_line"]=Q;pointGrip=v["c"+q]=svgedit.path.addCtrlGrip(M);svgedit.utilities.assignAttributes(pointGrip,{cx:L.x,cy:L.y,display:"inline"});v["c"+q]=pointGrip}return v};svgedit.path.replacePathSeg=function(g,c,n,v){v=v||svgedit.path.path.elem;g=v["createSVGPathSeg"+f[g]].apply(v,n);if(svgedit.browser.supportsPathReplaceItem())v.pathSegList.replaceItem(g,c);else{n=v.pathSegList;v=n.numberOfItems;for(var C=[],q=0;q<v;q++){var M=n.getItem(q);C.push(M)}n.clear();
for(q=0;q<v;q++)q==c?n.appendItem(g):n.appendItem(C[q])}};svgedit.path.getSegSelector=function(g,c){var n=g.index,v=svgedit.utilities.getElem("segline_"+n);if(!v){var C=svgedit.path.getGripContainer();v=document.createElementNS("http://www.w3.org/2000/svg","path");svgedit.utilities.assignAttributes(v,{id:"segline_"+n,display:"none",fill:"none",stroke:"#0ff","stroke-opacity":1,"shape-rendering":"crispEdges","stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"});C.appendChild(v)}if(c){n=g.prev;
if(!n){v.setAttribute("display","none");return v}n=svgedit.path.getGripPt(n);svgedit.path.replacePathSeg(2,0,[n.x,n.y],v);C=svgedit.path.ptObjToArr(g.type,g.item,true);for(var q=0;q<C.length;q+=2){n=svgedit.path.getGripPt(g,{x:C[q],y:C[q+1]});C[q]=n.x;C[q+1]=n.y}svgedit.path.replacePathSeg(g.type,1,C,v)}return v};svgedit.path.smoothControlPoints=this.smoothControlPoints=function(g,c,n){var v=g.x-n.x,C=g.y-n.y,q=c.x-n.x,M=c.y-n.y;if((v!=0||C!=0)&&(q!=0||M!=0)){g=Math.atan2(C,v);c=Math.atan2(M,q);v=
Math.sqrt(v*v+C*C);q=Math.sqrt(q*q+M*M);C=A.getSVGRoot().createSVGPoint();M=A.getSVGRoot().createSVGPoint();if(g<0)g+=2*Math.PI;if(c<0)c+=2*Math.PI;var Q=Math.abs(g-c),L=Math.abs(Math.PI-Q)/2;if(g-c>0){g=Q<Math.PI?g+L:g-L;c=Q<Math.PI?c-L:c+L}else{g=Q<Math.PI?g-L:g+L;c=Q<Math.PI?c+L:c-L}C.x=v*Math.cos(g)+n.x;C.y=v*Math.sin(g)+n.y;M.x=q*Math.cos(c)+n.x;M.y=q*Math.sin(c)+n.y;return[C,M]}};svgedit.path.Segment=function(g,c){this.selected=false;this.index=g;this.item=c;this.type=c.pathSegType;this.ctrlpts=
[];this.segsel=this.ptgrip=null};svgedit.path.Segment.prototype.showCtrlPts=function(g){for(var c in this.ctrlpts)this.ctrlpts[c].setAttribute("display",g?"inline":"none")};svgedit.path.Segment.prototype.selectCtrls=function(){$("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill","#4F80FF")};svgedit.path.Segment.prototype.show=function(g){if(this.ptgrip){this.ptgrip.setAttribute("display",g?"inline":"none");this.segsel.setAttribute("display",g?"inline":"none");this.showCtrlPts(g)}};
svgedit.path.Segment.prototype.select=function(g){if(this.ptgrip){this.ptgrip.setAttribute("stroke",g?"#4F80FF":"#4F80FF");this.ptgrip.setAttribute("fill",g?"#4F80FF":"#fff");this.segsel.setAttribute("display",g?"inline":"none");this.ctrlpts&&this.selectCtrls(g);this.selected=g}};svgedit.path.Segment.prototype.addGrip=function(){this.ptgrip=svgedit.path.getPointGrip(this,true);this.ctrlpts=svgedit.path.getControlPoints(this,true);this.segsel=svgedit.path.getSegSelector(this,true)};svgedit.path.Segment.prototype.update=
function(g){if(this.ptgrip){var c=svgedit.path.getGripPt(this),n=svgedit.browser.isTouch()?15:2.5;svgedit.utilities.assignAttributes(this.ptgrip,this.ptgrip.nodeName=="rect"?{x:c.x-n,y:c.y-n}:{cx:c.x,cy:c.y});svgedit.path.getSegSelector(this,true);if(this.ctrlpts){if(g){this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.type=this.item.pathSegType}svgedit.path.getControlPoints(this)}}};svgedit.path.Segment.prototype.move=function(g,c){var n=this.item;n=this.ctrlpts?[n.x+=g,n.y+=
c,n.x1,n.y1,n.x2+=g,n.y2+=c]:[n.x+=g,n.y+=c];svgedit.path.replacePathSeg(this.type,this.index,n);if(this.next&&this.next.ctrlpts){n=this.next.item;n=[n.x,n.y,n.x1+=g,n.y1+=c,n.x2,n.y2];svgedit.path.replacePathSeg(this.next.type,this.next.index,n)}if(this.mate){n=this.mate.item;n=[n.x+=g,n.y+=c];svgedit.path.replacePathSeg(this.mate.type,this.mate.index,n)}this.update(true);this.next&&this.next.update(true)};svgedit.path.Segment.prototype.setLinked=function(g){var c,n,v;if(g==2){n=1;c=this.next;if(!c)return;
v=this.item}else{n=2;c=this.prev;if(!c)return;v=c.item}var C=c.item;C["x"+n]=v.x+v.x-this.item["x"+g];C["y"+n]=v.y+v.y-this.item["y"+g];svgedit.path.replacePathSeg(c.type,c.index,[C.x,C.y,C.x1,C.y1,C.x2,C.y2]);c.update(true)};svgedit.path.Segment.prototype.moveCtrl=function(g,c,n){var v=this.item;v["x"+g]+=c;v["y"+g]+=n;svgedit.path.replacePathSeg(this.type,this.index,[v.x,v.y,v.x1,v.y1,v.x2,v.y2]);this.update(true)};svgedit.path.Segment.prototype.setType=function(g,c){svgedit.path.replacePathSeg(g,
this.index,c);this.type=g;this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.showCtrlPts(g===6);this.ctrlpts=svgedit.path.getControlPoints(this);this.update(true)};svgedit.path.Path=function(g){if(!g||g.tagName!=="path")throw"svgedit.path.Path constructed without a <path> element";this.elem=g;this.segs=[];this.selected_pts=[];svgedit.path.path=this;this.init()};svgedit.path.Path.prototype.init=function(){$(svgedit.path.getGripContainer()).find("*").attr("display","none");var g=
this.elem.pathSegList,c=g.numberOfItems;this.segs=[];this.selected_pts=[];this.first_seg=null;for(var n=0;n<c;n++){var v=g.getItem(n);v=new svgedit.path.Segment(n,v);v.path=this;this.segs.push(v)}g=this.segs;v=null;for(n=0;n<c;n++){var C=g[n],q=n+1>=c?null:g[n+1],M=n-1<0?null:g[n-1];if(C.type===2){if(M&&M.type!==1){q=g[v];q.next=g[v+1];q.next.prev=q;q.addGrip()}v=n}else if(q&&q.type===1){C.next=g[v+1];C.next.prev=C;C.mate=g[v];C.addGrip();if(this.first_seg==null)this.first_seg=C}else if(q){if(C.type!==
1){C.addGrip();if(q&&q.type!==2){C.next=q;C.next.prev=C}}}else if(C.type!==1){q=g[v];q.next=g[v+1];q.next.prev=q;q.addGrip();C.addGrip();if(!this.first_seg)this.first_seg=g[v]}}return this};svgedit.path.Path.prototype.eachSeg=function(g){for(var c=this.segs.length,n=0;n<c;n++)if(g.call(this.segs[n],n)===false)break};svgedit.path.Path.prototype.addSeg=function(g){var c=this.segs[g];if(c.prev){var n=c.prev,v;switch(c.item.pathSegType){case 4:var C=(c.item.x+n.item.x)/2,q=(c.item.y+n.item.y)/2;v=this.elem.createSVGPathSegLinetoAbs(C,
q);break;case 6:v=(n.item.x+c.item.x1)/2;var M=(c.item.x1+c.item.x2)/2,Q=(c.item.x2+c.item.x)/2,L=(v+M)/2;M=(M+Q)/2;C=(L+M)/2;var J=(n.item.y+c.item.y1)/2,Z=(c.item.y1+c.item.y2)/2;n=(c.item.y2+c.item.y)/2;var X=(J+Z)/2;Z=(Z+n)/2;q=(X+Z)/2;v=this.elem.createSVGPathSegCurvetoCubicAbs(C,q,v,J,L,X);svgedit.path.replacePathSeg(c.type,g,[c.item.x,c.item.y,M,Z,Q,n])}svgedit.path.insertItemBefore(this.elem,v,g)}};svgedit.path.Path.prototype.deleteSeg=function(g){var c=this.segs[g],n=this.elem.pathSegList;
c.show(false);var v=c.next;if(c.mate){var C=[v.item.x,v.item.y];svgedit.path.replacePathSeg(2,v.index,C);svgedit.path.replacePathSeg(4,c.index,C);n.removeItem(c.mate.index)}else{if(!c.prev){C=[v.item.x,v.item.y];svgedit.path.replacePathSeg(2,c.next.index,C)}n.removeItem(g)}};svgedit.path.Path.prototype.subpathIsClosed=function(g){var c=false;svgedit.path.path.eachSeg(function(n){if(n<=g)return true;if(this.type===2)return false;else if(this.type===1){c=true;return false}});return c};svgedit.path.Path.prototype.removePtFromSelection=
function(g){var c=this.selected_pts.indexOf(g);if(c!=-1){this.segs[g].select(false);this.selected_pts.splice(c,1)}};svgedit.path.Path.prototype.clearSelection=function(){this.eachSeg(function(){this.select(false)});this.selected_pts=[]};svgedit.path.Path.prototype.storeD=function(){this.last_d=this.elem.getAttribute("d")};svgedit.path.Path.prototype.show=function(g){this.eachSeg(function(){this.show(g)});g&&this.selectPt(this.first_seg.index);return this};svgedit.path.Path.prototype.movePts=function(g,
c){for(var n=this.selected_pts.length;n--;)this.segs[this.selected_pts[n]].move(g,c)};svgedit.path.Path.prototype.moveCtrl=function(g,c){var n=this.segs[this.selected_pts[0]];n.moveCtrl(this.dragctrl,g,c);b&&n.setLinked(this.dragctrl)};svgedit.path.Path.prototype.setSegType=function(g){this.storeD();for(var c=this.selected_pts.length,n;c--;){var v=this.segs[this.selected_pts[c]],C=v.prev;if(C){if(!g){n="Toggle Path Segment Type";g=v.type==6?4:6}g-=0;var q=v.item.x,M=v.item.y,Q=C.item.x;C=C.item.y;
var L;switch(g){case 6:if(v.olditem){Q=v.olditem;L=[q,M,Q.x1,Q.y1,Q.x2,Q.y2]}else{L=q-Q;var J=M-C;L=[q,M,Q+L/3,C+J/3,q-L/3,M-J/3]}break;case 4:L=[q,M];v.olditem=v.item}v.setType(g,L)}}svgedit.path.path.endChanges(n)};svgedit.path.Path.prototype.selectPt=function(g,c){this.clearSelection();g==null&&this.eachSeg(function(n){if(this.prev)g=n});this.addPtsToSelection(g);if(c){this.dragctrl=c;b&&this.segs[g].setLinked(c)}};svgedit.path.Path.prototype.update=function(){var g=this.elem;if(svgedit.utilities.getRotationAngle(g)){this.matrix=
svgedit.math.getMatrix(g);this.imatrix=this.matrix.inverse()}else this.imatrix=this.matrix=null;this.eachSeg(function(c){this.item=g.pathSegList.getItem(c);this.update()});return this};svgedit.path.getPath_=function(g){var c=p[g.id];c||(c=p[g.id]=new svgedit.path.Path(g));return c};svgedit.path.removePath_=function(g){g in p&&delete p[g]};var d=function(g,c,n,v,C,q,M){dx=g-n;dy=c-v;r=Math.sqrt(dx*dx+dy*dy);theta=Math.atan2(dy,dx)+M;dx=r*Math.cos(theta)+n;dy=r*Math.sin(theta)+v;dx-=C;dy-=q;r=Math.sqrt(dx*
dx+dy*dy);theta=Math.atan2(dy,dx)-M;return{x:(r*Math.cos(theta)+C)/1,y:(r*Math.sin(theta)+q)/1}};svgedit.path.recalcRotatedPath=function(){var g=svgedit.path.path.elem,c=svgedit.utilities.getRotationAngle(g,true);if(c){var n=svgedit.utilities.getBBox(g),v=svgedit.path.path.oldbbox,C=v.x+v.width/2;v=v.y+v.height/2;var q=n.x+n.width/2;n=n.y+n.height/2;q=q-C;var M=n-v;n=Math.sqrt(q*q+M*M);M=Math.atan2(M,q)+c;q=n*Math.cos(M)+C;n=n*Math.sin(M)+v;M=g.pathSegList;for(var Q=M.numberOfItems;Q;){Q-=1;var L=
M.getItem(Q),J=L.pathSegType;if(J!=1){var Z=d(L.x,L.y,C,v,q,n,c);Z=[Z.x,Z.y];if(L.x1!=null&&L.x2!=null){c_vals1=d(L.x1,L.y1,C,v,q,n,c);c_vals2=d(L.x2,L.y2,C,v,q,n,c);Z.splice(Z.length,0,c_vals1.x,c_vals1.y,c_vals2.x,c_vals2.y)}svgedit.path.replacePathSeg(J,Q,Z)}}svgedit.utilities.getBBox(g);C=svgroot.createSVGTransform();g=svgedit.transformlist.getTransformList(g);C.setRotate(c*180/Math.PI,q,n);g.replaceItem(C,0)}};svgedit.path.clearData=function(){p={}}})();if(!window.console){window.console={};window.console.log=function(){};window.console.dir=function(){}}if(window.opera){window.console.log=function(a){opera.postError(a)};window.console.dir=function(){}}
(function(){var a=jQuery.fn.attr;jQuery.fn.attr=function(s,f){var b=this.length;if(!b)return a.apply(this,arguments);for(var p=0;p<b;p++){var A=this[p];if(A.namespaceURI==="http://www.w3.org/2000/svg")if(f!==undefined)A.setAttribute(s,f);else if($.isArray(s)){b=s.length;for(p={};b--;){var d=s[b],g=A.getAttribute(d);if(g||g==="0")g=isNaN(g)?g:g-0;p[d]=g}return p}else if(typeof s==="object")for(d in s)A.setAttribute(d,s[d]);else{if((g=A.getAttribute(s))||g==="0")g=isNaN(g)?g:g-0;return g}else return a.apply(this,
arguments)}return this}})();
$.SvgCanvas=function(a,s){function f(e,k){for(var l=svgedit.utilities.getBBox(e),B=0;B<2;B++){var z=B===0?"fill":"stroke",G=e.getAttribute(z);if(G&&G.indexOf("url(")===0){G=P(G);if(G.tagName==="linearGradient"){var D=G.getAttribute("x1")||0,w=G.getAttribute("y1")||0,F=G.getAttribute("x2")||1,h=G.getAttribute("y2")||0;D=l.width*D+l.x;w=l.height*w+l.y;F=l.width*F+l.x;h=l.height*h+l.y;D=O(D,w,k);h=O(F,h,k);F={};F.x1=(D.x-l.x)/l.width;F.y1=(D.y-l.y)/l.height;F.x2=(h.x-l.x)/l.width;F.y2=(h.y-l.y)/l.height;
G=G.cloneNode(true);$(G).attr(F);G.id=ja();gb().appendChild(G);e.setAttribute(z,"url(#"+G.id+")")}}}}var b="http://www.w3.org/2000/svg",p={show_outside_canvas:true,selectNew:true,dimensions:[640,480]};s&&$.extend(p,s);var A=p.dimensions,d=this,g=a.ownerDocument,c=g.importNode(svgedit.utilities.text2xml('<svg id="svgroot" xmlns="'+b+'" xlinkns="http://www.w3.org/1999/xlink" width="'+A[0]+'" height="'+A[1]+'" x="'+A[0]+'" y="'+A[1]+'" overflow="visible"><defs><filter id="canvashadow" filterUnits="objectBoundingBox"><feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/><feOffset in="blur" dx="5" dy="5" result="offsetBlur"/><feMerge><feMergeNode in="offsetBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs></svg>').documentElement,
true);a.appendChild(c);var n=g.createElementNS(b,"svg");(d.clearSvgContentElement=function(){for(;n.firstChild;)n.removeChild(n.firstChild);$(n).attr({id:"svgcontent",width:A[0],height:A[1],x:A[0],y:A[1],overflow:p.show_outside_canvas?"visible":"hidden",xmlns:b,"xmlns:se":"http://svg-edit.googlecode.com","xmlns:xlink":"http://www.w3.org/1999/xlink"}).appendTo(c);var e=g.createComment(" Created with Method Draw - http://github.com/duopixel/Method-Draw/ ");n.appendChild(e)})();var v="svg_";d.setIdPrefix=
function(e){v=e};d.current_drawing_=new svgedit.draw.Drawing(n,v);var C=d.getCurrentDrawing=function(){return d.current_drawing_},q=1,M=null,Q={shape:{fill:(p.initFill.color=="none"?"":"#")+p.initFill.color,fill_paint:null,fill_opacity:p.initFill.opacity,stroke:"#"+p.initStroke.color,stroke_paint:null,stroke_opacity:p.initStroke.opacity,stroke_width:p.initStroke.width,stroke_dasharray:"none",opacity:p.initOpacity}};Q.text=$.extend(true,{},Q.shape);$.extend(Q.text,{fill:"#000000",stroke_width:0,font_size:24,
font_family:"Helvetica, Arial, sans-serif"});var L=Q.shape,J=Array(1),Z=this.addSvgElementFromJson=function(e){var k=svgedit.utilities.getElem(e.attr.id),l=C().getCurrentLayer();if(k&&e.element!=k.tagName){l.removeChild(k);k=null}if(!k){k=g.createElementNS(b,e.element);if(l)(M||l).appendChild(k)}e.curStyles&&svgedit.utilities.assignAttributes(k,{fill:L.fill,stroke:L.stroke,"stroke-width":L.stroke_width,"stroke-dasharray":L.stroke_dasharray,"stroke-opacity":L.stroke_opacity,"fill-opacity":L.fill_opacity,
opacity:L.opacity/2,style:"pointer-events:inherit"},100);svgedit.utilities.assignAttributes(k,e.attr,100);svgedit.utilities.cleanupElement(k);return k},X=d.getTransformList=svgedit.transformlist.getTransformList,O=svgedit.math.transformPoint,ha=d.matrixMultiply=svgedit.math.matrixMultiply,pa=d.hasMatrixTransform=svgedit.math.hasMatrixTransform,Y=d.transformListToTransform=svgedit.math.transformListToTransform,W=svgedit.math.snapToAngle,ea=svgedit.math.getMatrix;svgedit.units.init({getBaseUnit:function(){return p.baseUnit},
getElement:svgedit.utilities.getElem,getHeight:function(){return n.getAttribute("height")/q},getWidth:function(){return n.getAttribute("width")/q},getRoundDigits:function(){return $a.round_digits}});var Ea=d.convertToNum=svgedit.units.convertToNum;svgedit.utilities.init({getDOMDocument:function(){return g},getDOMContainer:function(){return a},getSVGRoot:function(){return c},getSelectedElements:function(){return J},getSVGContent:function(){return n}});var ma=d.getUrlFromAttr=svgedit.utilities.getUrlFromAttr,
da=d.getHref=svgedit.utilities.getHref,S=d.setHref=svgedit.utilities.setHref,V=svgedit.utilities.getPathBBox;d.getBBox=svgedit.utilities.getBBox;var na=d.getRotationAngle=svgedit.utilities.getRotationAngle,oa=d.getElem=svgedit.utilities.getElem,la=d.assignAttributes=svgedit.utilities.assignAttributes,ka=this.cleanupElement=svgedit.utilities.cleanupElement,ya=svgedit.sanitize.getNSMap(),za=d.sanitizeSvg=svgedit.sanitize.sanitizeSvg,Ja=svgedit.history.MoveElementCommand,Ia=svgedit.history.InsertElementCommand,
Fa=svgedit.history.RemoveElementCommand,Ma=svgedit.history.ChangeElementCommand,Ca=svgedit.history.BatchCommand;d.undoMgr=new svgedit.history.UndoManager({handleHistoryEvent:function(e,k){var l=svgedit.history.HistoryEventTypes;if(e==l.BEFORE_UNAPPLY||e==l.BEFORE_APPLY)d.clearSelection();else if(e==l.AFTER_APPLY||e==l.AFTER_UNAPPLY){var B=k.elements();d.pathActions.clear();K("changed",B);B=k.type();l=e==l.AFTER_APPLY;if(B==Ja.type())(l?k.newParent:k.oldParent)==n&&d.identifyLayers();else if(B==Ia.type()||
B==Fa.type()){k.parent==n&&d.identifyLayers();if(B==Ia.type())l&&Ta(k.elem);else l||Ta(k.elem);k.elem.tagName==="use"&&Gb(k.elem)}else if(B==Ma.type()){k.elem.tagName=="title"&&k.elem.parentNode.parentNode==n&&d.identifyLayers();l=l?k.newValues:k.oldValues;l.stdDeviation&&d.setBlurOffsets(k.elem.parentNode,l.stdDeviation)}}}});var wa=function(e){d.undoMgr.addCommandToHistory(e)};svgedit.select.init(p,{createSVGElement:function(e){return d.addSvgElementFromJson(e)},svgRoot:function(){return c},svgContent:function(){return n},
currentZoom:function(){return q},getStrokedBBox:function(e){return d.getStrokedBBox([e])}});var ra=this.selectorManager=svgedit.select.getSelectorManager();svgedit.path.init({getCurrentZoom:function(){return q},getSVGRoot:function(){return c}});svgedit.utilities.snapToGrid=function(e){var k=p.snappingStep,l=p.baseUnit;if(l!=="px")k*=svgedit.units.getTypeMap()[l];return e=Math.round(e/k)*k};var va=svgedit.utilities.snapToGrid,kb={exportNoBlur:"Blurred elements will appear as un-blurred",exportNoforeignObject:"foreignObject elements will not appear",
exportNoDashArray:"Strokes will appear filled",exportNoText:"Text may not appear as expected"},vb=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],cb=$.data,Ta=function(e){var k=$(e).attr(vb),l;for(l in k){var B=k[l];if(B&&B.indexOf("url(")===0){B=ma(B).substr(1);if(!oa(B)){gb().appendChild(sb[B]);delete sb[B]}}}e=e.getElementsByTagName("*");if(e.length){k=0;for(l=e.length;k<l;k++)Ta(e[k])}},Va={},Ga=p.imgPath+"logo.png",ta=[],$a={round_digits:5},Ka=false,Sa=
null,Ha="select",db="none",lb={},Ua=Q.text,Xa=L,wb=null,sa=null,hb=[],eb={},sb={};d.clipBoard=[];var ib=this.runExtensions=function(e,k,l){var B=false;if(l)B=[];$.each(eb,function(z,G){if(e in G)if(l)B.push(G[e](k));else B=G[e](k)});return B};this.addExtension=function(e,k){if(e in eb)console.log('Cannot add extension "'+e+'", an extension by that name already exists"');else{var l=$.isFunction(k)?k($.extend(d.getPrivateMethods(),{svgroot:c,svgcontent:n,nonce:C().getNonce(),selectorManager:ra})):k;
eb[e]=l;K("extension_added",l)}};var ab=this.round=function(e){return parseInt(e*q)/q},ob=this.getIntersectionList=function(e){if(sa==null)return null;var k=M||C().getCurrentLayer();hb.length||(hb=fb(k));var l=null;try{l=k.getIntersectionList(e,null)}catch(B){}if(l==null||typeof l.item!="function"){l=[];if(e)e=e;else{e=sa.getBBox();k={};for(var z in e)k[z]=e[z]/q;e=k}for(z=hb.length;z--;)e.width&&e.width&&svgedit.math.rectsIntersect(e,hb[z].bbox)&&l.push(hb[z].elem)}return l};getStrokedBBox=this.getStrokedBBox=
function(e){e||(e=pb());if(!e.length)return false;var k=function(h){try{var m=svgedit.utilities.getBBox(h),o=svgedit.utilities.getRotationAngle(h);if(o&&o%90||svgedit.math.hasMatrixTransform(svgedit.transformlist.getTransformList(h))){o=false;if(["ellipse","path","line","polyline","polygon"].indexOf(h.tagName)>=0)m=o=d.convertToPath(h,true);else if(h.tagName=="rect"){var u=h.getAttribute("rx"),E=h.getAttribute("ry");if(u||E)m=o=d.convertToPath(h,true)}if(!o){var H=h.cloneNode(true),I=document.createElementNS(b,
"g"),N=h.parentNode;N.appendChild(I);I.appendChild(H);m=svgedit.utilities.bboxToObj(I.getBBox());N.removeChild(I)}}return m}catch(U){console.log(h,U)}},l;$.each(e,function(){if(!l)if(this.parentNode)l=k(this)});if(l==null)return null;var B=l.x+l.width,z=l.y+l.height,G=l.x,D=l.y,w=function(h){var m=h.getAttribute("stroke-width"),o=0;if(h.getAttribute("stroke")!="none"&&!isNaN(m))o+=m/2;return o},F=[];$.each(e,function(h,m){var o=k(m);if(o){var u=w(m);G=Math.min(G,o.x-u);D=Math.min(D,o.y-u);F.push(o)}});
l.x=G;l.y=D;$.each(e,function(h,m){var o=F[h];if(o&&m.nodeType==1){var u=w(m);B=Math.max(B,o.x+o.width+u);z=Math.max(z,o.y+o.height+u)}});l.width=B-G;l.height=z-D;return l};var pb=this.getVisibleElements=function(e){e||(e=$(n).children());e.find("#canvas_background").length&&e.splice(0,1);var k=[];$(e).children().each(function(l,B){try{B.getBBox()&&k.push(B)}catch(z){}});return k.reverse()},fb=this.getVisibleElementsAndBBoxes=function(e){e||(e=$(n).children());var k=[];$(e).children().each(function(l,
B){try{B.getBBox()&&k.push({elem:B,bbox:getStrokedBBox([B])})}catch(z){}});return k.reverse()},tb=this.groupSvgElem=function(e){var k=document.createElementNS(b,"g");e.parentNode.replaceChild(k,e);$(k).append(e).data("gsvg",e)[0].id=ja()},ia=function(e){var k=document.createElementNS(e.namespaceURI,e.nodeName);k.removeAttribute("id");$.each(e.attributes,function(B,z){z.localName!="-moz-math-font-style"&&k.setAttributeNS(z.namespaceURI,z.nodeName,z.nodeValue)});if(svgedit.browser.isWebkit()&&e.nodeName==
"path"){var l=La.convertPath(e);k.setAttribute("d",l)}$.each(e.childNodes,function(B,z){switch(z.nodeType){case 1:k.appendChild(ia(z));break;case 3:k.textContent=z.nodeValue}});if($(e).data("gsvg"))$(k).data("gsvg",k.firstChild);else if($(e).data("symbol")){e=$(e).data("symbol");$(k).data("ref",e).data("symbol",e)}else k.tagName=="image"&&Fb(k);k.id=ja();return k},aa,ja,K;(function(e){var k={};aa=e.getId=function(){return C().getId()};ja=e.getNextId=function(){return C().getNextId()};K=e.call=function(l,
B){if(k[l])return k[l](this,B)};e.bind=function(l,B){var z=k[l];k[l]=B;return z}})(d);this.prepareSvg=function(e){this.sanitizeSvg(e.documentElement);e=e.getElementsByTagNameNS(b,"path");for(var k=0,l=e.length;k<l;++k){var B=e[k];B.setAttribute("d",La.convertPath(B));La.fixEnd(B)}};var P=this.getRefElem=function(e){return oa(ma(e).substr(1))},ca=function(e){if(!svgedit.browser.isGecko())return e;var k=e.cloneNode(true);e.parentNode.insertBefore(k,e);e.parentNode.removeChild(e);ra.releaseSelector(e);
J[0]=k;ra.requestSelector(k).showGrips(true);return k};this.setRotationAngle=function(e,k){e=parseFloat(e);var l=J[0];if(l){var B=l.getAttribute("transform"),z=svgedit.utilities.getBBox(l),G=z.x+z.width/2,D=z.y+z.height/2;z=X(l);z.numberOfItems>0&&z.getItem(0).type==4&&z.removeItem(0);if(e!=0){G=O(G,D,Y(z).matrix);D=c.createSVGTransform();D.setRotate(e,G.x,G.y);z.numberOfItems?z.insertItemBefore(D,0):z.appendItem(D)}else z.numberOfItems==0&&l.removeAttribute("transform");if(!k){z=l.getAttribute("transform");
l.setAttribute("transform",B);Ya("transform",z,J);K("changed",J)}oa("pathpointgrip_container");l=ra.requestSelector(J[0]);l.resize();l.updateGripCursors(e)}};var Da=this.recalculateAllSelectedDimensions=function(){for(var e=new Ca(db=="none"?"position":"size"),k=J.length;k--;){var l=Ra(J[k]);l&&e.addSubCommand(l)}if(!e.isEmpty()){wa(e);K("changed",J)}},Oa=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],Wa=function(e){console.log([e.a,e.b,e.c,e.d,e.e,e.f])},Za=this.remapElement=
function(e,k,l){var B=p.gridSnapping&&e.parentNode.parentNode.localName==="svg",z=function(){if(B)for(var o in k)k[o]=va(k[o]);la(e,k,1E3,true)};box=svgedit.utilities.getBBox(e);for(var G=0;G<2;G++){var D=G===0?"fill":"stroke",w=e.getAttribute(D);if(w&&w.indexOf("url(")===0)if(l.a<0||l.d<0){w=P(w).cloneNode(true);if(l.a<0){var F=w.getAttribute("x1"),h=w.getAttribute("x2");w.setAttribute("x1",-(F-1));w.setAttribute("x2",-(h-1))}if(l.d<0){F=w.getAttribute("y1");h=w.getAttribute("y2");w.setAttribute("y1",
-(F-1));w.setAttribute("y2",-(h-1))}w.id=ja();gb().appendChild(w);e.setAttribute(D,"url(#"+w.id+")")}}G=e.tagName;if(G==="g"||G==="text"||G==="use")if(l.a==1&&l.b==0&&l.c==0&&l.d==1&&(l.e!=0||l.f!=0)){D=Y(e).matrix;D=ha(D.inverse(),l,D);k.x=parseFloat(k.x)+D.e;k.y=parseFloat(k.y)+D.f}else{D=X(e);w=c.createSVGTransform();w.setMatrix(ha(Y(D).matrix,l));D.clear();D.appendItem(w)}switch(G){case "foreignObject":case "rect":case "image":if(G==="image"&&(l.a<0||l.d<0)){D=X(e);w=c.createSVGTransform();w.setMatrix(ha(Y(D).matrix,
l));D.clear();D.appendItem(w)}else{D=O(k.x,k.y,l);k.width=l.a*k.width;k.height=l.d*k.height;k.x=D.x+Math.min(0,k.width);k.y=D.y+Math.min(0,k.height);k.width=Math.abs(k.width);k.height=Math.abs(k.height)}z();break;case "ellipse":G=O(k.cx,k.cy,l);k.cx=G.x;k.cy=G.y;k.rx=l.a*k.rx;k.ry=l.d*k.ry;k.rx=Math.abs(k.rx);k.ry=Math.abs(k.ry);z();break;case "circle":G=O(k.cx,k.cy,l);k.cx=G.x;k.cy=G.y;G=svgedit.math.transformBox(box.x,box.y,box.width,box.height,l);k.r=Math.min((G.tr.x-G.tl.x)/2,(G.bl.y-G.tl.y)/
2);if(k.r)k.r=Math.abs(k.r);z();break;case "line":D=O(k.x1,k.y1,l);F=O(k.x2,k.y2,l);k.x1=D.x;k.y1=D.y;k.x2=F.x;k.y2=F.y;case "text":l=e.querySelectorAll("tspan");for(G=l.length;G--;){D=Ea("x",e.getAttribute("x"));w=Ea("x",l[G].getAttribute("x"));F=Ea("y",e.getAttribute("y"));h=Ea("y",l[G].getAttribute("y"));var m={};if(!isNaN(D)&&!isNaN(w)&&D!=0&&w!=0&&k.x)m.x=k.x-(D-w);if(!isNaN(F)&&!isNaN(h)&&F!=0&&h!=0&&k.y)m.y=k.y-(F-h);if(m.x||m.y)la(l[G],m,1E3,true)}z();break;case "use":z();break;case "g":(z=
$(e).data("gsvg"))&&la(z,k,1E3,true);break;case "polyline":case "polygon":z=k.points.length;for(G=0;G<z;++G){h=k.points[G];h=O(h.x,h.y,l);k.points[G].x=h.x;k.points[G].y=h.y}z=k.points.length;l="";for(G=0;G<z;++G){h=k.points[G];l+=h.x+","+h.y+" "}e.setAttribute("points",l);break;case "path":D=e.pathSegList;z=D.numberOfItems;k.d=Array(z);for(G=0;G<z;++G){w=D.getItem(G);k.d[G]={type:w.pathSegType,x:w.x,y:w.y,x1:w.x1,y1:w.y1,x2:w.x2,y2:w.y2,r1:w.r1,r2:w.r2,angle:w.angle,largeArcFlag:w.largeArcFlag,sweepFlag:w.sweepFlag}}z=
k.d.length;G=k.d[0];m=O(G.x,G.y,l);k.d[0].x=m.x;k.d[0].y=m.y;for(G=1;G<z;++G){w=k.d[G];D=w.type;if(D%2==0){h=O(w.x!=undefined?w.x:m.x,w.y!=undefined?w.y:m.y,l);D=O(w.x1,w.y1,l);F=O(w.x2,w.y2,l);w.x=h.x;w.y=h.y;w.x1=D.x;w.y1=D.y;w.x2=F.x;w.y2=F.y}else{w.x=l.a*w.x;w.y=l.d*w.y;w.x1=l.a*w.x1;w.y1=l.d*w.y1;w.x2=l.a*w.x2;w.y2=l.d*w.y2}w.r1=l.a*w.r1;w.r2=l.d*w.r2}l="";z=k.d.length;for(G=0;G<z;++G){w=k.d[G];D=w.type;l+=Oa[D];switch(D){case 13:case 12:l+=w.x+" ";break;case 15:case 14:l+=w.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:l+=
w.x+","+w.y+" ";break;case 7:case 6:l+=w.x1+","+w.y1+" "+w.x2+","+w.y2+" "+w.x+","+w.y+" ";break;case 9:case 8:l+=w.x1+","+w.y1+" "+w.x+","+w.y+" ";break;case 11:case 10:l+=w.r1+","+w.r2+" "+w.angle+" "+ +w.largeArcFlag+" "+ +w.sweepFlag+" "+w.x+","+w.y+" ";break;case 17:case 16:l+=w.x2+","+w.y2+" "+w.x+","+w.y+" "}}e.setAttribute("d",l)}},nb=function(e,k,l){e=P(e).firstChild;var B=X(e),z=c.createSVGTransform();z.setTranslate(k,l);B.appendItem(z);Ra(e)},Ra=this.recalculateDimensions=function(e){if(e==
null)return null;var k=X(e);if(k&&k.numberOfItems>0){for(var l=k.numberOfItems;l--;){var B=k.getItem(l);if(B.type===0)k.removeItem(l);else if(B.type===1)svgedit.math.isIdentity(B.matrix)&&k.removeItem(l);else B.type===4&&B.angle===0&&k.removeItem(l)}if(k.numberOfItems===1&&na(e))return null}if(!k||k.numberOfItems==0){e.removeAttribute("transform");return null}if(k){l=k.numberOfItems;for(var z=[];l--;){B=k.getItem(l);if(B.type===1)z.push([B.matrix,l]);else if(z.length)z=[]}if(z.length===2){l=c.createSVGTransformFromMatrix(ha(z[1][0],
z[0][0]));k.removeItem(z[0][1]);k.removeItem(z[1][1]);k.insertItemBefore(l,z[1][1])}l=k.numberOfItems;if(l>=2&&k.getItem(l-2).type===1&&k.getItem(l-1).type===2){z=c.createSVGTransform();B=ha(k.getItem(l-2).matrix,k.getItem(l-1).matrix);z.setMatrix(B);k.removeItem(l-2);k.removeItem(l-2);k.appendItem(z)}}switch(e.tagName){case "line":case "polyline":case "polygon":case "path":break;default:if(k.numberOfItems===1&&k.getItem(0).type===1||k.numberOfItems===2&&k.getItem(0).type===1&&k.getItem(0).type===
4)return null}var G=$(e).data("gsvg");l=new Ca("Transform");var D={},w=null;B=[];switch(e.tagName){case "line":B=["x1","y1","x2","y2"];break;case "circle":B=["cx","cy","r"];break;case "ellipse":B=["cx","cy","rx","ry"];break;case "foreignObject":case "rect":case "image":B=["width","height","x","y"];break;case "use":case "text":case "tspan":B=["x","y"];break;case "polygon":case "polyline":w={};w.points=e.getAttribute("points");z=e.points;var F=z.numberOfItems;D.points=Array(F);for(var h=0;h<F;++h){var m=
z.getItem(h);D.points[h]={x:m.x,y:m.y}}break;case "path":w={};w.d=e.getAttribute("d");D.d=e.getAttribute("d")}if(B.length){D=$(e).attr(B);$.each(D,function(Ba,Pa){D[Ba]=Ea(Ba,Pa)})}else if(G)D={x:$(G).attr("x")||0,y:$(G).attr("y")||0};if(w==null){w=$.extend(true,{},D);$.each(w,function(Ba,Pa){w[Ba]=Ea(Ba,Pa)})}w.transform=Sa?Sa:"";if(e.tagName=="g"&&!G||e.tagName=="a"){z=svgedit.utilities.getBBox(e);var o={x:z.x+z.width/2,y:z.y+z.height/2},u=O(z.x+z.width/2,z.y+z.height/2,Y(k).matrix);B=c.createSVGMatrix();
if(z=na(e)){h=z*Math.PI/180;F=Math.abs(h)>1.0E-10?Math.sin(h)/(1-Math.cos(h)):2/h;for(h=0;h<k.numberOfItems;++h){B=k.getItem(h);if(B.type==4){B=B.matrix;o.y=(F*B.e+B.f)/2;o.x=(B.e-F*B.f)/2;k.removeItem(h);break}}}h=B=G=0;var E=k.numberOfItems;if(E)var H=k.getItem(0).matrix;if(E>=3&&k.getItem(E-2).type==3&&k.getItem(E-3).type==2&&k.getItem(E-1).type==2){h=3;var I=k.getItem(E-3).matrix,N=k.getItem(E-2).matrix,U=k.getItem(E-1).matrix;F=e.childNodes;for(m=F.length;m--;){var ba=F.item(m);B=G=0;if(ba.nodeType==
1){var R=X(ba);if(R){B=Y(R).matrix;G=na(ba);var fa=Sa,ga=[];Sa=ba.getAttribute("transform");if(G||pa(R)){var T=c.createSVGTransform();T.setMatrix(ha(I,N,U,B));R.clear();R.appendItem(T);ga.push(T)}else{G=ha(B.inverse(),U,B);T=c.createSVGMatrix();T.e=-G.e;T.f=-G.f;B=ha(T.inverse(),B.inverse(),I,N,U,B,G.inverse());var qa=c.createSVGTransform(),ua=c.createSVGTransform(),Aa=c.createSVGTransform();qa.setTranslate(G.e,G.f);ua.setScale(B.a,B.d);Aa.setTranslate(T.e,T.f);R.appendItem(Aa);R.appendItem(ua);R.appendItem(qa);
ga.push(Aa);ga.push(ua);ga.push(qa)}l.addSubCommand(Ra(ba));Sa=fa}}}k.removeItem(E-1);k.removeItem(E-2);k.removeItem(E-3)}else if(E>=3&&k.getItem(E-1).type==1){h=3;B=Y(k).matrix;T=c.createSVGTransform();T.setMatrix(B);k.clear();k.appendItem(T)}else if((E==1||E>1&&k.getItem(1).type!=3)&&k.getItem(0).type==2){h=2;G=Y(k).matrix;k.removeItem(0);B=Y(k).matrix.inverse();B=ha(B,G);G=B.e;B=B.f;if(G!=0||B!=0){F=e.childNodes;m=F.length;for(E=[];m--;){ba=F.item(m);if(ba.nodeType==1){if(ba.getAttribute("clip-path")){fa=
ba.getAttribute("clip-path");if(E.indexOf(fa)===-1){nb(fa,G,B);E.push(fa)}}fa=Sa;Sa=ba.getAttribute("transform");if(R=X(ba)){I=c.createSVGTransform();I.setTranslate(G,B);R.numberOfItems?R.insertItemBefore(I,0):R.appendItem(I);l.addSubCommand(Ra(ba));R=e.getElementsByTagNameNS(b,"use");ba="#"+ba.id;for(I=R.length;I--;){N=R.item(I);if(ba==da(N)){U=c.createSVGTransform();U.setTranslate(-G,-B);X(N).insertItemBefore(U,0);l.addSubCommand(Ra(N))}}Sa=fa}}}E=[];Sa=fa}}else if(E==1&&k.getItem(0).type==1&&!z){h=
1;B=k.getItem(0).matrix;F=e.childNodes;for(m=F.length;m--;){ba=F.item(m);if(ba.nodeType==1){fa=Sa;Sa=ba.getAttribute("transform");if(R=X(ba)){G=ha(B,Y(R).matrix);E=c.createSVGTransform();E.setMatrix(G);R.clear();R.appendItem(E,0);l.addSubCommand(Ra(ba));Sa=fa;fa=ba.getAttribute("stroke-width");ba.getAttribute("stroke")!=="none"&&!isNaN(fa)&&ba.setAttribute("stroke-width",fa*((Math.abs(G.a)+Math.abs(G.d))/2))}}}k.clear()}else{if(z){o=c.createSVGTransform();o.setRotate(z,u.x,u.y);k.numberOfItems?k.insertItemBefore(o,
0):k.appendItem(o)}k.numberOfItems==0&&e.removeAttribute("transform");return null}if(h==2){if(z){u={x:o.x+H.e,y:o.y+H.f};o=c.createSVGTransform();o.setRotate(z,u.x,u.y);k.numberOfItems?k.insertItemBefore(o,0):k.appendItem(o)}}else if(h==3){B=Y(k).matrix;H=c.createSVGTransform();H.setRotate(z,o.x,o.y);H=H.matrix;o=c.createSVGTransform();o.setRotate(z,u.x,u.y);u=o.matrix.inverse();fa=B.inverse();u=ha(fa,u,H,B);G=u.e;B=u.f;if(G!=0||B!=0){F=e.childNodes;for(m=F.length;m--;){ba=F.item(m);if(ba.nodeType==
1){fa=Sa;Sa=ba.getAttribute("transform");R=X(ba);I=c.createSVGTransform();I.setTranslate(G,B);R.numberOfItems?R.insertItemBefore(I,0):R.appendItem(I);l.addSubCommand(Ra(ba));Sa=fa}}}if(z)k.numberOfItems?k.insertItemBefore(o,0):k.appendItem(o)}}else{z=svgedit.utilities.getBBox(e);if(!z&&e.tagName!="path")return null;B=c.createSVGMatrix();if(G=na(e)){o={x:z.x+z.width/2,y:z.y+z.height/2};u=O(z.x+z.width/2,z.y+z.height/2,Y(k).matrix);h=G*Math.PI/180;F=Math.abs(h)>1.0E-10?Math.sin(h)/(1-Math.cos(h)):2/
h;for(h=0;h<k.numberOfItems;++h){B=k.getItem(h);if(B.type==4){B=B.matrix;o.y=(F*B.e+B.f)/2;o.x=(B.e-F*B.f)/2;k.removeItem(h);break}}}h=0;E=k.numberOfItems;if(!svgedit.browser.isWebkit())if((H=e.getAttribute("fill"))&&H.indexOf("url(")===0){H=P(H);fa="pattern";if(H.tagName!==fa)fa="gradient";if(H.getAttribute(fa+"Units")==="userSpaceOnUse"){B=Y(k).matrix;z=X(H);z=Y(z).matrix;B=ha(B,z);z="matrix("+[B.a,B.b,B.c,B.d,B.e,B.f].join(",")+")";H.setAttribute(fa+"Transform",z)}}if(E>=3&&k.getItem(E-2).type==
3&&k.getItem(E-3).type==2&&k.getItem(E-1).type==2){h=3;B=Y(k,E-3,E-1).matrix;k.removeItem(E-1);k.removeItem(E-2);k.removeItem(E-3)}else if(E==4&&k.getItem(E-1).type==1){h=3;B=Y(k).matrix;T=c.createSVGTransform();T.setMatrix(B);k.clear();k.appendItem(T);B=c.createSVGMatrix()}else if((E==1||E>1&&k.getItem(1).type!=3)&&k.getItem(0).type==2){h=2;H=k.getItem(0).matrix;fa=Y(k,1).matrix;z=fa.inverse();B=ha(z,H,fa);k.removeItem(0)}else if(E==1&&k.getItem(0).type==1&&!G){B=Y(k).matrix;switch(e.tagName){case "line":D=
$(e).attr(["x1","y1","x2","y2"]);case "polyline":case "polygon":D.points=e.getAttribute("points");if(D.points){z=e.points;F=z.numberOfItems;D.points=Array(F);for(h=0;h<F;++h){m=z.getItem(h);D.points[h]={x:m.x,y:m.y}}}case "path":D.d=e.getAttribute("d");h=1;k.clear()}}else{h=4;if(G){o=c.createSVGTransform();o.setRotate(G,u.x,u.y);k.numberOfItems?k.insertItemBefore(o,0):k.appendItem(o)}k.numberOfItems==0&&e.removeAttribute("transform");return null}if(h==1||h==2||h==3)Za(e,D,B);if(h==2){if(G){pa(k)||
(u={x:o.x+B.e,y:o.y+B.f});o=c.createSVGTransform();o.setRotate(G,u.x,u.y);k.numberOfItems?k.insertItemBefore(o,0):k.appendItem(o)}}else if(h==3&&G){B=Y(k).matrix;H=c.createSVGTransform();H.setRotate(G,o.x,o.y);H=H.matrix;o=c.createSVGTransform();o.setRotate(G,u.x,u.y);u=o.matrix.inverse();fa=B.inverse();u=ha(fa,u,H,B);Za(e,D,u);if(G)k.numberOfItems?k.insertItemBefore(o,0):k.appendItem(o)}}k.numberOfItems==0&&e.removeAttribute("transform");l.addSubCommand(new Ma(e,w));return l},mb=null,xa=this.clearSelection=
function(e){if(J[0]!=null)for(var k=J.length,l=0;l<k;++l){var B=J[l];if(B==null)break;ra.releaseSelector(B);J[l]=null}e||K("selected",J)},qb=this.addToSelection=function(e,k){if(e.length!=0){for(var l=0;l<J.length;){if(J[l]==null)break;++l}for(var B=e.length;B--;){var z=e[B];if(z&&svgedit.utilities.getBBox(z)){if(z.tagName==="a"&&z.childNodes.length===1)z=z.firstChild;if(J.indexOf(z)==-1){J[l]=z;l++;z=ra.requestSelector(z);J.length>1&&z.showGrips(false)}}}K("selected",J);k||J.length==1?ra.requestSelector(J[0]).showGrips(true):
ra.requestSelector(J[0]).showGrips(false);for(J.sort(function(G,D){if(G&&D&&G.compareDocumentPosition)return 3-(D.compareDocumentPosition(G)&6);else if(G==null)return 1});J[0]==null;)J.shift(0)}},rb=this.selectOnly=function(e,k){xa(true);qb(e,k)};this.removeFromSelection=function(e){if(J[0]!=null)if(e.length!=0){var k=Array(J.length);j=0;len=J.length;for(var l=0;l<len;++l){var B=J[l];if(B)if(e.indexOf(B)==-1){k[j]=B;j++}else ra.releaseSelector(B)}J=k}};this.selectAllInCurrentLayer=function(){var e=
C().getCurrentLayer();if(e){Ha="select";rb($(M||e).children())}};var Bb=this.getMouseTarget=function(e){if(e==null||e.target==null)return null;e=e.target;if(e.correspondingUseElement)e=e.correspondingUseElement;if(["http://www.w3.org/1998/Math/MathML","http://www.w3.org/1999/xhtml"].indexOf(e.namespaceURI)>=0&&e.id!="svgcanvas")for(;e.nodeName!="foreignObject";){e=e.parentNode;if(!e)return c}var k=C().getCurrentLayer();if([c,a,n,k].indexOf(e)>=0)return c;if($(e).closest("#selectorParentGroup").length)return ra.selectorParentGroup;
for(;e.parentNode&&e.parentNode!==(M||k);)e=e.parentNode;return e};(function(){var e=null,k=null,l=null,B=null,z=null,G={},D={minx:null,miny:null,maxx:null,maxy:null};$(a).mousedown(function(w){if(!d.spaceKey){var F=w.button===2;mb=n.getScreenCTM().inverse();isBotchedZoom=svgedit.browser.isGecko();var h=O(w.pageX,w.pageY,mb),m=h.x*(isBotchedZoom?1:q);h=h.y*(isBotchedZoom?1:q);w.preventDefault();if(F)Ha="select";m=m/q;h=h/q;var o=Bb(w);if(o.tagName==="a"&&o.childNodes.length===1)o=o.firstChild;var u=
B=k=m,E=z=l=h;if(p.gridSnapping){m=va(m);h=va(h);k=va(k);l=va(l)}if(o==ra.selectorParentGroup&&J[0]!=null){o=w.target;var H=cb(o,"type");if(H=="rotate"){Ha="rotate";current_rotate_mode=cb(o,"dir")}else if(H=="resize"){Ha="resize";db=cb(o,"dir")}o=J[0]}Sa=o.getAttribute("transform");H=X(o);switch(Ha){case "select":Ka=true;db="none";if(F)Ka=false;if(o!=c){if(J.indexOf(o)==-1){w.shiftKey||xa(true);qb([o]);wb=o;La.clear()}if(!F)for(F=0;F<J.length;++F)if(J[F]!=null){var I=X(J[F]);I.numberOfItems?I.insertItemBefore(c.createSVGTransform(),
0):I.appendItem(c.createSVGTransform())}}else if(!F){xa();Ha="multiselect";if(sa==null)sa=ra.getRubberBandBox();B*=q;z*=q;la(sa,{x:B,y:z,width:0,height:0,display:"inline"},100)}break;case "zoom":Ka=true;if(sa==null)sa=ra.getRubberBandBox();la(sa,{x:u*q,y:u*q,width:0,height:0,display:"inline"},100);break;case "resize":Ka=true;k=m;l=h;G=svgedit.utilities.getBBox($("#selectedBox0")[0]);var N={};$.each(G,function(U,ba){N[U]=ba/q});G=N;F=na(o)?1:0;if(pa(H)){H.insertItemBefore(c.createSVGTransform(),F);
H.insertItemBefore(c.createSVGTransform(),F);H.insertItemBefore(c.createSVGTransform(),F)}else{H.appendItem(c.createSVGTransform());H.appendItem(c.createSVGTransform());H.appendItem(c.createSVGTransform());if(svgedit.browser.supportsNonScalingStroke()){if(m=svgedit.browser.isWebkit())I=function(U){var ba=U.getAttributeNS(null,"stroke");U.removeAttributeNS(null,"stroke");setTimeout(function(){U.setAttributeNS(null,"stroke",ba)},0)};o.style.vectorEffect="non-scaling-stroke";m&&I(o);h=o.getElementsByTagName("*");
u=h.length;for(F=0;F<u;F++){h[F].style.vectorEffect="non-scaling-stroke";m&&I(h[F])}}}break;case "fhellipse":case "fhrect":case "fhpath":Ka=true;e=u+","+E+" ";I=L.stroke_width==0?1:L.stroke_width;Z({element:"polyline",curStyles:true,attr:{points:e,id:ja(),fill:"none",opacity:L.opacity/2,"stroke-linecap":"round",style:"pointer-events:none"}});D.minx=u;D.maxx=u;D.miny=E;D.maxy=E;break;case "image":Ka=true;I=Z({element:"image",attr:{x:m,y:h,width:0,height:0,id:ja(),opacity:L.opacity/2,style:"pointer-events:inherit"}});
S(I,Ga);Fb(I);break;case "square":case "rect":Ka=true;k=m;l=h;Z({element:"rect",curStyles:true,attr:{x:m,y:h,width:0,height:0,id:ja(),opacity:L.opacity/2}});break;case "line":Ka=true;I=L.stroke_width==0?1:L.stroke_width;Z({element:"line",curStyles:true,attr:{x1:m,y1:h,x2:m,y2:h,id:ja(),stroke:L.stroke,"stroke-width":I,"stroke-dasharray":L.stroke_dasharray,"stroke-linejoin":L.stroke_linejoin,"stroke-linecap":L.stroke_linecap,"stroke-opacity":L.stroke_opacity,fill:"none",opacity:L.opacity/2,style:"pointer-events:none"}});
break;case "circle":Ka=true;Z({element:"circle",curStyles:true,attr:{cx:m,cy:h,r:0,id:ja(),opacity:L.opacity/2}});break;case "ellipse":Ka=true;Z({element:"ellipse",curStyles:true,attr:{cx:m,cy:h,rx:0,ry:0,id:ja(),opacity:L.opacity/2}});break;case "text":Ka=true;Z({element:"text",curStyles:true,attr:{x:m,y:h,id:ja(),fill:Ua.fill,"stroke-width":Ua.stroke_width,"font-size":Ua.font_size,"font-family":Ua.font_family,"text-anchor":"left","xml:space":"preserve",opacity:L.opacity}});break;case "path":case "pathedit":k*=
q;l*=q;La.mouseDown(w,o,k,l);Ka=true;break;case "textedit":k*=q;l*=q;bb.mouseDown(w,o,k,l);Ka=true;break;case "rotate":Ka=true;d.undoMgr.beginUndoableChange("transform",J);document.getElementById("workarea").className="rotate"}I=ib("mouseDown",{event:w,start_x:k,start_y:l,selectedElements:J},true);$.each(I,function(U,ba){if(ba&&ba.started)Ka=true});if(Ha)document.getElementById("workarea").className=Ha=="resize"?w.target.style.cursor:Ha}}).mousemove(function(w){if(!(w.originalEvent.touches&&w.originalEvent.touches.length>
1))if(Ka)if(!(w.button===1||d.spaceKey)){var F=J[0],h=O(w.pageX,w.pageY,mb),m=h.x*(isBotchedZoom?1:q);h=h.y*(isBotchedZoom?1:q);var o=oa(aa()),u=x=m/q,E=y=h/q;if(p.gridSnapping){x=va(x);y=va(y)}w.preventDefault();switch(Ha){case "select":if(J[0]!==null){u=x-k;var H=y-l;if(p.gridSnapping){u=va(u);H=va(H)}if(w.shiftKey){var I=W(k,l,x,y);x=I.x;y=I.y}if(u!=0||H!=0){E=J.length;for(var N=0;N<E;++N){F=J[N];if(F==null)break;var U=c.createSVGTransform();o=X(F);if(I){u=I.x-k;H=I.y-l}U.setTranslate(u,H);o.numberOfItems?
o.replaceItem(U,0):o.appendItem(U);ra.requestSelector(F).resize()}if(w.altKey)if(!d.addClones){d.addClones=d.cloneSelectedElements(0,0,U);d.removeClones=function(){d.addClones&&d.addClones.forEach(function(ua){ua.parentNode&&ua.parentNode.removeChild(ua);d.addClones=false})};window.addEventListener("keyup",d.removeClones)}K("transition",J)}}break;case "multiselect":u*=q;E*=q;la(sa,{x:Math.min(B,u),y:Math.min(z,E),width:Math.abs(u-B),height:Math.abs(E-z)},100);o=[];u=[];I=ob();E=J.length;for(N=0;N<
E;++N){H=I.indexOf(J[N]);if(H==-1)o.push(J[N]);else I[H]=null}E=I.length;for(N=0;N<E;++N)I[N]&&u.push(I[N]);o.length>0&&d.removeFromSelection(o);u.length>0&&qb(u);break;case "resize":o=X(F);u=(I=pa(o))?G:svgedit.utilities.getBBox(F);E=u.x;N=u.y;var ba=u.width,R=u.height;u=x-k;H=y-l;if(p.gridSnapping){u=va(u);H=va(H);R=va(R);ba=va(ba)}if(U=na(F)){var fa=Math.sqrt(u*u+H*H);H=Math.atan2(H,u)-U*Math.PI/180;u=fa*Math.cos(H);H=fa*Math.sin(H)}if(db.indexOf("n")==-1&&db.indexOf("s")==-1)H=0;if(db.indexOf("e")==
-1&&db.indexOf("w")==-1)u=0;var ga=fa=0,T=R?(R+H)/R:1,qa=ba?(ba+u)/ba:1;if(db.indexOf("n")>=0){T=R?(R-H)/R:1;ga=R}if(db.indexOf("w")>=0){qa=ba?(ba-u)/ba:1;fa=ba}u=c.createSVGTransform();H=c.createSVGTransform();ba=c.createSVGTransform();if(p.gridSnapping){E=va(E);fa=va(fa);N=va(N);ga=va(ga)}u.setTranslate(-(E+fa),-(N+ga));if(w.shiftKey)if(qa==1)qa=T;else T=qa;H.setScale(qa,T);ba.setTranslate(E+fa,N+ga);if(I){I=U?1:0;o.replaceItem(u,2+I);o.replaceItem(H,1+I);o.replaceItem(ba,0+I)}else{I=o.numberOfItems;
o.replaceItem(ba,I-3);o.replaceItem(H,I-2);o.replaceItem(u,I-1)}ra.requestSelector(F).resize();K("transition",J);break;case "zoom":u*=q;E*=q;la(sa,{x:Math.min(B*q,u),y:Math.min(z*q,E),width:Math.abs(u-B*q),height:Math.abs(E-z*q)},100);break;case "text":la(o,{x:x,y:y},1E3);break;case "line":u=null;window.opera||c.suspendRedraw(1E3);if(p.gridSnapping){x=va(x);y=va(y)}E=x;I=y;if(w.shiftKey){I=W(k,l,E,I);E=I.x;I=I.y}o.setAttributeNS(null,"x2",E);o.setAttributeNS(null,"y2",I);window.opera||c.unsuspendRedraw(u);
break;case "foreignObject":case "square":case "rect":case "image":u=Math.abs(x-k);I=Math.abs(y-l);if(Ha=="square"||w.shiftKey){u=I=Math.max(u,I);E=k<x?k:k-u;N=l<y?l:l-I}else{E=Math.min(k,x);N=Math.min(l,y)}if(w.altKey){u*=2;I*=2;E=k-u/2;N=l-I/2}if(p.gridSnapping){u=va(u);I=va(I);E=va(E);N=va(N)}la(o,{width:u,height:I,x:E,y:N},1E3);break;case "circle":u=$(o).attr(["cx","cy"]);I=u.cx;E=u.cy;u=Math.sqrt((x-I)*(x-I)+(y-E)*(y-E));if(p.gridSnapping)u=va(u);o.setAttributeNS(null,"r",u);break;case "ellipse":u=
$(o).attr(["cx","cy"]);I=Math.abs(k+(x-k)/2);E=Math.abs(l+(y-l)/2);u=null;window.opera||c.suspendRedraw(1E3);if(p.gridSnapping){x=va(x);I=va(I);y=va(y);E=va(E)}N=Math.abs(k-I);H=Math.abs(l-E);if(w.shiftKey){H=N;E=y>l?l+N:l-N}if(w.altKey){I=k;E=l;N=Math.abs(x-I);H=w.shiftKey?N:Math.abs(y-E)}o.setAttributeNS(null,"rx",N);o.setAttributeNS(null,"ry",H);o.setAttributeNS(null,"cx",I);o.setAttributeNS(null,"cy",E);window.opera||c.unsuspendRedraw(u);break;case "fhellipse":case "fhrect":D.minx=Math.min(u,
D.minx);D.maxx=Math.max(u,D.maxx);D.miny=Math.min(E,D.miny);D.maxy=Math.max(E,D.maxy);case "fhpath":e+=+u+","+E+" ";o.setAttributeNS(null,"points",e);break;case "path":case "pathedit":x*=q;y*=q;if(p.gridSnapping){x=va(x);y=va(y);k=va(k);l=va(l)}if(w.shiftKey){if(I=svgedit.path.path){o=I.dragging?I.dragging[0]:k;I=I.dragging?I.dragging[1]:l}else{o=k;I=l}I=W(o,I,x,y);x=I.x;y=I.y}if(sa&&sa.getAttribute("display")!=="none"){u*=q;E*=q;la(sa,{x:Math.min(B*q,u),y:Math.min(z*q,E),width:Math.abs(u-B*q),height:Math.abs(E-
z*q)},100)}La.mouseMove(w,x,y);break;case "textedit":x*=q;y*=q;bb.mouseMove(m,h);break;case "rotate":u=svgedit.utilities.getBBox(F);I=u.x+u.width/2;E=u.y+u.height/2;o=ea(F);o=O(I,E,o);I=o.x;E=o.y;o=u.x;N=u.y;if(current_rotate_mode=="nw")o=u.x+u.width;if(current_rotate_mode=="se")N=u.y+u.height;if(current_rotate_mode=="sw"){o=u.x+u.width;N=u.y+u.height}compensation_angle=(Math.atan2(E-N,I-o)*(180/Math.PI)-90)%360;U=(Math.atan2(E-y,I-x)*(180/Math.PI)-90)%360;U+=compensation_angle;if(p.gridSnapping)U=
va(U);if(w.shiftKey)U=Math.round(U/45)*45;d.setRotationAngle(U<-180?360+U:U,true);K("transition",J)}ib("mouseMove",{event:w,mouse_x:m,mouse_y:h,selected:F})}}).click(function(w){w.preventDefault();return false}).dblclick(function(w){var F=w.target.parentNode,h=Bb(w),m=h.tagName;if(F!==M){if(m==="text"&&Ha!=="textedit"){w=O(w.pageX,w.pageY,mb);bb.select(h,w.x,w.y)}if((m==="g"||m==="a")&&na(h)){Db(h);h=J[0];xa(true)}M&&Eb();F.tagName!=="g"&&F.tagName!=="a"||F===C().getCurrentLayer()||h===ra.selectorParentGroup||
Kb(h)}}).mouseup(function(w){d.addClones=false;window.removeEventListener("keyup",d.removeClones);J=J.filter(Boolean);if(w.button!==2){var F=wb;wb=null;if(Ka){var h=O(w.pageX,w.pageY,mb),m=h.x*q;h=h.y*q;var o=m/q,u=h/q,E=oa(aa()),H=false;Ka=false;switch(Ha){case "resize":case "multiselect":if(sa!=null){sa.setAttribute("display","none");hb=[]}Ha="select";case "select":if(J[0]!=null){if(J.length==1){m=J[0];switch(m.tagName){case "g":case "use":case "image":case "foreignObject":break;default:Xa.fill=
m.getAttribute("fill");Xa.fill_opacity=m.getAttribute("fill-opacity");Xa.stroke=m.getAttribute("stroke");Xa.stroke_opacity=m.getAttribute("stroke-opacity");Xa.stroke_width=m.getAttribute("stroke-width");Xa.stroke_dasharray=m.getAttribute("stroke-dasharray");Xa.stroke_linejoin=m.getAttribute("stroke-linejoin");Xa.stroke_linecap=m.getAttribute("stroke-linecap")}if(m.tagName=="text"){Ua.font_size=m.getAttribute("font-size");Ua.font_family=m.getAttribute("font-family")}ra.requestSelector(m).showGrips(true)}Da();
B=(m=svgedit.browser.isGecko())?B*q:B;z=m?z*q:z;m=Math.abs(u-z);if(m>1||m>1){w=J.length;for(m=0;m<w;++m){if(J[m]==null)break;J[m].firstChild||ra.requestSelector(J[m]).resize()}}else{m=w.target;if(J[0].nodeName==="path"&&J[1]==null)La.select(J[0]);else w.shiftKey&&F!=m&&d.removeFromSelection([m])}if(svgedit.browser.supportsNonScalingStroke())if(w=J[0]){w.removeAttribute("style");svgedit.utilities.walkTree(w,function(U){U.removeAttribute("style")})}}return;case "zoom":sa!=null&&sa.setAttribute("display",
"none");K("zoomed",{x:Math.min(B,o),y:Math.min(z,u),width:Math.abs(o-B),height:Math.abs(u-z),factor:w.altKey?0.5:2});return;case "fhpath":F=E.getAttribute("points");u=F.indexOf(",");if(H=u>=0?F.indexOf(",",u+1)>=0:F.indexOf(" ",F.indexOf(" ")+1)>=0)E=La.smoothPolylineIntoPath(E);break;case "line":F=$(E).attr(["x1","x2","y1","y2"]);H=F.x1!=F.x2||F.y1!=F.y2;break;case "foreignObject":case "square":case "rect":case "image":F=$(E).attr(["width","height"]);H=F.width!=0||F.height!=0||Ha==="image";break;
case "circle":H=E.getAttribute("r")!=0;break;case "ellipse":F=$(E).attr(["rx","ry"]);H=F.rx!=null||F.ry!=null;break;case "fhellipse":if(D.maxx-D.minx>0&&D.maxy-D.miny>0){E=Z({element:"ellipse",curStyles:true,attr:{cx:(D.minx+D.maxx)/2,cy:(D.miny+D.maxy)/2,rx:(D.maxx-D.minx)/2,ry:(D.maxy-D.miny)/2,id:aa()}});K("changed",[E]);H=true}break;case "fhrect":if(D.maxx-D.minx>0&&D.maxy-D.miny>0){E=Z({element:"rect",curStyles:true,attr:{x:D.minx,y:D.miny,width:D.maxx-D.minx,height:D.maxy-D.miny,id:aa()}});
K("changed",[E]);H=true}break;case "text":H=true;rb([E]);bb.start(E);break;case "path":E=null;Ka=true;F=La.mouseUp(w,E,m,h);E=F.element;H=F.keep;break;case "pathedit":H=true;E=null;La.mouseUp(w);break;case "textedit":H=false;E=null;bb.mouseUp(w,m,h);break;case "rotate":H=true;E=null;Ha="select";F=d.undoMgr.finishUndoableChange();F.isEmpty()||wa(F);Da();K("changed",J)}m=ib("mouseUp",{event:w,mouse_x:m,mouse_y:h},true);$.each(m,function(U,ba){if(ba){H=ba.keep||H;E=ba.element;Ka=ba.started||Ka}});if(!H&&
E!=null){C().releaseId(aa());E.parentNode.removeChild(E);E=null;for(m=w.target;m.parentNode.parentNode.tagName=="g";)m=m.parentNode;if((Ha!="path"||!drawn_path)&&m.parentNode.id!="selectorParentGroup"&&m.id!="svgcanvas"&&m.id!="svgroot"){d.setMode("select");rb([m],true)}}else if(E!=null){d.addedNew=true;w=0.2;var I;if(false.beginElement&&E.getAttribute("opacity")!=L.opacity){I=$(false).clone().attr({to:L.opacity,dur:w}).appendTo(E);try{I[0].beginElement()}catch(N){}}else w=0;setTimeout(function(){I&&
I.remove();E.setAttribute("opacity",L.opacity);E.setAttribute("style","pointer-events:inherit");ka(E);if(Ha==="path")La.toEditMode(E);else p.selectNew&&rb([E],true);wa(new Ia(E));K("changed",[E])},w*1E3)}Sa=null}}});$(a).bind("mousewheel DOMMouseScroll",function(w){if(w.shiftKey){w.preventDefault();mb=n.getScreenCTM().inverse();var F=O(w.pageX,w.pageY,mb);F={x:F.x,y:F.y,width:0,height:0};if(w.wheelDelta)if(w.wheelDelta>=120)F.factor=2;else{if(w.wheelDelta<=-120)F.factor=0.5}else if(w.detail)if(w.detail>
0)F.factor=0.5;else if(w.detail<0)F.factor=2;F.factor&&K("zoomed",F)}})})();var Fb=function(e){$(e).click(function(k){k.preventDefault()})},bb=d.textActions=function(){function e(R){var fa=h.value==="";$(h).focus();if(!arguments.length)if(fa)R=0;else{if(h.selectionEnd!==h.selectionStart)return;R=h.selectionEnd}var ga;ga=E[R];fa||h.setSelectionRange(R,R);m=oa("text_cursor");if(!m){m=document.createElementNS(b,"line");la(m,{id:"text_cursor",stroke:"#333","stroke-width":1});m=oa("selectorParentGroup").appendChild(m)}u||
(u=setInterval(function(){var T=m.getAttribute("display")==="none";m.setAttribute("display",T?"inline":"none")},600));fa=G(ga.x,H.y);ga=G(ga.x,H.y+H.height);la(m,{x1:fa.x,y1:fa.y,x2:ga.x,y2:ga.y,visibility:"visible",display:"inline"});o&&o.setAttribute("d","M 0 0")}function k(R,fa,ga){if(R===fa)e(fa);else{ga||h.setSelectionRange(R,fa);o=oa("text_selectblock");if(!o){o=document.createElementNS(b,"path");la(o,{id:"text_selectblock",fill:"green",opacity:0.5,style:"pointer-events:none"});oa("selectorParentGroup").appendChild(o)}R=
E[R];var T=E[fa];m.setAttribute("visibility","hidden");fa=G(R.x,H.y);ga=G(R.x+(T.x-R.x),H.y);var qa=G(R.x,H.y+H.height);R=G(R.x+(T.x-R.x),H.y+H.height);la(o,{d:"M"+fa.x+","+fa.y+" L"+ga.x+","+ga.y+" "+R.x+","+R.y+" "+qa.x+","+qa.y+"z",display:"inline"})}}function l(R,fa){var ga=c.createSVGPoint();ga.x=R;ga.y=fa;if(E.length==1)return 0;ga=F.getCharNumAtPosition(ga);if(ga<0){ga=E.length-2;if(R<=E[0].x)ga=0}else if(ga>=E.length-2)ga=E.length-2;var T=E[ga];R>T.x+T.width/2&&ga++;return ga}function B(R,
fa,ga){var T=h.selectionStart;R=l(R,fa);k(Math.min(T,R),Math.max(T,R),!ga)}function z(R,fa){var ga={x:R,y:fa};ga.x/=q;ga.y/=q;if(I){var T=O(ga.x,ga.y,I.inverse());ga.x=T.x;ga.y=T.y}return ga}function G(R,fa){var ga={x:R,y:fa};if(I){var T=O(ga.x,ga.y,I);ga.x=T.x;ga.y=T.y}ga.x*=q;ga.y*=q;return ga}function D(R){k(0,F.textContent.length);$(this).unbind(R)}function w(R){if(ba&&F){var fa=O(R.pageX,R.pageY,mb);fa=z(fa.x*q,fa.y*q);fa=l(fa.x,fa.y);var ga=F.textContent,T=ga.substr(0,fa).replace(/[a-z0-9]+$/i,
"").length;ga=ga.substr(fa).match(/^[a-z0-9]+/i);k(T,(ga?ga[0].length:0)+fa);$(R.target).click(D);setTimeout(function(){$(R.target).unbind("click",D)},300)}}var F,h,m,o,u,E=[],H,I,N,U,ba;return{select:function(R,fa,ga){F=R;bb.toEditMode(fa,ga)},start:function(R){F=R;bb.toEditMode()},mouseDown:function(R,fa,ga,T){R=z(ga,T);h.focus();e(l(R.x,R.y));N=ga;U=T},mouseMove:function(R,fa){var ga=z(R,fa);B(ga.x,ga.y)},mouseUp:function(R,fa,ga){var T=z(fa,ga);B(T.x,T.y,true);R.target!==F&&fa<N+2&&fa>N-2&&ga<
U+2&&ga>U-2&&bb.toSelectMode(true)},setCursor:e,toEditMode:function(R,fa){rb([F],false);ba=false;Ha="textedit";ra.requestSelector(F).showGrips(false);ra.requestSelector(F);bb.init();$(F).css("cursor","text");if(arguments.length){var ga=z(R,fa);e(l(ga.x,ga.y))}else e();setTimeout(function(){ba=true},300)},toSelectMode:function(R){Ha="select";clearInterval(u);u=null;o&&$(o).attr("display","none");m&&$(m).attr("visibility","hidden");$(F).css("cursor","move");if(R){xa();$(F).css("cursor","move");K("selected",
[F]);qb([F],true)}F&&!F.textContent.length&&d.deleteSelectedElements();$(h).blur();F=false},setInputElem:function(R){h=R},clear:function(){Ha=="textedit"&&bb.toSelectMode()},init:function(){if(F){if(!F.parentNode){F=J[0];ra.requestSelector(F).showGrips(false)}var R=F.textContent.length,fa=F.getAttribute("transform");H=svgedit.utilities.getBBox(F);I=fa?ea(F):null;E=Array(R);h.focus();$(F).unbind("dblclick",w).dblclick(w);if(!R)var ga={x:H.x+H.width/2,width:0};for(fa=0;fa<R;fa++){var T=F.getStartPositionOfChar(fa);
ga=F.getEndPositionOfChar(fa);if(!svgedit.browser.supportsGoodTextCharPos()){var qa=d.contentW*q;T.x-=qa;ga.x-=qa;T.x/=q;ga.x/=q}E[fa]={x:T.x,y:H.y,width:ga.x-T.x,height:H.height}}E.push({x:ga.x,width:0});k(h.selectionStart,h.selectionEnd,true)}}}}(),La=d.pathActions=function(){var e=false,k,l,B;svgedit.path.Path.prototype.endChanges=function(D){if(svgedit.browser.isWebkit()){var w=this.elem;w.setAttribute("d",La.convertPath(w))}D=new Ma(this.elem,{d:this.last_d},D);wa(D);K("changed",[this.elem])};
svgedit.path.Path.prototype.addPtsToSelection=function(D){$.isArray(D)||(D=[D]);for(var w=0;w<D.length;w++){var F=D[w],h=this.segs[F];h.ptgrip&&this.selected_pts.indexOf(F)==-1&&F>=0&&this.selected_pts.push(F)}this.selected_pts.sort();w=this.selected_pts.length;for(D=Array(w);w--;){h=this.segs[this.selected_pts[w]];h.select(true);D[w]=h.ptgrip}La.canDeleteNodes=true;La.closed_subpath=this.subpathIsClosed(this.selected_pts[0]);K("selected",D)};var z=k=null,G=false;this.lastCtrlPoint=[0,0];return{mouseDown:function(D,
w,F,h){if(Ha==="path"){mouse_x=F;mouse_y=h;F=mouse_x/q;w=mouse_y/q;h=oa("path_stretch_line");l=[F,w];if(p.gridSnapping){F=va(F);w=va(w);mouse_x=va(mouse_x);mouse_y=va(mouse_y)}if(!h){h=document.createElementNS(b,"path");la(h,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"});h=oa("selectorParentGroup").appendChild(h)}h.setAttribute("display","inline");this.stretchy=h;var m=null;if(z){m=z.pathSegList;for(var o=m.numberOfItems,u=6/q,E=false;o;){o--;var H=m.getItem(o),I=H.x;H=H.y;
if(F>=I-u&&F<=I+u&&w>=H-u&&w<=H+u){E=true;break}}u=aa();svgedit.path.removePath_(u);u=oa(u);I=m.numberOfItems;if(E){if(o<=1&&I>=2){F=m.getItem(0).x;w=m.getItem(0).y;o=svgedit.path.first_grip?svgedit.path.first_grip[0]/q:m.getItem(0).x;E=svgedit.path.first_grip?svgedit.path.first_grip[1]/q:m.getItem(0).y;D=h.pathSegList.getItem(1);D=D.pathSegType===4?z.createSVGPathSegLinetoAbs(F,w):z.createSVGPathSegCurvetoCubicAbs(F,w,D.x1/q,D.y1/q,o,E);F=z.createSVGPathSegClosePath();m.appendItem(D);m.appendItem(F)}else if(I<
3)return m=false;$(h).remove();element=u;z=null;Ka=false;if(e){svgedit.path.path.matrix&&Za(u,{},svgedit.path.path.matrix.inverse());F=u.getAttribute("d");h=$(svgedit.path.path.elem).attr("d");$(svgedit.path.path.elem).attr("d",h+F);$(u).remove();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();svgedit.path.path.init();La.toEditMode(svgedit.path.path.elem);svgedit.path.path.selectPt();return false}}else{if(!$.contains(a,Bb(D))){console.log("Clicked outside canvas");return false}m=z.pathSegList.numberOfItems;
o=z.pathSegList.getItem(m-1);u=o.x;o=o.y;if(D.shiftKey){w=W(u,o,F,w);F=w.x;w=w.y}D=h.pathSegList.getItem(1);D=D.pathSegType===4?z.createSVGPathSegLinetoAbs(ab(F),ab(w)):z.createSVGPathSegCurvetoCubicAbs(ab(F),ab(w),D.x1/q,D.y1/q,D.x2/q,D.y2/q);z.pathSegList.appendItem(D);F*=q;w*=q;h.setAttribute("d",["M",F,w,F,w].join(" "));h=svgedit.path.addCtrlGrip("1c1");D=svgedit.path.addCtrlGrip("0c2");u=svgedit.path.getCtrlLine(1);o=svgedit.path.getCtrlLine(2);h.setAttribute("cx",F);h.setAttribute("cy",w);D.setAttribute("cx",
F);D.setAttribute("cy",w);u.setAttribute("x1",F);u.setAttribute("x2",F);u.setAttribute("y1",w);u.setAttribute("y2",w);o.setAttribute("x1",F);o.setAttribute("x2",F);o.setAttribute("y1",w);o.setAttribute("y2",w);h=m;if(e)h+=svgedit.path.path.segs.length;svgedit.path.addPointGrip(h,F,w)}m=true}else{d_attr="M"+F+","+w+" ";z=Z({element:"path",curStyles:true,attr:{d:d_attr,id:ja(),opacity:L.opacity/2}});h.setAttribute("d",["M",mouse_x,mouse_y,mouse_x,mouse_y].join(" "));h=e?svgedit.path.path.segs.length:
0;svgedit.path.addPointGrip(h,mouse_x,mouse_y);svgedit.path.first_grip=null}}else if(svgedit.path.path){svgedit.path.path.storeD();u=D.target.id;if(u.substr(0,14)=="pathpointgrip_"){w=svgedit.path.path.cur_pt=parseInt(u.substr(14));svgedit.path.path.dragging=[F,h];u=svgedit.path.path.segs[w];if(D.shiftKey)u.selected?svgedit.path.path.removePtFromSelection(w):svgedit.path.path.addPtsToSelection(w);else{if(svgedit.path.path.selected_pts.length<=1||!u.selected)svgedit.path.path.clearSelection();svgedit.path.path.addPtsToSelection(w)}}else if(u.indexOf("ctrlpointgrip_")==
0){svgedit.path.path.dragging=[F,h];D=u.split("_")[1].split("c");w=D[0]-0;m=D=D[1]-0;o=svgedit.path.path.segs[w];svgedit.path.path.selectPt(w,D);if(m==2){E=1;u=o.next}else{E=2;u=o.prev}if(!u)return;D=function(N,U){return Math.sqrt(Math.pow(N.x-U.x,2)+Math.pow(N.y-U.y,2))};w={x:o.item["x"+m],y:o.item["y"+m]};m=m==2?{x:o.item.x,y:o.item.y}:{x:u.item.x,y:u.item.y};o={x:u.item["x"+E],y:u.item["y"+E]};u=D(w,m);D=D(o,m);w=Math.abs(Math.round(Math.atan2(w.y-m.y,w.x-m.x)*(180/Math.PI),0)-Math.round(Math.atan2(o.y-
m.y,o.x-m.x)*(180/Math.PI),0))==180;if(Math.abs(u-D)<5&&w){svgedit.path.setLinkControlPoints(true);svgedit.path.is_linked=true}else{svgedit.path.setLinkControlPoints(false);svgedit.path.is_linked=false}}if(!svgedit.path.path.dragging){if(sa==null)sa=ra.getRubberBandBox();la(sa,{x:F*q,y:h*q,width:0,height:0,display:"inline"},100)}}},mouseMove:function(D,w,F){G=true;var h=!D.altKey;if(Ha==="path"){if(z){var m=z.pathSegList,o=m.numberOfItems-1,u=svgedit.path.addCtrlGrip("1c1"),E=svgedit.path.addCtrlGrip("0c2");
if(l){var H=E.getAttribute("cx")/q||0,I=E.getAttribute("cy")/q||0;u.setAttribute("cx",w);u.setAttribute("cy",F);u.setAttribute("display","inline");D=l[0];u=l[1];m.getItem(o);var N=w/q,U=F/q;H=h?D+(D-N):H;h=h?u+(u-U):I;E.setAttribute("cx",H*q);E.setAttribute("cy",h*q);E.setAttribute("display","inline");E=svgedit.path.getCtrlLine(1);I=svgedit.path.getCtrlLine(2);la(E,{x1:w,y1:F,x2:D*q,y2:u*q,display:"inline"});la(I,{x1:H*q,y1:h*q,x2:D*q,y2:u*q,display:"inline"});if(o===0)B=[w,F];else{m=m.getItem(o-
1);w=m.x;F=m.y;if(m.pathSegType===6){w+=w-m.x2;F+=F-m.y2}else if(B){w=B[0]/q;F=B[1]/q}svgedit.path.replacePathSeg(6,o,[D,u,this.lastCtrlPoint[0]/q,this.lastCtrlPoint[1]/q,H,h],z)}}else if(h=this.stretchy){o=m.getItem(o);m=w;u=F;if(D.target.id==="pathpointgrip_0"&&svgedit.path.first_grip){m=svgedit.path.first_grip[0];u=svgedit.path.first_grip[1]}if(o.pathSegType===6)svgedit.path.replacePathSeg(6,1,[w,F,(this.lastCtrlPoint[0]/q||o.x+(o.x-o.x2))*q,(this.lastCtrlPoint[1]/q||o.y+(o.y-o.y2))*q,m,u],h);
else B?svgedit.path.replacePathSeg(6,1,[w,F,B[0],B[1],w,F],h):svgedit.path.replacePathSeg(4,1,[w,F],h)}}}else if(svgedit.path.path.dragging){m=svgedit.path.getPointFromGrip({x:svgedit.path.path.dragging[0],y:svgedit.path.path.dragging[1]},svgedit.path.path);D=svgedit.path.getPointFromGrip({x:w,y:F},svgedit.path.path);o=D.x-m.x;m=D.y-m.y;svgedit.path.path.dragging=[w,F];!h||!svgedit.path.is_linked?svgedit.path.setLinkControlPoints(false):svgedit.path.setLinkControlPoints(true);svgedit.path.path.dragctrl?
svgedit.path.path.moveCtrl(o,m):svgedit.path.path.movePts(o,m)}else{svgedit.path.path.selected_pts=[];svgedit.path.path.eachSeg(function(){if(this.next||this.prev){var ba=sa.getBBox(),R=svgedit.path.getGripPt(this);ba=svgedit.math.rectsIntersect(ba,{x:R.x,y:R.y,width:0,height:0});this.select(ba);ba&&svgedit.path.path.selected_pts.push(this.index)}})}},mouseUp:function(D,w,F,h){var m=oa("ctrlpointgrip_1c1"),o=oa("ctrlpointgrip_0c2");this.lastCtrlPoint=m?[m.getAttribute("cx"),m.getAttribute("cy")]:
[F,h];if(!svgedit.path.first_grip&&o)svgedit.path.first_grip=[o.getAttribute("cx"),o.getAttribute("cy")];if(Ha==="path"){l=null;if(!z){w=oa(aa());Ka=false;B=null}return{keep:true,element:w}}if(svgedit.path.path.dragging){w=svgedit.path.path.cur_pt;svgedit.path.path.dragging=false;svgedit.path.path.dragctrl=false;svgedit.path.path.update();G&&svgedit.path.path.endChanges("Move path point(s)");!D.shiftKey&&!G&&svgedit.path.path.selectPt(w)}else if(sa&&sa.getAttribute("display")!="none"){sa.setAttribute("display",
"none");sa.getAttribute("width")<=2&&sa.getAttribute("height")<=2&&La.toSelectMode(D.target)}else La.toSelectMode(D.target);G=false},toEditMode:function(D){svgedit.path.path=svgedit.path.getPath_(D);Ha="pathedit";xa();svgedit.path.path.show(true).update();svgedit.path.path.oldbbox=svgedit.utilities.getBBox(svgedit.path.path.elem);e=false},toSelectMode:function(D){var w=D==svgedit.path.path.elem;Ha="select";svgedit.path.path.show(false);k=false;xa();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();
if(w){K("selected",[D]);qb([D],true)}},addSubPath:function(D){if(D){Ha="path";e=true}else{La.clear(true);La.toEditMode(svgedit.path.path.elem)}},select:function(D){if(k===D){La.toEditMode(D);Ha="pathedit"}else k=D},reorient:function(){var D=J[0];if(D)if(na(D)!=0){var w=new Ca("Reorient path"),F={d:D.getAttribute("d"),transform:D.getAttribute("transform")};w.addSubCommand(new Ma(D,F));xa();this.resetOrientation(D);wa(w);svgedit.path.getPath_(D).show(false).matrix=null;this.clear();qb([D],true);K("changed",
J)}},clear:function(D){k=null;if(z){var w=oa(aa());$(oa("path_stretch_line")).remove();D&&$(w).remove();$(oa("pathpointgrip_container")).find("*").attr("display","none");z=B=null;Ka=false}else Ha=="pathedit"&&this.toSelectMode();svgedit.path.path&&svgedit.path.path.init().show(false)},resetOrientation:function(D){if(D==null||D.nodeName!="path")return false;var w=X(D),F=Y(w).matrix;w.clear();D.removeAttribute("transform");w=D.pathSegList;for(var h=w.numberOfItems,m=0;m<h;++m){var o=w.getItem(m),u=
o.pathSegType;if(u!=1){var E=[];$.each(["",1,2],function(H,I){var N=o["x"+I],U=o["y"+I];if(N!==undefined&&U!==undefined){N=O(N,U,F);E.splice(E.length,0,N.x,N.y)}});svgedit.path.replacePathSeg(u,m,E,D)}}f(D,F)},zoomChange:function(){Ha=="pathedit"&&svgedit.path.path.update()},getNodePoint:function(){if(svgedit.path.path){var D=svgedit.path.path.segs[svgedit.path.path.selected_pts.length?svgedit.path.path.selected_pts[0]:1];return{x:D.item.x,y:D.item.y,type:D.type}}},linkControlPoints:function(D){svgedit.path.setLinkControlPoints(D)},
clonePathNode:function(){svgedit.path.path.storeD();for(var D=svgedit.path.path.selected_pts,w=D.length,F=[];w--;){var h=D[w];svgedit.path.path.addSeg(h);F.push(h+w);F.push(h+w+1)}svgedit.path.path.init().addPtsToSelection(F);svgedit.path.path.endChanges("Clone path node(s)")},opencloseSubPath:function(){var D=svgedit.path.path.selected_pts;if(D.length===1){var w=svgedit.path.path.elem,F=w.pathSegList,h=D[0],m=null,o=null;svgedit.path.path.eachSeg(function(I){if(this.type===2&&I<=h)o=this.item;if(I<=
h)return true;if(this.type===2){m=I;return false}else if(this.type===1)return m=false});if(m==null)m=svgedit.path.path.segs.length-1;if(m!==false){var u=w.createSVGPathSegLinetoAbs(o.x,o.y),E=w.createSVGPathSegClosePath();if(m==svgedit.path.path.segs.length){F.appendItem(u);F.appendItem(E)}else{svgedit.path.insertItemBefore(w,E,m);svgedit.path.insertItemBefore(w,u,m)}svgedit.path.path.init().selectPt(m+1)}else if(svgedit.path.path.segs[h].mate){F.removeItem(h);F.removeItem(h);svgedit.path.path.init().selectPt(h-
1)}else{for(D=0;D<F.numberOfItems;D++){var H=F.getItem(D);if(H.pathSegType===2)u=D;else if(D===h)F.removeItem(u);else if(H.pathSegType===1&&h<D){E=D-1;F.removeItem(D);break}}for(D=h-u-1;D--;)svgedit.path.insertItemBefore(w,F.getItem(u),E);w=F.getItem(u);svgedit.path.replacePathSeg(2,u,[w.x,w.y]);D=h;svgedit.path.path.init().selectPt(0)}}},deletePathNode:function(){if(La.canDeleteNodes){svgedit.path.path.storeD();for(var D=svgedit.path.path.selected_pts,w=D.length;w--;)svgedit.path.path.deleteSeg(D[w]);
var F=function(){var h=svgedit.path.path.elem.pathSegList,m=h.numberOfItems,o=function(H,I){for(;I--;)h.removeItem(H)};if(m<=1)return true;for(;m--;){var u=h.getItem(m);if(u.pathSegType===1){u=h.getItem(m-1);var E=h.getItem(m-2);if(u.pathSegType===2){o(m-1,2);F();break}else if(E.pathSegType===2){o(m-2,3);F();break}}else if(u.pathSegType===2)if(m>0){u=h.getItem(m-1).pathSegType;if(u===2){o(m-1,1);F();break}else if(u===1&&h.numberOfItems-1===m){o(m,1);F();break}}}return false};F();if(svgedit.path.path.elem.pathSegList.numberOfItems<=
1){d.setMode("select");d.deleteSelectedElements()}else{svgedit.path.path.init();svgedit.path.path.clearSelection();if(window.opera){D=$(svgedit.path.path.elem);D.attr("d",D.attr("d"))}svgedit.path.path.endChanges("Delete path node(s)")}}},smoothPolylineIntoPath:function(D){var w=D.points,F=w.numberOfItems;if(F>=4){var h=w.getItem(0),m=null;D=[];D.push(["M",h.x,",",h.y," C"].join(""));for(var o=1;o<=F-4;o+=3){var u=w.getItem(o),E=w.getItem(o+1),H=w.getItem(o+2);if(m)if((h=svgedit.path.smoothControlPoints(m,
u,h))&&h.length==2){u=D[D.length-1].split(",");u[2]=h[0].x;u[3]=h[0].y;D[D.length-1]=u.join(",");u=h[1]}D.push([u.x,u.y,E.x,E.y,H.x,H.y].join(","));h=H;m=E}for(D.push("L");o<F;++o){E=w.getItem(o);D.push([E.x,E.y].join(","))}D=D.join(" ");D=Z({element:"path",curStyles:true,attr:{id:aa(),d:D,fill:"none"}})}return D},setSegType:function(D){svgedit.path.path.setSegType(D)},moveNode:function(D,w){var F=svgedit.path.path.selected_pts;if(F.length){svgedit.path.path.storeD();F=svgedit.path.path.segs[F[0]];
var h={x:0,y:0};h[D]=w-F.item[D];F.move(h.x,h.y);svgedit.path.path.endChanges("Move path point")}},fixEnd:function(D){for(var w=D.pathSegList,F=w.numberOfItems,h,m=0;m<F;++m){var o=w.getItem(m);if(o.pathSegType===2)h=o;if(o.pathSegType===1){o=w.getItem(m-1);if(o.x!=h.x||o.y!=h.y){w=D.createSVGPathSegLinetoAbs(h.x,h.y);svgedit.path.insertItemBefore(D,w,m);La.fixEnd(D);break}}}svgedit.browser.isWebkit()&&D.setAttribute("d",La.convertPath(D))},convertPath:function(D,w){for(var F=D.pathSegList,h=F.numberOfItems,
m=0,o=0,u="",E=null,H=0;H<h;++H){var I=F.getItem(H),N=I.x||0,U=I.y||0,ba=I.x1||0,R=I.y1||0,fa=I.x2||0,ga=I.y2||0,T=I.pathSegType,qa=Oa[T]["to"+(w?"Lower":"Upper")+"Case"](),ua=function(Aa,Ba,Pa){Ba=Ba?" "+Ba.join(" "):"";Pa=Pa?" "+svgedit.units.shortFloat(Pa):"";$.each(Aa,function(Qa,Na){Aa[Qa]=svgedit.units.shortFloat(Na)});u+=qa+Aa.join(" ")+Ba+Pa};switch(T){case 1:u+="z";break;case 12:N-=m;case 13:if(w){m+=N;qa="l"}else{N+=m;m=N;qa="L"}ua([[N,o]]);break;case 14:U-=o;case 15:if(w){o+=U;qa="l"}else{U+=
o;o=U;qa="L"}ua([[m,U]]);break;case 2:case 4:case 18:N-=m;U-=o;case 5:case 3:if(E&&F.getItem(H-1).pathSegType===1&&!w){m=E[0];o=E[1]}case 19:if(w){m+=N;o+=U}else{N+=m;U+=o;m=N;o=U}if(T===3)E=[m,o];ua([[N,U]]);break;case 6:N-=m;ba-=m;fa-=m;U-=o;R-=o;ga-=o;case 7:if(w){m+=N;o+=U}else{N+=m;ba+=m;fa+=m;U+=o;R+=o;ga+=o;m=N;o=U}ua([[ba,R],[fa,ga],[N,U]]);break;case 8:N-=m;ba-=m;U-=o;R-=o;case 9:if(w){m+=N;o+=U}else{N+=m;ba+=m;U+=o;R+=o;m=N;o=U}ua([[ba,R],[N,U]]);break;case 10:N-=m;U-=o;case 11:if(w){m+=
N;o+=U}else{N+=m;U+=o;m=N;o=U}ua([[I.r1,I.r2]],[I.angle,I.largeArcFlag?1:0,I.sweepFlag?1:0],[N,U]);break;case 16:N-=m;fa-=m;U-=o;ga-=o;case 17:if(w){m+=N;o+=U}else{N+=m;fa+=m;U+=o;ga+=o;m=N;o=U}ua([[fa,ga],[N,U]])}}return u}}}(),yb=this.removeUnusedDefElems=function(){var e=n.getElementsByTagNameNS(b,"defs");if(!e||!e.length)return 0;for(var k=[],l=0,B=["fill","stroke","filter","marker-start","marker-mid","marker-end"],z=B.length,G=n.getElementsByTagNameNS(b,"*"),D=G.length,w=0;w<D;w++){for(var F=
G[w],h=0;h<z;h++)if(F){var m=ma(F.getAttribute(B[h]));m&&k.push(m.substr(1))}(F=da(F))&&F.indexOf("#")===0&&k.push(F.substr(1))}e=$(e).find("linearGradient, radialGradient, filter, marker, svg, symbol");defelem_ids=[];for(w=e.length;w--;){B=e[w];z=B.id;if(k.indexOf(z)<0){sb[z]=B;B.parentNode.removeChild(B);l++}}return l};this.svgCanvasToString=function(){for(;yb()>0;);La.clear(true);$.each(n.childNodes,function(l,B){l&&B.nodeType===8&&B.data.indexOf("Created with")>=0&&n.insertBefore(B,n.firstChild)});
if(M){Eb();rb([M])}$("#canvasGrid").attr("display","none");var e=[];$(n).find("g:data(gsvg)").each(function(){for(var l=this.attributes,B=l.length,z=0;z<B;z++)if(l[z].nodeName=="id"||l[z].nodeName=="style")B--;if(B<=0){l=this.firstChild;e.push(l);$(this).replaceWith(l)}});var k=this.svgToString(n,0);e.length&&$(e).each(function(){tb(this)});return k};this.svgToString=function(e,k){var l=[],B=svgedit.utilities.toXml,z=p.baseUnit,G=RegExp("^-?[\\d\\.]+"+z+"$");if(e){ka(e);var D=e.attributes,w,F,h=e.childNodes;
for(F=0;F<k;F++)l.push(" ");l.push("<");l.push(e.nodeName);if(e.id==="svgcontent"){F=zb();if(z!=="px"){F.w=svgedit.units.convertUnit(F.w,z)+z;F.h=svgedit.units.convertUnit(F.h,z)+z}l.push(' width="'+F.w+'" height="'+F.h+'" xmlns="'+b+'"');var m={};$(e).find("*").andSelf().each(function(){$.each(this.attributes,function(H,I){var N=I.namespaceURI;if(N&&!m[N]&&ya[N]!=="xmlns"&&ya[N]!=="xml"){m[N]=true;l.push(" xmlns:"+ya[N]+'="'+N+'"')}})});F=D.length;for(z=["width","height","xmlns","x","y","viewBox",
"id","overflow"];F--;){w=D.item(F);var o=B(w.nodeValue);if(w.nodeName.indexOf("xmlns:")!==0)if(o!=""&&z.indexOf(w.localName)==-1)if(!w.namespaceURI||ya[w.namespaceURI]){l.push(" ");l.push(w.nodeName);l.push('="');l.push(o);l.push('"')}}}else{if(e.nodeName==="defs"&&!e.firstChild)return;var u=["-moz-math-font-style","_moz-math-font-style"];for(F=D.length-1;F>=0;F--){w=D.item(F);o=B(w.nodeValue);if(!(u.indexOf(w.localName)>=0))if(o!="")if(o.indexOf("pointer-events")!==0)if(!(w.localName==="class"&&
o.indexOf("se_")===0)){l.push(" ");if(w.localName==="d")o=La.convertPath(e,true);if(isNaN(o)){if(G.test(o))o=svgedit.units.shortFloat(o)+z}else o=svgedit.units.shortFloat(o);if($a.apply&&e.nodeName==="image"&&w.localName==="href"&&$a.images&&$a.images==="embed"){var E=Va[o];if(E)o=E}if(!w.namespaceURI||w.namespaceURI==b||ya[w.namespaceURI]){l.push(w.nodeName);l.push('="');l.push(o);l.push('"')}}}}if(e.hasChildNodes()){l.push(">");k++;D=false;for(F=0;F<h.length;F++){z=h.item(F);switch(z.nodeType){case 1:l.push("\n");
l.push(this.svgToString(h.item(F),k));break;case 3:z=z.nodeValue.replace(/^\s+|\s+$/g,"");if(z!=""){D=true;l.push(B(z)+"")}break;case 4:l.push("\n");l.push(Array(k+1).join(" "));l.push("<![CDATA[");l.push(z.nodeValue);l.push("]]\>");break;case 8:l.push("\n");l.push(Array(k+1).join(" "));l.push("<!--");l.push(z.data);l.push("--\>")}}k--;if(!D){l.push("\n");for(F=0;F<k;F++)l.push(" ")}l.push("</");l.push(e.nodeName);l.push(">")}else l.push("/>")}return l.join("")};this.embedImage=function(e,k){$(new Image).load(function(){var l=
document.createElement("canvas");l.width=this.width;l.height=this.height;l.getContext("2d").drawImage(this,0,0);try{var B=";svgedit_url="+encodeURIComponent(e);B=l.toDataURL().replace(";base64",B+";base64");Va[e]=B}catch(z){Va[e]=false}Ga=e;k&&k(Va[e])}).attr("src",e)};this.setGoodImage=function(e){Ga=e};this.open=function(){};this.save=function(e){xa();e&&$.extend($a,e);$a.apply=true;e=this.svgCanvasToString();K("saved",e)};this.rasterExport=function(){xa();var e=[],k={feGaussianBlur:kb.exportNoBlur,
foreignObject:kb.exportNoforeignObject,"[stroke-dasharray]":kb.exportNoDashArray},l=$(n);if(!("font"in $("<canvas>")[0].getContext("2d")))k.text=kb.exportNoText;$.each(k,function(B,z){l.find(B).length&&e.push(z)});k=this.svgCanvasToString();K("exported",{svg:k,issues:e})};this.getSvgString=function(){$a.apply=false;return this.svgCanvasToString()};this.randomizeIds=function(){arguments.length>0&&arguments[0]==false?svgedit.draw.randomizeIds(false,C()):svgedit.draw.randomizeIds(true,C())};var Hb=this.uniquifyElems=
function(e){var k={},l=["filter","linearGradient","pattern","radialGradient","symbol","textPath","use"];svgedit.utilities.walkTree(e,function(w){if(w.nodeType==1){if(w.id){w.id in k||(k[w.id]={elem:null,attrs:[],hrefs:[]});k[w.id].elem=w}$.each(vb,function(h,m){var o=w.getAttributeNode(m);if(o){var u=svgedit.utilities.getUrlFromAttr(o.value);if(u=u?u.substr(1):null){u in k||(k[u]={elem:null,attrs:[],hrefs:[]});k[u].attrs.push(o)}}});var F=svgedit.utilities.getHref(w);if(F&&l.indexOf(w.nodeName)>=
0)if(F=F.substr(1)){F in k||(k[F]={elem:null,attrs:[],hrefs:[]});k[F].hrefs.push(w)}}});for(var B in k)if(B){var z=k[B].elem;if(z){e=ja();z.id=e;z=k[B].attrs;for(var G=z.length;G--;){var D=z[G];D.ownerElement.setAttribute(D.name,"url(#"+e+")")}z=k[B].hrefs;for(G=z.length;G--;)svgedit.utilities.setHref(z[G],"#"+e)}}},Gb=this.setUseData=function(e){var k=$(e);if(e.tagName!=="use")k=k.find("use");k.each(function(){var l=da(this).substr(1);if(l=oa(l)){$(this).data("ref",l);if(l.tagName=="symbol"||l.tagName==
"svg")$(this).data("symbol",l).data("ref",l)}})},Ib=this.convertGradients=function(e){var k=$(e).find("linearGradient, radialGradient");if(!k.length&&svgedit.browser.isWebkit())k=$(e).find("*").filter(function(){return this.tagName.indexOf("Gradient")>=0});k.each(function(){if($(this).attr("gradientUnits")==="userSpaceOnUse"){var l=$(n).find('[fill="url(#'+this.id+')"],[stroke="url(#'+this.id+')"]');if(l.length)if(l=svgedit.utilities.getBBox(l[0]))if(this.tagName==="linearGradient"){var B=$(this).attr(["x1",
"y1","x2","y2"]),z=this.gradientTransform.baseVal;if(z&&z.numberOfItems>0){var G=Y(z).matrix;z=O(B.x1,B.y1,G);G=O(B.x2,B.y2,G);B.x1=z.x;B.y1=z.y;B.x2=G.x;B.y2=G.y;this.removeAttribute("gradientTransform")}$(this).attr({x1:(B.x1-l.x)/l.width,y1:(B.y1-l.y)/l.height,x2:(B.x2-l.x)/l.width,y2:(B.y2-l.y)/l.height});this.removeAttribute("gradientUnits")}}})},Lb=this.convertToGroup=function(e){e||(e=J[0]);var k=$(e),l=new Ca,B;if(k.data("gsvg")){l=$(e.firstChild).attr(["x","y"]);$(e.firstChild.firstChild).unwrap();
$(e).removeData("gsvg");B=X(e);var z=c.createSVGTransform();z.setTranslate(l.x,l.y);B.appendItem(z);Ra(e);K("selected",[e])}else if(k.data("symbol")){e=k.data("symbol");B=k.attr("transform");z=k.attr(["x","y"]);var G=e.getAttribute("viewBox");if(G){G=G.split(" ");z.x-=+G[0];z.y-=+G[1]}B+=" translate("+(z.x||0)+","+(z.y||0)+")";z=k.prev();l.addSubCommand(new Fa(k[0],k[0].nextSibling,k[0].parentNode));k.remove();G=$(n).find("use:data(symbol)").length;k=g.createElementNS(b,"g");for(var D=e.childNodes,
w=0;w<D.length;w++)k.appendChild(D[w].cloneNode(true));if(svgedit.browser.isGecko()){D=$(gb()).children("linearGradient,radialGradient,pattern").clone();$(k).append(D)}B&&k.setAttribute("transform",B);B=e.parentNode;Hb(k);svgedit.browser.isGecko()&&$(gb()).append($(k).find("linearGradient,radialGradient,pattern"));k.id=ja();z.after(k);if(B){if(!G){z=e.nextSibling;B.removeChild(e);l.addSubCommand(new Fa(e,z,B))}l.addSubCommand(new Ia(k))}Gb(k);svgedit.browser.isGecko()?Ib(gb()):Ib(k);svgedit.utilities.walkTreePost(k,
function(F){try{Ra(F)}catch(h){console.log(h)}});$(k).find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=ja()});rb([k]);(e=Db(k,true))&&l.addSubCommand(e);wa(l)}else console.log("Unexpected element to ungroup:",e)};this.setSvgString=function(e){try{var k=svgedit.utilities.text2xml(e);this.prepareSvg(k);var l=new Ca("Change Source"),B=n.nextSibling,z=c.removeChild(n);l.addSubCommand(new Fa(z,B,c));n=g.adoptNode?g.adoptNode(k.documentElement):
g.importNode(k.documentElement,true);c.appendChild(n);var G=$(n);d.current_drawing_=new svgedit.draw.Drawing(n,v);var D=C().getNonce();D?K("setnonce",D):K("unsetnonce");G.find("image").each(function(){var I=this;Fb(I);var N=da(this);if(N.indexOf("data:")===0){var U=N.match(/svgedit_url=(.*?);/);if(U){var ba=decodeURIComponent(U[1]);$(new Image).load(function(){I.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",ba)}).attr("src",ba)}}d.embedImage(N)});G.find("svg").each(function(){if(!$(this).closest("defs").length){Hb(this);
var I=this.parentNode;if(I.childNodes.length===1&&I.nodeName==="g"){$(I).data("gsvg",this);I.id=I.id||ja()}else tb(this)}});G.find("linearGradient, radialGradient, pattern").appendTo(gb());Gb(G);Ib(G[0]);svgedit.utilities.walkTreePost(n,function(I){try{Ra(I)}catch(N){console.log(N)}});var w={id:"svgcontent",overflow:p.show_outside_canvas?"visible":"hidden"},F=false;if(G.attr("viewBox")){var h=G.attr("viewBox").split(" ");w.width=h[2];w.height=h[3]}else $.each(["width","height"],function(I,N){var U=
G.attr(N);U||(U="100%");if((U+"").substr(-1)==="%")F=true;else w[N]=Ea(N,U)});xb();G.children().find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=ja()});if(F){var m=getStrokedBBox();w.width=m.width+m.x;w.height=m.height+m.y}if(w.width<=0)w.width=200;if(w.height<=0)w.height=200;G.attr(w);this.contentW=w.width;this.contentH=w.height;$("#canvas_width").val(this.contentW);$("#canvas_height").val(this.contentH);var o=$("#canvas_background");
if(o.length){var u=o.attr("fill-opacity");u=u?parseInt(u)*100:100;fill=this.getPaint(o.attr("fill"),u,"canvas")}else fill=this.getPaint("none",100,"canvas");methodDraw.paintBox.canvas.setPaint(fill);l.addSubCommand(new Ia(n));var E=G.attr(["width","height"]);l.addSubCommand(new Ma(c,E));q=1;svgedit.transformlist.resetListMap();xa();svgedit.path.clearData();c.appendChild(ra.selectorParentGroup);wa(l);K("changed",[n])}catch(H){console.log(H);return false}return true};this.getPaint=function(e,k,l){var B=
null;if(e.indexOf("url(#")===0){e=(e=svgCanvas.getRefElem(e))?e.cloneNode(true):$("#"+l+"_color defs *")[0];B={alpha:k};B[e.tagName]=e}else B=e.indexOf("#")===0?{alpha:k,solidColor:e.substr(1)}:{alpha:k,solidColor:"none"};return new $.jGraduate.Paint(B)};this.importSvgString=function(e){try{var k=svgedit.utilities.encode64(e.length+e).substr(0,32),l=false;if(lb[k])if($(lb[k].symbol).parents("#svgroot").length)l=true;var B=new Ca("Import SVG");if(l)var z=lb[k].symbol,G=lb[k].xform;else{var D=svgedit.utilities.text2xml(e);
this.prepareSvg(D);var w;w=g.adoptNode?g.adoptNode(D.documentElement):g.importNode(D.documentElement,true);Hb(w);var F=Ea("width",w.getAttribute("width")),h=Ea("height",w.getAttribute("height")),m=w.getAttribute("viewBox"),o=m?m.split(" "):[0,0,F,h];for(e=0;e<4;++e)o[e]=+o[e];n.getAttribute("width");var u=+n.getAttribute("height");G=h>F?"scale("+u/3/o[3]+")":"scale("+u/3/o[2]+")";G="translate(0) "+G+" translate(0)";z=g.createElementNS(b,"symbol");var E=gb();for(svgedit.browser.isGecko()&&$(w).find("linearGradient, radialGradient, pattern").appendTo(E);w.firstChild;)z.appendChild(w.firstChild);
var H=w.attributes;for(w=0;w<H.length;w++){var I=H[w];z.setAttribute(I.nodeName,I.nodeValue)}z.id=ja();lb[k]={symbol:z,xform:G};gb().appendChild(z);B.addSubCommand(new Ia(z))}var N=g.createElementNS(b,"use");N.id=ja();S(N,"#"+z.id);(M||C().getCurrentLayer()).appendChild(N);B.addSubCommand(new Ia(N));xa();N.setAttribute("transform",G);Ra(N);$(N).data("symbol",z).data("ref",z);qb([N]);wa(B);K("changed",[n])}catch(U){console.log(U);return false}return true};var xb=d.identifyLayers=function(){Eb();C().identifyLayers()};
this.createLayer=function(e){var k=new Ca("Create Layer");e=C().createLayer(e);k.addSubCommand(new Ia(e));wa(k);xa();K("changed",[e])};this.cloneLayer=function(e){var k=new Ca("Duplicate Layer"),l=g.createElementNS(b,"g"),B=g.createElementNS(b,"title");B.textContent=e;l.appendChild(B);B=C().getCurrentLayer();$(B).after(l);B=B.childNodes;for(var z=0;z<B.length;z++){var G=B[z];G.localName!="title"&&l.appendChild(ia(G))}xa();xb();k.addSubCommand(new Ia(l));wa(k);d.setCurrentLayer(e);K("changed",[l])};
this.deleteCurrentLayer=function(){var e=C().getCurrentLayer(),k=e.nextSibling,l=e.parentNode;if(e=C().deleteCurrentLayer()){var B=new Ca("Delete Layer");B.addSubCommand(new Fa(e,k,l));wa(B);xa();K("changed",[l]);return true}return false};this.setCurrentLayer=function(e){(e=C().setCurrentLayer(svgedit.utilities.toXml(e)))&&xa();return e};this.renameCurrentLayer=function(e){var k=C();if(k.current_layer){var l=k.current_layer;if(!d.setCurrentLayer(e)){for(var B=new Ca("Rename Layer"),z=0;z<k.getNumLayers();++z)if(k.all_layers[z][1]==
l)break;var G=k.getLayerName(z);k.all_layers[z][0]=svgedit.utilities.toXml(e);var D=l.childNodes.length;for(z=0;z<D;++z){var w=l.childNodes.item(z);if(w&&w.tagName=="title"){for(;w.firstChild;)w.removeChild(w.firstChild);w.textContent=e;B.addSubCommand(new Ma(w,{"#text":G}));wa(B);K("changed",[l]);return true}}}k.current_layer=l}return false};this.setCurrentLayerPosition=function(e){var k=C();if(k.current_layer&&e>=0&&e<k.getNumLayers()){for(var l=0;l<k.getNumLayers();++l)if(k.all_layers[l][1]==k.current_layer)break;
if(l==k.getNumLayers())return false;if(l!=e){var B=null,z=k.current_layer.nextSibling;if(e>l){if(e<k.getNumLayers()-1)B=k.all_layers[e+1][1]}else B=k.all_layers[e][1];n.insertBefore(k.current_layer,B);wa(new Ja(k.current_layer,z,n));xb();d.setCurrentLayer(k.getLayerName(e));return true}}return false};this.setLayerVisibility=function(e,k){var l=C(),B=l.getLayerVisibility(e),z=l.setLayerVisibility(e,k);if(z)wa(new Ma(z,{display:B?"inline":"none"},"Layer Visibility"));else return false;if(z==l.getCurrentLayer()){xa();
La.clear()}return true};this.moveSelectedToLayer=function(e){for(var k=null,l=C(),B=0;B<l.getNumLayers();++B)if(l.getLayerName(B)==e){k=l.all_layers[B][1];break}if(!k)return false;e=new Ca("Move Elements to Layer");l=J;for(B=l.length;B--;){var z=l[B];if(z){var G=z.nextSibling,D=z.parentNode;k.appendChild(z);e.addSubCommand(new Ja(z,G,D))}}wa(e);return true};this.mergeLayer=function(e){var k=new Ca("Merge Layer"),l=C(),B=$(l.current_layer).prev()[0];if(B){for(k.addSubCommand(new Fa(l.current_layer,
l.current_layer.nextSibling,n));l.current_layer.firstChild;){var z=l.current_layer.firstChild;if(z.localName=="title"){k.addSubCommand(new Fa(z,z.nextSibling,l.current_layer));l.current_layer.removeChild(z)}else{var G=z.nextSibling;B.appendChild(z);k.addSubCommand(new Ja(z,G,l.current_layer))}}n.removeChild(l.current_layer);if(!e){xa();xb();K("changed",[n]);wa(k)}l.current_layer=B;return k}};this.mergeAllLayers=function(){var e=new Ca("Merge all Layers"),k=C();for(k.current_layer=k.all_layers[k.getNumLayers()-
1][1];$(n).children("g").length>1;)e.addSubCommand(d.mergeLayer(true));xa();xb();K("changed",[n]);wa(e)};var Eb=this.leaveContext=function(){var e=ta.length;if(e){for(var k=0;k<e;k++){var l=ta[k],B=cb(l,"orig_opac");B!==1?l.setAttribute("opacity",B):l.removeAttribute("opacity");l.setAttribute("style","pointer-events: inherit")}ta=[];xa(true);K("contextset",null)}M=null},Kb=this.setContext=function(e){Eb();if(typeof e==="string")e=oa(e);M=e;$(e).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var k=
this.getAttribute("opacity")||1;cb(this,"orig_opac",k);this.setAttribute("opacity",k*0.33);this.setAttribute("style","pointer-events: none");ta.push(this)});xa();K("contextset",M)};this.clear=function(){La.clear();xa();d.clearSvgContentElement();d.current_drawing_=new svgedit.draw.Drawing(n);d.createLayer("Layer 1");d.undoMgr.resetUndoStack();ra.initGroup();sa=ra.getRubberBandBox();K("cleared")};this.linkControlPoints=La.linkControlPoints;this.getContentElem=function(){return n};this.getRootElem=
function(){return c};this.getSelectedElems=function(){return J};var zb=this.getResolution=function(){var e=n.getAttribute("width")/q,k=n.getAttribute("height")/q;return{w:e,h:k,zoom:q}};this.getZoom=function(){return q};this.getVersion=function(){return"svgcanvas.js ($Rev: 2082 $)"};this.setUiStrings=function(e){$.extend(kb,e.notification)};this.setConfig=function(e){$.extend(p,e)};this.getTitle=function(e){if(e=e||J[0]){e=$(e).data("gsvg")||$(e).data("symbol")||e;e=e.childNodes;for(var k=0;k<e.length;k++)if(e[k].nodeName==
"title")return e[k].textContent;return""}};this.setGroupTitle=function(e){var k=J[0];k=$(k).data("gsvg")||k;var l=$(k).children("title"),B=new Ca("Set Label");if(e.length)if(l.length){l=l[0];B.addSubCommand(new Ma(l,{"#text":l.textContent}));l.textContent=e}else{l=g.createElementNS(b,"title");l.textContent=e;$(k).prepend(l);B.addSubCommand(new Ia(l))}else{B.addSubCommand(new Fa(l[0],l.nextSibling,k));l.remove()}wa(B)};this.getDocumentTitle=function(){return d.getTitle(n)};this.setDocumentTitle=function(e){for(var k=
n.childNodes,l=false,B="",z=new Ca("Change Image Title"),G=0;G<k.length;G++)if(k[G].nodeName=="title"){l=k[G];B=l.textContent;break}if(!l){l=g.createElementNS(b,"title");n.insertBefore(l,n.firstChild)}if(e.length)l.textContent=e;else l.parentNode.removeChild(l);z.addSubCommand(new Ma(l,{"#text":B}));wa(z)};this.getEditorNS=function(e){e&&n.setAttribute("xmlns:se","http://svg-edit.googlecode.com");return"http://svg-edit.googlecode.com"};this.setResolution=function(e,k){var l=zb(),B=l.w;l=l.h;var z;
if(e=="fit"){var G=getStrokedBBox();if(G){z=new Ca("Fit Canvas to Content");var D=pb();qb(D);var w=[],F=[];$.each(D,function(){w.push(G.x*-1);F.push(G.y*-1)});D=d.moveSelectedElements(w,F,true);z.addSubCommand(D);xa();e=Math.round(G.width);k=Math.round(G.height)}else return false}if(e!=B||k!=l){D=c.suspendRedraw(1E3);z||(z=new Ca("Change Image Dimensions"));e=Ea("width",e);k=Ea("height",k);n.setAttribute("width",e);n.setAttribute("height",k);this.contentW=e;this.contentH=k;z.addSubCommand(new Ma(n,
{width:B,height:l}));n.setAttribute("viewBox",[0,0,e/q,k/q].join(" "));z.addSubCommand(new Ma(n,{viewBox:["0 0",B,l].join(" ")}));wa(z);c.unsuspendRedraw(D);if(background=document.getElementById("canvas_background")){background.setAttribute("x",-1);background.setAttribute("y",-1);background.setAttribute("width",e+2);background.setAttribute("height",k+2)}K("changed",[n])}return[e,k]};this.getOffset=function(){return $(n).attr(["x","y"])};this.setBBoxZoom=function(e,k,l){var B=0.85,z=function(G){if(!G)return false;
var D=Math.min(Math.round(k/G.width*100*B)/100,Math.round(l/G.height*100*B)/100);d.setZoom(D);return{zoom:D,bbox:G}};if(typeof e=="object"){e=e;if(e.width==0||e.height==0){d.setZoom(e.zoom?e.zoom:q*e.factor);return{zoom:q,bbox:e}}return z(e)}switch(e){case "selection":if(!J[0])return;e=$.map(J,function(G){if(G)return G});e=getStrokedBBox(e);break;case "canvas":e=zb();B=0.95;e={width:e.w,height:e.h,x:0,y:0};break;case "content":e=getStrokedBBox();break;case "layer":e=getStrokedBBox(pb(C().getCurrentLayer()));
break;default:return}return z(e)};this.setZoom=function(e){var k=zb();n.setAttribute("viewBox","0 0 "+k.w/e+" "+k.h/e);q=e;$.each(J,function(l,B){B&&ra.requestSelector(B).resize()});La.zoomChange();ib("zoomChanged",e)};this.getMode=function(){return Ha};this.setMode=function(e){La.clear();bb.clear();$("#workarea").attr("class",e);Xa=J[0]&&J[0].nodeName=="text"?Ua:L;Ha=e};this.getColor=function(e){return Xa[e]};this.setColor=function(e,k,l){L[e]=k;Xa[e+"_paint"]={type:"solidColor"};for(var B=[],z=
J.length;z--;){var G=J[z];if(G)if(G.tagName=="g")svgedit.utilities.walkTree(G,function(D){D.nodeName!="g"&&B.push(D)});else if(e=="fill")G.tagName!="polyline"&&G.tagName!="line"&&B.push(G);else B.push(G)}if(B.length>0)if(l)Ab(e,k,B);else{Ya(e,k,B);K("changed",B)}};var gb=function(){var e=n.getElementsByTagNameNS(b,"defs");if(e.length>0)e=e[0];else{e=g.createElementNS(b,"defs");n.firstChild?n.insertBefore(e,n.firstChild.nextSibling):n.appendChild(e)}return e},Nb=this.setGradient=function(e){if(!(!Xa[e+
"_paint"]||Xa[e+"_paint"].type=="solidColor")){var k=d[e+"Grad"],l=Mb(k),B=gb();if(l)k=l;else{k=B.appendChild(g.importNode(k,true));k.id=ja()}d.setColor(e,"url(#"+k.id+")");if(e=="canvas")(e=document.getElementById("canvas_background"))&&e.setAttribute("fill","url(#"+k.id+")")}},Mb=function(e){var k=gb();k=$(k).find("linearGradient, radialGradient");for(var l=k.length,B=["r","cx","cy","fx","fy"];l--;){var z=k[l];if(e.tagName=="linearGradient"){if(e.getAttribute("x1")!=z.getAttribute("x1")||e.getAttribute("y1")!=
z.getAttribute("y1")||e.getAttribute("x2")!=z.getAttribute("x2")||e.getAttribute("y2")!=z.getAttribute("y2"))continue}else{var G=$(e).attr(B),D=$(z).attr(B),w=false;$.each(B,function(E,H){if(G[H]!=D[H])w=true});if(w)continue}var F=e.getElementsByTagNameNS(b,"stop"),h=z.getElementsByTagNameNS(b,"stop");if(F.length==h.length){for(var m=F.length;m--;){var o=F[m],u=h[m];if(o.getAttribute("offset")!=u.getAttribute("offset")||o.getAttribute("stop-opacity")!=u.getAttribute("stop-opacity")||o.getAttribute("stop-color")!=
u.getAttribute("stop-color"))break}if(m==-1)return z}}return null};this.setPaint=function(e,k){var l=new $.jGraduate.Paint(k);this.setPaintOpacity(e,l.alpha/100,true);Xa[e+"_paint"]=l;switch(l.type){case "solidColor":if(l.solidColor!="none"&&l.solidColor!="#none")this.setColor(e,"#"+l.solidColor);else{this.setColor(e,"none");document.querySelector(e=="fill"?"#fill_color rect":"#stroke_color rect").setAttribute("fill","none")}break;case "linearGradient":case "radialGradient":d[e+"Grad"]=l[l.type];
Nb(e)}};this.getStrokeWidth=function(){return Xa.stroke_width};this.setStrokeWidth=function(e){if(e==0&&["line","path"].indexOf(Ha)>=0)d.setStrokeWidth(1);else{Xa.stroke_width=e;for(var k=[],l=J.length;l--;){var B=J[l];if(B)B.tagName=="g"?svgedit.utilities.walkTree(B,function(z){z.nodeName!="g"&&k.push(z)}):k.push(B)}if(k.length>0){Ya("stroke-width",e,k);K("changed",J)}}};this.setStrokeAttr=function(e,k){L[e.replace("-","_")]=k;for(var l=[],B=J.length;B--;){var z=J[B];if(z)z.tagName=="g"?svgedit.utilities.walkTree(z,
function(G){G.nodeName!="g"&&l.push(G)}):l.push(z)}if(l.length>0){Ya(e,k,l);K("changed",J)}};this.getStyle=function(){return L};this.getOpacity=function(){return L.opacity};this.setOpacity=function(e){L.opacity=e;Ya("opacity",e)};this.getFillOpacity=function(){return L.fill_opacity};this.getStrokeOpacity=function(){return L.stroke_opacity};this.setPaintOpacity=function(e,k,l){L[e+"_opacity"]=k;l?Ab(e+"-opacity",k):Ya(e+"-opacity",k)};this.getBlur=function(e){var k=0;if(e)if(e.getAttribute("filter"))if(e=
oa(e.id+"_blur"))k=e.firstChild.getAttribute("stdDeviation");return k};(function(){function e(){var z=d.undoMgr.finishUndoableChange();k.addSubCommand(z);wa(k);l=k=null}var k=null,l=null,B=false;d.setBlurNoUndo=function(z){if(l)if(z===0){Ab("filter","");B=true}else{var G=J[0];B&&Ab("filter","url(#"+G.id+"_blur)");if(svgedit.browser.isWebkit()){G.removeAttribute("filter");G.setAttribute("filter","url(#"+G.id+"_blur)")}Ab("stdDeviation",z,[l.firstChild]);d.setBlurOffsets(l,z)}else d.setBlur(z)};d.setBlurOffsets=
function(z,G){if(G>3)la(z,{x:"-50%",y:"-50%",width:"200%",height:"200%"},100);else if(!svgedit.browser.isWebkit()){z.removeAttribute("x");z.removeAttribute("y");z.removeAttribute("width");z.removeAttribute("height")}};d.setBlur=function(z,G){if(k)e();else{var D=J[0],w=D.id;l=oa(w+"_blur");z-=0;var F=new Ca;if(l){if(z===0)l=null}else{var h=Z({element:"feGaussianBlur",attr:{"in":"SourceGraphic",stdDeviation:z}});l=Z({element:"filter",attr:{id:w+"_blur"}});l.appendChild(h);gb().appendChild(l);F.addSubCommand(new Ia(l))}h=
{filter:D.getAttribute("filter")};if(z===0){D.removeAttribute("filter");F.addSubCommand(new Ma(D,h))}else{Ya("filter","url(#"+w+"_blur)");F.addSubCommand(new Ma(D,h));d.setBlurOffsets(l,z);k=F;d.undoMgr.beginUndoableChange("stdDeviation",[l?l.firstChild:null]);if(G){d.setBlurNoUndo(z);e()}}}}})();this.getBold=function(){var e=true;J.filter(Boolean).forEach(function(k){if(k.getAttribute("font-weight")!="bold")e=false});return e};this.setBold=function(e){var k=J.filter(Boolean);k.forEach(function(l){if(l!=
null&&l.tagName=="text")Ya("font-weight",e?"bold":"normal")});k[0].textContent||bb.setCursor()};this.getItalic=function(){var e=true;J.filter(Boolean).forEach(function(k){if(k.getAttribute("font-style")!="italic")e=false});return e};this.setItalic=function(e){var k=J.filter(Boolean);k.forEach(function(l){if(l!=null&&l.tagName=="text")Ya("font-style",e?"italic":"normal")});k[0].textContent||bb.setCursor()};this.getFontFamily=function(){return Ua.font_family};this.setFontFamily=function(e){Ua.font_family=
e;Ya("font-family",e);J[0]&&!J[0].textContent&&bb.setCursor()};this.setFontColor=function(e){Ua.fill=e;Ya("fill",e)};this.getFontSize=function(){return Ua.fill};this.getFontSize=function(){return Ua.font_size};this.setFontSize=function(e){Ua.font_size=e;Ya("font-size",e);J[0].textContent||bb.setCursor()};this.getText=function(){var e=J[0];if(e==null)return"";return e.textContent};this.setTextContent=function(e){Ya("#text",e);bb.init(e);bb.setCursor()};this.setImageURL=function(e){var k=J[0];if(k){var l=
$(k).attr(["width","height"]);l=!l.width||!l.height;var B=da(k);if(B!==e)l=true;else if(!l)return;var z=new Ca("Change Image URL");S(k,e);z.addSubCommand(new Ma(k,{"#href":B}));l?$(new Image).load(function(){var G=$(k).attr(["width","height"]);$(k).attr({width:this.width,height:this.height});ra.requestSelector(k).resize();z.addSubCommand(new Ma(k,G));wa(z);K("changed",[k])}).attr("src",e):wa(z)}};this.setLinkURL=function(e){var k=J[0];if(k){if(k.tagName!=="a"){k=$(k).parents("a");if(k.length)k=k[0];
else return}var l=da(k);if(l!==e){var B=new Ca("Change Link URL");S(k,e);B.addSubCommand(new Ma(k,{"#href":l}));wa(B)}}};this.elementsAreSame=function(e){return!e.length||e[0]==null?null:J.every(function(k){return k&&J[0]?k.nodeName==J[0].nodeName:null})};this.setRectRadius=function(e){d.elementsAreSame(J)&&J[0].tagName=="rect"&&J.forEach(function(k){var l=k.getAttribute("rx");if(l!=e){k.setAttribute("rx",e);k.setAttribute("ry",e);wa(new Ma(k,{rx:l,ry:l},"Radius"));K("changed",[k])}})};this.makeHyperlink=
function(e){d.groupSelectedElements("a",e)};this.removeHyperlink=function(){d.ungroupSelectedElement()};this.setSegType=function(e){La.setSegType(e)};this.convertToPath=function(e,k){if(e==null)$.each(J,function(ba,R){R&&d.convertToPath(R)});else{if(!k)var l=new Ca("Convert element to Path");var B=k?{}:{fill:L.fill,"fill-opacity":L.fill_opacity,stroke:L.stroke,"stroke-width":L.stroke_width,"stroke-dasharray":L.stroke_dasharray,"stroke-linejoin":L.stroke_linejoin,"stroke-linecap":L.stroke_linecap,
"stroke-opacity":L.stroke_opacity,opacity:L.opacity,visibility:"hidden"};$.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){if(e.getAttribute(this))B[this]=e.getAttribute(this)});var z=Z({element:"path",attr:B}),G=e.getAttribute("transform");G&&z.setAttribute("transform",G);var D=e.id,w=e.parentNode;e.nextSibling?w.insertBefore(z,e):w.appendChild(z);var F="",h=function(ba){$.each(ba,function(R,fa){var ga=fa[1];F+=fa[0];for(var T=0;T<ga.length;T+=2)F+=ga[T]+","+ga[T+
1]+" "})},m=1.81;switch(e.tagName){case "ellipse":case "circle":var o=$(e).attr(["rx","ry","cx","cy"]),u=o.cx,E=o.cy,H=o.rx;o=o.ry;if(e.tagName=="circle")H=o=$(e).attr("r");h([["M",[u-H,E]],["C",[u-H,E-o/m,u-H/m,E-o,u,E-o]],["C",[u+H/m,E-o,u+H,E-o/m,u+H,E]],["C",[u+H,E+o/m,u+H/m,E+o,u,E+o]],["C",[u-H/m,E+o,u-H,E+o/m,u-H,E]],["Z",[]]]);break;case "path":F=e.getAttribute("d");break;case "line":o=$(e).attr(["x1","y1","x2","y2"]);F="M"+o.x1+","+o.y1+"L"+o.x2+","+o.y2;break;case "polyline":case "polygon":F=
"M"+e.getAttribute("points");break;case "rect":o=$(e).attr(["rx","ry"]);H=o.rx;o=o.ry;var I=e.getBBox();u=I.x;E=I.y;var N=I.width;I=I.height;m=4-m;if(!H&&!o)h([["M",[u,E]],["L",[u+N,E]],["L",[u+N,E+I]],["L",[u,E+I]],["L",[u,E]],["Z",[]]]);else{o||(o=H);h([["M",[u,E+o]],["C",[u,E+o/m,u+H/m,E,u+H,E]],["L",[u+N-H,E]],["C",[u+N-H/m,E,u+N,E+o/m,u+N,E+o]],["L",[u+N,E+I-o]],["C",[u+N,E+I-o/m,u+N-H/m,E+I,u+N-H,E+I]],["L",[u+H,E+I]],["C",[u+H/m,E+I,u,E+I-o/m,u,E+I-o]],["L",[u,E+o]],["Z",[]]])}break;default:z.parentNode.removeChild(z)}F&&
z.setAttribute("d",F);if(k){La.resetOrientation(z);l=false;try{l=z.getBBox()}catch(U){}z.parentNode.removeChild(z);return l}else{if(G){G=X(z);pa(G)&&La.resetOrientation(z)}l.addSubCommand(new Fa(e,e.nextSibling,w));l.addSubCommand(new Ia(z));xa();e.parentNode.removeChild(e);z.setAttribute("id",D);z.removeAttribute("visibility");qb([z],true);wa(l)}}};var Ab=this.changeSelectedAttributeNoUndo=function(e,k,l){var B=c.suspendRedraw(1E3);Ha=="pathedit"&&La.moveNode(e,k);l=l||J;for(var z=l.length,G=["g",
"polyline","path"];z--;){var D=l[z];if(D!=null){Ha==="textedit"&&e!=="#text"&&D.textContent.length&&bb.toSelectMode(D);if((e==="x"||e==="y")&&G.indexOf(D.tagName)>=0){var w=getStrokedBBox([D]);d.moveSelectedElements((e==="x"?k-w.x:0)*q,(e==="y"?k-w.y:0)*q,true)}else{w=e==="#text"?D.textContent:D.getAttribute(e);if(w==null)w="";if(w!==String(k)){if(e=="#text"){svgedit.utilities.getBBox(D);D.textContent=k}else e=="#href"?S(D,k):D.setAttribute(e,k);J.indexOf(D)>=0&&setTimeout(function(){D.parentNode&&
ra.requestSelector(D).resize()},0);w=na(D);if(w!=0&&e!="transform")for(var F=X(D),h=F.numberOfItems;h--;)if(F.getItem(h).type==4){F.removeItem(h);var m=svgedit.utilities.getBBox(D),o=O(m.x+m.width/2,m.y+m.height/2,Y(F).matrix);m=o.x;o=o.y;var u=c.createSVGTransform();u.setRotate(w,m,o);F.insertItemBefore(u,h);break}}}}}c.unsuspendRedraw(B)},Ya=this.changeSelectedAttribute=function(e,k,l){l=l||J;d.undoMgr.beginUndoableChange(e,l);Ab(e,k,l);e=d.undoMgr.finishUndoableChange();e.isEmpty()||wa(e)};this.deleteSelectedElements=
function(){for(var e=new Ca("Delete Elements"),k=J.length,l=[],B=0;B<k;++B){var z=J[B];if(z==null)break;var G=z.parentNode,D=z;ra.releaseSelector(D);svgedit.path.removePath_(D.id);if(G.tagName==="a"&&G.childNodes.length===1){D=G;G=G.parentNode}var w=D.nextSibling;D=G.removeChild(D);l.push(z);J[B]=null;e.addSubCommand(new Fa(D,w,G))}e.isEmpty()||wa(e);K("changed",l);xa()};this.cutSelectedElements=function(){for(var e=new Ca("Cut Elements"),k=J.length,l=[],B=0;B<k;++B){var z=J[B];if(z==null)break;var G=
z.parentNode,D=z;ra.releaseSelector(D);svgedit.path.removePath_(D.id);var w=D.nextSibling;D=G.removeChild(D);l.push(z);J[B]=null;e.addSubCommand(new Fa(D,w,G))}e.isEmpty()||wa(e);K("changed",l);xa();d.clipBoard=l};this.copySelectedElements=function(){d.clipBoard=$.merge([],J)};this.pasteElements=function(){var e=d.clipBoard,k=e.length;if(k){for(var l=[],B=new Ca("Paste elements");k--;){var z=e[k];if(z){var G=ia(z);if(!oa(z.id))G.id=z.id;l.push(G);(M||C().getCurrentLayer()).appendChild(G);B.addSubCommand(new Ia(G))}}svgCanvas.clearSelection();
setTimeout(function(){rb(l)},100);wa(B);K("changed",l)}};this.groupSelectedElements=function(e){e||(e="g");var k="";switch(e){case "a":k="Make hyperlink";var l="";if(arguments.length>1)l=arguments[1];break;default:e="g";k="Group Elements"}k=new Ca(k);var B=Z({element:e,attr:{id:ja()}});e==="a"&&S(B,l);k.addSubCommand(new Ia(B));for(l=J.length;l--;){var z=J[l];if(z!=null){if(z.parentNode.tagName==="a"&&z.parentNode.childNodes.length===1)z=z.parentNode;var G=z.nextSibling,D=z.parentNode;B.appendChild(z);
k.addSubCommand(new Ja(z,G,D))}}k.isEmpty()||wa(k);rb([B],true)};var Db=this.pushGroupProperties=function(e,k){var l=e.childNodes,B=l.length,z=e.getAttribute("transform"),G=X(e),D=Y(G).matrix,w=new Ca("Push group properties"),F=0,h=na(e),m=$(e).attr(["filter","opacity"]),o,u;for(F=0;F<B;F++){var E=l[F];if(E.nodeType===1){if(m.opacity!==null&&m.opacity!==1){E.getAttribute("opacity");var H=Math.round((E.getAttribute("opacity")||1)*m.opacity*100)/100;Ya("opacity",H,[E])}if(m.filter){var I=H=this.getBlur(E);
u||(u=this.getBlur(e));if(H)H=u-0+(H-0);else if(H===0)H=u;if(I)o=P(E.getAttribute("filter"));else if(o){o=ia(o);gb().appendChild(o)}else o=P(m.filter);o.id=E.id+"_"+(o.firstChild.tagName==="feGaussianBlur"?"blur":"filter");Ya("filter","url(#"+o.id+")",[E]);if(H){Ya("stdDeviation",H,[o.firstChild]);d.setBlurOffsets(o,H)}}H=X(E);if(~E.tagName.indexOf("Gradient"))H=null;if(H)if(E.tagName!=="defs")if(G.numberOfItems){if(h&&G.numberOfItems==1){var N=G.getItem(0).matrix,U=c.createSVGMatrix();if(I=na(E))U=
H.getItem(0).matrix;var ba=svgedit.utilities.getBBox(E),R=Y(H).matrix,fa=O(ba.x+ba.width/2,ba.y+ba.height/2,R);ba=h+I;R=c.createSVGTransform();R.setRotate(ba,fa.x,fa.y);N=ha(N,U,R.matrix.inverse());I&&H.removeItem(0);if(ba)H.numberOfItems?H.insertItemBefore(R,0):H.appendItem(R);if(N.e||N.f){I=c.createSVGTransform();I.setTranslate(N.e,N.f);H.numberOfItems?H.insertItemBefore(I,0):H.appendItem(I)}}else{I=E.getAttribute("transform");N={};N.transform=I?I:"";I=c.createSVGTransform();N=Y(H).matrix;U=N.inverse();
N=ha(U,D,N);I.setMatrix(N);H.appendItem(I)}(E=Ra(E))&&w.addSubCommand(E)}}}if(z){N={};N.transform=z;e.setAttribute("transform","");e.removeAttribute("transform");w.addSubCommand(new Ma(e,N))}if(k&&!w.isEmpty())return w};this.ungroupSelectedElement=function(){var e=J[0];if($(e).data("gsvg")||$(e).data("symbol"))Lb(e);else if(e.tagName==="use"){var k=oa(da(e).substr(1));$(e).data("symbol",k).data("ref",k);Lb(e)}else{k=$(e).parents("a");if(k.length)e=k[0];if(e.tagName==="g"||e.tagName==="a"){k=new Ca("Ungroup Elements");
var l=Db(e,true);l&&k.addSubCommand(l);l=e.parentNode;for(var B=e.nextSibling,z=Array(e.childNodes.length),G=0;e.firstChild;){var D=e.firstChild,w=D.nextSibling,F=D.parentNode;if(D.tagName==="title"){k.addSubCommand(new Fa(D,D.nextSibling,F));F.removeChild(D)}else{z[G++]=D=l.insertBefore(D,B);k.addSubCommand(new Ja(D,w,F))}}xa();B=e.nextSibling;e=l.removeChild(e);k.addSubCommand(new Fa(e,B,l));k.isEmpty()||wa(k);qb(z)}}};this.moveToTopSelectedElement=function(){var e=J.filter(Boolean).reverse(),k=
new Ca("Move to top");e.forEach(function(l){l=l;var B=l.parentNode,z=l.nextSibling;l=l.parentNode.appendChild(l);if(z!=l.nextSibling){k.addSubCommand(new Ja(l,z,B,"top"));K("changed",[l])}k.isEmpty()||wa(k)})};this.moveToBottomSelectedElement=function(){var e=J.filter(Boolean).reverse(),k=new Ca("Move to top");e.forEach(function(l){l=l;var B=l.parentNode,z=l.nextSibling,G=l.parentNode.firstChild;if(G.tagName=="title")G=G.nextSibling;if(G.tagName=="defs")G=G.nextSibling;l=l.parentNode.insertBefore(l,
G);if(z!=l.nextSibling){k.addSubCommand(new Ja(l,z,B,"bottom"));K("changed",[l])}});k.isEmpty()||wa(k)};this.moveUpDownSelected=function(e){var k=J.filter(Boolean);e=="Down"&&k.reverse();var l=new Ca("Move "+e);k.forEach(function(B){hb=[];var z,G,D=$(ob(getStrokedBBox([B]))).toArray();e=="Down"&&D.reverse();$.each(D,function(){if(G){z=this;return false}else if(this==B)G=true});if(z){D=B.parentNode;var w=B.nextSibling;$(z)[e=="Down"?"before":"after"](B);if(w!=B.nextSibling){l.addSubCommand(new Ja(B,
w,D,"Move "+e));K("changed",[B])}}});l.isEmpty()||wa(l)};this.moveSelectedElements=function(e,k,l){if(e.constructor!=Array){e/=q;k/=q}l=l||true;for(var B=new Ca("position"),z=J.length;z--;){var G=J[z];if(G!=null){var D=c.createSVGTransform(),w=X(G);e.constructor==Array?D.setTranslate(e[z],k[z]):D.setTranslate(e,k);w.numberOfItems?w.insertItemBefore(D,0):w.appendItem(D);(D=Ra(G))&&B.addSubCommand(D);ra.requestSelector(G).resize()}}if(!B.isEmpty()){l&&wa(B);K("changed",J);return B}};this.cloneSelectedElements=
function(e,k,l){for(var B=new Ca("Clone Elements"),z=J.length,G=0;G<z;++G){var D=J[G];if(D==null)break}z=J.slice(0,G);this.clearSelection(true);G=z.length;for(clones=[];G--;){D=z[G];var w=ia(z[G]),F=M||C().getCurrentLayer();if(l){tlist=X(w);tlist.removeItem(l);Ra(w);F.insertBefore(w,D)}else F.appendChild(w);clones.push(w);B.addSubCommand(new Ia(w))}if(!B.isEmpty()){qb(z.reverse());l||this.moveSelectedElements(e,k,false);wa(B)}return clones};this.alignSelectedElements=function(e,k){var l=[],B=Number.MAX_VALUE,
z=Number.MIN_VALUE,G=Number.MAX_VALUE,D=Number.MIN_VALUE,w=Number.MIN_VALUE,F=Number.MIN_VALUE,h=J.length;if(h){for(var m=0;m<h;++m){if(J[m]==null)break;l[m]=getStrokedBBox([J[m]]);switch(k){case "smallest":if((e=="l"||e=="c"||e=="r")&&(w==Number.MIN_VALUE||w>l[m].width)||(e=="t"||e=="m"||e=="b")&&(F==Number.MIN_VALUE||F>l[m].height)){B=l[m].x;G=l[m].y;z=l[m].x+l[m].width;D=l[m].y+l[m].height;w=l[m].width;F=l[m].height}break;case "largest":if((e=="l"||e=="c"||e=="r")&&(w==Number.MIN_VALUE||w<l[m].width)||
(e=="t"||e=="m"||e=="b")&&(F==Number.MIN_VALUE||F<l[m].height)){B=l[m].x;G=l[m].y;z=l[m].x+l[m].width;D=l[m].y+l[m].height;w=l[m].width;F=l[m].height}break;default:if(l[m].x<B)B=l[m].x;if(l[m].y<G)G=l[m].y;if(l[m].x+l[m].width>z)z=l[m].x+l[m].width;if(l[m].y+l[m].height>D)D=l[m].y+l[m].height}}if(k=="page"){G=B=0;z=d.contentW;D=d.contentH}w=Array(h);F=Array(h);for(m=0;m<h;++m){if(J[m]==null)break;var o=l[m];w[m]=0;F[m]=0;switch(e){case "l":w[m]=B-o.x;break;case "c":w[m]=(B+z)/2-(o.x+o.width/2);break;
case "r":w[m]=z-(o.x+o.width);break;case "t":F[m]=G-o.y;break;case "m":F[m]=(G+D)/2-(o.y+o.height/2);break;case "b":F[m]=D-(o.y+o.height)}}this.moveSelectedElements(w,F)}};this.contentW=zb().w;this.contentH=zb().h;this.updateCanvas=function(e,k){c.setAttribute("width",e);c.setAttribute("height",k);var l=$("#canvasBackground")[0],B=n.getAttribute("x"),z=n.getAttribute("y"),G=e/2-this.contentW*q/2,D=k/2-this.contentH*q/2;la(n,{width:this.contentW*q,height:this.contentH*q,x:G,y:D,viewBox:"0 0 "+this.contentW+
" "+this.contentH});la(l,{width:n.getAttribute("width"),height:n.getAttribute("height"),x:G,y:D});(l=oa("background_image"))&&la(l,{width:"100%",height:"100%"});ra.selectorParentGroup.setAttribute("transform","translate("+G+","+D+")");return{x:G,y:D,old_x:B,old_y:z,d_x:G-B,d_y:D-z}};this.setBackground=function(e,k){var l=oa("canvasBackground"),B=$(l).find("rect")[0],z=oa("background_image");B.setAttribute("fill",e);if(k){if(!z){z=g.createElementNS(b,"image");la(z,{id:"background_image",width:"100%",
height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})}S(z,k);l.appendChild(z)}else z&&z.parentNode.removeChild(z)};this.cycleElement=function(e){var k=J[0],l=false,B=pb(M||C().getCurrentLayer());if(B.length){if(k==null){e=e?B.length-1:0;l=B[e]}else for(var z=B.length;z--;)if(B[z]==k){e=e?z-1:z+1;if(e>=B.length)e=0;else if(e<0)e=B.length-1;l=B[e];break}rb([l],true);K("selected",J)}};this.clear();this.getPrivateMethods=function(){return{addCommandToHistory:wa,setGradient:Nb,addSvgElementFromJson:Z,
assignAttributes:la,BatchCommand:Ca,call:K,ChangeElementCommand:Ma,copyElem:ia,ffClone:ca,findDefs:gb,findDuplicateGradient:Mb,getElem:oa,getId:aa,getIntersectionList:ob,getMouseTarget:Bb,getNextId:ja,getPathBBox:V,getUrlFromAttr:ma,hasMatrixTransform:pa,identifyLayers:xb,InsertElementCommand:Ia,isIdentity:svgedit.math.isIdentity,logMatrix:Wa,matrixMultiply:ha,MoveElementCommand:Ja,preventClickDefault:Fb,recalculateAllSelectedDimensions:Da,recalculateDimensions:Ra,remapElement:Za,RemoveElementCommand:Fa,
removeUnusedDefElems:yb,round:ab,runExtensions:ib,sanitizeSvg:za,SVGEditTransformList:svgedit.transformlist.SVGTransformList,toString:toString,transformBox:svgedit.math.transformBox,transformListToTransform:Y,transformPoint:O,walkTree:svgedit.utilities.walkTree}}};(function(){document.addEventListener("touchstart",touchHandler,true);document.addEventListener("touchmove",touchHandler,true);document.addEventListener("touchend",touchHandler,true);document.addEventListener("touchcancel",touchHandler,true);if(!window.methodDraw)window.methodDraw=function(a){function s(c,n){var v=f.setSvgString(c)!==false;n=n||a.noop;v?n(true):a.alert(uiStrings.notification.errorLoadingSVG,function(){n(false)})}var f,b={},p=false;curConfig={canvas_expansion:1,dimensions:[740,520],
initFill:{color:"fff",opacity:1},initStroke:{width:1.5,color:"000",opacity:1},initOpacity:1,imgPath:"images/",extPath:"extensions/",jGraduatePath:"lib/jgraduate/images/",extensions:[],initTool:"select",wireframe:false,colorPickerCSS:false,gridSnapping:false,gridColor:"#000",baseUnit:"px",snappingStep:10,showRulers:svgedit.browser.isTouch()?false:true,show_outside_canvas:false,no_save_warning:true,initFont:"Helvetica, Arial, sans-serif"};uiStrings=b.uiStrings={common:{ok:"OK",cancel:"Cancel",key_up:"Up",
key_down:"Down",key_backspace:"Backspace",key_del:"Del"},layers:{layer:"Layer"},notification:{invalidAttrValGiven:"Invalid value given",noContentToFitTo:"No content to fit to",dupeLayerName:"There is already a layer named that!",enterUniqueLayerName:"Please enter a unique layer name",enterNewLayerName:"Please enter the new layer name",layerHasThatName:"Layer already has that name",QmoveElemsToLayer:'Move selected elements to layer "%s"?',QwantToClear:"<strong>Do you want to clear the drawing?</strong>\nThis will also erase your undo history",
QwantToOpen:"Do you want to open a new file?\nThis will also erase your undo history",QerrorsRevertToSource:"There were parsing errors in your SVG source.\nRevert back to original SVG source?",QignoreSourceChanges:"Ignore changes made to SVG source?",featNotSupported:"Feature not supported",enterNewImgURL:"Enter the new image URL",defsFailOnSave:"NOTE: Due to a bug in your browser, this image may appear wrong (missing gradients or elements). It will however appear correct once actually saved.",loadingImage:"Loading image, please wait...",
saveFromBrowser:'Select "Save As..." in your browser to save this image as a %s file.',noteTheseIssues:"Also note the following issues: ",unsavedChanges:"There are unsaved changes.",enterNewLinkURL:"Enter the new hyperlink URL",errorLoadingSVG:"Error: Unable to load SVG data",URLloadFail:"Unable to load from URL",retrieving:'Retrieving "%s" ...'}};var A={},d={};b.curConfig=curConfig;b.tool_scale=1;b.setConfig=function(c){a.extend(true,curConfig,c);if(c.extensions)curConfig.extensions=c.extensions};
b.setCustomHandlers=function(c){b.ready(function(){if(c.open){a('#tool_open > input[type="file"]').remove();a("#tool_open").show();f.open=c.open}if(c.save){b.show_save_warning=false;f.bind("saved",c.save)}c.pngsave&&f.bind("exported",c.pngsave);d=c})};b.randomizeIds=function(){f.randomizeIds(arguments)};b.init=function(){(function(){var h=window.opener;if(h)try{var m=h.document.createEvent("Event");m.initEvent("methodDrawReady",true,true);h.document.documentElement.dispatchEvent(m)}catch(o){}})();
(function(){a("body").toggleClass("touch",svgedit.browser.isTouch());var h=a.deparam.querystring(true);if(!a.isEmptyObject(h)){if(h.dimensions)h.dimensions=h.dimensions.split(",");if(h.extensions)h.extensions=h.extensions.split(",");if(h.bkgd_color)h.bkgd_color="#"+h.bkgd_color;methodDraw.setConfig(h);var m=h.source,o=a.param.querystring();if(!m)if(o.indexOf("source=data:")>=0)m=o.match(/source=(data:[^&]*)/)[1];if(m)if(m.indexOf("data:")===0){m=m.replace(/ /g,"+");b.loadFromDataURI(m)}else b.loadFromString(m);
else if(o.indexOf("paramurl=")!==-1)methodDraw.loadFromURL(o.substr(9));else h.url&&methodDraw.loadFromURL(h.url)}})();a("#canvas_width").val(curConfig.dimensions[0]);a("#canvas_height").val(curConfig.dimensions[1]);var c=function(){a.each(curConfig.extensions,function(){var h=this;a.getScript(curConfig.extPath+h,function(m){if(!m){m=document.createElement("script");m.src=curConfig.extPath+h;document.querySelector("head").appendChild(m)}})})};document.location.protocol==="file:"?setTimeout(c,100):
c();a.svgIcons(curConfig.imgPath+"svg_edit_icons.svg",{w:27,h:27,id_match:false,no_img:true,fallback_path:curConfig.imgPath,fallback:{logo:"logo.png",select:"select.png",select_node:"select_node.png",pencil:"pencil.png",pen:"line.png",rect:"square.png",ellipse:"ellipse.png",path:"path.png",text:"text.png",image:"image.png",zoom:"zoom.png","delete":"delete.png",spapelib:"shapelib.png",node_delete:"node_delete.png",align_left:"align-left.png",align_center:"align-center.png",align_right:"align-right.png",
align_top:"align-top.png",align_middle:"align-middle.png",align_bottom:"align-bottom.png",arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#logo":"logo","#tool_select":"select","#tool_fhpath":"pencil","#tool_line":"pen","#tool_rect,#tools_rect_show":"rect","#tool_ellipse,#tools_ellipse_show":"ellipse","#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_node_clone":"node_clone","#tool_node_delete":"node_delete","#tool_add_subpath":"add_subpath",
"#tool_openclose_path":"open_path","#tool_alignleft, #tool_posleft":"align_left","#tool_aligncenter, #tool_poscenter":"align_center","#tool_alignright, #tool_posright":"align_right","#tool_aligntop, #tool_postop":"align_top","#tool_alignmiddle, #tool_posmiddle":"align_middle","#tool_alignbottom, #tool_posbottom":"align_bottom","#cur_position":"align","#zoomLabel":"zoom"},resize:{"#logo .svg_icon":15,".flyout_arrow_horiz .svg_icon":5,"#fill_bg .svg_icon, #stroke_bg .svg_icon":svgedit.browser.isTouch()?
24:24,".palette_item:first .svg_icon":svgedit.browser.isTouch()?30:16,"#zoomLabel .svg_icon":16,"#zoom_dropdown .svg_icon":7},callback:function(){a(".toolbar_button button > svg, .toolbar_button button > img").each(function(){a(this).parent().prepend(this)});a(".tool_button, .tool_button_current").addClass("loaded");var h=a("#tools_left");if(h.length!=0){h.offset();h.outerHeight()}a(".tools_flyout").each(function(){var m=a("#"+this.id+"_show"),o=m.attr("data-curopt");if(!m.children("svg, img").length){o=
a(o).children().clone();if(o.length){o[0].removeAttribute("style");m.append(o)}}});methodDraw.runCallbacks();setTimeout(function(){a(".flyout_arrow_horiz:empty").each(function(){a(this).append(a.getSvgIcon("arrow_right").width(5).height(5))})},1)}});a("#rulers").on("dblclick",function(h){a("#base_unit_container").css({top:h.pageY-10,left:h.pageX-50,display:"block"})});a("#base_unit_container").on("mouseleave mouseenter",function(){t=setTimeout(function(){a("#base_unit_container").fadeOut(500)},200);
event.type=="mouseover"&&clearTimeout(t)});a("#base_unit").on("change",function(){savePreferences()});b.canvas=f=new a.SvgCanvas(document.getElementById("svgcanvas"),curConfig);b.show_save_warning=false;b.paintBox={fill:null,stroke:null,canvas:null};c=navigator.platform.indexOf("Mac")>=0;var n=navigator.userAgent.indexOf("AppleWebKit")>=0,v=c?"meta+":"ctrl+",C=f.pathActions,q=f.undoMgr,M=svgedit.utilities,Q=curConfig.imgPath+"placeholder.svg",L=a("#workarea"),J=a("#cmenu_canvas"),Z=null,X=1,O="toolbars",
ha="";c||a(".shortcut").each(function(){var h=a(this).text();a(this).text(h.split("\u2318").join("Ctrl+"))});(function(){a("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *",containment:"window"});var h=a("#dialog_box"),m=a("#dialog_buttons"),o=function(u,E,H,I){a("#dialog_content").html("<p>"+E.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt",u=="prompt");m.empty();var N=a('<input type="button" value="'+uiStrings.common.ok+'">').appendTo(m);u!="alert"&&a('<input type="button" value="'+
uiStrings.common.cancel+'">').appendTo(m).on("click touchstart",function(){h.hide();H(false)});if(u=="prompt"){var U=a('<input type="text">').prependTo(m);U.val(I||"");U.bind("keydown","return",function(){N.trigger("click touchstart")})}u=="process"&&N.hide();h.show();N.on("click touchstart",function(){h.hide();var ba=u=="prompt"?U.val():true;H&&H(ba)}).focus();u=="prompt"&&U.focus()};a.alert=function(u,E){o("alert",u,E)};a.confirm=function(u,E){o("confirm",u,E)};a.process_cancel=function(u,E){o("process",
u,E)};a.prompt=function(u,E,H){o("prompt",u,H,E)}})();var pa=function(){var h=a(".tool_button_current");if(h.length&&h[0].id!=="tool_select"){h.removeClass("tool_button_current").addClass("tool_button");a("#tool_select").addClass("tool_button_current").removeClass("tool_button")}f.setMode("select")},Y=null,W=false,ea=false,Ea="",ma=function(h,m){var o=f.getResolution(),u=L;a("#svgcanvas").position();if(u=f.setBBoxZoom(m,u.width()-15,u.height()-15)){var E=u.zoom;u=u.bbox;if(E<0.0010)wa({value:0.1});
else{typeof animatedZoom!="undefined"&&h.cancelAnimationFrame(animatedZoom);var H=Date.now(),I=E-o.zoom;a("#zoom");var N=o.zoom,U=function(){var ba=(Date.now()-H)/500;ba=Math.pow(ba-1,3)+1;f.setZoom(N+I*ba);G();if(ba<1&&ba>-0.9)h.animatedZoom=requestAnimationFrame(U);else{a("#zoom").val(parseInt(E*100));a("option","#zoom_select").removeAttr("selected");a("option[value="+parseInt(E*100)+"]","#zoom_select").attr("selected","selected")}};U();f.getMode()=="zoom"&&u.width&&pa();xb()}}};a("#cur_context_panel").delegate("a",
"click",function(){var h=a(this);h.attr("data-root")?f.leaveContext():f.setContext(h.text());f.clearSelection();return false});var da=function(){b.paintBox.fill.prep();b.paintBox.stroke.prep()},S={},V=function(h){a.each(h,function(m,o){var u=a(m).children(),E=m+"_show",H=a(E),I=false;u.addClass("tool_button").unbind("click mousedown mouseup").each(function(ba){var R=o[ba];S[R.sel]=R.fn;if(R.isDefault)I=ba;ba=function(fa){var ga=R;if(fa.type==="keydown"){var T=a(ga.parent+"_show").hasClass("tool_button_current"),
qa=a(ga.parent+"_show").attr("data-curopt");a.each(h[R.parent],function(Aa,Ba){if(Ba.sel==qa)ga=!fa.shiftKey||!T?Ba:h[R.parent][Aa+1]||h[R.parent][0]})}if(a(this).hasClass("disabled"))return false;ra(E)&&ga.fn();var ua=ga.icon?a.getSvgIcon(ga.icon,true):a(ga.sel).children().eq(0).clone();ua[0].setAttribute("width",H.width());ua[0].setAttribute("height",H.height());H.children(":not(.flyout_arrow_horiz)").remove();H.append(ua).attr("data-curopt",ga.sel)};a(this).mouseup(ba);R.key&&a(document).bind("keydown",
R.key[0]+" shift+"+R.key[0],ba)});if(I)H.attr("data-curopt",o[I].sel);else H.attr("data-curopt")||H.attr("data-curopt",o[0].sel);var N,U=a(E).position();a(m).css({left:U.left+34,top:U.top+77});H.mousedown(function(ba){a("#workarea").one("mousedown",function(){a("#tools_shapelib").hide()});a("#tools_shapelib").is(":visible")&&ra(E,false);if(H.hasClass("disabled"))return false;var R=a(m),fa=U.left+34,ga=R.width()*-1,T=R.data("shown_popop")?200:0;if(ba.currentTarget.id==="tools_shapelib_show")T=R.data("shown_popop")?
0:0;N=setTimeout(function(){H.data("isLibrary")?R.css("left",fa).show():R.css("left",ga).show().animate({left:fa},50);R.data("shown_popop",true)},T);ba.preventDefault()}).mouseup(function(){clearTimeout(N);var ba=a(this).attr("data-curopt");if(H.data("isLibrary")&&a(E.replace("_show","")).is(":visible"))ra(E,true);else ra(E)&&ba in S&&S[ba]()})});la()},na=function(h,m){return a("<div>",{"class":"tools_flyout",id:h}).appendTo("#svg_editor").append(m)},oa=function(){a(".tools_flyout").each(function(){var h=
a("#"+this.id+"_show"),m=h.offset();h=h.outerWidth();a(this).css({left:(m.left+h)*X,top:m.top})})},la=function(){a(".tools_flyout").each(function(){var h=a("#"+this.id+"_show");if(!h.data("isLibrary")){var m=[];a(this).children().each(function(){m.push(this.title)});h[0].title=m.join(" / ")}})},ka,ya=function(h,m,o){var u=null;if(h.indexOf("url(#")===0){h=(h=f.getRefElem(h))?h.cloneNode(true):a("#"+o+"_color defs *")[0];u={alpha:m};u[h.tagName]=h}else u=h.indexOf("#")===0?{alpha:m,solidColor:h.substr(1)}:
{alpha:m,solidColor:"none"};return new a.jGraduate.Paint(u)},za=f.getResolution();if(curConfig.baseUnit!=="px"){za.w=svgedit.units.convertUnit(za.w)+curConfig.baseUnit;za.h=svgedit.units.convertUnit(za.h)+curConfig.baseUnit}var Ja=function(h){f.createLayer("background");cur_shape=f.addSvgElementFromJson({element:"rect",attr:{x:-1,y:-1,width:za.w+2,height:za.h+2,stroke:"none",id:"canvas_background",opacity:1,fill:h||"#fff",style:"pointer-events:none"}});f.setCurrentLayer("Layer 1");f.setCurrentLayerPosition("1")};
document.getElementById("canvas_background")||Ja();document.getElementById("canvas_background").getAttribute("fill");var Ia=b.setImageURL=function(h){h||(h=Q);f.setImageURL(h);a("#image_url").val(h)},Fa=function(){var h=Y;if(h!=null&&!h.parentNode)h=null;if(W&&W[0]!=null&&!W[0].parentNode)W=false;var m=f.getCurrentDrawing().getCurrentLayerName(),o=f.getMode(),u=curConfig.baseUnit!=="px"?curConfig.baseUnit:null,E=o=="pathedit";if(E){a(".context_panel").hide();a("#path_node_panel").show();a("#stroke_panel").hide();
m=C.getNodePoint();a("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button");a("#tool_node_delete").toggleClass("disabled",!C.canDeleteNodes);zb("#tool_openclose_path",C.closed_subpath?"open_path":"close_path");if(m){E=a("#seg_type");if(u){m.x=svgedit.units.convertUnit(m.x);m.y=svgedit.units.convertUnit(m.y)}a("#path_node_x").val(Math.round(m.x));a("#path_node_y").val(Math.round(m.y));if(m.type){E.val(m.type).removeAttr("disabled");a("#seg_type_label").html(m.type==4?"Straight":
"Curve")}else E.val(4).attr("disabled","disabled")}a("#tools_top").removeClass("multiselected");a("#stroke_panel").hide();a("#canvas_panel").hide()}else{var H=a("#cmenu_canvas li");a(".context_panel").hide();a(".menu_item","#edit_menu").addClass("disabled");a(".menu_item","#object_menu").addClass("disabled");if(W){W=W.filter(Boolean);(h=f.elementsAreSame(W)?W[0]:null)&&a("#tools_top").addClass("multiselected")}if(!h&&!W){a("#tools_top").removeClass("multiselected");a("#stroke_panel").hide();a("#canvas_panel").show()}if(h!=
null){a("#stroke_panel").show();var I=h.nodeName,N=f.getRotationAngle(h);a("#angle").val(Math.round(N));N=f.getBlur(h);a("#blur").val(N);if(!E&&o!="pathedit"){a("#selected_panel").show();a(".action_selected").removeClass("disabled");var U,ba;if(["g","polyline","path"].indexOf(I)>=0)if(o=f.getStrokedBBox([h])){U=o.x;ba=o.y}if(u){U=svgedit.units.convertUnit(U);ba=svgedit.units.convertUnit(ba)}a("#"+I+"_x").val(Math.round(U));a("#"+I+"_y").val(Math.round(ba));if(I==="polyline"){a("#path_x").val(Math.round(U));
a("#path_y").val(Math.round(ba))}["image","text","path","g","use"].indexOf(I)==-1&&a(".action_path_convert_selected").removeClass("disabled");I==="path"&&a(".action_path_selected").removeClass("disabled")}u=null;if(R==="a"){u=f.getHref(h);a("#g_panel").show()}if(h.parentNode.tagName==="a")if(!a(h).siblings().length){a("#a_panel").show();u=f.getHref(h.parentNode)}a("#tool_make_link, #tool_make_link").toggle(!u);u&&a("#link_url").val(u);u={g:[],a:[],rect:["rx","width","height","x","y"],image:["width",
"height","x","y"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:["x","y"],use:[],path:[]};var R=h.tagName;a(h).data("gsvg")&&a("#g_panel").show();if(R=="path"||R=="polyline")a("#path_panel").show();if(u[R]){u=u[R];a("#"+R+"_panel").show();R=="rect"?a("#cornerRadiusLabel").show():a("#cornerRadiusLabel").hide();a.each(u,function(fa,ga){var T=h.getAttribute(ga);if(curConfig.baseUnit!=="px"&&h[ga])T=svgedit.units.convertUnit(h[ga].baseVal.value);var qa=document.getElementById(R+
"_"+ga);qa.value=Math.round(T)||0;qa.getAttribute("data-cursor")==="true"&&a.fn.dragInput.updateCursor(qa)});if(R=="text"){u=h.getAttribute("font-family");document.getElementById("font_family_dropdown").selectedIndex=3;a("#text_panel").css("display","inline");a("#tool_italic").toggleClass("active",f.getItalic());a("#tool_bold").toggleClass("active",f.getBold());a("#font_family").val(u);a("#font_size").val(h.getAttribute("font-size"));a("#text").val(h.textContent);a("#preview_font").text(u.split(",")[0].replace(/'/g,
"")).css("font-family",u);f.addedNew&&setTimeout(function(){a("#text").focus().select()},100)}else if(R=="image")Ia(f.getHref(h));else if(R==="g"||R==="use"){a("#container_panel").show();a(".action_group_selected").removeClass("disabled");f.getTitle()}}H[(R==="g"?"en":"dis")+"ableContextMenuItems"]("#ungroup");H[(R==="g"||!W?"dis":"en")+"ableContextMenuItems"]("#group")}if(W){a("#multiselected_panel").show();a(".action_multi_selected").removeClass("disabled");H.enableContextMenuItems("#group").disableContextMenuItems("#ungroup")}h||
H.disableContextMenuItems("#delete,#cut,#copy,#group,#ungroup,#move_front,#move_up,#move_down,#move_back");q.getUndoStackSize()>0?a("#tool_undo").removeClass("disabled"):a("#tool_undo").addClass("disabled");q.getRedoStackSize()>0?a("#tool_redo").removeClass("disabled"):a("#tool_redo").addClass("disabled");f.addedNew=false;if(h&&!E||W){a("#selLayerNames").removeAttr("disabled").val(m);J.enableContextMenuItems("#delete,#cut,#copy,#move_front,#move_up,#move_down,#move_back")}}};a("#text").on("focus",
function(){});a("#text").on("blur",function(){});f.bind("selected",function(h,m){var o=f.getMode();o==="select"&&pa();if(o==="pathedit")return Fa();Y=m.length==1||m[1]==null?m[0]:null;m=m.filter(Boolean);W=m.length>=2?m:false;if(f.elementsAreSame(W))Y=W[0];if(Y!=null){a("#multiselected_panel").hide();if(Y!=null)switch(Y.tagName){case "use":a(".context_panel").hide();a("#use_panel").show();break;case "image":a(".context_panel").hide();a("#image_panel").show();break;case "foreignObject":a(".context_panel").hide();
break;case "g":case "a":o=null;for(var u=Y.getElementsByTagName("*"),E=0,H=u.length;E<H;E++){var I=u[E].getAttribute("stroke-width");if(E===0)o=I;else if(o!==I)o=null}a("#stroke_width").val(o===null?"0":o);Fa();break;default:a("#stroke_width").val(Y.getAttribute("stroke-width")||0);o=Y.getAttribute("stroke-dasharray")||"none";a("option","#stroke_style").removeAttr("selected");a('#stroke_style option[value="'+o+'"]').attr("selected","selected");a("#stroke_style").trigger("change");a.fn.dragInput.updateCursor(a("#stroke_width")[0]);
a.fn.dragInput.updateCursor(a("#blur")[0])}if(Y!=null){o=(Y.getAttribute("opacity")||1)*100;a("#group_opacity").val(o);a.fn.dragInput.updateCursor(a("#group_opacity")[0])}W.length&&a("#tools_top").addClass("multiselected")}else if(W.length){a(".context_panel").hide();a("#tools_top").removeClass("multiselected");a("#multiselected_panel").show()}else{a(".context_panel").hide();a("#canvas_panel").show();a("#tools_top").removeClass("multiselected")}f.runExtensions("selectedChanged",{elems:m,selectedElement:Y,
multiselected:W})});f.bind("transition",function(h,m){var o=f.getMode(),u=m[0];if(u){W=m.length>=2&&m[1]!=null?m:null;if(!W)switch(o){case "rotate":o=f.getRotationAngle(u);a("#angle").val(Math.round(o));rotateCursor(o);a("#tool_reorient").toggleClass("disabled",o==0)}f.runExtensions("elementTransition",{elems:m})}});f.bind("changed",function(h,m){var o=f.getMode();o==="select"&&pa();for(var u=0;u<m.length;++u){var E=m[u];if(E&&E.tagName==="svg")G();else if(E&&Y&&Y.parentNode==null)Y=E}b.show_save_warning=
true;Fa();if(Y&&o==="select"){b.paintBox.fill.update();b.paintBox.stroke.update()}f.runExtensions("elementChanged",{elems:m})});f.bind("saved",function(h,m){b.show_save_warning=false;m='<?xml version="1.0"?>\n'+m;var o=navigator.userAgent;if(~o.indexOf("MSIE"))Eb(0,true);else{var u=h.open("data:image/svg+xml;base64,"+M.encode64(m)),E=a.pref("save_notice_done");if(E!=="all"){var H=uiStrings.notification.saveFromBrowser.replace("%s","SVG");if(o.indexOf("Gecko/")!==-1)if(m.indexOf("<defs")!==-1){H+=
"\n\n"+uiStrings.notification.defsFailOnSave;a.pref("save_notice_done","all");E="all"}else a.pref("save_notice_done","part");else a.pref("save_notice_done","all");E!=="part"&&u.alert(H)}}});f.bind("exported",function(h,m){var o=m.issues;a("#export_canvas").length||a("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var u=a("#export_canvas")[0];u.width=f.contentW;u.height=f.contentH;canvg(u,m.svg,{renderCallback:function(){var E=u.toDataURL("image/png");Z.location.href=E;if(a.pref("export_notice_done")!==
"all"){E=uiStrings.notification.saveFromBrowser.replace("%s","PNG");if(o.length)E+="\n\n"+uiStrings.notification.noteTheseIssues+"\n \u2022 "+o.join("\n \u2022 ");a.pref("export_notice_done","all");Z.alert(E)}}})});f.bind("zoomed",ma);f.bind("contextset",function(h,m){var o="";if(m){var u="";o='<a href="#" data-root="y">'+f.getCurrentDrawing().getCurrentLayerName()+"</a>";a(m).parentsUntil("#svgcontent > g").andSelf().each(function(){if(this.id){u+=" > "+this.id;o+=this!==m?' > <a href="#">'+this.id+
"</a>":" > "+this.id}});Ea=u}else Ea=null;a("#cur_context_panel").toggle(!!m).html(o)});f.bind("extension_added",function(h,m){function o(){if(ka){clearTimeout(ka);ka=null}E||(ka=setTimeout(function(){E=true;Mb(A.iconsize)},50))}var u=false,E=false,H=true,I=function(){if(m.callback&&!u&&H){u=true;m.callback()}},N=[];m.context_tools&&a.each(m.context_tools,function(ga,T){var qa=T.container_id?' id="'+T.container_id+'"':"",ua=a("#"+T.panel);ua.length||(ua=a("<div>",{id:T.panel}).appendTo("#tools_top").hide());
switch(T.type){case "tool_button":var Aa='<div class="tool_button">'+T.id+"</div>",Ba=a(Aa).appendTo(ua);T.events&&a.each(T.events,function(Na,jb){a(Ba).bind(Na,jb)});break;case "select":Aa="<label"+qa+'><select id="'+T.id+'">';a.each(T.options,function(Na,jb){Aa+='<option value="'+Na+'"'+(Na==T.defval?" selected":"")+">"+jb+"</option>"});Aa+="</select></label>";var Pa=a(Aa).appendTo(ua).find("select");a.each(T.events,function(Na,jb){a(Pa).bind(Na,jb)});break;case "button-select":Aa='<div id="'+T.id+
'" class="dropdown toolset" title="'+T.title+'"><div id="cur_'+T.id+'" class="icon_label"></div><button></button></div>';qa=a('<ul id="'+T.id+'_opts"></ul>').appendTo("#option_lists");T.colnum&&qa.addClass("optcols"+T.colnum);a(Aa).appendTo(ua).children();N.push({elem:"#"+T.id,list:"#"+T.id+"_opts",title:T.title,callback:T.events.change,cur:"#cur_"+T.id});break;case "input":Aa="<label"+qa+'><span id="'+T.id+'_label">'+T.label+':</span><input id="'+T.id+'" title="'+T.title+'" size="'+(T.size||"4")+
'" value="'+(T.defval||"")+'" type="text"/></label>';var Qa=a(Aa).appendTo(ua).find("input");T.spindata&&Qa.SpinButton(T.spindata);T.events&&a.each(T.events,function(Na,jb){Qa.bind(Na,jb)})}});if(m.buttons){var U={},ba={},R=m.svgicons,fa={};a.each(m.buttons,function(ga,T){for(var qa,ua=T.id,Aa=ga;a("#"+ua).length;)ua=T.id+"_"+ ++Aa;if(R){U[ua]=T.icon;Aa=T.svgicon?T.svgicon:T.id;if(T.type=="app_menu")ba["#"+ua+" > div"]=Aa;else ba["#"+ua]=Aa}else qa=T.type=="menu"?"":a('<img src="'+T.icon+'">');var Ba,
Pa;switch(T.type){case "mode_flyout":case "mode":Ba="tool_button";if(T.cls)Ba+=" "+T.cls;Pa="#tools_left";break;case "context":Ba="tool_button";Pa="#"+T.panel;a(Pa).length||a("<div>",{id:T.panel}).appendTo("#tools_top");break;case "menu":Ba="menu_item tool_button";Pa="#"+(T.after||T.panel);break;case "app_menu":Ba="";Pa=T.parent||"#main_menu ul";a(Pa).length||a("<div>",{id:T.panel}).appendTo("#tools_top")}var Qa=a(T.list||T.type=="app_menu"?"<li/>":"<div/>").attr("id",ua).attr("title",T.title).addClass(Ba);
if(!T.includeWith&&!T.list){if("position"in T)a(Pa).children().eq(T.position).before(Qa);else T.type!="menu"||!T.after?Qa.appendTo(Pa):a(Pa).after(Qa);if(T.type=="mode_flyout"){Aa=a(Qa);Ba=Aa.parent();if(!Aa.parent().hasClass("tools_flyout")){var Na=Aa[0].id.replace("tool_","tools_"),jb=Aa.clone().attr("id",Na+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));Aa.before(jb);Ba=na(Na,Aa);Ba.data("isLibrary",true);jb.data("isLibrary",true)}ba["#"+Na+"_show"]=T.id;ua=fa["#"+Ba[0].id]=[{sel:"#"+
ua,fn:T.events.click,icon:T.id,isDefault:true},ub]}else if(T.type=="app_menu"||T.type=="menu")Qa.append(T.title)}else if(T.list){Qa.addClass("push_button");a("#"+T.list+"_opts").append(Qa);if(T.isDefault){a("#cur_"+T.list).append(Qa.children().clone());Aa=T.svgicon?T.svgicon:T.id;ba["#cur_"+T.list]=Aa}}else if(T.includeWith){Pa=T.includeWith;Aa=a(Pa.button);Ba=Aa.parent();if(!Aa.parent().hasClass("tools_flyout")){Na=Aa[0].id.replace("tool_","tools_");jb=Aa.clone().attr("id",Na+"_show").append(a("<div>",
{"class":"flyout_arrow_horiz"}));Aa.before(jb);Ba=na(Na,Aa)}var ub=B.getButtonData(Pa.button);if(Pa.isDefault)ba["#"+Na+"_show"]=T.id;ua=fa["#"+Ba[0].id]=[{sel:"#"+ua,fn:T.events.click,icon:T.id,key:T.key,isDefault:T.includeWith?T.includeWith.isDefault:0},ub];Na="position"in Pa?Pa.position:"last";ub=Ba.children().length;if(!isNaN(Na)&&Na>=0&&Na<ub)Ba.children().eq(Na).before(Qa);else{Ba.append(Qa);ua.reverse()}}R||Qa.append(qa);T.list||a.each(T.events,function(Cb,Jb){if(Cb=="click")if(T.type=="mode"){T.includeWith?
Qa.bind(Cb,Jb):Qa.bind(Cb,function(){ra(Qa)&&Jb()});if(T.key){a(document).bind("keydown",T.key,Jb);T.title&&Qa.attr("title",T.title+" ["+T.key+"]")}}else Qa.bind(Cb,Jb);else Qa.bind(Cb,Jb)});V(fa)});a.each(N,function(){vb(this.elem,this.list,this.callback,{seticon:true})});if(R)H=false;a.svgIcons(R,{w:27,h:27,id_match:false,no_img:!n,fallback:U,placement:ba,callback:function(){A.iconsize&&A.iconsize!="m"&&o();H=true;I()}})}I()});f.textActions.setInputElem(a("#text")[0]);var Ma='<div class="palette_item transparent" data-rgb="none"></div>\t\t\t\t\t\t\t\t<div class="palette_item black" data-rgb="#000000"></div>\t\t\t\t\t\t\t\t<div class="palette_item white" data-rgb="#ffffff"></div>';
["#444444","#482816","#422C10","#3B2F0E","#32320F","#293414","#1F361B","#153723","#0C372C","#083734","#0E353B","#1A333F","#273141","#332D40","#3E2A3C","#462735","#4B252D","#4D2425","#4C261D","#666666","#845335","#7B572D","#6F5C2A","#62612C","#546433","#46673D","#396849","#306856","#2D6862","#33666C","#426373","#535F75","#645A73","#74556D","#805064","#884D58","#8B4D4B","#894F3F","#999999","#C48157","#B8874D","#A98E49","#97944B","#849854","#729C62","#619E73","#559E84","#529D94","#5B9BA2","#6D97AB",
"#8391AE","#9A8AAB","#AF84A3","#BF7E96","#C97A86","#CE7975","#CC7C65","#BBBBBB","#FFB27C","#FABA6F","#E6C36A","#CFCA6D","#B8D078","#A0D58A","#8CD79F","#7DD8B5","#7AD6CA","#84D3DB","#9ACEE6","#B6C7EA","#D3BEE7","#EDB6DC","#FFAFCC","#FFAAB8","#FFA9A2","#FFAC8D","#DDDDDD","#FFE7A2","#FFF093","#FFFA8D","#FFFF91","#EEFF9F","#D1FFB4","#B9FFCE","#A8FFE9","#A4FFFF","#B1FFFF","#CBFFFF","#EDFFFF","#FFF5FF","#FFEBFF","#FFE2FF","#FFDCEC","#FFDBD2","#FFDFB8"].forEach(function(h){Ma+='<div class="palette_item" style="background-color: '+
h+';" data-rgb="'+h+'"></div>'});a("#palette").append(Ma);var Ca=a("#tool_angle_indicator");a("#tool_reorient");rotateCursor=function(h){h="rotate("+h+"deg)";Ca.css({"-webkit-transform":h,"-moz-transform":h,"-o-transform":h,"-ms-transform":h,transform:h})};var wa=function(h){var m=h.value/100;if(m<0.0010)h.value=0.1;else{h=f.getZoom();var o=L;ma(window,{width:0,height:0,x:(o[0].scrollLeft+o.width()/2)/h,y:(o[0].scrollTop+o.height()/2)/h,zoom:m},true)}};a("#stroke_style").change(function(){f.setStrokeAttr("stroke-dasharray",
a(this).val());a("#stroke_style_label").html(this.options[this.selectedIndex].text);window.opera&&a("<p/>").hide().appendTo("body").remove()});a("#seg_type").change(function(){f.setSegType(a(this).val());a("#seg_type_label").html(this.options[this.selectedIndex].text)});a("select").change(function(){a(this).blur()});a("#font_family").change(function(){f.setFontFamily(this.value)});a("#text").keyup(function(){f.setTextContent(this.value)});changeAttribute=function(h){var m=h.getAttribute("data-attr"),
o=h.getAttribute("data-multiplier")||1;o=parseFloat(o);o=h.value*o;if(!svgedit.units.isValidUnit(m,o,Y)){a.alert(uiStrings.notification.invalidAttrValGiven);h.value=Y.getAttribute(m);return false}f.changeSelectedAttributeNoUndo(m,o)};picking=false;a(document).on("mouseup",function(){picking=false});a("#palette").on("mousemove mousedown touchstart touchmove",".palette_item",function(h){h.preventDefault();if(h.type=="mousedown")picking=true;if(picking){var m=a("#tool_stroke").hasClass("active"),o=m?
"stroke":"fill",u=a(this).attr("data-rgb"),E=null,H=true;if(h.type=="mousedown")H=false;if(u==="transparent"||u==="initial"||u==="#none"){u="none";E=new a.jGraduate.Paint}else E=new a.jGraduate.Paint({alpha:100,solidColor:u.substr(1)});b.paintBox[o].setPaint(E);if(m){f.setColor("stroke",u,H);u!="none"&&f.getStrokeOpacity()!=1&&f.setPaintOpacity("stroke",1)}else{f.setColor("fill",u,H);u!="none"&&f.getFillOpacity()!=1&&f.setPaintOpacity("fill",1)}}}).bind("contextmenu",function(h){h.preventDefault()});
a("#toggle_stroke_tools").toggle(function(){a(".stroke_tool").css("display","table-cell");a(this).addClass("expanded");Db()},function(){a(".stroke_tool").css("display","none");a(this).removeClass("expanded");Db()});var ra=function(h,m){if(a(h).hasClass("disabled"))return false;if(a(h).parent().hasClass("tools_flyout"))return true;var o=o||"normal";m||a(".tools_flyout").fadeOut(o);a("#styleoverrides").text("");a(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");a(h).addClass("tool_button_current").removeClass("tool_button");
return true};(function(){var h=null,m=null,o=L[0],u=false,E=false;a("#svgcanvas").on("mousemove mouseup touchend",function(H){if(u!==false){o.scrollLeft-=H.clientX-h;o.scrollTop-=H.clientY-m;h=H.clientX;m=H.clientY;if(H.type==="mouseup"||H.type==="touchend")u=false;return false}}).on("mousedown touchmove",function(H){if(H.button===1||E===true||H.originalEvent.touches&&H.originalEvent.touches.length>=2){u=true;h=H.clientX;m=H.clientY;return false}});a(window).mouseup(function(){u=false});a(document).bind("keydown",
"space",function(H){H.preventDefault();f.spaceKey=E=true}).bind("keyup","space",function(H){H.preventDefault();f.spaceKey=E=false}).bind("keydown","alt",function(){f.getMode()==="zoom"&&L.addClass("out")}).bind("keyup","alt",function(){f.getMode()==="zoom"&&L.removeClass("out")})})();var va=a(".menu"),kb=function(h){h.target.style.background="#fff";setTimeout(function(){h.target.style.background="#ddd"},50);setTimeout(function(){h.target.style.background="#fff"},150);setTimeout(function(){h.target.style.background=
"#ddd"},200);setTimeout(function(){h.target.style.background=""},200);setTimeout(function(){a("#menu_bar").removeClass("active")},220);return false};a(".menu_item").on("mousedown touchstart",function(h){kb(h)});a("svg, body").on("mousedown  touchstart",function(h){if(!(h.target.nodeName&&h.target.nodeName.toLowerCase()==="input"))if(!a(h.target).hasClass("menu_title")&&!a(h.target).parent().hasClass("menu_title"))!a(h.target).hasClass("disabled")&&a(h.target).hasClass("menu_item")?kb(h):a("#menu_bar").removeClass("active")});
a("#workarea").on("mousewheel",function(h,m,o,u){if(h.altKey){h.preventDefault();zoom=parseInt(a("#zoom").val());a("#zoom").val(parseInt(zoom+u*10)).change()}});a(".menu_title").on("mousedown",function(){a("#tools_shapelib").hide();a("#menu_bar").toggleClass("active");va.removeClass("open");a(this).parent().addClass("open")}).on("mouseover",function(){va.removeClass("open");a(this).parent().addClass("open")});b.addDropDown=function(h,m,o){if(a(h).length!=0){var u=a(h).find("button"),E=a(h).find("ul").attr("id",
a(h)[0].id+"-list");o||a("#option_lists").append(E);var H=false;o&&a(h).addClass("dropup");E.find("li").bind("mouseup",m);a(window).mouseup(function(){if(!H){u.removeClass("down");E.hide()}H=false});u.bind("mousedown",function(){if(u.hasClass("down")){u.removeClass("down");E.hide()}else{u.addClass("down");if(!o){var I=a(h).offset();E.css({top:I.top,left:I.left-110})}E.show();H=true}}).hover(function(){H=true}).mouseout(function(){H=false})}};var vb=function(h,m,o,u){var E=a(h);m=a(m);var H=false,
I=u.dropUp;I&&a(h).addClass("dropup");m.find("li").bind("mouseup",function(){if(u.seticon){zb("#cur_"+E[0].id,a(this).children());a(this).addClass("current").siblings().removeClass("current")}o.apply(this,arguments)});a(window).mouseup(function(){if(!H){E.removeClass("down");m.hide();m.css({top:0,left:0})}H=false});m.height();a(h).bind("mousedown",function(){var N=a(h).offset();if(I){N.top-=m.height();N.left+=8}else N.top+=a(h).height();a(m).offset(N);if(E.hasClass("down")){E.removeClass("down");
m.hide();m.css({top:0,left:0})}else{E.addClass("down");m.show();H=true;return false}}).hover(function(){H=true}).mouseout(function(){H=false});u.multiclick&&m.mousedown(function(){H=true})};a("#font_family_dropdown").change(function(){var h=this.options[this.selectedIndex].value,m=this.options[this.selectedIndex].text;a("#preview_font").html(m).css("font-family",h);a("#font_family").val(h).change()});a("div","#position_opts").each(function(){this.addEventListener("mouseup",function(){var h=this.id.replace("tool_pos",
"").charAt(0);f.alignSelectedElements(h,"page")})});(function(){var h,m=function(){a(h).blur()};a("#svg_editor").find("button, select, input:not(#text)").focus(function(){h=this;O="toolbars";L.mousedown(m)}).blur(function(){O="canvas";L.unbind("mousedown",m);f.getMode()=="textedit"&&a("#text").focus()})})();var cb=function(){ra("#tool_select")&&f.setMode("select")},Ta=function(){ra("#tool_fhpath")&&f.setMode("fhpath")},Va=function(){ra("#tool_line")&&f.setMode("line")},Ga=function(){ra("#tool_rect")&&
f.setMode("rect")},ta=function(){ra("#tool_ellipse")&&f.setMode("ellipse")},$a=function(){ra("#tool_image")&&f.setMode("image")},Ka=function(){ra("#tool_zoom")&&f.setMode("zoom")},Sa=function(){if(ra("#tool_zoom")){yb();pa()}},Ha=function(){ra("#tool_text")&&f.setMode("text")},db=function(){ra("#tool_path")&&f.setMode("path")},lb=function(){if(Y!=null||W)f.deleteSelectedElements();C.getNodePoint()&&C.deletePathNode()},Ua=function(){if(Y!=null||W){xa(a("#edit_menu"));f.cutSelectedElements()}},Xa=function(){if(Y!=
null||W){xa(a("#edit_menu"));f.copySelectedElements()}},wb=function(){xa(a("#edit_menu"));var h=f.getZoom(),m=(L[0].scrollLeft+L.width()/2)/h-f.contentW;h=(L[0].scrollTop+L.height()/2)/h-f.contentH;f.pasteElements("point",m,h)},sa=function(){if(Y!=null){xa(a("#object_menu"));f.moveToTopSelectedElement()}},hb=function(){if(Y!=null){xa(a("#object_menu"));f.moveToBottomSelectedElement()}},eb=function(){if(Y!=null){xa(a("#object_menu"));f.moveUpDownSelected("Up")}},sb=function(){if(Y!=null){xa(a("#object_menu"));
f.moveUpDownSelected("Down")}},ib=function(h){if(Y!=null){xa(a("#object_menu"));f.moveUpDownSelected(h)}},ab=function(){if(Y!=null){f.convertToPath();var h=f.getSelectedElems();f.selectorManager.requestSelector(h[0]).reset(h[0]);f.selectorManager.requestSelector(h[0]).selectorRect.setAttribute("display","none");f.setMode("pathedit");C.toEditMode(h[0]);f.clearSelection();Fa()}},ob=function(){Y!=null&&C.reorient()},pb=function(){if(Y!=null||W)a.prompt(uiStrings.notification.enterNewLinkURL,"http://",
function(h){h&&f.makeHyperlink(h)})},fb=function(h,m){if(Y!=null||W){if(curConfig.gridSnapping){var o=f.getZoom()*curConfig.snappingStep;h*=o;m*=o}a("input").blur();f.moveSelectedElements(h,m)}},tb=function(){},ia=function(){C.getNodePoint()&&C.clonePathNode()},aa=function(){C.getNodePoint()&&C.deletePathNode()},ja=function(){var h=a("#tool_add_subpath"),m=!h.hasClass("push_button_pressed");m?h.addClass("push_button_pressed").removeClass("tool_button"):h.removeClass("push_button_pressed").addClass("tool_button");
C.addSubPath(m)},K=function(){C.opencloseSubPath()},P=function(){f.cycleElement(1)},ca=function(){f.cycleElement(0)},Da=function(h,m){if(!(Y==null||W)){h||(m*=-1);var o=a("#angle").val()*1+m;f.setRotationAngle(o);Fa()}},Oa=function(){var h=curConfig.dimensions;a.confirm(uiStrings.notification.QwantToClear,function(m){if(m){pa();f.clear();f.setResolution(h[0],h[1]);G(true);yb();Fa();da();f.runExtensions("onNewDocument")}})},Wa=function(){f.setBold(!f.getBold());Fa()},Za=function(){f.setItalic(!f.getItalic());
Fa()},nb=function(){if(!d.pngsave){var h=uiStrings.notification.loadingImage;Z=window.open("data:text/html;charset=utf-8,<title>"+h+"</title><h1>"+h+"</h1>")}window.canvg?f.rasterExport():a.getScript("canvg/rgbcolor.js",function(){a.getScript("canvg/canvg.js",function(){f.rasterExport()})})},Ra=function(){f.open()},mb=function(){},xa=function(h){var m=h.prev();m.css({background:"white",color:"black"});setTimeout(function(){m.removeAttr("style")},200)},qb=function(){if(q.getUndoStackSize()>0){xa(a("#edit_menu"));
q.undo()}},rb=function(){if(q.getRedoStackSize()>0){xa(a("#edit_menu"));q.redo()}},Bb=function(){if(W){xa(a("#object_menu"));f.groupSelectedElements()}else if(Y){xa(a("#object_menu"));f.ungroupSelectedElement()}},Fb=function(){xa(a("#edit_menu"));f.cloneSelectedElements(20,20)},bb=function(){var h=this.id.replace("tool_align","").charAt(0);f.alignSelectedElements(h,a("#align_relative_to").val())},La=function(){var h=document.querySelector("#tool_stroke rect");a("#tool_stroke").toggleClass("active");
a("#tool_fill").toggleClass("active");var m=document.querySelector("#tool_fill rect"),o=m.getAttribute("fill"),u=h.getAttribute("fill");h=parseFloat(h.getAttribute("stroke-opacity"));if(isNaN(h))h=100;m=parseFloat(m.getAttribute("fill-opacity"));if(isNaN(m))m=100;u=ya(u,h,"stroke");o=ya(o,m,"fill");b.paintBox.fill.setPaint(u,true);b.paintBox.stroke.setPaint(o,true)},yb=function(h){var m=f.getResolution();h=h?m.zoom*h:1;a("#zoom").val(h*100);f.setZoom(h);xb();G(true)},Hb=function(){xa(a("#view_menu"));
!a("#tool_wireframe").hasClass("push_button_pressed")?a("#tool_wireframe").addClass("push_button_pressed"):a("#tool_wireframe").removeClass("push_button_pressed");L.toggleClass("wireframe");if(!k){var h=a("#wireframe_rules");h.length?h.empty():a('<style id="wireframe_rules"></style>').appendTo("head");xb()}},Gb=function(){xa(a("#view_menu"));var h=!a("#tool_snap").hasClass("push_button_pressed");h?a("#tool_snap").addClass("push_button_pressed"):a("#tool_snap").removeClass("push_button_pressed");curConfig.gridSnapping=
h},Ib=function(){window.self!=window.top&&top.exit_fullscreen()},Lb=function(){xa(a("#view_menu"));if(a("#tool_rulers").hasClass("push_button_pressed")){a("#tool_rulers").removeClass("push_button_pressed");a("#show_rulers").attr("checked",false);curConfig.showRulers=false}else{a("#tool_rulers").addClass("push_button_pressed");a("#show_rulers").attr("checked",true);curConfig.showRulers=true}a("#rulers").toggle(!!curConfig.showRulers)},xb=function(){if(!k){var h="#workarea.wireframe #svgcontent * { stroke-width: "+
1/f.getZoom()+"px; }";a("#wireframe_rules").text(L.hasClass("wireframe")?h:"")}},Eb=function(h,m){if(!ea){xa(a("#view_menu"));ea=true;a("#save_output_btns").toggle(!!m);a("#tool_source_back").toggle(!m);var o=ha=f.getSvgString();a("#svg_source_textarea").val(o);a("#svg_source_editor").fadeIn();a("#svg_source_textarea").focus().select()}},Kb=function(){if(ea){if(f.setSvgString(a("#svg_source_textarea").val())){f.clearSelection();Ya();yb();da()}else a.confirm(uiStrings.notification.QerrorsRevertToSource,
function(h){if(!h)return false;f.clearSelection();Ya();yb();da()});pa()}},zb=b.setIcon=function(h,m){var o=typeof m==="string"?a.getSvgIcon(m,true):m.clone();o?a(h).find("img").replaceWith(o):console.log("NOTE: Icon image missing: "+m)},gb;gb=function(){var h=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,m=document.getElementsByTagName("script")[0],o;for(o in m.style)if(h.test(o))return o.match(h)[0];if("WebkitOpacity"in m.style)return"Webkit";if("KhtmlOpacity"in m.style)return"Khtml";return""}();var Nb=
function(h,m){gb.toLowerCase();var o=["top","left","bottom","right"];h.each(function(){for(var u=a(this),E=u.outerWidth()*(m-1),H=u.outerHeight()*(m-1),I=0;I<4;I++){var N=o[I],U=u.data("orig_margin-"+N);if(U==null){U=parseInt(u.css("margin-"+N));u.data("orig_margin-"+N,U)}U=U*m;if(N==="right")U+=E;else if(N==="bottom")U+=H;u.css("margin-"+N,U)}})},Mb=b.setIconSize=function(h,m){if(!(h==A.size&&!m)){var o=a("#tools_top .toolset, #editor_panel > *, #history_panel > *,\t\t\t\t#main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,\t\t\t\t#g_panel > *, #tool_font_size > *, .tools_flyout"),
u=1;u=typeof h=="number"?h:{s:0.75,m:1,l:1.25,xl:1.5}[h];b.tool_scale=X=u;oa();var E=o.parents(":hidden");E.css("visibility","hidden").show();Nb(o,u);E.css("visibility","visible").hide();o=a("#tool_size_rules");if(o.length)o.empty();else o=a('<style id="tool_size_rules"></style>').appendTo("head");if(h!="m"){var H="";a.each(cssResizeRules,function(I,N){I="#svg_editor "+I.replace(/,/g,", #svg_editor");H+=I+"{";a.each(N,function(U,ba){if(typeof ba==="number")var R=ba*u+"px";else if(ba[h]||ba.all)R=
ba[h]||ba.all;H+=U+":"+R+";"});H+="}"});E="-"+gb.toLowerCase()+"-";H+="#tools_top .toolset, #editor_panel > *, #history_panel > *,\t\t\t\t#main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,\t\t\t\t#g_panel > *, #tool_font_size > *, .tools_flyout{"+E+"transform: scale("+u+");} #svg_editor div.toolset .toolset {"+E+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+E+"transform: scale("+1/u+");}";o.text(H)}oa()}},Ab=function(){a("#dialog_box").hide();
if(ea){if(ea)ha!==a("#svg_source_textarea").val()?a.confirm(uiStrings.notification.QignoreSourceChanges,function(h){h&&Ya()}):Ya();Db()}else Ea&&f.leaveContext()},Ya=function(){a("#svg_source_editor").hide();ea=false;a("#svg_source_textarea").blur()};a(window).width();a(window).height();var Db=a.noop;a(window).resize(function(){G()});(function(){L.scroll(function(){if(a("#ruler_x").length!=0)a("#ruler_x")[0].scrollLeft=L[0].scrollLeft;if(a("#ruler_y").length!=0)a("#ruler_y")[0].scrollTop=L[0].scrollTop})})();
a("#url_notice").click(function(){a.alert(this.title)});a("#change_image_url").click(function(){var h=f.getHref(Y);h=h.indexOf("data:")===0?"":h;a.prompt(uiStrings.notification.enterNewImgURL,h,function(m){m&&Ia(m)})});var e=function(h){var m=h[0].id=="stroke_color"?"stroke":"fill",o=h[0].id=="canvas_color";if(o)m="canvas";var u=b.paintBox[m].paint;h=m=="stroke"?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity";o=o?{right:175,top:50}:{left:50,bottom:50};a("#color_picker").draggable({cancel:".jGraduate_tabs, .jGraduate_colPick, .jGraduate_gradPick, .jPicker",
containment:"window"}).removeAttr("style").css(o).jGraduate({paint:u,window:{pickerTitle:h},images:{clientPath:curConfig.jGraduatePath},newstop:"inverse"},function(E){u=new a.jGraduate.Paint(E);b.paintBox[m].setPaint(u);f.setPaint(m,u);a("#color_picker").hide()},function(){a("#color_picker").hide()})};c=function(h,m){var o=document.getElementById("canvas_background"),u={color:"fff",opacity:1};if(m=="stroke")u=curConfig.initStroke;if(m=="fill")u=curConfig.initFill;if(m=="canvas"&&o)if(o=o.getAttribute("fill").match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))u=
{color:("0"+parseInt(o[1],10).toString(16)).slice(-2)+("0"+parseInt(o[2],10).toString(16)).slice(-2)+("0"+parseInt(o[3],10).toString(16)).slice(-2),opacity:1};o=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%"\t\t\t\t\tfill="#'+u.color+'" opacity="'+u.opacity+'"/>\t\t\t\t\t<defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml").documentElement;o=a(h)[0].appendChild(document.importNode(o,true));m==="canvas"?o.setAttribute("width",60.5):
o.setAttribute("width","100%");this.rect=o.firstChild;this.defs=o.getElementsByTagName("defs")[0];this.grad=this.defs.firstChild;this.paint=new a.jGraduate.Paint({solidColor:u.color});this.type=m;this.setPaint=function(E,H){this.paint=E;var I="none",N=E.type,U=E.alpha/100;switch(N){case "solidColor":I=E[N]=="none"||E[N]=="one"?"none":"#"+E[N];break;case "linearGradient":case "radialGradient":this.defs.removeChild(this.grad);this.grad=this.defs.appendChild(E[N]);I="url(#"+(this.grad.id="gradbox_"+
this.type)+")"}this.rect.setAttribute("fill",I);this.rect.setAttribute("opacity",U);if(this.type=="canvas")if(N=document.getElementById("canvas_background")){za=f.getResolution();N.setAttribute("x",-1);N.setAttribute("y",-1);N.setAttribute("width",za.w+2);N.setAttribute("height",za.h+2);I.indexOf("url")==-1&&N.setAttribute("fill",I)}else Ja(I);if(H){f.setColor(this.type,I,true);f.setPaintOpacity(this.type,U,true)}};this.update=function(E){if(Y){var H=this.type;switch(Y.tagName){case "use":case "image":case "foreignObject":return;
case "g":case "a":for(var I=null,N=Y.getElementsByTagName("*"),U=0,ba=N.length;U<ba;U++){var R=N[U].getAttribute(H);if(U===0)I=R;else if(I!==R){I=null;break}}if(I===null){N=null;return}N=I;I=1;break;default:I=parseFloat(Y.getAttribute(H+"-opacity"));if(isNaN(I))I=1;N=H==="fill"?"black":"none";N=Y.getAttribute(H)||N}if(E){f.setColor(H,N,true);f.setPaintOpacity(H,I,true)}I*=100;this.setPaint(ya(N,I,H))}};this.prep=function(){switch(this.paint.type){case "linearGradient":case "radialGradient":var E=
new a.jGraduate.Paint({copy:this.paint});f.setPaint(m,E)}}};b.paintBox.fill=new c("#fill_color","fill");b.paintBox.stroke=new c("#stroke_color","stroke");b.paintBox.canvas=new c("#canvas_color","canvas");a("#stroke_width").val(curConfig.initStroke.width);a("#group_opacity").val(curConfig.initOpacity*100);c=b.paintBox.fill.rect.cloneNode(false);c.setAttribute("style","vector-effect:non-scaling-stroke");var k=c.style.vectorEffect==="non-scaling-stroke";c.removeAttribute("style");c=b.paintBox.fill.rect.ownerDocument.createElementNS("http://www.w3.org/2000/svg",
"feGaussianBlur");typeof c.stdDeviationX==="undefined"&&a("#tool_blur").hide();a(c).remove();setTimeout(function(){f.embedImage("images/placeholder.svg",function(h){if(!h){a("#image_save_opts [value=embed]").attr("disabled","disabled");a("#image_save_opts input").val(["ref"]);A.img_save="ref";a("#image_opt_embed").css("color","#666").attr("title",uiStrings.notification.featNotSupported)}})},1E3);a("#tool_fill").click(function(){if(a("#tool_fill").hasClass("active"))e(a("#fill_color"));else{a("#tool_fill").addClass("active");
a("#tool_stroke").removeClass("active")}});a("#tool_stroke").on("click",function(){if(a("#tool_stroke").hasClass("active"))e(a("#stroke_color"));else{a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active")}});a("#tool_canvas").on("click touchstart",function(){e(a("#canvas_color"))});a("#tool_stroke").on("touchstart",function(){a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active");e(a("#stroke_color"))});a("#tool_fill").on("touchstart",function(){a("#tool_fill").addClass("active");
a("#tool_stroke").removeClass("active");e(a("#fill_color"))});a("#zoom_select").on("change",function(){var h=this.options[this.selectedIndex].text;h=h.split("%")[0];a("#zoom").val(h).trigger("change")});a(".push_button").mousedown(function(){a(this).hasClass("disabled")||a(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){a(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){a(this).removeClass("push_button_pressed").addClass("push_button")});
a(window).bind("load resize",function(){L.css("line-height",L.height()+"px")});var l=function(){var h=a("#canvas_width"),m=a("#canvas_height"),o=h.val(),u=m.val();if(o!="fit"&&!svgedit.units.isValidUnit("width",o)){a.alert(uiStrings.notification.invalidAttrValGiven);h.parent().addClass("error");return false}h.parent().removeClass("error");if(u!="fit"&&!svgedit.units.isValidUnit("height",u)){a.alert(uiStrings.notification.invalidAttrValGiven);m.parent().addClass("error");return false}m.parent().removeClass("error");
if(!f.setResolution(o,u)){a.alert(uiStrings.notification.noContentToFitTo);o=f.getResolution();h.val(o.w);m.val(o.h);return false}G()};a("#resolution").change(function(){var h=a("#canvas_width")[0],m=a("#canvas_height")[0];if(this.selectedIndex)if(this.value=="content"){h.value="fit";m.value="fit";l();var o=f.getResolution();h.value=o.w;m.value=o.h}else{var u=this.value.split("x");u[0]=parseInt(u[0]);u[1]=parseInt(u[1]);var E=u[0]-h.value,H=u[1]-m.value,I=Date.now(),N=function(U){U=(U-I)/1E3;U=Math.pow(U-
1,3)+1;h.value=(u[0]-E+U*E).toFixed(0);m.value=(u[1]-H+U*H).toFixed(0);l();if(U>=1){U=f.getResolution();a("#canvas_width").val(U.w.toFixed());a("#canvas_height").val(U.h.toFixed());a("#resolution_label").html("<div class='pull'>"+U.w+"<span>\u00d7</span></br>"+U.h+"</div>")}else requestAnimationFrame(N)};N(Date.now())}else{a("#resolution_label").html("Custom");h.removeAttribute("readonly");h.focus();h.select();if(h.value=="fit"){h.value=100;m.value=100}}});a("#zoom").change(function(){wa(this)});
a("input,select").attr("autocomplete","off");var B=function(){var h=[{sel:"#tool_select",fn:cb,evt:"click",key:["V",true]},{sel:"#tool_fhpath",fn:Ta,evt:"click",key:["Q",true]},{sel:"#tool_line",fn:Va,evt:"click",key:["L",true]},{sel:"#tool_rect",fn:Ga,evt:"click",key:["R",true],icon:"rect"},{sel:"#tool_ellipse",fn:ta,evt:"mouseup",key:["C",true],icon:"ellipse"},{sel:"#tool_path",fn:db,evt:"click",key:["P",true]},{sel:"#tool_text",fn:Ha,evt:"click",key:["T",true]},{sel:"#tool_image",fn:$a,evt:"mouseup"},
{sel:"#tool_zoom",fn:Ka,evt:"mouseup",key:["Z",true]},{sel:"#tool_clear",fn:Oa,evt:"mouseup",key:[v+"N",true]},{sel:"#tool_save",fn:function(){if(ea)Kb();else{xa(a("#file_menu"));f.save({images:A.img_save,round_digits:6})}},evt:"mouseup",key:[v+"S",true]},{sel:"#tool_export",fn:nb,evt:"mouseup"},{sel:"#tool_open",fn:Ra,evt:"mouseup"},{sel:"#tool_import",fn:mb,evt:"mouseup"},{sel:"#tool_source",fn:Eb,evt:"click",key:[v+"U",true]},{sel:"#tool_wireframe",fn:Hb,evt:"click"},{sel:"#tool_snap",fn:Gb,evt:"click"},
{sel:"#tool_rulers",fn:Lb,evt:"click"},{sel:"#tool_source_cancel,#svg_source_overlay,#tool_docprops_cancel,#tool_prefs_cancel",fn:Ab,evt:"click",key:["esc",false,false],hidekey:true},{sel:"#tool_source_save",fn:Kb,evt:"click"},{sel:"#tool_delete,#tool_delete_multi",fn:lb,evt:"click",key:["del/backspace",true]},{sel:"#tool_reorient",fn:ob,evt:"click"},{sel:"#tool_node_link",fn:tb,evt:"change"},{sel:"#tool_node_clone",fn:ia,evt:"click"},{sel:"#tool_node_delete",fn:aa,evt:"click"},{sel:"#tool_openclose_path",
fn:K,evt:"click"},{sel:"#tool_add_subpath",fn:ja,evt:"click"},{sel:"#tool_move_top",fn:sa,evt:"click",key:v+"shift+up"},{sel:"#tool_move_bottom",fn:hb,evt:"click",key:v+"shift+down"},{sel:"#tool_move_up",fn:eb,evt:"click",key:[v+"up",true]},{sel:"#tool_move_down",fn:sb,evt:"click",key:[v+"down",true]},{sel:"#tool_topath",fn:ab,evt:"click"},{sel:"#tool_make_link,#tool_make_link_multi",fn:pb,evt:"click"},{sel:"#tool_clone,#tool_clone_multi",fn:Fb,evt:"click",key:[v+"D",true]},{sel:"#tool_group",fn:Bb,
evt:"click",key:[v+"G",true]},{sel:"#tool_ungroup",fn:Bb,evt:"click",key:v+"shift+G"},{sel:"#tool_unlink_use",fn:Bb,evt:"click"},{sel:"[id^=tool_align]",fn:bb,evt:"click"},{sel:"#tool_undo",fn:qb,evt:"click",key:v+"z"},{sel:"#tool_redo",fn:rb,evt:"click",key:["y",true]},{sel:"#tool_cut",fn:Ua,evt:"click",key:[v+"x",true]},{sel:"#tool_copy",fn:Xa,evt:"click",key:v+"c"},{sel:"#tool_paste",fn:wb,evt:"click",key:v+"v"},{sel:"#tool_switch",fn:La,evt:"click",key:["x",true]},{sel:"#tool_bold",fn:Wa,evt:"mousedown",
key:[v+"B",true]},{sel:"#tool_italic",fn:Za,evt:"mousedown",key:[v+"I",true]},{sel:"#copy_save_done",fn:Ab,evt:"click"},{key:"ctrl+left",fn:function(){Da(0,1)}},{key:"ctrl+right",fn:function(){Da(1,1)}},{key:"ctrl+shift+left",fn:function(){Da(0,5)}},{key:"ctrl+shift+right",fn:function(){Da(1,5)}},{key:"shift+O",fn:ca},{key:"shift+P",fn:P},{key:[v+"+",true],fn:function(){yb(2)}},{key:[v+"-",true],fn:function(){yb(0.5)}},{key:["up",true],fn:function(){fb(0,-1)}},{key:["down",true],fn:function(){fb(0,
1)}},{key:["left",true],fn:function(){fb(-1,0)}},{key:["right",true],fn:function(){fb(1,0)}},{key:"shift+up",fn:function(){fb(0,-10)}},{key:"shift+down",fn:function(){fb(0,10)}},{key:"shift+left",fn:function(){fb(-10,0)}},{key:"shift+right",fn:function(){fb(10,0)}},{key:["alt+up",true],fn:function(){f.cloneSelectedElements(0,-1)}},{key:["alt+down",true],fn:function(){f.cloneSelectedElements(0,1)}},{key:["alt+left",true],fn:function(){f.cloneSelectedElements(-1,0)}},{key:["alt+right",true],fn:function(){f.cloneSelectedElements(1,
0)}},{key:["alt+shift+up",true],fn:function(){f.cloneSelectedElements(0,-10)}},{key:["alt+shift+down",true],fn:function(){f.cloneSelectedElements(0,10)}},{key:["alt+shift+left",true],fn:function(){f.cloneSelectedElements(-10,0)}},{key:["alt+shift+right",true],fn:function(){f.cloneSelectedElements(10,0)}},{key:v+"A",fn:function(){f.selectAllInCurrentLayer()}},{key:"I",fn:function(){var o=a(".tool_button_current");if(o.length&&o[0].id!=="tool_eyedropper"){o.removeClass("tool_button_current").addClass("tool_button");
a("#tool_eyedropper").addClass("tool_button_current").removeClass("tool_button")}f.setMode("eyedropper")}},{key:v+"shift+z",fn:rb},{key:"esc",fn:Ib}],m={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"};return{setAll:function(){var o={};a.each(h,function(u,E){if(E.sel){var H=a(E.sel);if(H.length==0)return true;if(E.evt){if(svgedit.browser.isTouch()&&E.evt==="click")E.evt="mousedown";H[E.evt](E.fn)}if(E.parent&&a(E.parent+"_show").length!=0){var I=a(E.parent);I.length||(I=na(E.parent.substr(1)));
I.append(H);a.isArray(o[E.parent])||(o[E.parent]=[]);o[E.parent].push(E)}}if(E.key){var N=E.fn,U=false;if(a.isArray(E.key)){I=E.key[0];if(E.key.length>1)U=E.key[1]}else I=E.key;I+="";svgedit.browser.isMac&&I.indexOf("+")!=-1&&I.split("+")[0]=="ctrl"&&I.replace("ctrl","cmd");a.each(I.split("/"),function(R,fa){a(document).bind("keydown",fa,function(ga){N();U&&ga.preventDefault();return false})});if(E.sel&&!E.hidekey&&H.attr("title")){var ba=H.attr("title").split("[")[0]+" ("+I+")";m[I]=E.sel;H.parents("#main_menu").length||
H.attr("title",ba)}}});V(o);a(window).bind("keydown","tab",function(u){if(O==="canvas"){u.preventDefault();P()}}).bind("keydown","shift+tab",function(u){if(O==="canvas"){u.preventDefault();ca()}});a("#tool_zoom").dblclick(Sa)},setTitles:function(){a.each(m,function(o,u){var E=a(u).parents("#main_menu").length;a(u).each(function(){var H=E?a(this).text().split(" [")[0]:this.title.split(" [")[0],I="";a.each(o.split("/"),function(N,U){var ba=U.split("+"),R="";if(ba.length>1){R=ba[0]+"+";U=ba[1]}I+=(N?
"/":"")+R+(uiStrings["key_"+U]||U)});if(E)this.lastChild.textContent=H+" ["+I+"]";else this.title=H+" ["+I+"]"})})},getButtonData:function(o){var u;a.each(h,function(E,H){if(H.sel===o)u=H});return u}}}();B.setAll();b.ready(function(){var h=curConfig.initTool,m=a("#tools_left, #svg_editor .tools_flyout"),o=m.find("#tool_"+h);h=m.find("#"+h);(o.length?o:h.length?h:a("#tool_select")).click().mouseup();curConfig.wireframe&&a("#tool_wireframe").click();curConfig.showlayers&&toggleSidePanel();a("#rulers").toggle(!!curConfig.showRulers)});
a("#canvas_height").dragInput({min:10,max:null,step:10,callback:l,cursor:false,dragAdjust:0.1});a("#canvas_width").dragInput({min:10,max:null,step:10,callback:l,cursor:false,dragAdjust:0.1});a("#rect_width").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cy").dragInput({min:1,max:null,
step:1,callback:changeAttribute,cursor:false});a("#ellipse_rx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_ry").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cy").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_r").dragInput({min:1,
max:null,step:1,callback:changeAttribute,cursor:false});a("#image_height").dragInput({min:0,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,
cursor:false});a("#image_width").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_x").dragInput({min:null,
max:null,step:1,callback:changeAttribute,cursor:false});a("#path_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_x").dragInput({min:null,
max:null,step:1,callback:changeAttribute,cursor:false});a("#text_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#text_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_rx").dragInput({min:0,max:100,step:1,callback:changeAttribute,cursor:true});a("#stroke_width").dragInput({min:0,max:99,step:1,callback:function(h){var m=h.value;if(m==0&&
Y&&["line","polyline"].indexOf(Y.nodeName)>=0)m=h.value=1;f.setStrokeWidth(m)},cursor:true,smallStep:0.1,start:1.5});a("#angle").dragInput({min:-180,max:180,step:1,callback:function(h){f.setRotationAngle(h.value,true);rotateCursor(h.value);a("#tool_reorient").toggleClass("disabled",h.value==0)},cursor:false,dragAdjust:0.5});a("#font_size").dragInput({min:1,max:250,step:1,callback:function(h){f.setFontSize(h.value)},cursor:true,stepfunc:function(h,m){var o=h.value-0,u=o+m,E=u>=o;if(m===0)return o;
return o>=24?E?Math.round(o*1.1):Math.round(o/1.1):o<=1?E?o*2:o/2:u},dragAdjust:0.15});a("#group_opacity").dragInput({min:0,max:100,step:5,callback:changeAttribute,cursor:true,start:100});a("#blur").dragInput({min:0,max:10,step:0.1,callback:function(h,m){val=h.value;a("#blur").val(val);m?f.setBlur(val,true):f.setBlurNoUndo(val)},cursor:true,start:0});a("#zoom").val(f.getZoom()*100);a("#workarea").contextMenu({menu:"cmenu_canvas",inSpeed:0},function(h){switch(h){case "delete":lb();break;case "cut":Ua();
break;case "copy":Xa();break;case "paste":f.pasteElements();break;case "paste_in_place":f.pasteElements("in_place");break;case "group":f.groupSelectedElements();break;case "ungroup":f.ungroupSelectedElement();break;case "move_front":sa();break;case "move_up":ib("Up");break;case "move_down":ib("Down");break;case "move_back":hb();break;default:svgedit.contextmenu&&svgedit.contextmenu.hasCustomHandler(h)&&svgedit.contextmenu.getCustomHandler(h).call()}});a(".contextMenu li").mousedown(function(h){h.preventDefault()});
a("#cmenu_canvas li").disableContextMenu();J.enableContextMenuItems("#delete,#cut,#copy");window.onbeforeunload=function(){if(q.getUndoStackSize()===0)b.show_save_warning=false;if(!curConfig.no_save_warning&&b.show_save_warning)return uiStrings.notification.unsavedChanges};b.openPrep=function(h){a("#main_menu").hide();q.getUndoStackSize()===0?h(true):a.confirm(uiStrings.notification.QwantToOpen,h)};if(window.FileReader){c=function(h){h.stopPropagation();h.preventDefault();a("#workarea").removeAttr("style");
a("#main_menu").hide();var m=null;if(m=h.type=="drop"?h.dataTransfer.files[0]:this.files[0])if(m.type.indexOf("image")!=-1)if(m.type.indexOf("svg")!=-1){h=new FileReader;h.onloadend=function(o){f.importSvgString(o.target.result,true);f.ungroupSelectedElement();f.ungroupSelectedElement();f.groupSelectedElements();f.alignSelectedElements("m","page");f.alignSelectedElements("c","page")};h.readAsText(m)}else{h=new FileReader;h.onloadend=function(o){insertNewImage=function(I,N){var U=f.addSvgElementFromJson({element:"image",
attr:{x:0,y:0,width:I,height:N,id:f.getNextId(),style:"pointer-events:inherit"}});f.setHref(U,o.target.result);f.selectOnly([U]);f.alignSelectedElements("m","page");f.alignSelectedElements("c","page");Fa()};var u=100,E=100,H=new Image;H.src=o.target.result;document.body.appendChild(H);H.onload=function(){u=H.offsetWidth;E=H.offsetHeight;insertNewImage(u,E);document.body.removeChild(H)}};h.readAsDataURL(m)}};L=a("#workarea");L[0].addEventListener("dragenter",function(h){h.stopPropagation();h.preventDefault();
L.css({"-webkit-transform":"scale3d(1.1,1.1,1)","-moz-transform":"scale3d(1.1,1.1,1)","-o-transform":"scale(1.1)","-ms-transform":"scale3d(1.1,1.1,1)",transform:"scale3d(1.1,1.1,1)"})},false);L[0].addEventListener("dragover",function(h){h.stopPropagation();h.preventDefault()},false);L[0].addEventListener("dragleave",function(h){L.removeAttr("style");h.stopPropagation();h.preventDefault()},false);L[0].addEventListener("drop",c,false);var z=a('<input type="file">').change(function(){var h=this;b.openPrep(function(m){if(m){f.clear();
if(h.files.length==1){m=new FileReader;m.onloadend=function(o){s(o.target.result);G()};m.readAsText(h.files[0])}}})});a("#tool_open").show().prepend(z);c=a('<input type="file">').change(c);a("#tool_import").show().prepend(c)}var G=b.updateCanvas=function(h,m){var o=L.width(),u=L.height(),E=o,H=u,I=f.getZoom(),N=L,U=a("#svgcanvas"),ba={x:N[0].scrollLeft+E/2,y:N[0].scrollTop+H/2},R=curConfig.canvas_expansion;o=Math.max(E,f.contentW*I*R);u=Math.max(H,f.contentH*I*R);o==E&&u==H?L.css("overflow","hidden"):
L.css("overflow","scroll");R=U.height()/2;var fa=U.width()/2;U.width(o).height(u);var ga=u/2,T=o/2,qa=f.updateCanvas(o,u),ua=T/fa;o=o/2-E/2;u=u/2-H/2;if(m){m.x+=qa.x;m.y+=qa.y}else m={x:T+(ba.x-fa)*ua,y:ga+(ba.y-R)*ua};if(h)if(f.contentW>N.width()){L[0].scrollLeft=qa.x-10;L[0].scrollTop=qa.y-10}else{N[0].scrollLeft=o;N[0].scrollTop=u}else{N[0].scrollLeft=m.x-E/2;N[0].scrollTop=m.y-H/2}if(curConfig.showRulers){E=U;I=I;document.getElementById("workarea");document.getElementById("title_show");I||(I=
f.getZoom());E||(E=a("#svgcanvas"));H=f.getContentElem();N=svgedit.units.getTypeMap()[curConfig.baseUnit];for(U=0;U<2;U++){fa=(ba=U===0)?"x":"y";ua=ba?"width":"height";R=H.getAttribute(fa)-0;fa=a("#ruler_"+fa+" canvas:first");$hcanv=fa.clone();fa.replaceWith($hcanv);o=$hcanv[0];ga=fa=E[ua]()*2;o.parentNode.style[ua]=ga+"px";T=0;var Aa;qa=o.getContext("2d");qa.fillStyle="rgb(200,0,0)";qa.fillRect(0,0,o.width,o.height);$hcanv.siblings().remove();if(fa>=3E4){var Ba=parseInt(fa/3E4)+1;Aa=Array(Ba);Aa[0]=
qa;for(u=1;u<Ba;u++){o[ua]=3E4;var Pa=o.cloneNode(true);o.parentNode.appendChild(Pa);Aa[u]=Pa.getContext("2d")}Pa[ua]=fa%3E4;fa=3E4}o[ua]=fa;ua=N*I;var Qa=50/ua;o=1;for(u=0;u<D.length;u++){o=Ba=D[u];if(Qa<=Ba)break}Qa=o*ua;qa.font="normal 9px 'Lucida Grande', sans-serif";qa.fillStyle="#777";for(var Na=R/ua%o*ua,jb=Na-Qa;Na<ga;Na+=Qa){jb+=Qa;u=Math.round(Na)+0.5;if(ba){qa.moveTo(u,15);qa.lineTo(u,0)}else{qa.moveTo(15,u);qa.lineTo(0,u)}Ba=(jb-R)/ua;if(o>=1)u=Math.round(Ba);else{u=(o+"").split(".")[1].length;
u=Ba.toFixed(u)-0}if(u!==0&&u!==1E3&&u%1E3===0)u=u/1E3+"K";if(ba){qa.fillText(u,Na+2,8);qa.fillStyle="#777"}else{Ba=(u+"").split("");for(u=0;u<Ba.length;u++){qa.fillText(Ba[u],1,Na+9+u*9);qa.fillStyle="#777"}}Ba=Qa/10;for(u=1;u<10;u++){var ub=Math.round(Na+Ba*u)+0.5;if(Aa&&ub>fa){T++;qa.stroke();if(T>=Aa.length){u=10;Na=ga;continue}qa=Aa[T];Na-=3E4;ub=Math.round(Na+Ba*u)+0.5}var Cb=u%2?12:10;if(ba){qa.moveTo(ub,15);qa.lineTo(ub,Cb)}else{qa.moveTo(15,ub);qa.lineTo(Cb,ub)}}}qa.strokeStyle="#666";qa.stroke()}L.scroll()}},
D=[];for(c=0.1;c<1E5;c*=10){D.push(1*c);D.push(2*c);D.push(5*c)}G(true);try{var w=function(h){if(window.JSON&&JSON.stringify)return JSON.stringify(h);var m=arguments.callee;if(typeof h=="boolean"||typeof h=="number")return h+"";else if(typeof h=="string")return'"'+h.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(E){return"\\u"+("0000"+E.charCodeAt(0).toString(16)).slice(-4)})+'"';else if(h.length){for(var o=
0;o<h.length;o++)h[o]=m(h[o]);return"["+h.join(",")+"]"}else{o=[];for(var u in h)o.push(m(u)+":"+m(h[u]));return"{"+o.join(",")+"}"}};window.addEventListener("message",function(h){var m=parseInt(h.data.substr(0,h.data.indexOf(";")));try{h.source.postMessage("SVGe"+m+";"+w(eval(h.data)),"*")}catch(o){h.source.postMessage("SVGe"+m+";error:"+o.message,"*")}},false)}catch(F){window.embed_error=F}a(function(){window.svgCanvas=f;f.ready=methodDraw.ready});b.setLang=function(h,m){a.pref("lang",h);a("#lang_select").val(h);
if(m){f.runExtensions("langChanged",h);la();a.each({"#stroke_color":"#tool_stroke .icon_label, #tool_stroke .color_block","#fill_color":"#tool_fill label, #tool_fill .color_block","#linejoin_miter":"#cur_linejoin","#linecap_butt":"#cur_linecap"},function(o,u){a(u).attr("title",a(o)[0].title)});a("#multiselected_panel div[id^=tool_align]").each(function(){a("#tool_pos"+this.id.substr(10))[0].title=this.title})}}};var g=[];b.ready=function(c){p?c():g.push(c)};b.runCallbacks=function(){a.each(g,function(){this()});
p=true};b.loadFromString=function(c){b.ready(function(){s(c)})};b.loadFromURL=function(c,n){n||(n={});var v=n.cache,C=n.callback;b.ready(function(){a.ajax({url:c,dataType:"text",cache:!!v,success:function(q){s(q,C)},error:function(q,M,Q){q.status!=404&&q.responseText?s(q.responseText,C):a.alert(uiStrings.notification.URLloadFail+": \n"+Q+"",C)}})})};b.loadFromDataURI=function(c){b.ready(function(){var n=c.substring(26);s(svgedit.utilities.decode64(n))})};b.addExtension=function(){var c=arguments;
a(function(){f&&f.addExtension.apply(this,c)})};return b}(jQuery);$(methodDraw.init)})();$.fn.dragInput=function(a){return this.each(function(){this.repeating=false;this.dragCfg={min:a&&!isNaN(parseFloat(a.min))?Number(a.min):null,max:a&&!isNaN(parseFloat(a.max))?Number(a.max):null,step:a&&Number(a.step)?a.step:1,stepfunc:a&&a.stepfunc?a.stepfunc:false,dragAdjust:a&&a.dragAdjust?a.dragAdjust:1,height:70,cursor:a&&a.cursor?Boolean(a.cursor):false,start:a&&a.start?Number(a.start):0,_btn_width:20,_direction:null,_delay:null,_repeat:null,callback:a&&a.callback?a.callback:null};this.dragCfg.smallStep=
a&&a.smallStep?a.smallStep:this.dragCfg.step/2;var s=this.dragCfg.dragAdjust,f=$(this).parent(),b=$(this),p=this.dragCfg.height,A=this.dragCfg.min,d=this.dragCfg.max,g=this.dragCfg.step,c=d-A>0?(d-A)/g:200,n=c/p*g,v=0,C=this.getAttribute("data-attr"),q=methodDraw.canvas,M=svgedit.browser.isTouch(),Q=true,L=c&&this.dragCfg.cursor?$("<div class='draginput_cursor' />").appendTo(f):false;b.attr("readonly","readonly");L&&!isNaN(this.dragCfg.start)&&L.css("top",this.dragCfg.start*-1/n+p);this.adjustValue=
function(J,Z){var X;J=parseFloat(J);X=isNaN(this.value)?this.dragCfg.reset:$.isFunction(this.dragCfg.stepfunc)?this.dragCfg.stepfunc(this,J):Number((Number(this.value)+Number(J)).toFixed(5));if(d!==null)X=Math.min(X,d);if(A!==null)X=Math.max(X,A);L&&this.updateCursor(X);this.value=X;f.attr("data-value",X);$.isFunction(this.dragCfg.callback)&&this.dragCfg.callback(this,Z)};f.toggleClass("draginput",f.is("label"));this.move=function(J,Z,X){if(M)J=J.originalEvent.touches[0];if(v===0)v=Z;Z=(J.pageY-v)*
-1;v=J.pageY;X=Z*n*s;this.adjustValue(X.toFixed(g<1?1:0))};this.stop=function(){var J=q.getSelectedElems();$("body").removeClass("dragging");f.removeClass("active");Q=true;$(window).unbind("mousemove.draginput touchmove.draginput mouseup.draginput touchend.draginput");v=0;if(J[0]){J=q.undoMgr.finishUndoableChange();J.isEmpty()||q.undoMgr.addCommandToHistory(J)}this.adjustValue(0,Q)};this.updateCursor=function(){var J=parseFloat(this.value)*-1/n+p;L.css("top",J)};this.launch=function(J){var Z=q.getSelectedElems();
if(M)J=J.originalEvent.touches[0];var X=J.pageY,O=this.value,ha=this;q.undoMgr.beginUndoableChange(C,Z);$("body").addClass("dragging");f.addClass("active");$(window).bind("mousemove.draginput touchmove.draginput",function(pa){ha.move(pa,X,parseFloat(O))});$(window).bind("mouseup.draginput touchend.draginput",function(){ha.stop()})};$(this).attr("readonly","readonly").attr("data-scale",n).attr("data-domain",p).attr("data-cursor",L!=false).bind("mousedown touchstart",function(J){this.blur();this.launch(J)}).bind("dblclick taphold",
function(){this.removeAttribute("readonly","readonly");this.focus();this.select()}).keydown(function(J){switch(J.keyCode){case 13:this.adjustValue(0);this.blur()}}).focus(function(){this.getAttribute("readonly")==="readonly"&&this.blur()}).blur(function(){this.setAttribute("readonly","readonly")}).bind("mousewheel",function(J,Z,X,O){Z=q.getSelectedElems();Q&&q.undoMgr.beginUndoableChange(C,Z);Q=false;clearTimeout(window.undoTimeout);window.undoTimeout=setTimeout(function(){ha.stop()},200);var ha=
this;if(O>0)this.adjustValue(this.dragCfg.step);else O<0&&this.adjustValue(-this.dragCfg.step);J.preventDefault()})})};$.fn.dragInput.updateCursor=function(a){var s=parseFloat(a.value),f=parseFloat(a.getAttribute("data-scale")),b=parseFloat(a.getAttribute("data-domain"));s=s*-1/f+b+"px";a=a.parentNode.lastChild;if(a.className=="draginput_cursor")a.style.top=s};svgedit=svgedit||{};
(function(){var a=this;if(!svgedit.contextmenu)svgedit.contextmenu={};a.contextMenuExtensions={};methodDraw.ready(function(){for(menuItem in contextMenuExtensions){var s=contextMenuExtensions[menuItem];Object.keys(a.contextMenuExtensions).length==0&&$("#cmenu_canvas").append("<li class='separator'>");var f=s.shortcut||"";$("#cmenu_canvas").append("<li class='disabled'><a href='#"+s.id+"'>"+s.label+"<span class='shortcut'>"+f+"</span></a></li>")}});svgedit.contextmenu.resetCustomMenus=function(){a.contextMenuExtensions=
{}};svgedit.contextmenu.add=function(s){if(s&&s.id&&s.label&&s.action&&typeof s.action=="function")if(s.id in a.contextMenuExtensions)console.error('Cannot add extension "'+s.id+'", an extension by that name already exists"');else{console.log("Registed contextmenu item: {id:"+s.id+", label:"+s.label+"}");a.contextMenuExtensions[s.id]=s}else console.error("Menu items must be defined and have at least properties: id, label, action, where action must be a function")};svgedit.contextmenu.hasCustomHandler=
function(s){return a.contextMenuExtensions[s]&&true};svgedit.contextmenu.getCustomHandler=function(s){return a.contextMenuExtensions[s].action}})();(function(a,s){function f(p){return!a(p).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}function b(p,A){var d=p.nodeName.toLowerCase();if("area"===d){d=p.parentNode;var g=d.name;if(!p.href||!g||d.nodeName.toLowerCase()!=="map")return false;d=a("img[usemap=#"+g+"]")[0];return!!d&&f(d)}return(/input|select|textarea|button|object/.test(d)?!p.disabled:"a"==d?p.href||A:A)&&f(p)}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.17",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(p,A){return typeof p=="number"?this.each(function(){var d=
this;setTimeout(function(){a(d).focus();A&&A.call(d)},p)}):this._focus.apply(this,arguments)},scrollParent:function(){var p;a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?p=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):p=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,
"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!p.length?a(document):p},zIndex:function(p){if(p!==s)return this.css("zIndex",p);if(this.length){p=a(this[0]);for(var A;p.length&&p[0]!==document;){A=p.css("position");if(A==="absolute"||A==="relative"||A==="fixed"){A=parseInt(p.css("zIndex"),10);if(!isNaN(A)&&A!==0)return A}p=p.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(p){p.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(p,A){function d(v,C,q,M){a.each(g,function(){C-=parseFloat(a.curCSS(v,"padding"+this,true))||0;q&&(C-=parseFloat(a.curCSS(v,"border"+this+"Width",true))||0);M&&(C-=parseFloat(a.curCSS(v,"margin"+this,true))||0)});return C}var g=A==="Width"?["Left","Right"]:["Top","Bottom"],c=A.toLowerCase(),n={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,
outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+A]=function(v){if(v===s)return n["inner"+A].call(this);return this.each(function(){a(this).css(c,d(this,v)+"px")})};a.fn["outer"+A]=function(v,C){if(typeof v!="number")return n["outer"+A].call(this,v);return this.each(function(){a(this).css(c,d(this,v,true,C)+"px")})}}),a.extend(a.expr[":"],{data:function(p,A,d){return!!a.data(p,d[3])},focusable:function(p){return b(p,!isNaN(a.attr(p,"tabindex")))},tabbable:function(p){var A=a.attr(p,
"tabindex"),d=isNaN(A);return(d||A>=0)&&b(p,!d)}}),a(function(){var p=document.body,A=p.appendChild(A=document.createElement("div"));a.extend(A.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=A.offsetHeight===100;a.support.selectstart="onselectstart"in A;p.removeChild(A).style.display="none"}),a.extend(a.ui,{plugin:{add:function(p,A,d){p=a.ui[p].prototype;for(var g in d){p.plugins[g]=p.plugins[g]||[];p.plugins[g].push([A,d[g]])}},call:function(p,A,d){if((A=p.plugins[A])&&
p.element[0].parentNode)for(var g=0;g<A.length;g++)p.options[A[g][0]]&&A[g][1].apply(p.element,d)}},contains:function(p,A){return document.compareDocumentPosition?p.compareDocumentPosition(A)&16:p!==A&&p.contains(A)},hasScroll:function(p,A){if(a(p).css("overflow")==="hidden")return false;var d=A&&A==="left"?"scrollLeft":"scrollTop",g=false;if(p[d]>0)return true;p[d]=1;g=p[d]>0;p[d]=0;return g},isOverAxis:function(p,A,d){return p>A&&p<A+d},isOver:function(p,A,d,g,c,n){return a.ui.isOverAxis(p,d,c)&&
a.ui.isOverAxis(A,g,n)}}))})(jQuery);
(function(a,s){if(a.cleanData){var f=a.cleanData;a.cleanData=function(p){for(var A=0,d;(d=p[A])!=null;A++)try{a(d).triggerHandler("remove")}catch(g){}f(p)}}else{var b=a.fn.remove;a.fn.remove=function(p,A){return this.each(function(){A||(!p||a.filter(p,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(d){}});return b.call(a(this),p,A)})}}a.widget=function(p,A,d){var g=p.split(".")[0],c;p=p.split(".")[1];c=g+"-"+p;d||(d=A,A=a.Widget);a.expr[":"][c]=
function(n){return!!a.data(n,p)};a[g]=a[g]||{};a[g][p]=function(n,v){arguments.length&&this._createWidget(n,v)};A=new A;A.options=a.extend(true,{},A.options);a[g][p].prototype=a.extend(true,A,{namespace:g,widgetName:p,widgetEventPrefix:a[g][p].prototype.widgetEventPrefix||p,widgetBaseClass:c},d);a.widget.bridge(p,a[g][p])};a.widget.bridge=function(p,A){a.fn[p]=function(d){var g=typeof d=="string",c=Array.prototype.slice.call(arguments,1),n=this;d=!g&&c.length?a.extend.apply(null,[true,d].concat(c)):
d;if(g&&d.charAt(0)==="_")return n;g?this.each(function(){var v=a.data(this,p),C=v&&a.isFunction(v[d])?v[d].apply(v,c):v;if(C!==v&&C!==s){n=C;return false}}):this.each(function(){var v=a.data(this,p);v?v.option(d||{})._init():a.data(this,p,new A(d,this))});return n}};a.Widget=function(p,A){arguments.length&&this._createWidget(p,A)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(p,A){a.data(A,this.widgetName,this);this.element=a(A);this.options=
a.extend(true,{},this.options,this._getCreateOptions(),p);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(p,A){var d=p;if(arguments.length===0)return a.extend({},this.options);if(typeof p=="string"){if(A===s)return this.options[p];d={};d[p]=A}this._setOptions(d);return this},_setOptions:function(p){var A=this;a.each(p,function(d,g){A._setOption(d,g)});return this},_setOption:function(p,A){this.options[p]=A;p==="disabled"&&this.widget()[A?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
A);return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(p,A,d){var g,c=this.options[p];d=d||{};A=a.Event(A);A.type=(p===this.widgetEventPrefix?p:this.widgetEventPrefix+p).toLowerCase();A.target=this.element[0];if(p=A.originalEvent)for(g in p)g in A||(A[g]=p[g]);this.element.trigger(A,d);return!(a.isFunction(c)&&c.call(this.element[0],A,d)===false||A.isDefaultPrevented())}}})(jQuery);
(function(a){var s=false;a(document).mouseup(function(){s=false});a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var f=this;this.element.bind("mousedown."+this.widgetName,function(b){return f._mouseDown(b)}).bind("click."+this.widgetName,function(b){if(true===a.data(b.target,f.widgetName+".preventClickEvent")){a.removeData(b.target,f.widgetName+".preventClickEvent");b.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(f){if(!s){this._mouseStarted&&this._mouseUp(f);this._mouseDownEvent=f;var b=this,p=f.which==1,A=typeof this.options.cancel=="string"&&f.target.nodeName?a(f.target).closest(this.options.cancel).length:false;if(!p||A||!this._mouseCapture(f))return true;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){b.mouseDelayMet=true},this.options.delay));if(this._mouseDistanceMet(f)&&this._mouseDelayMet(f)){this._mouseStarted=this._mouseStart(f)!==
false;if(!this._mouseStarted){f.preventDefault();return true}}true===a.data(f.target,this.widgetName+".preventClickEvent")&&a.removeData(f.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(d){return b._mouseMove(d)};this._mouseUpDelegate=function(d){return b._mouseUp(d)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);f.preventDefault();return s=true}},_mouseMove:function(f){if(a.browser.msie&&
!(document.documentMode>=9)&&!f.button)return this._mouseUp(f);if(this._mouseStarted){this._mouseDrag(f);return f.preventDefault()}this._mouseDistanceMet(f)&&this._mouseDelayMet(f)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,f)!==false,this._mouseStarted?this._mouseDrag(f):this._mouseUp(f));return!this._mouseStarted},_mouseUp:function(f){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&
(this._mouseStarted=false,f.target==this._mouseDownEvent.target&&a.data(f.target,this.widgetName+".preventClickEvent",true),this._mouseStop(f));return false},_mouseDistanceMet:function(f){return Math.max(Math.abs(this._mouseDownEvent.pageX-f.pageX),Math.abs(this._mouseDownEvent.pageY-f.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){this.options.helper=="original"&&
!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(s){var f=this.options;
if(this.helper||f.disabled||a(s.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(s);if(!this.handle)return false;f.iframeFix&&a(f.iframeFix===true?"iframe":f.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")});return true},_mouseStart:function(s){var f=this.options;this.helper=
this._createHelper(s);this._cacheHelperProportions();a.ui.ddmanager&&(a.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:s.pageX-this.offset.left,top:s.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.originalPosition=this.position=this._generatePosition(s);this.originalPageX=s.pageX;this.originalPageY=s.pageY;f.cursorAt&&this._adjustOffsetFromHelper(f.cursorAt);f.containment&&this._setContainment();if(this._trigger("start",s)===false){this._clear();return false}this._cacheHelperProportions();a.ui.ddmanager&&!f.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,s);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(s,true);a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,s);return true},
_mouseDrag:function(s,f){this.position=this._generatePosition(s);this.positionAbs=this._convertPositionTo("absolute");if(!f){var b=this._uiHash();if(this._trigger("drag",s,b)===false){this._mouseUp({});return false}this.position=b.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,s);return false},_mouseStop:function(s){var f=
false;a.ui.ddmanager&&!this.options.dropBehaviour&&(f=a.ui.ddmanager.drop(this,s));this.dropped&&(f=this.dropped,this.dropped=false);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!f||this.options.revert=="valid"&&f||this.options.revert===true||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,f)){var b=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),
function(){b._trigger("stop",s)!==false&&b._clear()})}else this._trigger("stop",s)!==false&&this._clear();return false},_mouseUp:function(s){this.options.iframeFix===true&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,s);return a.ui.mouse.prototype._mouseUp.call(this,s)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(s){var f=!this.options.handle||
!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==s.target&&(f=true)});return f},_createHelper:function(s){var f=this.options;s=a.isFunction(f.helper)?a(f.helper.apply(this.element[0],[s])):f.helper=="clone"?this.element.clone().removeAttr("id"):this.element;s.parents("body").length||s.appendTo(f.appendTo=="parent"?this.element[0].parentNode:f.appendTo);s[0]!=this.element[0]&&!/(fixed|absolute)/.test(s.css("position"))&&
s.css("position","absolute");return s},_adjustOffsetFromHelper:function(s){typeof s=="string"&&(s=s.split(" "));a.isArray(s)&&(s={left:+s[0],top:+s[1]||0});"left"in s&&(this.offset.click.left=s.left+this.margins.left);"right"in s&&(this.offset.click.left=this.helperProportions.width-s.right+this.margins.left);"top"in s&&(this.offset.click.top=s.top+this.margins.top);"bottom"in s&&(this.offset.click.top=this.helperProportions.height-s.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=
this.helper.offsetParent();var s=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(s.left+=this.scrollParent.scrollLeft(),s.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)s={top:0,left:0};return{top:s.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:s.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var s=this.element.position();return{top:s.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:s.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),
10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var s=this.options;s.containment=="parent"&&(s.containment=this.helper[0].parentNode);if(s.containment=="document"||s.containment=="window")this.containment=[s.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,s.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,
(s.containment=="document"?0:a(window).scrollLeft())+a(s.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(s.containment=="document"?0:a(window).scrollTop())+(a(s.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(s.containment)&&s.containment.constructor!=Array){s=a(s.containment);var f=s[0];if(f){s.offset();var b=a(f).css("overflow")!=
"hidden";this.containment=[(parseInt(a(f).css("borderLeftWidth"),10)||0)+(parseInt(a(f).css("paddingLeft"),10)||0),(parseInt(a(f).css("borderTopWidth"),10)||0)+(parseInt(a(f).css("paddingTop"),10)||0),(b?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(a(f).css("borderLeftWidth"),10)||0)-(parseInt(a(f).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(a(f).css("borderTopWidth"),
10)||0)-(parseInt(a(f).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=s}}else s.containment.constructor==Array&&(this.containment=s.containment)},_convertPositionTo:function(s,f){f||(f=this.position);var b=s=="absolute"?1:-1,p=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,A=/(html|body)/i.test(p[0].tagName);return{top:f.top+
this.offset.relative.top*b+this.offset.parent.top*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():A?0:p.scrollTop())*b),left:f.left+this.offset.relative.left*b+this.offset.parent.left*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():A?0:p.scrollLeft())*b)}},_generatePosition:function(s){var f=this.options,b=this.cssPosition=="absolute"&&
(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,p=/(html|body)/i.test(b[0].tagName),A=s.pageX,d=s.pageY;if(this.originalPosition){var g;if(this.containment){if(this.relative_container){g=this.relative_container.offset();g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]}else g=this.containment;s.pageX-this.offset.click.left<g[0]&&(A=g[0]+this.offset.click.left);
s.pageY-this.offset.click.top<g[1]&&(d=g[1]+this.offset.click.top);s.pageX-this.offset.click.left>g[2]&&(A=g[2]+this.offset.click.left);s.pageY-this.offset.click.top>g[3]&&(d=g[3]+this.offset.click.top)}if(f.grid){d=f.grid[1]?this.originalPageY+Math.round((d-this.originalPageY)/f.grid[1])*f.grid[1]:this.originalPageY;d=g?d-this.offset.click.top<g[1]||d-this.offset.click.top>g[3]?d-this.offset.click.top<g[1]?d+f.grid[1]:d-f.grid[1]:d:d;A=f.grid[0]?this.originalPageX+Math.round((A-this.originalPageX)/
f.grid[0])*f.grid[0]:this.originalPageX;A=g?A-this.offset.click.left<g[0]||A-this.offset.click.left>g[2]?A-this.offset.click.left<g[0]?A+f.grid[0]:A-f.grid[0]:A:A}}return{top:d-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():p?0:b.scrollTop()),left:A-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<
526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():p?0:b.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(s,f,b){b=b||this._uiHash();a.ui.plugin.call(this,s,[f,b]);s=="drag"&&(this.positionAbs=this._convertPositionTo("absolute"));return a.Widget.prototype._trigger.call(this,s,f,
b)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.17"});a.ui.plugin.add("draggable","connectToSortable",{start:function(s,f){var b=a(this).data("draggable"),p=b.options,A=a.extend({},f,{item:b.element});b.sortables=[];a(p.connectToSortable).each(function(){var d=a.data(this,"sortable");d&&!d.options.disabled&&(b.sortables.push({instance:d,shouldRevert:d.options.revert}),
d.refreshPositions(),d._trigger("activate",s,A))})},stop:function(s,f){var b=a(this).data("draggable"),p=a.extend({},f,{item:b.element});a.each(b.sortables,function(){this.instance.isOver?(this.instance.isOver=0,b.cancelHelperRemoval=true,this.instance.cancelHelperRemoval=false,this.shouldRevert&&(this.instance.options.revert=true),this.instance._mouseStop(s),this.instance.options.helper=this.instance.options._helper,b.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):
(this.instance.cancelHelperRemoval=false,this.instance._trigger("deactivate",s,p))})},drag:function(s,f){var b=a(this).data("draggable"),p=this;a.each(b.sortables,function(){this.instance.positionAbs=b.positionAbs;this.instance.helperProportions=b.helperProportions;this.instance.offset.click=b.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(p).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",
true),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return f.helper[0]},s.target=this.instance.currentItem[0],this.instance._mouseCapture(s,true),this.instance._mouseStart(s,true,true),this.instance.offset.click.top=b.offset.click.top,this.instance.offset.click.left=b.offset.click.left,this.instance.offset.parent.left-=b.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=b.offset.parent.top-this.instance.offset.parent.top,
b._trigger("toSortable",s),b.dropped=this.instance.element,b.currentItem=b.element,this.instance.fromOutside=b),this.instance.currentItem&&this.instance._mouseDrag(s)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=true,this.instance.options.revert=false,this.instance._trigger("out",s,this.instance._uiHash(this.instance)),this.instance._mouseStop(s,true),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&
this.instance.placeholder.remove(),b._trigger("fromSortable",s),b.dropped=false)})}});a.ui.plugin.add("draggable","cursor",{start:function(){var s=a("body"),f=a(this).data("draggable").options;s.css("cursor")&&(f._cursor=s.css("cursor"));s.css("cursor",f.cursor)},stop:function(){var s=a(this).data("draggable").options;s._cursor&&a("body").css("cursor",s._cursor)}});a.ui.plugin.add("draggable","opacity",{start:function(s,f){var b=a(f.helper),p=a(this).data("draggable").options;b.css("opacity")&&(p._opacity=
b.css("opacity"));b.css("opacity",p.opacity)},stop:function(s,f){var b=a(this).data("draggable").options;b._opacity&&a(f.helper).css("opacity",b._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var s=a(this).data("draggable");s.scrollParent[0]!=document&&s.scrollParent[0].tagName!="HTML"&&(s.overflowOffset=s.scrollParent.offset())},drag:function(s){var f=a(this).data("draggable"),b=f.options,p=false;if(f.scrollParent[0]!=document&&f.scrollParent[0].tagName!="HTML"){if(!b.axis||
b.axis!="x")f.overflowOffset.top+f.scrollParent[0].offsetHeight-s.pageY<b.scrollSensitivity?f.scrollParent[0].scrollTop=p=f.scrollParent[0].scrollTop+b.scrollSpeed:s.pageY-f.overflowOffset.top<b.scrollSensitivity&&(f.scrollParent[0].scrollTop=p=f.scrollParent[0].scrollTop-b.scrollSpeed);if(!b.axis||b.axis!="y")f.overflowOffset.left+f.scrollParent[0].offsetWidth-s.pageX<b.scrollSensitivity?f.scrollParent[0].scrollLeft=p=f.scrollParent[0].scrollLeft+b.scrollSpeed:s.pageX-f.overflowOffset.left<b.scrollSensitivity&&
(f.scrollParent[0].scrollLeft=p=f.scrollParent[0].scrollLeft-b.scrollSpeed)}else{if(!b.axis||b.axis!="x")s.pageY-a(document).scrollTop()<b.scrollSensitivity?p=a(document).scrollTop(a(document).scrollTop()-b.scrollSpeed):a(window).height()-(s.pageY-a(document).scrollTop())<b.scrollSensitivity&&(p=a(document).scrollTop(a(document).scrollTop()+b.scrollSpeed));if(!b.axis||b.axis!="y")s.pageX-a(document).scrollLeft()<b.scrollSensitivity?p=a(document).scrollLeft(a(document).scrollLeft()-b.scrollSpeed):
a(window).width()-(s.pageX-a(document).scrollLeft())<b.scrollSensitivity&&(p=a(document).scrollLeft(a(document).scrollLeft()+b.scrollSpeed))}p!==false&&a.ui.ddmanager&&!b.dropBehaviour&&a.ui.ddmanager.prepareOffsets(f,s)}});a.ui.plugin.add("draggable","snap",{start:function(){var s=a(this).data("draggable"),f=s.options;s.snapElements=[];a(f.snap.constructor!=String?f.snap.items||":data(draggable)":f.snap).each(function(){var b=a(this),p=b.offset();this!=s.element[0]&&s.snapElements.push({item:this,
width:b.outerWidth(),height:b.outerHeight(),top:p.top,left:p.left})})},drag:function(s,f){for(var b=a(this).data("draggable"),p=b.options,A=p.snapTolerance,d=f.offset.left,g=d+b.helperProportions.width,c=f.offset.top,n=c+b.helperProportions.height,v=b.snapElements.length-1;v>=0;v--){var C=b.snapElements[v].left,q=C+b.snapElements[v].width,M=b.snapElements[v].top,Q=M+b.snapElements[v].height;if(C-A<d&&d<q+A&&M-A<c&&c<Q+A||C-A<d&&d<q+A&&M-A<n&&n<Q+A||C-A<g&&g<q+A&&M-A<c&&c<Q+A||C-A<g&&g<q+A&&M-A<n&&
n<Q+A){if(p.snapMode!="inner"){var L=Math.abs(M-n)<=A,J=Math.abs(Q-c)<=A,Z=Math.abs(C-g)<=A,X=Math.abs(q-d)<=A;L&&(f.position.top=b._convertPositionTo("relative",{top:M-b.helperProportions.height,left:0}).top-b.margins.top);J&&(f.position.top=b._convertPositionTo("relative",{top:Q,left:0}).top-b.margins.top);Z&&(f.position.left=b._convertPositionTo("relative",{top:0,left:C-b.helperProportions.width}).left-b.margins.left);X&&(f.position.left=b._convertPositionTo("relative",{top:0,left:q}).left-b.margins.left)}var O=
L||J||Z||X;if(p.snapMode!="outer"){L=Math.abs(M-c)<=A;J=Math.abs(Q-n)<=A;Z=Math.abs(C-d)<=A;X=Math.abs(q-g)<=A;L&&(f.position.top=b._convertPositionTo("relative",{top:M,left:0}).top-b.margins.top);J&&(f.position.top=b._convertPositionTo("relative",{top:Q-b.helperProportions.height,left:0}).top-b.margins.top);Z&&(f.position.left=b._convertPositionTo("relative",{top:0,left:C}).left-b.margins.left);X&&(f.position.left=b._convertPositionTo("relative",{top:0,left:q-b.helperProportions.width}).left-b.margins.left)}!b.snapElements[v].snapping&&
(L||J||Z||X||O)&&b.options.snap.snap&&b.options.snap.snap.call(b.element,s,a.extend(b._uiHash(),{snapItem:b.snapElements[v].item}));b.snapElements[v].snapping=L||J||Z||X||O}else{b.snapElements[v].snapping&&b.options.snap.release&&b.options.snap.release.call(b.element,s,a.extend(b._uiHash(),{snapItem:b.snapElements[v].item}));b.snapElements[v].snapping=false}}}});a.ui.plugin.add("draggable","stack",{start:function(){var s=a(this).data("draggable").options;s=a.makeArray(a(s.stack)).sort(function(b,
p){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(p).css("zIndex"),10)||0)});if(s.length){var f=parseInt(s[0].style.zIndex)||0;a(s).each(function(b){this.style.zIndex=f+b});this[0].style.zIndex=f+s.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(s,f){var b=a(f.helper),p=a(this).data("draggable").options;b.css("zIndex")&&(p._zIndex=b.css("zIndex"));b.css("zIndex",p.zIndex)},stop:function(s,f){var b=a(this).data("draggable").options;b._zIndex&&a(f.helper).css("zIndex",b._zIndex)}})})(jQuery);
(function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var s=this,f=this.options,b=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),p=f.values&&f.values.length||1,A=[];this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(f.disabled?" ui-slider-disabled ui-disabled":""));this.range=a([]);f.range&&(f.range===true&&(f.values||(f.values=[this._valueMin(),this._valueMin()]),f.values.length&&f.values.length!==2&&(f.values=[f.values[0],f.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(f.range==="min"||f.range==="max"?" ui-slider-range-"+f.range:"")));for(var d=b.length;d<p;d+=1)A.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=b.add(a(A.join("")).appendTo(s.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(g){g.preventDefault()}).hover(function(){f.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){f.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")});this.handles.each(function(g){a(this).data("index.ui-slider-handle",
g)});this.handles.keydown(function(g){var c=true,n=a(this).data("index.ui-slider-handle"),v,C,q;if(!s.options.disabled){switch(g.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:c=false;if(!s._keySliding){s._keySliding=true;a(this).addClass("ui-state-active");v=s._start(g,n);if(v===false)return}}v=s.options.step;s.options.values&&s.options.values.length?
C=q=s.values(n):C=q=s.value();switch(g.keyCode){case a.ui.keyCode.HOME:q=s._valueMin();break;case a.ui.keyCode.END:q=s._valueMax();break;case a.ui.keyCode.PAGE_UP:q=s._trimAlignValue(C+(s._valueMax()-s._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:q=s._trimAlignValue(C-(s._valueMax()-s._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(C===s._valueMax())return;q=s._trimAlignValue(C+v);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(C===s._valueMin())return;q=s._trimAlignValue(C-
v)}s._slide(g,n,q);return c}}).keyup(function(g){var c=a(this).data("index.ui-slider-handle");s._keySliding&&(s._keySliding=false,s._stop(g,c),s._change(g,c),a(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();
return this},_mouseCapture:function(s){var f=this.options,b,p,A,d,g;if(f.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();b=this._normValueFromMouse({x:s.pageX,y:s.pageY});p=this._valueMax()-this._valueMin()+1;d=this;this.handles.each(function(c){var n=Math.abs(b-d.values(c));p>n&&(p=n,A=a(this),g=c)});f.range===true&&this.values(1)===f.min&&(g+=1,A=a(this.handles[g]));if(this._start(s,g)===false)return false;
this._mouseSliding=true;d._handleIndex=g;A.addClass("ui-state-active").focus();f=A.offset();this._clickOffset=!a(s.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:s.pageX-f.left-A.width()/2,top:s.pageY-f.top-A.height()/2-(parseInt(A.css("borderTopWidth"),10)||0)-(parseInt(A.css("borderBottomWidth"),10)||0)+(parseInt(A.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(s,g,b);return this._animateOff=true},_mouseStart:function(){return true},_mouseDrag:function(s){var f=
this._normValueFromMouse({x:s.pageX,y:s.pageY});this._slide(s,this._handleIndex,f);return false},_mouseStop:function(s){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(s,this._handleIndex);this._change(s,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(s){var f,b;this.orientation==="horizontal"?
(f=this.elementSize.width,b=s.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(f=this.elementSize.height,b=s.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));s=b/f;s>1&&(s=1);s<0&&(s=0);this.orientation==="vertical"&&(s=1-s);f=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+s*f)},_start:function(s,f){var b={handle:this.handles[f],value:this.value()};this.options.values&&this.options.values.length&&(b.value=this.values(f),
b.values=this.values());return this._trigger("start",s,b)},_slide:function(s,f,b){var p,A,d;this.options.values&&this.options.values.length?(p=this.values(f?0:1),this.options.values.length===2&&this.options.range===true&&(f===0&&b>p||f===1&&b<p)&&(b=p),b!==this.values(f)&&(A=this.values(),A[f]=b,d=this._trigger("slide",s,{handle:this.handles[f],value:b,values:A}),this.values(f?0:1),d!==false&&this.values(f,b,true))):b!==this.value()&&(d=this._trigger("slide",s,{handle:this.handles[f],value:b}),d!==
false&&this.value(b))},_stop:function(s,f){var b={handle:this.handles[f],value:this.value()};this.options.values&&this.options.values.length&&(b.value=this.values(f),b.values=this.values());this._trigger("stop",s,b)},_change:function(s,f){if(!this._keySliding&&!this._mouseSliding){var b={handle:this.handles[f],value:this.value()};this.options.values&&this.options.values.length&&(b.value=this.values(f),b.values=this.values());this._trigger("change",s,b)}},value:function(s){if(arguments.length){this.options.value=
this._trimAlignValue(s);this._refreshValue();this._change(null,0)}else return this._value()},values:function(s,f){var b,p,A;if(arguments.length>1){this.options.values[s]=this._trimAlignValue(f);this._refreshValue();this._change(null,s)}else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(s):this.value();b=this.options.values;p=arguments[0];for(A=0;A<b.length;A+=1){b[A]=this._trimAlignValue(p[A]);this._change(null,
A)}this._refreshValue()}},_setOption:function(s,f){var b,p=0;a.isArray(this.options.values)&&(p=this.options.values.length);a.Widget.prototype._setOption.apply(this,arguments);switch(s){case "disabled":f?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",true),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",false),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(b=0;b<p;b+=1)this._change(null,b);this._animateOff=false}},_value:function(){var s=this.options.value;return s=this._trimAlignValue(s)},_values:function(s){var f,b;if(arguments.length){f=this.options.values[s];
return f=this._trimAlignValue(f)}f=this.options.values.slice();for(b=0;b<f.length;b+=1)f[b]=this._trimAlignValue(f[b]);return f},_trimAlignValue:function(s){if(s<=this._valueMin())return this._valueMin();if(s>=this._valueMax())return this._valueMax();var f=this.options.step>0?this.options.step:1,b=(s-this._valueMin())%f;s=s-b;Math.abs(b)*2>=f&&(s+=b>0?f:-f);return parseFloat(s.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var s=
this.options.range,f=this.options,b=this,p=this._animateOff?false:f.animate,A,d={},g,c,n,v;this.options.values&&this.options.values.length?this.handles.each(function(C){A=(b.values(C)-b._valueMin())/(b._valueMax()-b._valueMin())*100;d[b.orientation==="horizontal"?"left":"bottom"]=A+"%";a(this).stop(1,1)[p?"animate":"css"](d,f.animate);b.options.range===true&&(b.orientation==="horizontal"?(C===0&&b.range.stop(1,1)[p?"animate":"css"]({left:A+"%"},f.animate),C===1&&b.range[p?"animate":"css"]({width:A-
g+"%"},{queue:false,duration:f.animate})):(C===0&&b.range.stop(1,1)[p?"animate":"css"]({bottom:A+"%"},f.animate),C===1&&b.range[p?"animate":"css"]({height:A-g+"%"},{queue:false,duration:f.animate})));g=A}):(c=this.value(),n=this._valueMin(),v=this._valueMax(),A=v!==n?(c-n)/(v-n)*100:0,d[b.orientation==="horizontal"?"left":"bottom"]=A+"%",this.handle.stop(1,1)[p?"animate":"css"](d,f.animate),s==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[p?"animate":"css"]({width:A+"%"},f.animate),
s==="max"&&this.orientation==="horizontal"&&this.range[p?"animate":"css"]({width:100-A+"%"},{queue:false,duration:f.animate}),s==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[p?"animate":"css"]({height:A+"%"},f.animate),s==="max"&&this.orientation==="vertical"&&this.range[p?"animate":"css"]({height:100-A+"%"},{queue:false,duration:f.animate}))}});a.extend(a.ui.slider,{version:"1.8.17"})})(jQuery);(function(a){Math.precision=function(d,g){if(g===undefined)g=0;return Math.round(d*Math.pow(10,g))/Math.pow(10,g)};var s=function(d,g){var c=this,n=d.find("img:first"),v=0,C=100,q=100,M=0,Q=100,L=100,J=0,Z=0,X,O,ha=[],pa=function(S){for(var V=0;V<ha.length;V++)ha[V].call(c,c,S)},Y=function(S){var V=d.offset();X={l:V.left|0,t:V.top|0};clearTimeout(O);O=setTimeout(function(){Ea.call(c,S)},0);a(document).bind("mousemove",W).bind("mouseup",ea);S.preventDefault()},W=function(S){clearTimeout(O);O=setTimeout(function(){Ea.call(c,
S)},0);S.stopPropagation();S.preventDefault();return false},ea=function(S){a(document).unbind("mouseup",ea).unbind("mousemove",W);S.stopPropagation();S.preventDefault();return false},Ea=function(S){var V=S.pageX-X.l;S=S.pageY-X.t;var na=d.w,oa=d.h;if(V<0)V=0;else if(V>na)V=na;if(S<0)S=0;else if(S>oa)S=oa;ma.call(c,"xy",{x:V/na*q+v,y:S/oa*L+M})},ma=function(S,V,na){if(V===undefined){if(S===undefined||S==null)S="xy";switch(S.toLowerCase()){case "x":return J;case "y":return Z;default:return{x:J,y:Z}}}if(!(na!=
null&&na==c)){var oa=false,la,ka;if(S==null)S="xy";switch(S.toLowerCase()){case "x":la=V&&(V.x&&V.x|0||V|0)||0;break;case "y":ka=V&&(V.y&&V.y|0||V|0)||0;break;default:la=V&&V.x&&V.x|0||0;ka=V&&V.y&&V.y|0||0}if(la!=null){if(la<v)la=v;else if(la>C)la=C;if(J!=la){J=la;oa=true}}if(ka!=null){if(ka<M)ka=M;else if(ka>Q)ka=Q;if(Z!=ka){Z=ka;oa=true}}oa&&pa.call(c,na||c)}},da=function(S){a.isFunction(S)&&ha.push(S)};a.extend(true,c,{val:ma,range:function(S,V){if(V===undefined){if(S===undefined||S==null)S="all";
switch(S.toLowerCase()){case "minx":return v;case "maxx":return C;case "rangex":return{minX:v,maxX:C,rangeX:q};case "miny":return M;case "maxy":return Q;case "rangey":return{minY:M,maxY:Q,rangeY:L};default:return{minX:v,maxX:C,rangeX:q,minY:M,maxY:Q,rangeY:L}}}var na,oa,la,ka;if(S==null)S="all";switch(S.toLowerCase()){case "minx":na=V&&(V.minX&&V.minX|0||V|0)||0;break;case "maxx":oa=V&&(V.maxX&&V.maxX|0||V|0)||0;break;case "rangex":na=V&&V.minX&&V.minX|0||0;oa=V&&V.maxX&&V.maxX|0||0;break;case "miny":la=
V&&(V.minY&&V.minY|0||V|0)||0;break;case "maxy":ka=V&&(V.maxY&&V.maxY|0||V|0)||0;break;case "rangey":la=V&&V.minY&&V.minY|0||0;ka=V&&V.maxY&&V.maxY|0||0;break;default:na=V&&V.minX&&V.minX|0||0;oa=V&&V.maxX&&V.maxX|0||0;la=V&&V.minY&&V.minY|0||0;ka=V&&V.maxY&&V.maxY|0||0}if(na!=null&&v!=na){v=na;q=C-v}if(oa!=null&&C!=oa){C=oa;q=C-v}if(la!=null&&M!=la){M=la;L=Q-M}if(ka!=null&&Q!=ka){Q=ka;L=Q-M}},bind:da,unbind:function(S){if(a.isFunction(S))for(var V;(V=a.inArray(S,ha))!=-1;)ha.splice(V,1)},destroy:function(){a(document).unbind("mouseup",
ea).unbind("mousemove",W);d.unbind("mousedown",Y);ha=n=d=null}});n.src=g.arrow&&g.arrow.image;n.w=g.arrow&&g.arrow.width||n.width();n.h=g.arrow&&g.arrow.height||n.height();d.w=g.map&&g.map.width||d.width();d.h=g.map&&g.map.height||d.height();d.bind("mousedown",Y);da.call(c,function(){var S=0,V=0,na=d.w,oa=d.h,la=n.w,ka=n.h;setTimeout(function(){if(q>0)S=J==C?na:J/q*na|0;if(L>0)V=Z==Q?oa:Z/L*oa|0;if(la>=na)S=(na>>1)-(la>>1);else S-=la>>1;if(ka>=oa)V=(oa>>1)-(ka>>1);else V-=ka>>1;n.css({left:S+"px",
top:V+"px"})},0)})},f=function(d,g,c,n){var v=this;d=d.find("td.Text input");var C=d.eq(3),q=d.eq(4),M=d.eq(5),Q=d.length>7?d.eq(6):null,L=d.eq(0),J=d.eq(1),Z=d.eq(2),X=d.eq(d.length>7?7:6),O=d.length>7?d.eq(8):null,ha=function(ma){if(!(ma.target.value==""&&ma.target!=X.get(0)&&(c!=null&&ma.target!=c.get(0)||c==null))){if(!W(ma))return ma;switch(ma.target){case C.get(0):switch(ma.keyCode){case 38:C.val(ea.call(v,(C.val()<<0)+1,0,255));g.val("r",C.val(),ma.target);return false;case 40:C.val(ea.call(v,
(C.val()<<0)-1,0,255));g.val("r",C.val(),ma.target);return false}break;case q.get(0):switch(ma.keyCode){case 38:q.val(ea.call(v,(q.val()<<0)+1,0,255));g.val("g",q.val(),ma.target);return false;case 40:q.val(ea.call(v,(q.val()<<0)-1,0,255));g.val("g",q.val(),ma.target);return false}break;case M.get(0):switch(ma.keyCode){case 38:M.val(ea.call(v,(M.val()<<0)+1,0,255));g.val("b",M.val(),ma.target);return false;case 40:M.val(ea.call(v,(M.val()<<0)-1,0,255));g.val("b",M.val(),ma.target);return false}break;
case Q&&Q.get(0):switch(ma.keyCode){case 38:Q.val(ea.call(v,parseFloat(Q.val())+1,0,100));g.val("a",Math.precision(Q.val()*255/100,n),ma.target);return false;case 40:Q.val(ea.call(v,parseFloat(Q.val())-1,0,100));g.val("a",Math.precision(Q.val()*255/100,n),ma.target);return false}break;case L.get(0):switch(ma.keyCode){case 38:L.val(ea.call(v,(L.val()<<0)+1,0,360));g.val("h",L.val(),ma.target);return false;case 40:L.val(ea.call(v,(L.val()<<0)-1,0,360));g.val("h",L.val(),ma.target);return false}break;
case J.get(0):switch(ma.keyCode){case 38:J.val(ea.call(v,(J.val()<<0)+1,0,100));g.val("s",J.val(),ma.target);return false;case 40:J.val(ea.call(v,(J.val()<<0)-1,0,100));g.val("s",J.val(),ma.target);return false}break;case Z.get(0):switch(ma.keyCode){case 38:Z.val(ea.call(v,(Z.val()<<0)+1,0,100));g.val("v",Z.val(),ma.target);return false;case 40:Z.val(ea.call(v,(Z.val()<<0)-1,0,100));g.val("v",Z.val(),ma.target);return false}}}},pa=function(ma){if(!(ma.target.value==""&&ma.target!=X.get(0)&&(c!=null&&
ma.target!=c.get(0)||c==null))){if(!W(ma))return ma;switch(ma.target){case C.get(0):C.val(ea.call(v,C.val(),0,255));g.val("r",C.val(),ma.target);break;case q.get(0):q.val(ea.call(v,q.val(),0,255));g.val("g",q.val(),ma.target);break;case M.get(0):M.val(ea.call(v,M.val(),0,255));g.val("b",M.val(),ma.target);break;case Q&&Q.get(0):Q.val(ea.call(v,Q.val(),0,100));g.val("a",Math.precision(Q.val()*255/100,n),ma.target);break;case L.get(0):L.val(ea.call(v,L.val(),0,360));g.val("h",L.val(),ma.target);break;
case J.get(0):J.val(ea.call(v,J.val(),0,100));g.val("s",J.val(),ma.target);break;case Z.get(0):Z.val(ea.call(v,Z.val(),0,100));g.val("v",Z.val(),ma.target);break;case X.get(0):X.val(X.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));c&&c.val(X.val());g.val("hex",X.val()!=""?X.val():null,ma.target);break;case c&&c.get(0):c.val(c.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));X.val(c.val());g.val("hex",c.val()!=""?c.val():null,ma.target);break;case O&&O.get(0):O.val(O.val().replace(/[^a-fA-F0-9]/g,
"").toLowerCase().substring(0,2));g.val("a",O.val()!=null?parseInt(O.val(),16):null,ma.target)}}},Y=function(ma){if(g.val()!=null)switch(ma.target){case C.get(0):C.val(g.val("r"));break;case q.get(0):q.val(g.val("g"));break;case M.get(0):M.val(g.val("b"));break;case Q&&Q.get(0):Q.val(Math.precision(g.val("a")*100/255,n));break;case L.get(0):L.val(g.val("h"));break;case J.get(0):J.val(g.val("s"));break;case Z.get(0):Z.val(g.val("v"));break;case X.get(0):case c&&c.get(0):X.val(g.val("hex"));c&&c.val(g.val("hex"));
break;case O&&O.get(0):O.val(g.val("ahex").substring(6))}},W=function(ma){switch(ma.keyCode){case 9:case 16:case 29:case 37:case 39:return false;case "c".charCodeAt():case "v".charCodeAt():if(ma.ctrlKey)return false}return true},ea=function(ma,da,S){if(ma==""||isNaN(ma))return da;if(ma>S)return S;if(ma<da)return da;return ma},Ea=function(ma,da){var S=ma.val("all");if(da!=C.get(0))C.val(S!=null?S.r:"");if(da!=q.get(0))q.val(S!=null?S.g:"");if(da!=M.get(0))M.val(S!=null?S.b:"");if(Q&&da!=Q.get(0))Q.val(S!=
null?Math.precision(S.a*100/255,n):"");if(da!=L.get(0))L.val(S!=null?S.h:"");if(da!=J.get(0))J.val(S!=null?S.s:"");if(da!=Z.get(0))Z.val(S!=null?S.v:"");if(da!=X.get(0)&&(c&&da!=c.get(0)||!c))X.val(S!=null?S.hex:"");if(c&&da!=c.get(0)&&da!=X.get(0))c.val(S!=null?S.hex:"");if(O&&da!=O.get(0))O.val(S!=null?S.ahex.substring(6):"")};a.extend(true,v,{destroy:function(){C.add(q).add(M).add(Q).add(L).add(J).add(Z).add(X).add(c).add(O).unbind("keyup",pa).unbind("blur",Y);C.add(q).add(M).add(Q).add(L).add(J).add(Z).unbind("keydown",
ha);g.unbind(Ea);O=X=Z=J=L=Q=M=q=C=null}});C.add(q).add(M).add(Q).add(L).add(J).add(Z).add(X).add(c).add(O).bind("keyup",pa).bind("blur",Y);C.add(q).add(M).add(Q).add(L).add(J).add(Z).bind("keydown",ha);g.bind(Ea)};a.jPicker={List:[],Color:function(d){var g=this,c,n,v,C,q,M,Q,L=[],J=function(X){for(var O=0;O<L.length;O++)L[O].call(g,g,X)},Z=function(X,O,ha){if(O===undefined){if(X===undefined||X==null||X=="")X="all";if(c==null)return null;switch(X.toLowerCase()){case "ahex":return A.rgbaToHex({r:c,
g:n,b:v,a:C});case "hex":return Z("ahex").substring(0,6);case "all":return{r:c,g:n,b:v,a:C,h:q,s:M,v:Q,hex:Z.call(g,"hex"),ahex:Z.call(g,"ahex")};default:O={};for(var pa=0;pa<X.length;pa++)switch(X.charAt(pa)){case "r":if(X.length==1)O=c;else O.r=c;break;case "g":if(X.length==1)O=n;else O.g=n;break;case "b":if(X.length==1)O=v;else O.b=v;break;case "a":if(X.length==1)O=C;else O.a=C;break;case "h":if(X.length==1)O=q;else O.h=q;break;case "s":if(X.length==1)O=M;else O.s=M;break;case "v":if(X.length==
1)O=Q;else O.v=Q}return O=={}?Z.call(g,"all"):O}}if(!(ha!=null&&ha==g)){var Y=false;if(X==null)X="";if(O==null){if(c!=null){c=null;Y=true}if(n!=null){n=null;Y=true}if(v!=null){v=null;Y=true}if(C!=null){C=null;Y=true}if(q!=null){q=null;Y=true}if(M!=null){M=null;Y=true}if(Q!=null){Q=null;Y=true}Y&&J.call(g,ha||g)}else switch(X.toLowerCase()){case "ahex":case "hex":O=A.hexToRgba(O&&(O.ahex||O.hex)||O||"00000000");Z.call(g,"rgba",{r:O.r,g:O.g,b:O.b,a:X=="ahex"?O.a:C!=null?C:255},ha);break;default:if(O&&
(O.ahex!=null||O.hex!=null)){Z.call(g,"ahex",O.ahex||O.hex||"00000000",ha);break}var W={},ea=false,Ea=false;if(O.r!==undefined&&!X.indexOf("r")==-1)X+="r";if(O.g!==undefined&&!X.indexOf("g")==-1)X+="g";if(O.b!==undefined&&!X.indexOf("b")==-1)X+="b";if(O.a!==undefined&&!X.indexOf("a")==-1)X+="a";if(O.h!==undefined&&!X.indexOf("h")==-1)X+="h";if(O.s!==undefined&&!X.indexOf("s")==-1)X+="s";if(O.v!==undefined&&!X.indexOf("v")==-1)X+="v";for(pa=0;pa<X.length;pa++)switch(X.charAt(pa)){case "r":if(Ea)continue;
ea=true;W.r=O&&O.r&&O.r|0||O&&O|0||0;if(W.r<0)W.r=0;else if(W.r>255)W.r=255;if(c!=W.r){c=W.r;Y=true}break;case "g":if(Ea)continue;ea=true;W.g=O&&O.g&&O.g|0||O&&O|0||0;if(W.g<0)W.g=0;else if(W.g>255)W.g=255;if(n!=W.g){n=W.g;Y=true}break;case "b":if(Ea)continue;ea=true;W.b=O&&O.b&&O.b|0||O&&O|0||0;if(W.b<0)W.b=0;else if(W.b>255)W.b=255;if(v!=W.b){v=W.b;Y=true}break;case "a":W.a=O&&O.a!=null?O.a|0:O!=null?O|0:255;if(W.a<0)W.a=0;else if(W.a>255)W.a=255;if(C!=W.a){C=W.a;Y=true}break;case "h":if(ea)continue;
Ea=true;W.h=O&&O.h&&O.h|0||O&&O|0||0;if(W.h<0)W.h=0;else if(W.h>360)W.h=360;if(q!=W.h){q=W.h;Y=true}break;case "s":if(ea)continue;Ea=true;W.s=O&&O.s!=null?O.s|0:O!=null?O|0:100;if(W.s<0)W.s=0;else if(W.s>100)W.s=100;if(M!=W.s){M=W.s;Y=true}break;case "v":if(ea)continue;Ea=true;W.v=O&&O.v!=null?O.v|0:O!=null?O|0:100;if(W.v<0)W.v=0;else if(W.v>100)W.v=100;if(Q!=W.v){Q=W.v;Y=true}}if(Y){if(ea){c=c||0;n=n||0;v=v||0;O=A.rgbToHsv({r:c,g:n,b:v});q=O.h;M=O.s;Q=O.v}else if(Ea){q=q||0;M=M!=null?M:100;Q=Q!=
null?Q:100;O=A.hsvToRgb({h:q,s:M,v:Q});c=O.r;n=O.g;v=O.b}C=C!=null?C:255;J.call(g,ha||g)}}}};a.extend(true,g,{val:Z,bind:function(X){a.isFunction(X)&&L.push(X)},unbind:function(X){if(a.isFunction(X))for(var O;(O=a.inArray(X,L))!=-1;)L.splice(O,1)},destroy:function(){L=null}});if(d)if(d.ahex!=null)Z("ahex",d);else if(d.hex!=null)Z((d.a!=null?"a":"")+"hex",d.a!=null?{ahex:d.hex+A.intToHex(d.a)}:d);else if(d.r!=null&&d.g!=null&&d.b!=null)Z("rgb"+(d.a!=null?"a":""),d);else if(d.h!=null&&d.s!=null&&d.v!=
null)Z("hsv"+(d.a!=null?"a":""),d)},ColorMethods:{hexToRgba:function(d){d=this.validateHex(d);if(d=="")return{r:null,g:null,b:null,a:null};var g="00",c="00",n="00",v="255";if(d.length==6)d+="ff";if(d.length>6){g=d.substring(0,2);c=d.substring(2,4);n=d.substring(4,6);v=d.substring(6,d.length)}else{if(d.length>4){g=d.substring(4,d.length);d=d.substring(0,4)}if(d.length>2){c=d.substring(2,d.length);d=d.substring(0,2)}if(d.length>0)n=d.substring(0,d.length)}return{r:this.hexToInt(g),g:this.hexToInt(c),
b:this.hexToInt(n),a:this.hexToInt(v)}},validateHex:function(d){if(typeof d=="object")return"";d=d.toLowerCase().replace(/[^a-f0-9]/g,"");if(d.length>8)d=d.substring(0,8);return d},rgbaToHex:function(d){return this.intToHex(d.r)+this.intToHex(d.g)+this.intToHex(d.b)+this.intToHex(d.a)},intToHex:function(d){d=(d|0).toString(16);if(d.length==1)d="0"+d;return d.toLowerCase()},hexToInt:function(d){return parseInt(d,16)},rgbToHsv:function(d){var g=d.r/255,c=d.g/255;d=d.b/255;var n={h:0,s:0,v:0},v=0,C=
0;if(g>=c&&g>=d){C=g;v=c>d?d:c}else if(c>=d&&c>=g){C=c;v=g>d?d:g}else{C=d;v=c>g?g:c}n.v=C;n.s=C?(C-v)/C:0;if(n.s){v=C-v;n.h=g==C?(c-d)/v:c==C?2+(d-g)/v:4+(g-c)/v;n.h=parseInt(n.h*60);if(n.h<0)n.h+=360}else n.h=0;n.s=n.s*100|0;n.v=n.v*100|0;return n},hsvToRgb:function(d){var g={r:0,g:0,b:0,a:100},c=d.h,n=d.s;d=d.v;if(n==0)g.r=d==0?g.g=g.b=0:g.g=g.b=d*255/100|0;else{if(c==360)c=0;c/=60;n/=100;d/=100;var v=c|0,C=c-v;c=d*(1-n);var q=d*(1-n*C);n=d*(1-n*(1-C));switch(v){case 0:g.r=d;g.g=n;g.b=c;break;case 1:g.r=
q;g.g=d;g.b=c;break;case 2:g.r=c;g.g=d;g.b=n;break;case 3:g.r=c;g.g=q;g.b=d;break;case 4:g.r=n;g.g=c;g.b=d;break;case 5:g.r=d;g.g=c;g.b=q}g.r=g.r*255|0;g.g=g.g*255|0;g.b=g.b*255|0}return g}}};var b=a.jPicker.Color,p=a.jPicker.List,A=a.jPicker.ColorMethods;a.fn.jPicker=function(d){var g=arguments;return this.each(function(){var c=this,n=a.extend(true,{},a.fn.jPicker.defaults,d);if(a(c).get(0).nodeName.toLowerCase()=="input"){a.extend(true,n,{window:{bindToInput:true,expandable:true,input:a(c)}});if(a(c).val()==
""){n.color.active=new b({hex:null});n.color.current=new b({hex:null})}else if(A.validateHex(a(c).val())){n.color.active=new b({hex:a(c).val(),a:n.color.active.val("a")});n.color.current=new b({hex:a(c).val(),a:n.color.active.val("a")})}}if(n.window.expandable)a(c).after('<span class="jPicker"><span class="Icon"><span class="Color">&nbsp;</span><span class="Alpha">&nbsp;</span><span class="Image" title="Click To Open Color Picker">&nbsp;</span><span class="Container">&nbsp;</span></span></span>');
else n.window.liveUpdate=false;var v=parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters,C=null,q=null,M=null,Q=null,L=null,J=null,Z=null,X=null,O=null,ha=null,pa=null,Y=null,W=null,ea=null,Ea=null,ma=null,da=null,S=null,V=null,na=null,oa=null,la=null,ka=null,ya=null,za=null,Ja=null,Ia=null,Fa=null,Ma=function(K){var P=ja.active,ca=P.val("hex"),Da,Oa;n.color.mode=K;switch(K){case "h":setTimeout(function(){Ta.call(c,q,"transparent");Ga.call(c,Q,0);ta.call(c,Q,100);Ga.call(c,
L,260);ta.call(c,L,100);Ta.call(c,M,"transparent");Ga.call(c,Z,0);ta.call(c,Z,100);Ga.call(c,X,260);ta.call(c,X,100);Ga.call(c,O,260);ta.call(c,O,100);Ga.call(c,ha,260);ta.call(c,ha,100);Ga.call(c,Y,260);ta.call(c,Y,100)},0);W.range("all",{minX:0,maxX:100,minY:0,maxY:100});ea.range("rangeY",{minY:0,maxY:360});if(P.val("ahex")==null)break;W.val("xy",{x:P.val("s"),y:100-P.val("v")},W);ea.val("y",360-P.val("h"),ea);break;case "s":setTimeout(function(){Ta.call(c,q,"transparent");Ga.call(c,Q,-260);Ga.call(c,
L,-520);Ga.call(c,Z,-260);Ga.call(c,X,-520);Ga.call(c,Y,260);ta.call(c,Y,100)},0);W.range("all",{minX:0,maxX:360,minY:0,maxY:100});ea.range("rangeY",{minY:0,maxY:100});if(P.val("ahex")==null)break;W.val("xy",{x:P.val("h"),y:100-P.val("v")},W);ea.val("y",100-P.val("s"),ea);break;case "v":setTimeout(function(){Ta.call(c,q,"000000");Ga.call(c,Q,-780);Ga.call(c,L,260);Ta.call(c,M,ca);Ga.call(c,Z,-520);Ga.call(c,X,260);ta.call(c,X,100);Ga.call(c,Y,260);ta.call(c,Y,100)},0);W.range("all",{minX:0,maxX:360,
minY:0,maxY:100});ea.range("rangeY",{minY:0,maxY:100});if(P.val("ahex")==null)break;W.val("xy",{x:P.val("h"),y:100-P.val("s")},W);ea.val("y",100-P.val("v"),ea);break;case "r":Da=-1040;Oa=-780;W.range("all",{minX:0,maxX:255,minY:0,maxY:255});ea.range("rangeY",{minY:0,maxY:255});if(P.val("ahex")==null)break;W.val("xy",{x:P.val("b"),y:255-P.val("g")},W);ea.val("y",255-P.val("r"),ea);break;case "g":Da=-1560;Oa=-1820;W.range("all",{minX:0,maxX:255,minY:0,maxY:255});ea.range("rangeY",{minY:0,maxY:255});
if(P.val("ahex")==null)break;W.val("xy",{x:P.val("b"),y:255-P.val("r")},W);ea.val("y",255-P.val("g"),ea);break;case "b":Da=-2080;Oa=-2860;W.range("all",{minX:0,maxX:255,minY:0,maxY:255});ea.range("rangeY",{minY:0,maxY:255});if(P.val("ahex")==null)break;W.val("xy",{x:P.val("r"),y:255-P.val("g")},W);ea.val("y",255-P.val("b"),ea);break;case "a":setTimeout(function(){Ta.call(c,q,"transparent");Ga.call(c,Q,-260);Ga.call(c,L,-520);Ga.call(c,Z,260);Ga.call(c,X,260);ta.call(c,X,100);Ga.call(c,Y,0);ta.call(c,
Y,100)},0);W.range("all",{minX:0,maxX:360,minY:0,maxY:100});ea.range("rangeY",{minY:0,maxY:255});if(P.val("ahex")==null)break;W.val("xy",{x:P.val("h"),y:100-P.val("v")},W);ea.val("y",255-P.val("a"),ea);break;default:throw"Invalid Mode";}switch(K){case "s":case "v":case "a":setTimeout(function(){ta.call(c,Q,100);ta.call(c,Z,100);Ga.call(c,O,260);ta.call(c,O,100);Ga.call(c,ha,260);ta.call(c,ha,100)},0);break;case "r":case "g":case "b":setTimeout(function(){Ta.call(c,q,"transparent");Ta.call(c,M,"transparent");
ta.call(c,Z,100);ta.call(c,Q,100);Ga.call(c,Q,Da);Ga.call(c,L,Da-260);Ga.call(c,Z,Oa-780);Ga.call(c,X,Oa-520);Ga.call(c,O,Oa);Ga.call(c,ha,Oa-260);Ga.call(c,Y,260);ta.call(c,Y,100)},0)}P.val("ahex")!=null&&Ca.call(c,P)},Ca=function(K,P){if(P==null||P!=ea&&P!=W)va.call(c,K,P);setTimeout(function(){kb.call(c,K);vb.call(c,K);cb.call(c,K)},0)},wa=function(K,P){var ca=ja.active;if(!(P!=W&&ca.val()==null)){var Da=K.val("all");switch(n.color.mode){case "h":ca.val("sv",{s:Da.x,v:100-Da.y},P);break;case "s":case "a":ca.val("hv",
{h:Da.x,v:100-Da.y},P);break;case "v":ca.val("hs",{h:Da.x,s:100-Da.y},P);break;case "r":ca.val("gb",{g:255-Da.y,b:Da.x},P);break;case "g":ca.val("rb",{r:255-Da.y,b:Da.x},P);break;case "b":ca.val("rg",{r:Da.x,g:255-Da.y},P)}}},ra=function(K,P){var ca=ja.active;if(!(P!=ea&&ca.val()==null))switch(n.color.mode){case "h":ca.val("h",{h:360-K.val("y")},P);break;case "s":ca.val("s",{s:100-K.val("y")},P);break;case "v":ca.val("v",{v:100-K.val("y")},P);break;case "r":ca.val("r",{r:255-K.val("y")},P);break;
case "g":ca.val("g",{g:255-K.val("y")},P);break;case "b":ca.val("b",{b:255-K.val("y")},P);break;case "a":ca.val("a",255-K.val("y"),P)}},va=function(K,P){if(P!=W)switch(n.color.mode){case "h":var ca=K.val("sv");W.val("xy",{x:ca!=null?ca.s:100,y:100-(ca!=null?ca.v:100)},P);break;case "s":case "a":ca=K.val("hv");W.val("xy",{x:ca&&ca.h||0,y:100-(ca!=null?ca.v:100)},P);break;case "v":ca=K.val("hs");W.val("xy",{x:ca&&ca.h||0,y:100-(ca!=null?ca.s:100)},P);break;case "r":ca=K.val("bg");W.val("xy",{x:ca&&
ca.b||0,y:255-(ca&&ca.g||0)},P);break;case "g":ca=K.val("br");W.val("xy",{x:ca&&ca.b||0,y:255-(ca&&ca.r||0)},P);break;case "b":ca=K.val("rg");W.val("xy",{x:ca&&ca.r||0,y:255-(ca&&ca.g||0)},P)}if(P!=ea)switch(n.color.mode){case "h":ea.val("y",360-(K.val("h")||0),P);break;case "s":ca=K.val("s");ea.val("y",100-(ca!=null?ca:100),P);break;case "v":ca=K.val("v");ea.val("y",100-(ca!=null?ca:100),P);break;case "r":ea.val("y",255-(K.val("r")||0),P);break;case "g":ea.val("y",255-(K.val("g")||0),P);break;case "b":ea.val("y",
255-(K.val("b")||0),P);break;case "a":ca=K.val("a");ea.val("y",255-(ca!=null?ca:255),P)}},kb=function(K){try{var P=K.val("all");na.css({backgroundColor:P&&"#"+P.hex||"transparent"});ta.call(c,na,P&&Math.precision(P.a*100/255,4)||0)}catch(ca){}},vb=function(K){switch(n.color.mode){case "h":Ta.call(c,q,(new b({h:K.val("h")||0,s:100,v:100})).val("hex"));break;case "s":case "a":var P=K.val("s");ta.call(c,L,100-(P!=null?P:100));break;case "v":P=K.val("v");ta.call(c,Q,P!=null?P:100);break;case "r":ta.call(c,
L,Math.precision((K.val("r")||0)/255*100,4));break;case "g":ta.call(c,L,Math.precision((K.val("g")||0)/255*100,4));break;case "b":ta.call(c,L,Math.precision((K.val("b")||0)/255*100))}K=K.val("a");ta.call(c,J,Math.precision((255-(K||0))*100/255,4))},cb=function(K){switch(n.color.mode){case "h":var P=K.val("a");ta.call(c,pa,Math.precision((255-(P||0))*100/255,4));break;case "s":P=K.val("hva");var ca=new b({h:P&&P.h||0,s:100,v:P!=null?P.v:100});Ta.call(c,M,ca.val("hex"));ta.call(c,X,100-(P!=null?P.v:
100));ta.call(c,pa,Math.precision((255-(P&&P.a||0))*100/255,4));break;case "v":P=K.val("hsa");ca=new b({h:P&&P.h||0,s:P!=null?P.s:100,v:100});Ta.call(c,M,ca.val("hex"));ta.call(c,pa,Math.precision((255-(P&&P.a||0))*100/255,4));break;case "r":case "g":case "b":ca=P=0;K=K.val("rgba");if(n.color.mode=="r"){P=K&&K.b||0;ca=K&&K.g||0}else if(n.color.mode=="g"){P=K&&K.b||0;ca=K&&K.r||0}else if(n.color.mode=="b"){P=K&&K.r||0;ca=K&&K.g||0}var Da=ca>P?P:ca;ta.call(c,X,P>ca?Math.precision((P-ca)/(255-ca)*100,
4):0);ta.call(c,O,ca>P?Math.precision((ca-P)/(255-P)*100,4):0);ta.call(c,ha,Math.precision(Da/255*100,4));ta.call(c,pa,Math.precision((255-(K&&K.a||0))*100/255,4));break;case "a":P=K.val("a");Ta.call(c,M,K.val("hex")||"000000");ta.call(c,pa,P!=null?0:100);ta.call(c,Y,P!=null?100:0)}},Ta=function(K,P){K.css({backgroundColor:P&&P.length==6&&"#"+P||"transparent"})},Va=function(K,P){if(v&&(P.indexOf("AlphaBar.png")!=-1||P.indexOf("Bars.png")!=-1||P.indexOf("Maps.png")!=-1)){K.attr("pngSrc",P);K.css({backgroundImage:"none",
filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+P+"', sizingMethod='scale')"})}else K.css({backgroundImage:"url('"+P+"')"})},Ga=function(K,P){K.css({top:P+"px"})},ta=function(K,P){K.css({visibility:P>0?"visible":"hidden"});if(P>0&&P<100)if(v){var ca=K.attr("pngSrc");ca!=null&&(ca.indexOf("AlphaBar.png")!=-1||ca.indexOf("Bars.png")!=-1||ca.indexOf("Maps.png")!=-1)?K.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+ca+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity="+
P+")"}):K.css({opacity:Math.precision(P/100,4)})}else K.css({opacity:Math.precision(P/100,4)});else if(P==0||P==100)if(v){ca=K.attr("pngSrc");ca!=null&&(ca.indexOf("AlphaBar.png")!=-1||ca.indexOf("Bars.png")!=-1||ca.indexOf("Maps.png")!=-1)?K.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+ca+"', sizingMethod='scale')"}):K.css({opacity:""})}else K.css({opacity:""})},$a=function(){ja.active.val("ahex",ja.current.val("ahex"))},Ka=function(){ja.current.val("ahex",ja.active.val("ahex"))},
Sa=function(K){a(this).parents("tbody:first").find('input:radio[value!="'+K.target.value+'"]').removeAttr("checked");Ma.call(c,K.target.value)},Ha=function(){$a.call(c)},db=function(){$a.call(c);n.window.expandable&&fb.call(c);a.isFunction(ob)&&ob.call(c,ja.active,ka)},lb=function(){Ka.call(c);n.window.expandable&&fb.call(c);a.isFunction(ib)&&ib.call(c,ja.active,la)},Ua=function(){pb.call(c)},Xa=function(K){var P=K.val("hex");oa.css({backgroundColor:P&&"#"+P||"transparent"});ta.call(c,oa,Math.precision((K.val("a")||
0)*100/255,4))},wb=function(K){var P=K.val("hex");K=K.val("va");za.css({backgroundColor:P&&"#"+P||"transparent"});ta.call(c,Ja,Math.precision((255-(K&&K.a||0))*100/255,4));if(n.window.bindToInput&&n.window.updateInputColor)n.window.input.css({backgroundColor:P&&"#"+P||"transparent",color:K==null||K.v>75?"#000000":"#ffffff"})},sa=function(K){ma=parseInt(C.css("left"));da=parseInt(C.css("top"));S=K.pageX;V=K.pageY;a(document).bind("mousemove",hb).bind("mouseup",eb);K.preventDefault()},hb=function(K){C.css({left:ma-
(S-K.pageX)+"px",top:da-(V-K.pageY)+"px"});n.window.expandable&&!a.support.boxModel&&C.prev().css({left:C.css("left"),top:C.css("top")});K.stopPropagation();K.preventDefault();return false},eb=function(K){a(document).unbind("mousemove",hb).unbind("mouseup",eb);K.stopPropagation();K.preventDefault();return false},sb=function(K){K.preventDefault();K.stopPropagation();ja.active.val("ahex",a(this).attr("title")||null,K.target);return false},ib=a.isFunction(g[1])&&g[1]||null,ab=a.isFunction(g[2])&&g[2]||
null,ob=a.isFunction(g[3])&&g[3]||null,pb=function(){ja.current.val("ahex",ja.active.val("ahex"));var K=function(){if(!(!n.window.expandable||a.support.boxModel)){var P=C.find("table:first");C.before("<iframe/>");C.prev().css({width:P.width(),height:C.height(),opacity:0,position:"absolute",left:C.css("left"),top:C.css("top")})}};if(n.window.expandable){a(document.body).children("div.jPicker.Container").css({zIndex:10});C.css({zIndex:20})}switch(n.window.effects.type){case "fade":C.fadeIn(n.window.effects.speed.show,
K);break;case "slide":C.slideDown(n.window.effects.speed.show,K);break;default:C.show(n.window.effects.speed.show,K)}},fb=function(){var K=function(){n.window.expandable&&C.css({zIndex:10});!n.window.expandable||a.support.boxModel||C.prev().remove()};switch(n.window.effects.type){case "fade":C.fadeOut(n.window.effects.speed.hide,K);break;case "slide":C.slideUp(n.window.effects.speed.hide,K);break;default:C.hide(n.window.effects.speed.hide,K)}},tb=function(){var K=n.window,P=K.expandable?a(c).next().find(".Container:first"):
null;C=K.expandable?a("<div/>"):a(c);C.addClass("jPicker Container");K.expandable&&C.hide();C.get(0).onselectstart=function(xa){if(xa.target.nodeName.toLowerCase()!=="input")return false};var ca=ja.active.val("all");if(K.alphaPrecision<0)K.alphaPrecision=0;else if(K.alphaPrecision>2)K.alphaPrecision=2;var Da='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody>'+(K.expandable?'<tr><td class="Move" colspan="5">&nbsp;</td></tr>':"")+'<tr><td rowspan="9"><h2 class="Title">'+(K.title||aa.text.title)+
'</h2><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+ia.clientPath+ia.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+ia.clientPath+ia.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview"><div class="prev_div">'+
aa.text.newColor+'<div class="color_preview"><span class="Active" title="'+aa.tooltips.colors.newColor+'">&nbsp;</span><span class="Current" title="'+aa.tooltips.colors.currentColor+'">&nbsp;</span></div></div>'+aa.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+aa.text.ok+'" title="'+aa.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+aa.text.cancel+'" title="'+aa.tooltips.buttons.cancel+'"/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label title="'+
aa.tooltips.hue.radio+'"><input type="radio" value="h"'+(n.color.mode=="h"?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.h:"")+'" title="'+aa.tooltips.hue.textbox+'"/>&nbsp;\u00ba</td></tr><tr class="Saturation"><td class="Radio"><label title="'+aa.tooltips.saturation.radio+'"><input type="radio" value="s"'+(n.color.mode=="s"?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=
null?ca.s:"")+'" title="'+aa.tooltips.saturation.textbox+'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label title="'+aa.tooltips.value.radio+'"><input type="radio" value="v"'+(n.color.mode=="v"?' checked="checked"':"")+'/>V:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.v:"")+'" title="'+aa.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label title="'+aa.tooltips.red.radio+'"><input type="radio" value="r"'+
(n.color.mode=="r"?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.r:"")+'" title="'+aa.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label title="'+aa.tooltips.green.radio+'"><input type="radio" value="g"'+(n.color.mode=="g"?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.g:"")+'" title="'+aa.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label title="'+
aa.tooltips.blue.radio+'"><input type="radio" value="b"'+(n.color.mode=="b"?' checked="checked"':"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ca!=null?ca.b:"")+'" title="'+aa.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio">'+(K.alphaSupport?'<label title="'+aa.tooltips.alpha.radio+'"><input type="radio" value="a"'+(n.color.mode=="a"?' checked="checked"':"")+"/>A:</label>":"&nbsp;")+'</td><td class="Text">'+(K.alphaSupport?'<input type="text" maxlength="'+
(3+K.alphaPrecision)+'" value="'+(ca!=null?Math.precision(ca.a*100/255,K.alphaPrecision):"")+'" title="'+aa.tooltips.alpha.textbox+'"/>&nbsp;%':"&nbsp;")+'</td></tr><tr class="Hex"><td colspan="2" class="Text"><label title="'+aa.tooltips.hex.textbox+'">#:<input type="text" maxlength="6" class="Hex" value="'+(ca!=null?ca.hex:"")+'"/></label>'+(K.alphaSupport?'<input type="text" maxlength="2" class="AHex" value="'+(ca!=null?ca.ahex.substring(6):"")+'" title="'+aa.tooltips.hex.alpha+'"/></td>':"&nbsp;")+
"</tr></tbody></table>";if(K.expandable){C.html(Da);a(document.body).children("div.jPicker.Container").length==0?a(document.body).prepend(C):a(document.body).children("div.jPicker.Container:last").after(C);C.mousedown(function(){a(document.body).children("div.jPicker.Container").css({zIndex:10});C.css({zIndex:20})});C.css({left:K.position.x=="left"?P.offset().left-530-(K.position.y=="center"?25:0)+"px":K.position.x=="center"?P.offset().left-260+"px":K.position.x=="right"?P.offset().left-10+(K.position.y==
"center"?25:0)+"px":K.position.x=="screenCenter"?(a(document).width()>>1)-260+"px":P.offset().left+parseInt(K.position.x)+"px",position:"absolute",top:K.position.y=="top"?P.offset().top-312+"px":K.position.y=="center"?P.offset().top-156+"px":K.position.y=="bottom"?P.offset().top+25+"px":P.offset().top+parseInt(K.position.y)+"px"})}else{C=a(c);C.html(Da)}Da=C.find("tbody:first");q=Da.find("div.Map:first");M=Da.find("div.Bar:first");var Oa=q.find("span"),Wa=M.find("span");Q=Oa.filter(".Map1:first");
L=Oa.filter(".Map2:first");J=Oa.filter(".Map3:first");Z=Wa.filter(".Map1:first");X=Wa.filter(".Map2:first");O=Wa.filter(".Map3:first");ha=Wa.filter(".Map4:first");pa=Wa.filter(".Map5:first");Y=Wa.filter(".Map6:first");W=new s(q,{map:{width:ia.colorMap.width,height:ia.colorMap.height},arrow:{image:ia.clientPath+ia.colorMap.arrow.file,width:ia.colorMap.arrow.width,height:ia.colorMap.arrow.height}});W.bind(wa);ea=new s(M,{map:{width:ia.colorBar.width,height:ia.colorBar.height},arrow:{image:ia.clientPath+
ia.colorBar.arrow.file,width:ia.colorBar.arrow.width,height:ia.colorBar.arrow.height}});ea.bind(ra);Ea=new f(Da,ja.active,K.expandable&&K.bindToInput?K.input:null,K.alphaPrecision);Oa=ca!=null?ca.hex:null;var Za=Da.find(".Preview");Wa=Da.find(".Button");na=Za.find(".Active:first").css({backgroundColor:Oa&&"#"+Oa||"transparent"});oa=Za.find(".Current:first").css({backgroundColor:Oa&&"#"+Oa||"transparent"}).bind("click",Ha);ta.call(c,oa,Math.precision(ja.current.val("a")*100)/255,4);la=Wa.find(".Ok:first").bind("click touchstart",
lb);ka=Wa.find(".Cancel:first").bind("click touchstart",db);ya=Wa.find(".Grid:first");setTimeout(function(){Va.call(c,Q,ia.clientPath+"Maps.png");Va.call(c,L,ia.clientPath+"Maps.png");Va.call(c,J,ia.clientPath+"map-opacity.png");Va.call(c,Z,ia.clientPath+"Bars.png");Va.call(c,X,ia.clientPath+"Bars.png");Va.call(c,O,ia.clientPath+"Bars.png");Va.call(c,ha,ia.clientPath+"Bars.png");Va.call(c,pa,ia.clientPath+"bar-opacity.png");Va.call(c,Y,ia.clientPath+"AlphaBar.png");Va.call(c,Za.find("div:last"),ia.clientPath+
"preview-opacity.png")},0);Da.find("td.Radio input").bind("click  touchstart",Sa);if(ja.quickList&&ja.quickList.length>0){Wa="";for(i=0;i<ja.quickList.length;i++){if((typeof ja.quickList[i]).toString().toLowerCase()=="string")ja.quickList[i]=new b({hex:ja.quickList[i]});var nb=ja.quickList[i].val("a"),Ra=ja.quickList[i].val("ahex");if(!K.alphaSupport&&Ra)Ra=Ra.substring(0,6)+"ff";var mb=ja.quickList[i].val("hex");Wa+='<span class="QuickColor"'+(Ra&&' title="#'+Ra+'"'||"")+' style="background-color:'+
(mb&&"#"+mb||"")+";"+(mb?"":"background-image:url("+ia.clientPath+"NoColor.png)")+(K.alphaSupport&&nb&&nb<255?";opacity:"+Math.precision(nb/255,4)+";filter:Alpha(opacity="+Math.precision(nb/2.55,4)+")":"")+'">&nbsp;</span>'}Va.call(c,ya,ia.clientPath+"bar-opacity.png");ya.html(Wa);ya.find(".QuickColor").click(sb)}Ma.call(c,n.color.mode);ja.active.bind(Ca);a.isFunction(ab)&&ja.active.bind(ab);ja.current.bind(Xa);if(K.expandable){c.icon=P.parents(".Icon:first");za=c.icon.find(".Color:first").css({backgroundColor:Oa&&
"#"+Oa||"transparent"});Ja=c.icon.find(".Alpha:first");Va.call(c,Ja,ia.clientPath+"bar-opacity.png");ta.call(c,Ja,Math.precision((255-(ca!=null?ca.a:0))*100/255,4));Ia=c.icon.find(".Image:first").css({backgroundImage:"url('"+ia.clientPath+ia.picker.file+"')"}).bind("click",Ua);if(K.bindToInput&&K.updateInputColor)K.input.css({backgroundColor:Oa&&"#"+Oa||"transparent",color:ca==null||ca.v>75?"#000000":"#ffffff"});Fa=Da.find(".Move:first").bind("mousedown",sa);ja.active.bind(wb)}else pb.call(c)},ia=
n.images,aa=n.localization,ja={active:(typeof n.color.active).toString().toLowerCase()=="string"?new b({ahex:!n.window.alphaSupport&&n.color.active?n.color.active.substring(0,6)+"ff":n.color.active}):new b({ahex:!n.window.alphaSupport&&n.color.active.val("ahex")?n.color.active.val("ahex").substring(0,6)+"ff":n.color.active.val("ahex")}),current:(typeof n.color.active).toString().toLowerCase()=="string"?new b({ahex:!n.window.alphaSupport&&n.color.active?n.color.active.substring(0,6)+"ff":n.color.active}):
new b({ahex:!n.window.alphaSupport&&n.color.active.val("ahex")?n.color.active.val("ahex").substring(0,6)+"ff":n.color.active.val("ahex")}),quickList:n.color.quickList};a.extend(true,c,{commitCallback:ib,liveCallback:ab,cancelCallback:ob,color:ja,show:pb,hide:fb,destroy:function(){C.find("td.Radio input  touchstart").unbind("click",Sa);oa.unbind("click  touchstart",Ha);ka.unbind("click  touchstart",db);la.unbind("click  touchstart",lb);if(n.window.expandable){Ia.unbind("click",Ua);Fa.unbind("mousedown",
sa);c.icon=null}C.find(".QuickColor").unbind("click",sb);Y=pa=ha=O=X=Z=J=L=Q=M=q=null;W.destroy();W=null;ea.destroy();ea=null;Ea.destroy();ab=ob=ib=ya=ka=la=oa=na=Ea=null;C.html("");for(i=0;i<p.length;i++)p[i]==c&&p.splice(i,1)}});p.push(c);setTimeout(function(){tb.call(c)},0)})};a.fn.jPicker.defaults={window:{title:null,effects:{type:"slide",speed:{show:"slow",hide:"fast"}},position:{x:"screenCenter",y:"top"},expandable:false,liveUpdate:true,alphaSupport:false,alphaPrecision:0,updateInputColor:true},
color:{mode:"h",active:new b({ahex:"#ffcc00ff"}),quickList:[new b({h:360,s:33,v:100}),new b({h:360,s:66,v:100}),new b({h:360,s:100,v:100}),new b({h:360,s:100,v:75}),new b({h:360,s:100,v:50}),new b({h:180,s:0,v:100}),new b({h:30,s:33,v:100}),new b({h:30,s:66,v:100}),new b({h:30,s:100,v:100}),new b({h:30,s:100,v:75}),new b({h:30,s:100,v:50}),new b({h:180,s:0,v:90}),new b({h:60,s:33,v:100}),new b({h:60,s:66,v:100}),new b({h:60,s:100,v:100}),new b({h:60,s:100,v:75}),new b({h:60,s:100,v:50}),new b({h:180,
s:0,v:80}),new b({h:90,s:33,v:100}),new b({h:90,s:66,v:100}),new b({h:90,s:100,v:100}),new b({h:90,s:100,v:75}),new b({h:90,s:100,v:50}),new b({h:180,s:0,v:70}),new b({h:120,s:33,v:100}),new b({h:120,s:66,v:100}),new b({h:120,s:100,v:100}),new b({h:120,s:100,v:75}),new b({h:120,s:100,v:50}),new b({h:180,s:0,v:60}),new b({h:150,s:33,v:100}),new b({h:150,s:66,v:100}),new b({h:150,s:100,v:100}),new b({h:150,s:100,v:75}),new b({h:150,s:100,v:50}),new b({h:180,s:0,v:50}),new b({h:180,s:33,v:100}),new b({h:180,
s:66,v:100}),new b({h:180,s:100,v:100}),new b({h:180,s:100,v:75}),new b({h:180,s:100,v:50}),new b({h:180,s:0,v:40}),new b({h:210,s:33,v:100}),new b({h:210,s:66,v:100}),new b({h:210,s:100,v:100}),new b({h:210,s:100,v:75}),new b({h:210,s:100,v:50}),new b({h:180,s:0,v:30}),new b({h:240,s:33,v:100}),new b({h:240,s:66,v:100}),new b({h:240,s:100,v:100}),new b({h:240,s:100,v:75}),new b({h:240,s:100,v:50}),new b({h:180,s:0,v:20}),new b({h:270,s:33,v:100}),new b({h:270,s:66,v:100}),new b({h:270,s:100,v:100}),
new b({h:270,s:100,v:75}),new b({h:270,s:100,v:50}),new b({h:180,s:0,v:10}),new b({h:300,s:33,v:100}),new b({h:300,s:66,v:100}),new b({h:300,s:100,v:100}),new b({h:300,s:100,v:75}),new b({h:300,s:100,v:50}),new b({h:180,s:0,v:0}),new b({h:330,s:33,v:100}),new b({h:330,s:66,v:100}),new b({h:330,s:100,v:100}),new b({h:330,s:100,v:75}),new b({h:330,s:100,v:50}),new b]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,
height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},
saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},
alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}}})(jQuery,"1.1.6");(function(a){function s(p){var A=p||window.event,d=[].slice.call(arguments,1),g=0,c=0,n=0;p=a.event.fix(A);p.type="mousewheel";if(A.wheelDelta)g=A.wheelDelta/120;if(A.detail)g=-A.detail/3;n=g;if(A.axis!==undefined&&A.axis===A.HORIZONTAL_AXIS){n=0;c=-1*g}if(A.wheelDeltaY!==undefined)n=A.wheelDeltaY/120;if(A.wheelDeltaX!==undefined)c=-1*A.wheelDeltaX/120;d.unshift(p,g,c,n);return(a.event.dispatch||a.event.handle).apply(this,d)}var f=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var b=f.length;b;)a.event.fixHooks[f[--b]]=
a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var p=f.length;p;)this.addEventListener(f[--p],s,false);else this.onmousewheel=s},teardown:function(){if(this.removeEventListener)for(var p=f.length;p;)this.removeEventListener(f[--p],s,false);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(p){return p?this.bind("mousewheel",p):this.trigger("mousewheel")},unmousewheel:function(p){return this.unbind("mousewheel",p)}})})(jQuery);methodDraw.addExtension("view_grid",function(a){function s(n){g.attr("width");g.attr("height");var v=svgedit.units.getTypeMap()[methodDraw.curConfig.baseUnit],C=[0.01,0.1,1,10,100,1E3];b.getContentElem().getAttribute("x");var q=A;v=v*n;var M=100/v,Q=1;for(n=0;n<C.length;n++){var L=C[n];Q=L;if(M<=L)break}C=Q*v;q.width=C;q.height=C;v=q.getContext("2d");M=C/10;v.globalAlpha=0.2;v.strokeStyle="#000";for(n=1;n<10;n++){Q=Math.round(M*n)+0.5;v.moveTo(Q,C);v.lineTo(Q,0);v.moveTo(C,Q);v.lineTo(0,Q)}v.stroke();
v.beginPath();v.globalAlpha=0.5;v.moveTo(0.5,C);v.lineTo(0.5,0);v.moveTo(C,0.5);v.lineTo(0,0.5);v.stroke();q=q.toDataURL("image/png");c.setAttribute("width",C);c.setAttribute("height",C);c.parentNode.setAttribute("width",C);c.parentNode.setAttribute("height",C);b.setHref(c,q)}if(!document.getElementById("canvasGrid")){var f=document.getElementById("svgcanvas").ownerDocument,b=methodDraw.canvas,p=false;a=a.assignAttributes;var A=document.createElement("canvas");$(A).hide().appendTo("body");var d=f.createElementNS("http://www.w3.org/2000/svg",
"g");a(d,{id:"canvasGrid",width:"100%",height:"100%",x:0,y:0,overflow:"visible",display:"none"});var g=$("#canvas_background");g.after(d);d=f.createElementNS("http://www.w3.org/2000/svg","pattern");a(d,{id:"gridpattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:100,height:100});var c=f.createElementNS("http://www.w3.org/2000/svg","image");a(c,{x:0,y:0,width:100,height:100});d.appendChild(c);$("#svgroot defs").append(d);f=f.createElementNS("http://www.w3.org/2000/svg","rect");a(f,{width:"100%",height:"100%",
x:0,y:0,"stroke-width":0,stroke:"none",fill:"url(#gridpattern)",style:"pointer-events: none; display:visible;"});$("#canvasGrid").append(f)}return{name:"view_grid",zoomChanged:function(n){p&&s(n)},buttons:[{id:"view_grid",type:"menu",after:"tool_wireframe",panel:"view_menu",title:"View Grid",events:{click:function(){if($("#view_grid").hasClass("push_button_pressed")){methodDraw.curConfig.showGrid=p=false;$("#view_grid").removeClass("push_button_pressed");$("#canvasGrid").attr("display","none")}else{methodDraw.curConfig.showGrid=
p=true;$("#view_grid").addClass("push_button_pressed");$("#canvasGrid").attr("display","inline");s(b.getZoom())}}}}]}});methodDraw.addExtension("biobutton-bacteria",function(){function a(s,f){var b=svgCanvas.addSvgElementFromJson({element:"image",attr:{x:f*200,y:0,width:0,height:0,id:svgCanvas.getNextId(),style:"pointer-events:none;"}});svgCanvas.clearSelection();svgCanvas.addToSelection([b]);svgCanvas.setImageURL(s)}return{name:"Neuron",svgicons:"extensions/ext-biobutton-bacteria.xml",buttons:[{id:"biobutton-bacteria",type:"mode",title:"Add a bacteria",events:{click:function(){methodDraw.canvas.setMode("select");
a("extensions/imagelib/bacteria.svg",0);a("extensions/imagelib/bacteria_color.svg",1)}}}],mouseDown:function(){},mouseUp:function(){},callback:function(){}}});methodDraw.addExtension("biobutton-cell",function(){return{name:"Animal Cell",svgicons:"extensions/ext-biobutton-cell.xml",buttons:[{id:"biobutton-cell",type:"mode",title:"Add an animal cell",events:{click:function(){methodDraw.canvas.setMode("select");var a=svgCanvas.addSvgElementFromJson({element:"image",attr:{x:0,y:0,width:0,height:0,id:svgCanvas.getNextId(),style:"pointer-events:none;"}});svgCanvas.clearSelection();svgCanvas.addToSelection([a]);svgCanvas.setImageURL("extensions/imagelib/animal_cell.svg")}}}],
mouseDown:function(){},mouseUp:function(){},callback:function(){}}});methodDraw.addExtension("biobutton-neuron",function(){function a(s,f){var b=svgCanvas.addSvgElementFromJson({element:"image",attr:{x:f*110,y:0,width:0,height:0,id:svgCanvas.getNextId(),style:"pointer-events:none;"}});svgCanvas.clearSelection();svgCanvas.addToSelection([b]);svgCanvas.setImageURL(s)}return{name:"Neuron",svgicons:"extensions/ext-biobutton-neuron.xml",buttons:[{id:"biobutton-neuron",type:"mode",title:"Add a neuron",events:{click:function(){methodDraw.canvas.setMode("select");a("extensions/imagelib/neuron_bipolar.svg",
0);a("extensions/imagelib/neuron_multipolares.svg",1);a("extensions/imagelib/neuron_pseudounipolares.svg",2);a("extensions/imagelib/neuron_unipolar.svg",3)}}}],mouseDown:function(){},mouseUp:function(){},callback:function(){}}});methodDraw.addExtension("mathjax",function(){function a(){var A=$("#mathjax_code_textarea").val();MathJax.Hub.queue.Push(["Text",s,"\\displaystyle{"+A+"}"]);MathJax.Hub.queue.Push(function(){var d=$(".MathJax_SVG");d=$(d.html());d.find("use").each(function(){var g,c,n;g=$(this).attr("href")?$(this).attr("href").slice(1):$(this).attr("xlink:href").slice(1);var v=$("#"+g).clone().removeAttr("id");g=$(this).attr("x");c=$(this).attr("y");if((n=$(this).attr("transform"))&&(g||c))v.attr("transform",n+" translate("+
g+","+c+")");else if(n)v.attr("transform",n);else if(g||c)v.attr("transform","translate("+g+","+c+")");$(this).replaceWith(v)});d.removeAttr("style");d.attr("xmlns","http://www.w3.org/2000/svg");svgCanvas.importSvgString($("<div>").append(d.clone()).html(),true);svgCanvas.ungroupSelectedElement();svgCanvas.moveSelectedElements(f,b,true)})}var s,f,b,p=false;$.extend(methodDraw.uiStrings,{mathjax:{embed_svg:"Save as mathematics",embed_mathml:"Save as figure",svg_save_warning:"The math will be transformed into a figure is manipulatable like everything else. You will not be able to manipulate the TeX-code anymore. ",
mathml_save_warning:"Advised. The math will be saved as a figure.",title:"Mathematics code editor"}});return{name:"MatJax",svgicons:"extensions/mathjax-icons.xml",buttons:[{id:"tool_mathjax",type:"mode",title:"Add Mathematics",events:{click:function(){if(p===false){$('<div id="mathjax">                <!-- Here is where MathJax creates the math --\>                  <div id="mathjax_creator" class="tex2jax_process" style="display:none">                    $${}$$                  </div>                  <div id="mathjax_overlay"></div>                  <div id="mathjax_container">                    <div id="tool_mathjax_back" class="toolbar_button">                      <button id="tool_mathjax_save">OK</button>                      <button id="tool_mathjax_cancel">Cancel</button>                    </div>                    <fieldset>                      <legend id="mathjax_legend">Mathematics Editor</legend>                      <label>                        <span id="mathjax_explication">Please type your mathematics in                         <a href="http://en.wikipedia.org/wiki/Help:Displaying_a_formula" target="_blank">TeX</a> code.</span></label>                      <textarea id="mathjax_code_textarea" spellcheck="false"></textarea>                    </fieldset>                  </div>                </div>').insertBefore("#dialog_box").hide();
$("#mathjax_container").draggable({cancel:"button,fieldset",containment:"window"});$("#tool_mathjax_cancel").prepend($.getSvgIcon("cancel",true)).on("click touched",function(){$("#mathjax").hide()});$("#tool_mathjax_save").prepend($.getSvgIcon("ok",true)).on("click touched",function(){a();$("#mathjax").hide()});$("body").addClass("tex2jax_ignore");$.getScript("https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js").done(function(){MathJax.Hub.queue.Push(function(){s=
MathJax.Hub.getAllJax("#mathjax_creator")[0];console.log(s);p=true;console.log("MathJax Loaded")})}).fail(function(){console.log("Failed loadeing MathJax.");$.alert("Failed loading MathJax. You will not be able to change the mathematics.")})}svgCanvas.setMode("mathjax")}}}],mouseDown:function(){if(svgCanvas.getMode()==="mathjax")return{started:true}},mouseUp:function(A){if(svgCanvas.getMode()==="mathjax"){var d=svgCanvas.getZoom();f=A.mouse_x/d;b=A.mouse_y/d;$("#mathjax").show();return{started:false}}},
callback:function(){$("<style>").text("\t\t\t\t#mathjax fieldset{\t\t\t\t\tpadding: 5px;\t\t\t\t\tmargin: 5px;\t\t\t\t\tborder: 1px solid #DDD;\t\t\t\t}\t\t\t\t#mathjax label{\t\t\t\t\tdisplay: block;\t\t\t\t\tmargin: .5em;\t\t\t\t}\t\t\t\t#mathjax legend {\t\t\t\t\tmax-width:195px;\t\t\t\t}\t\t\t\t#mathjax_overlay {\t\t\t\t\tposition: absolute;\t\t\t\t\ttop: 0;\t\t\t\t\tleft: 0;\t\t\t\t\tright: 0;\t\t\t\t\tbottom: 0;\t\t\t\t\tbackground-color: black;\t\t\t\t\topacity: 0.6;\t\t\t\t\tz-index: 20000;\t\t\t\t}\t\t\t\t\t\t\t\t#mathjax_container {\t\t\t\t\tposition: absolute;\t\t\t\t\ttop: 50px;\t\t\t\t\tpadding: 10px;\t\t\t\t\tbackground-color: #B0B0B0;\t\t\t\t\tborder: 1px outset #777;\t\t\t\t\topacity: 1.0;\t\t\t\t\tfont-family: Verdana, Helvetica, sans-serif;\t\t\t\t\tfont-size: .8em;\t\t\t\t\tz-index: 20001;\t\t\t\t}\t\t\t\t\t\t\t\t#tool_mathjax_back {\t\t\t\t\tmargin-left: 1em;\t\t\t\t\toverflow: auto;\t\t\t\t}\t\t\t\t\t\t\t\t#mathjax_legend{\t\t\t\t\tfont-weight: bold;\t\t\t\t\tfont-size:1.1em;\t\t\t\t}\t\t\t\t\t\t\t\t#mathjax_code_textarea {\\n          margin: 5px .7em;\t\t\t\t\toverflow: hidden;          width: 416px;\t\t\t\t\tdisplay: block;\t\t\t\t\theight: 100px;\t\t\t\t}\t\t\t").appendTo("head")}}});(function(){for(var a=0,s=["ms","moz","webkit","o"],f=0;f<s.length&&!window.requestAnimationFrame;++f){window.requestAnimationFrame=window[s[f]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[s[f]+"CancelAnimationFrame"]||window[s[f]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(b){var p=(new Date).getTime(),A=Math.max(0,16-(p-a)),d=window.setTimeout(function(){b(p+A)},A);a=p+A;return d};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=
function(b){clearTimeout(b)}})();(function(a){function s(q){var M=q.originalEvent;if(!M.touches||M.targetTouches.length===1&&M.touches.length===1){d.call(this,q);q=a(this);q.bind(v,f);q.bind(n,b)}else{clearTimeout(C);A.call(this)}}function f(q){if(C!=null){var M=q.originalEvent;q=M.changedTouches?M.changedTouches[0].pageX:M.pageX;M=M.changedTouches?M.changedTouches[0].pageY:M.pageY;var Q=a(this).data("taphold.point");q=q-Q.x;M=M-Q.y;if(Math.sqrt(q*q+M*M)>c){clearTimeout(C);A.call(this)}}}function b(){clearTimeout(C);A.call(this)}
function p(q){A.call(this);a(this).data("taphold.handler").call(this,q)}function A(){C=null;a(this).unbind(v,f);a(this).unbind(n,b)}function d(q){if(C==null){var M=this;C=setTimeout(function(){p.call(M,q)},g);var Q=q.originalEvent,L={};L.x=Q.changedTouches?Q.changedTouches[0].pageX:Q.pageX;L.y=Q.changedTouches?Q.changedTouches[0].pageY:Q.pageY;a(this).data("taphold.point",L)}}var g=1E3,c=5,n="touchend",v="touchmove",C=null;a.event.special.taphold={setup:function(){},add:function(q){a(this).data("taphold.handler",
q.handler);q.data?a(this).bind("touchstart",q.data,s):a(this).bind("touchstart",s)},remove:function(q){clearTimeout(C);A.call(this);q.data?a(this).unbind("touchstart",q.data,s):a(this).unbind("touchstart",s)},teardown:function(){}}})(jQuery);
