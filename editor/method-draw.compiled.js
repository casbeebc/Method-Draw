function touchHandler(a){var u=a.changedTouches,e=u[0],b="";switch(a.type){case "touchstart":b="mousedown";break;case "touchmove":b="mousemove";break;case "touchend":b="mouseup";break;default:return}var m=document.createEvent("MouseEvent");m.initMouseEvent(b,true,true,window,1,e.screenX,e.screenY,e.clientX,e.clientY,false,false,false,false,0,null);if(u.length<2){e.target.dispatchEvent(m);a.preventDefault()}};(function(a){function u(e){if(typeof e.data==="string"){var b=e.handler,m=e.data.toLowerCase().split(" ");e.handler=function(A){if(!(this!==A.target&&(/textarea|select/i.test(A.target.nodeName)||A.target.type==="text"))){var c=A.type!=="keypress"&&a.hotkeys.specialKeys[A.which],g=String.fromCharCode(A.which).toLowerCase(),d="",o={};if(A.altKey&&c!=="alt")d+="alt+";if(A.ctrlKey&&c!=="ctrl")d+="ctrl+";if(A.metaKey&&!A.ctrlKey&&c!=="meta")d+="meta+";if(A.shiftKey&&c!=="shift")d+="shift+";if(c)o[d+c]=
true;else{o[d+g]=true;o[d+a.hotkeys.shiftNums[g]]=true;if(d==="shift+")o[a.hotkeys.shiftNums[g]]=true}c=0;for(g=m.length;c<g;c++)if(o[m[c]])return b.apply(this,arguments)}}}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta",219:"[",221:"]"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:u}})})(jQuery);(function(a,u){function e(ga){return typeof ga==="string"}function b(ga){var W=d.call(arguments,1);return function(){return ga.apply(this,W.concat(d.call(arguments)))}}function m(ga,W,ba,ja,pa){var ka;if(ja!==g){W=ba.match(ga?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);ba=W[3]||"";if(pa===2&&e(ja))ja=ja.replace(ga?ca:V,"");else{ka=q(W[2]);ja=e(ja)?q[ga?Z:K](ja):ja;ja=pa===2?ja:pa===1?a.extend({},ja,ka):a.extend({},ka,ja);ja=z(ja);if(ga)ja=ja.replace(ta,o)}ga=W[1]+(ga?"#":ja||!W[1]?"?":"")+ja+
ba}else ga=W(ba!==g?ba:u[U][S]);return ga}function A(ga,W,ba){if(W===g||typeof W==="boolean"){ba=W;W=z[ga?Z:K]()}else W=e(W)?W.replace(ga?ca:V,""):W;return q(W,ba)}function c(ga,W,ba,ja){if(!e(ba)&&typeof ba!=="object"){ja=ba;ba=W;W=g}return this.each(function(){var pa=a(this),ka=W||M()[(this.nodeName||"").toLowerCase()]||"",la=ka&&pa.attr(ka)||"";pa.attr(ka,z[ga](la,ba,ja))})}var g,d=Array.prototype.slice,o=decodeURIComponent,z=a.param,E,q,I,R=a.bbq=a.bbq||{},s,v,M,N=a.event.special,K="querystring",
Z="fragment",U="location",S="href",V=/^.*\?|#.*$/g,ca=/^.*\#/,ta,na={};z[K]=b(m,0,function(ga){return ga.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")});z[Z]=E=b(m,1,function(ga){return ga.replace(/^[^#]*#?(.*)$/,"$1")});E.noEscape=function(ga){ga=ga||"";ga=a.map(ga.split(""),encodeURIComponent);ta=RegExp(ga.join("|"),"g")};E.noEscape(",/");a.deparam=q=function(ga,W){var ba={},ja={"true":true,"false":false,"null":null};a.each(ga.replace(/\+/g," ").split("&"),function(pa,ka){var la=ka.split("="),za=o(la[0]),
Aa=ba,Ja=0,Ia=za.split("]["),Fa=Ia.length-1;if(/\[/.test(Ia[0])&&/\]$/.test(Ia[Fa])){Ia[Fa]=Ia[Fa].replace(/\]$/,"");Ia=Ia.shift().split("[").concat(Ia);Fa=Ia.length-1}else Fa=0;if(la.length===2){la=o(la[1]);if(W)la=la&&!isNaN(la)?+la:la==="undefined"?g:ja[la]!==g?ja[la]:la;if(Fa)for(;Ja<=Fa;Ja++){za=Ia[Ja]===""?Aa.length:Ia[Ja];Aa=Aa[za]=Ja<Fa?Aa[za]||(Ia[Ja+1]&&isNaN(Ia[Ja+1])?{}:[]):la}else if(a.isArray(ba[za]))ba[za].push(la);else ba[za]=ba[za]!==g?[ba[za],la]:la}else if(za)ba[za]=W?g:""});return ba};
q[K]=b(A,0);q[Z]=I=b(A,1);a.elemUrlAttr||(a.elemUrlAttr=function(ga){return a.extend(na,ga)})({a:S,base:S,iframe:"src",img:"src",input:"src",form:"action",link:S,script:"src"});M=a.elemUrlAttr;a.fn[K]=b(c,K);a.fn[Z]=b(c,Z);R.pushState=s=function(ga,W){if(e(ga)&&/^#/.test(ga)&&W===g)W=2;var ba=ga!==g;ba=E(u[U][S],ba?ga:{},ba?W:2);u[U][S]=ba+(/#/.test(ba)?"":"#")};R.getState=v=function(ga,W){return ga===g||typeof ga==="boolean"?I(ga):I(W)[ga]};R.removeState=function(ga){var W={};if(ga!==g){W=v();a.each(a.isArray(ga)?
ga:arguments,function(ba,ja){delete W[ja]})}s(W,2)};N.hashchange=a.extend(N.hashchange,{add:function(ga){function W(ja){var pa=ja[Z]=E();ja.getState=function(ka,la){return ka===g||typeof ka==="boolean"?q(pa,ka):q(pa,la)[ka]};ba.apply(this,arguments)}var ba;if(a.isFunction(ga)){ba=ga;return W}else{ba=ga.handler;ga.handler=W}}})})(jQuery,this);
(function(a,u,e){function b(E){E=E||u[c][g];return E.replace(/^[^#]*#?(.*)$/,"$1")}var m,A=a.event.special,c="location",g="href",d=document.documentMode,o=a.browser.msie&&(d===e||d<8),z="onhashchange"in u&&!o;a.hashchangeDelay=100;A.hashchange=a.extend(A.hashchange,{setup:function(){if(z)return false;a(m.start)},teardown:function(){if(z)return false;a(m.stop)}});m=function(){function E(){s=v=function(M){return M};if(o){R=a('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;
v=function(){return b(R.document[c][g])};s=function(M,N){if(M!==N){var K=R.document;K.open().close();K[c].hash="#"+M}};s(b())}}var q={},I,R,s,v;q.start=function(){if(!I){var M=b();s||E();(function N(){var K=b(),Z=v(M);if(K!==M){s(M=K,Z);a(u).trigger("hashchange")}else if(Z!==M)u[c][g]=u[c][g].replace(/#.*/,"")+"#"+Z;I=setTimeout(N,a.hashchangeDelay)})()}};q.stop=function(){if(!R){I&&clearTimeout(I);I=0}};return q}()})(jQuery,this);(function(a){var u={},e;a.svgIcons=function(b,m){function A(ga,W){if(ga!=="ajax"){if(M)return;var ba=(R=S[0].contentDocument)&&R.getElementById("svg_eof");if(!ba&&!(W&&ba)){N++;if(N<50)setTimeout(A,20);else{g();M=true}return}M=true}I=a(R.firstChild).children();if(m.no_img)setTimeout(function(){v||c()},500);else{ba=U+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzUiIGhlaWdodD0iMjc1Ij48L3N2Zz4%3D";s=a(new Image).attr({src:ba,width:0,height:0}).appendTo("body").load(function(){c(true)}).error(function(){c()})}}
function c(ga,W){if(!v){if(m.no_img)ga=false;if(ga){var ba=a(document.createElement("div"));ba.hide().appendTo("body")}if(W){var ja=m.fallback_path?m.fallback_path:"";a.each(W,function(Fa,Ma){a("#"+Fa);var Da=a(new Image).attr({"class":"svg_icon",src:ja+Ma,width:E,height:q,alt:"icon"});na(Da,Fa)})}else for(var pa=I.length,ka=0;ka<pa;ka++){var la=I[ka],za=la.id;if(za==="svg_eof")break;a("#"+za);la=la.getElementsByTagNameNS(o,"svg")[0];var Aa=document.createElementNS(o,"svg");Aa.setAttributeNS(o,"viewBox",
[0,0,E,q].join(" "));var Ja=la.getAttribute("width"),Ia=la.getAttribute("height");la.removeAttribute("width");la.removeAttribute("height");la.getAttribute("viewBox")||la.setAttribute("viewBox",[0,0,Ja,Ia].join(" "));Aa.setAttribute("xmlns",o);Aa.setAttribute("width",E);Aa.setAttribute("height",q);Aa.setAttribute("xmlns:xlink",z);Aa.setAttribute("class","svg_icon");Z||(la=la.cloneNode(true));Aa.appendChild(la);if(ga){Z||Aa.cloneNode(true);ba.empty().append(Aa);la=U+d(ba.html());la=a(new Image).attr({"class":"svg_icon",
src:la})}else la=e(a(Aa),ka);na(la,za)}m.placement&&a.each(m.placement,function(Fa,Ma){u[Ma]&&a(Fa).each(function(Da){var xa=u[Ma].clone();if(Da>0&&!ga)xa=e(xa,Da,true);ta(a(this),xa,Ma)})});if(!W){ga&&ba.remove();S&&S.remove();s&&s.remove()}m.resize&&a.resizeSvgIcons(m.resize);v=true;m.callback&&m.callback(u)}}function g(){if(b.indexOf(".svgz")!=-1){var ga=b.replace(".svgz",".svg");window.console&&console.log(".svgz failed, trying with .svg");a.svgIcons(ga,m)}else m.fallback&&c(false,m.fallback)}
function d(ga){if(window.btoa)return window.btoa(ga);var W=Array(Math.floor((ga.length+2)/3)*4),ba,ja,pa,ka,la,za,Aa=0,Ja=0;do{ba=ga.charCodeAt(Aa++);ja=ga.charCodeAt(Aa++);pa=ga.charCodeAt(Aa++);ka=ba>>2;ba=(ba&3)<<4|ja>>4;la=(ja&15)<<2|pa>>6;za=pa&63;if(isNaN(ja))la=za=64;else if(isNaN(pa))za=64;W[Ja++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(ka);W[Ja++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(ba);W[Ja++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(la);
W[Ja++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(za)}while(Aa<ga.length);return W.join("")}var o="http://www.w3.org/2000/svg",z="http://www.w3.org/1999/xlink",E=m.w?m.w:24,q=m.h?m.h:24,I,R,s,v=false,M=false,N=0,K=navigator.userAgent,Z=!!window.opera;K.indexOf("Safari/")>-1&&K.indexOf("Chrome/");var U="data:image/svg+xml;charset=utf-8;base64,";if(m.svgz){var S=a('<object data="'+b+'" type=image/svg+xml>').appendTo("body").hide();try{R=S[0].contentDocument;S.load(A);
A(0,true)}catch(V){g()}}else{var ca=new DOMParser;a.ajax({url:b,dataType:"string",success:function(ga){if(ga){R=ca.parseFromString(ga,"text/xml");a(function(){A("ajax")})}else a(g)},error:function(ga){if(window.opera)a(function(){g()});else if(ga.responseText){R=ca.parseFromString(ga.responseText,"text/xml");R.childNodes.length||a(g);a(function(){A("ajax")})}else a(g)}})}var ta=function(ga,W,ba,ja){Z&&W.css("visibility","hidden");if(m.replace){ja&&W.attr("id",ba);(ba=ga.attr("class"))&&W.attr("class",
"svg_icon "+ba);ga.replaceWith(W)}else ga.append(W);Z&&setTimeout(function(){W.removeAttr("style")},1)},na=function(ga,W){if(m.id_match===undefined||m.id_match!==false)ta(holder,ga,W,true);u[W]=ga};e=function(ga,W){var ba=ga.find("defs");if(!ba.length)return ga;ba=Z?ba.find("*").filter(function(){return!!this.id}):ba.find("[id]");var ja=ga[0].getElementsByTagName("*"),pa=ja.length;ba.each(function(ka){var la=this.id;a(R).find("#"+la);this.id=ka="x"+la+W+ka;la="url(#"+la+")";var za="url(#"+ka+")";
for(ka=0;ka<pa;ka++){var Aa=ja[ka];Aa.getAttribute("fill")===la&&Aa.setAttribute("fill",za);Aa.getAttribute("stroke")===la&&Aa.setAttribute("stroke",za);Aa.getAttribute("filter")===la&&Aa.setAttribute("filter",za)}});return ga}};a.getSvgIcon=function(b,m){var A=u[b];if(m&&A)A=e(A,0,true).clone(true);return A};a.resizeSvgIcons=function(b){var m=!a(".svg_icon:first").length;a.each(b,function(A,c){var g=a.isArray(c),d=g?c[0]:c,o=g?c[1]:c;if(m)A=A.replace(/\.svg_icon/g,"svg");a(A).each(function(){this.setAttribute("width",
d);this.setAttribute("height",o);if(window.opera&&window.widget){this.parentNode.style.width=d+"px";this.parentNode.style.height=o+"px"}})})}})(jQuery);(function(){function a(b,m,A){b=document.createElementNS(u.svg,b);if(e)for(var c in m)b.setAttribute(c,m[c]);else for(c in m){var g=m[c],d=b[c];if(d&&d.constructor==="SVGLength")d.baseVal.value=g;else b.setAttribute(c,g)}A&&A.appendChild(b);return b}var u={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};if(!window.console)window.console=new function(){this.log=function(){};this.dir=function(){}};$.jGraduate={Paint:function(b){b=b||{};this.alpha=isNaN(b.alpha)?100:b.alpha;if(b.copy){this.type=
b.copy.type;this.alpha=b.copy.alpha;this.radialGradient=this.linearGradient=this.solidColor=null;switch(this.type){case "solidColor":this.solidColor=b.copy.solidColor;break;case "linearGradient":this.linearGradient=b.copy.linearGradient.cloneNode(true);break;case "radialGradient":this.radialGradient=b.copy.radialGradient.cloneNode(true)}}else if(b.linearGradient){this.type="linearGradient";this.radialGradient=this.solidColor=null;this.linearGradient=b.linearGradient.cloneNode(true)}else if(b.radialGradient){this.type=
"radialGradient";this.linearGradient=this.solidColor=null;this.radialGradient=b.radialGradient.cloneNode(true)}else if(b.solidColor){this.type="solidColor";this.solidColor=b.solidColor}else{this.type="none";this.radialGradient=this.linearGradient=this.solidColor=null}}};jQuery.fn.jGraduateDefaults={paint:new $.jGraduate.Paint,window:{pickerTitle:"Drag markers to pick a paint"},images:{clientPath:"images/"},newstop:"inverse"};var e=navigator.userAgent.indexOf("Gecko/")>=0;jQuery.fn.jGraduate=function(b){var m=
arguments;return this.each(function(){function A(ma,da,oa,P,T){var fa=T||a("stop",{"stop-color":da,"stop-opacity":oa,offset:ma},ca);if(T){da=T.getAttribute("stop-color");oa=T.getAttribute("stop-opacity");ma=T.getAttribute("offset")}else ca.appendChild(fa);if(oa===null)oa=1;T=a("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:"url(#jGraduate_trans)",transform:"translate("+(10+ma*Z)+", 26)"},kb);var Ea=
a("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:da,"fill-opacity":oa,transform:"translate("+(10+ma*Z)+", 26)",stroke:"#000","stroke-width":1.5},kb);$(Ea).mousedown(function(Oa){c(this);Va=cb;M.mousemove(o).mouseup(g);ua=vb.offset();Oa.preventDefault();return false}).data("stop",fa).data("bg",T).dblclick(function(){$("div.jGraduate_LightBox").show();for(var Oa=this,Wa=+fa.getAttribute("stop-opacity")||
1,Za=fa.getAttribute("stop-color")||1,nb=(parseFloat(Wa)*255).toString(16);nb.length<2;)nb="0"+nb;da=Za.substr(1)+nb;$("#"+q+"_jGraduate_stopPicker").css({left:100,bottom:15}).jPicker({window:{title:"Pick the start color and opacity for the gradient"},images:{clientPath:E.images.clientPath},color:{active:da,alphaSupport:true}},function(Ra){Za=Ra.val("hex")?"#"+Ra.val("hex"):"none";Wa=Ra.val("a")!==null?Ra.val("a")/256:1;Oa.setAttribute("fill",Za);Oa.setAttribute("fill-opacity",Wa);fa.setAttribute("stop-color",
Za);fa.setAttribute("stop-opacity",Wa);$("div.jGraduate_LightBox").hide();$("#"+q+"_jGraduate_stopPicker").hide()},null,function(){$("div.jGraduate_LightBox").hide();$("#"+q+"_jGraduate_stopPicker").hide()})});$(ca).find("stop").each(function(){var Oa=$(this);if(+this.getAttribute("offset")>ma){if(!da){var Wa=this.getAttribute("stop-color"),Za=this.getAttribute("stop-opacity");fa.setAttribute("stop-color",Wa);Ea.setAttribute("fill",Wa);fa.setAttribute("stop-opacity",Za===null?1:Za);Ea.setAttribute("fill-opacity",
Za===null?1:Za)}Oa.before(fa);return false}});P&&c(Ea);return fa}function c(ma){cb&&cb.setAttribute("stroke","#000");ma.setAttribute("stroke","blue");cb=ma;cb.parentNode.appendChild(cb)}function g(){M.unbind("mousemove",o);if(Ga.getAttribute("display")!=="none"){Ga.setAttribute("display","none");var ma=$(cb),da=ma.data("stop");ma=ma.data("bg");$([cb,da,ma]).remove()}Va=null}function d(){var ma=Sa?"rotate("+Sa+","+Ha+","+db+") ":"";$a===1&&Ka===1?ca.removeAttribute("gradientTransform"):ca.setAttribute("gradientTransform",
ma+"translate("+-Ha*($a-1)+","+-db*(Ka-1)+") scale("+$a+","+Ka+")")}function o(ma){var da=ma.pageX-ua.left;ma=ma.pageY-ua.top;da=da<10?10:da>Z+10?Z+10:da;var oa="translate("+da+", 26)";if(ma<-60||ma>130){Ga.setAttribute("display","block");Ga.setAttribute("transform",oa)}else Ga.setAttribute("display","none");Va.setAttribute("transform",oa);$.data(Va,"bg").setAttribute("transform",oa);$.data(Va,"stop").setAttribute("offset",(da-10)/Z);var P=0;$(ca).find("stop").each(function(){var T=this.getAttribute("offset"),
fa=$(this);if(T<P){fa.prev().before(fa);wa=$(ca).find("stop")}P=T})}var z=$(this),E=$.extend(true,{},jQuery.fn.jGraduateDefaults,b),q=z.attr("id"),I="#"+z.attr("id")+" ";if(I){var R=function(){switch(z.paint.type){case "radialGradient":z.paint.linearGradient=null;break;case "linearGradient":z.paint.radialGradient=null;break;case "solidColor":z.paint.radialGradient=z.paint.linearGradient=null}$.isFunction(z.okCallback)&&z.okCallback(z.paint);z.hide()},s=function(){$.isFunction(z.cancelCallback)&&z.cancelCallback();
z.hide()};$.extend(true,z,{paint:new $.jGraduate.Paint({copy:E.paint}),okCallback:$.isFunction(m[1])&&m[1]||null,cancelCallback:$.isFunction(m[2])&&m[2]||null});z.position();var v=null,M=$(window);if(z.paint.type=="none")z.paint=$.jGraduate.Paint({solidColor:"ffffff"});z.addClass("jGraduate_Picker");z.html('<ul class="jGraduate_tabs"><li class="jGraduate_tab_color jGraduate_tab_current" data-type="col">Solid Color</li><li class="jGraduate_tab_lingrad" data-type="lg">Linear Gradient</li><li class="jGraduate_tab_radgrad" data-type="rg">Radial Gradient</li></ul><div class="jGraduate_colPick"></div><div class="jGraduate_gradPick"></div><div class="jGraduate_LightBox"></div><div id="'+
q+'_jGraduate_stopPicker" class="jGraduate_stopPicker"></div>');var N=$(I+"> .jGraduate_colPick"),K=$(I+"> .jGraduate_gradPick");K.html('<div id="'+q+'_jGraduate_Swatch" class="jGraduate_Swatch"><h2 class="jGraduate_Title">'+E.window.pickerTitle+'</h2><div id="'+q+'_jGraduate_GradContainer" class="jGraduate_GradContainer"></div><div id="'+q+'_jGraduate_StopSlider" class="jGraduate_StopSlider"></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_lg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Begin Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+
q+'_jGraduate_x1" size="3" title="Enter starting x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+q+'_jGraduate_y1" size="3" title="Enter starting y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">End Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+q+'_jGraduate_x2" size="3" title="Enter ending x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+
q+'_jGraduate_y2" size="3" title="Enter ending y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_rg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Center Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+q+'_jGraduate_cx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+q+'_jGraduate_cy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Focal Point</label><div class="jGraduate_Form_Section"><label>Match center: <input type="checkbox" checked="checked" id="'+
q+'_jGraduate_match_ctr"/></label><br/><label>x:</label><input type="text" id="'+q+'_jGraduate_fx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+q+'_jGraduate_fy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_StopSection jGraduate_SpreadMethod"><label class="jGraduate_Form_Heading">Spread method</label><div class="jGraduate_Form_Section"><select class="jGraduate_spreadMethod"><option value=pad selected>Pad</option><option value=reflect>Reflect</option><option value=repeat>Repeat</option></select></div></div><div class="jGraduate_Form"><div class="jGraduate_Slider jGraduate_RadiusField jGraduate_rg_field"><label class="prelabel">Radius:</label><div id="'+
q+'_jGraduate_Radius" class="jGraduate_SliderBar jGraduate_Radius" title="Click to set radius"><img id="'+q+'_jGraduate_RadiusArrows" class="jGraduate_RadiusArrows" src="'+E.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_RadiusInput" size="3" value="100"/>%</label></div><div class="jGraduate_Slider jGraduate_EllipField jGraduate_rg_field"><label class="prelabel">Ellip:</label><div id="'+q+'_jGraduate_Ellip" class="jGraduate_SliderBar jGraduate_Ellip" title="Click to set Ellip"><img id="'+
q+'_jGraduate_EllipArrows" class="jGraduate_EllipArrows" src="'+E.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_EllipInput" size="3" value="0"/>%</label></div><div class="jGraduate_Slider jGraduate_AngleField jGraduate_rg_field"><label class="prelabel">Angle:</label><div id="'+q+'_jGraduate_Angle" class="jGraduate_SliderBar jGraduate_Angle" title="Click to set Angle"><img id="'+q+'_jGraduate_AngleArrows" class="jGraduate_AngleArrows" src="'+E.images.clientPath+
'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_AngleInput" size="3" value="0"/>\u00ba&nbsp;</label></div><div class="jGraduate_Slider jGraduate_OpacField"><label class="prelabel">Opac:</label><div id="'+q+'_jGraduate_Opac" class="jGraduate_SliderBar jGraduate_Opac" title="Click to set Opac"><img id="'+q+'_jGraduate_OpacArrows" class="jGraduate_OpacArrows" src="'+E.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+q+'_jGraduate_OpacInput" size="3" value="100"/>%</label></div></div><div class="jGraduate_OkCancel"><input type="button" id="'+
q+'_jGraduate_Ok" class="jGraduate_Ok" value="OK"/><input type="button" id="'+q+'_jGraduate_Cancel" class="jGraduate_Cancel" value="Cancel"/></div>');var Z=256,U=Z-0,S=Z-0,V,ca,ta,na={};$(".jGraduate_SliderBar").width(145);var ga=$("#"+q+"_jGraduate_GradContainer")[0],W=a("svg",{id:q+"_jgraduate_svg",width:Z,height:Z,xmlns:u.svg},ga);V=V||z.paint.type;var ba=ca=z.paint[V],ja=z.paint.alpha,pa=V==="solidColor";switch(V){case "solidColor":case "linearGradient":if(!pa){ca.id=q+"_lg_jgraduate_grad";ba=
ca=W.appendChild(ca)}a("radialGradient",{id:q+"_rg_jgraduate_grad"},W);if(V==="linearGradient")break;case "radialGradient":if(!pa){ca.id=q+"_rg_jgraduate_grad";ba=ca=W.appendChild(ca)}a("linearGradient",{id:q+"_lg_jgraduate_grad"},W)}if(pa){ba=ca=$("#"+q+"_lg_jgraduate_grad")[0];v=z.paint[V];A(0,"#"+v,1);var ka=typeof E.newstop;if(ka==="string")switch(E.newstop){case "same":A(1,"#"+v,1);break;case "inverse":ka="";for(var la=0;la<6;la+=2){v.substr(la,2);var za=(255-parseInt(v.substr(la,2),16)).toString(16);
if(za.length<2)za=0+za;ka+=za}A(1,"#"+ka,1);break;case "white":A(1,"#ffffff",1);break;case "black":A(1,"#000000",1)}else if(ka==="object")A(1,E.newstop.color||"#"+v,"opac"in E.newstop?E.newstop.opac:1)}v=parseFloat(ba.getAttribute("x1")||0);ka=parseFloat(ba.getAttribute("y1")||0);la=parseFloat(ba.getAttribute("x2")||1);za=parseFloat(ba.getAttribute("y2")||0);var Aa=parseFloat(ba.getAttribute("cx")||0.5),Ja=parseFloat(ba.getAttribute("cy")||0.5),Ia=parseFloat(ba.getAttribute("fx")||Aa),Fa=parseFloat(ba.getAttribute("fy")||
Ja);ta=a("rect",{id:q+"_jgraduate_rect",x:0,y:0,width:U,height:S,fill:"url(#"+q+"_jgraduate_grad)","fill-opacity":ja/100},W);var Ma=$("<div/>").attr({"class":"grad_coord jGraduate_lg_field",title:"Begin Stop"}).text(1).css({top:ka*Z,left:v*Z}).data("coord","start").appendTo(ga),Da=Ma.clone().text(2).css({top:za*Z,left:la*Z}).attr("title","End stop").data("coord","end").appendTo(ga),xa=$("<div/>").attr({"class":"grad_coord jGraduate_rg_field",title:"Center stop"}).text("C").css({top:Ja*Z,left:Aa*Z}).data("coord",
"center").appendTo(ga),ra=xa.clone().text("F").css({top:Fa*Z,left:Ia*Z,display:"none"}).attr("title","Focus point").data("coord","focus").appendTo(ga);ra[0].id=q+"_jGraduate_focusCoord";$(I+" .grad_coord");$.each(["x1","y1","x2","y2","cx","cy","fx","fy"],function(ma,da){var oa=ca.getAttribute(da),P=isNaN(da[1]);oa||(oa=P?"0.5":da==="x2"?"1.0":"0.0");na[da]=$("#"+q+"_jGraduate_"+da).val(oa).change(function(){if(isNaN(parseFloat(this.value))||this.value<0)this.value=0;else if(this.value>1)this.value=
1;if(!(da[0]==="f"&&!eb))if(P&&V==="radialGradient"||!P&&V==="linearGradient")ca.setAttribute(da,this.value);var T=P?da[0]==="c"?xa:ra:da[1]==="1"?Ma:Da,fa=da.indexOf("x")>=0?"left":"top";T.css(fa,this.value*Z)}).change()});var wa,kb,vb=$("#"+q+"_jGraduate_StopSlider"),cb,Ta,Va,Ga=a("path",{d:"m9.75,-6l-19.5,19.5m0,-19.5l19.5,19.5",fill:"none",stroke:"#D00","stroke-width":5,display:"none"},Ta),ua,$a=1,Ka=1,Sa=0,Ha=Aa,db=Ja;Ta=a("svg",{width:"100%",height:45},vb[0]);ga=a("pattern",{width:16,height:16,
patternUnits:"userSpaceOnUse",id:"jGraduate_trans"},Ta);a("image",{width:16,height:16},ga).setAttributeNS(u.xlink,"xlink:href",E.images.clientPath+"map-opacity.png");$(Ta).on("click touchstart",function(ma){ua=vb.offset();if(ma.target.tagName!=="path"){var da=ma.pageX-ua.left-8;da=da<10?10:da>Z+10?Z+10:da;A(da/Z,0,0,true);ma.stopPropagation()}});$(Ta).mouseover(function(){Ta.appendChild(Ga)});kb=a("g",{},Ta);a("line",{x1:10,y1:15,x2:Z+10,y2:15,"stroke-width":2,stroke:"#000"},Ta);var lb=K.find(".jGraduate_spreadMethod").change(function(){ca.setAttribute("spreadMethod",
$(this).val())}),Ua=null,Xa=function(ma){var da=ma.pageX-hb.left,oa=ma.pageY-hb.top;da=da<0?0:da>Z?Z:da;oa=oa<0?0:oa>Z?Z:oa;Ua.css("left",da).css("top",oa);da=da/U;oa=oa/S;var P=Ua.data("coord"),T=ca;switch(P){case "start":na.x1.val(da);na.y1.val(oa);T.setAttribute("x1",da);T.setAttribute("y1",oa);break;case "end":na.x2.val(da);na.y2.val(oa);T.setAttribute("x2",da);T.setAttribute("y2",oa);break;case "center":na.cx.val(da);na.cy.val(oa);T.setAttribute("cx",da);T.setAttribute("cy",oa);Ha=da;db=oa;d();
break;case "focus":na.fx.val(da);na.fy.val(oa);T.setAttribute("fx",da);T.setAttribute("fy",oa);d()}ma.preventDefault()},wb=function(){Ua=null;M.unbind("mousemove",Xa).unbind("mouseup",wb)};wa=ca.getElementsByTagNameNS(u.svg,"stop");if(sa<2){for(;sa<2;){ca.appendChild(document.createElementNS(u.svg,"stop"));++sa}wa=ca.getElementsByTagNameNS(u.svg,"stop")}var sa=wa.length;for(la=0;la<sa;la++)A(0,0,0,0,wa[la]);lb.val(ca.getAttribute("spreadMethod")||"pad");var hb,eb=false;ta.setAttribute("fill-opacity",
ja/100);$("#"+q+" div.grad_coord").mousedown(function(ma){ma.preventDefault();Ua=$(this);Ua.offset();hb=Ua.parent().offset();M.mousemove(Xa).mouseup(wb)});$("#"+q+"_jGraduate_Ok").bind("click touchstart",function(){z.paint.type=V;z.paint[V]=ca.cloneNode(true);z.paint.solidColor=null;R()});$("#"+q+"_jGraduate_Cancel").bind("click touchstart",function(){s()});if(V==="radialGradient")if(eb)ra.show();else{ra.hide();na.fx.val("");na.fy.val("")}$("#"+q+"_jGraduate_match_ctr")[0].checked=!eb;var sb,ib;$("#"+
q+"_jGraduate_match_ctr").change(function(){eb=!this.checked;ra.toggle(eb);na.fx.val("");na.fy.val("");var ma=ca;if(eb){var da=sb||0.5,oa=ib||0.5;ma.setAttribute("fx",da);ma.setAttribute("fy",oa);na.fx.val(da);na.fy.val(oa)}else{sb=ma.getAttribute("fx");ib=ma.getAttribute("fy");ma.removeAttribute("fx");ma.removeAttribute("fy")}});wa=ca.getElementsByTagNameNS(u.svg,"stop");sa=wa.length;if(sa<2){for(;sa<2;){ca.appendChild(document.createElementNS(u.svg,"stop"));++sa}wa=ca.getElementsByTagNameNS(u.svg,
"stop")}var ab;ja=K=0;if(V==="radialGradient"){W=ca.gradientTransform.baseVal;if(W.numberOfItems===2){sa=W.getItem(0);W=W.getItem(1);if(sa.type===2&&W.type===3){sa=W.matrix;if(sa.a!==1)K=Math.round(-(1-sa.a)*100);else if(sa.d!==1)K=Math.round((1-sa.d)*100)}}else if(W.numberOfItems===3){ga=W.getItem(0);sa=W.getItem(1);W=W.getItem(2);if(ga.type===4&&sa.type===2&&W.type===3){ja=Math.round(ga.angle);sa=W.matrix;if(sa.a!==1)K=Math.round(-(1-sa.a)*100);else if(sa.d!==1)K=Math.round((1-sa.d)*100)}}}K={radius:{handle:"#"+
q+"_jGraduate_RadiusArrows",input:"#"+q+"_jGraduate_RadiusInput",val:(ca.getAttribute("r")||0.5)*100},opacity:{handle:"#"+q+"_jGraduate_OpacArrows",input:"#"+q+"_jGraduate_OpacInput",val:z.paint.alpha||100},ellip:{handle:"#"+q+"_jGraduate_EllipArrows",input:"#"+q+"_jGraduate_EllipInput",val:K},angle:{handle:"#"+q+"_jGraduate_AngleArrows",input:"#"+q+"_jGraduate_AngleInput",val:ja}};$.each(K,function(ma,da){var oa=$(da.handle);oa.mousedown(function(P){var T=oa.parent();ab={type:ma,elem:oa,input:$(da.input),
parent:T,offset:T.offset()};M.mousemove(ob).mouseup(pb);P.preventDefault()});$(da.input).val(da.val).change(function(){var P=+this.value,T=0,fa=V==="radialGradient";switch(ma){case "radius":fa&&ca.setAttribute("r",P/100);T=Math.pow(P/100,0.4)/2*145;break;case "opacity":z.paint.alpha=P;ta.setAttribute("fill-opacity",P/100);T=P*1.45;break;case "ellip":$a=Ka=1;if(P===0){T=72.5;break}if(P>99.5)P=99.5;if(P>0)Ka=1-P/100;else $a=-(P/100)-1;T=145*((P+100)/2)/100;fa&&d();break;case "angle":Sa=P;T=Sa/180;T+=
0.5;T*=145;fa&&d()}if(T>145)T=145;else if(T<0)T=0;oa.css({"margin-left":T-5})}).change()});var ob=function(ma){var da=ma.pageX-ab.offset.left-parseInt(ab.parent.css("border-left-width"));if(da>145)da=145;if(da<=0)da=0;var oa=da-5;da/=145;switch(ab.type){case "radius":da=Math.pow(da*2,2.5);if(da>0.98&&da<1.02)da=1;if(da<=0.01)da=0.01;ca.setAttribute("r",da);break;case "opacity":z.paint.alpha=parseInt(da*100);ta.setAttribute("fill-opacity",da);break;case "ellip":Ka=$a=1;if(da<0.5){da/=0.5;$a=da<=0?
0.01:da}else if(da>0.5){da/=0.5;da=2-da;Ka=da<=0?0.01:da}d();da-=1;if(Ka===da+1)da=Math.abs(da);break;case "angle":da-=0.5;Sa=da*=180;d();da/=100}ab.elem.css({"margin-left":oa});da=Math.round(da*100);ab.input.val(da);ma.preventDefault()},pb=function(){M.unbind("mousemove",ob).unbind("mouseup",pb);ab=null};for(K=(z.paint.alpha*255/100).toString(16);K.length<2;)K="0"+K;K=K.split(".")[0];v=z.paint.solidColor=="none"?"":z.paint.solidColor+K;pa||(v=wa[0].getAttribute("stop-color"));$.extend($.fn.jPicker.defaults.window,
{alphaSupport:true,effects:{type:"show",speed:0}});N.jPicker({window:{title:E.window.pickerTitle},images:{clientPath:E.images.clientPath},color:{active:v,alphaSupport:true}},function(ma){z.paint.type="solidColor";z.paint.alpha=ma.val("ahex")?Math.round(ma.val("a")/255*100):100;z.paint.solidColor=ma.val("hex")?ma.val("hex"):"none";z.paint.radialGradient=null;R()},null,function(){s()});var fb=$(I+" .jGraduate_tabs li");fb.on("click touchstart",function(){fb.removeClass("jGraduate_tab_current");$(this).addClass("jGraduate_tab_current");
$(I+" > div").hide();var ma=$(this).attr("data-type");$(I+" .jGraduate_gradPick").show();if(ma==="rg"||ma==="lg"){$(".jGraduate_"+ma+"_field").show();$(".jGraduate_"+(ma==="lg"?"rg":"lg")+"_field").hide();$("#"+q+"_jgraduate_rect")[0].setAttribute("fill","url(#"+q+"_"+ma+"_jgraduate_grad)");V=ma==="lg"?"linearGradient":"radialGradient";$("#"+q+"_jGraduate_OpacInput").val(z.paint.alpha).change();var da=$("#"+q+"_"+ma+"_jgraduate_grad")[0];if(ca!==da){var oa=$(ca).find("stop");$(da).empty().append(oa);
ca=da;da=lb.val();ca.setAttribute("spreadMethod",da)}eb=ma==="rg"&&ca.getAttribute("fx")!=null&&!(Aa==Ia&&Ja==Fa);$("#"+q+"_jGraduate_focusCoord").toggle(eb);if(eb)$("#"+q+"_jGraduate_match_ctr")[0].checked=false}else{$(I+" .jGraduate_gradPick").hide();$(I+" .jGraduate_colPick").show()}});$(I+" > div").hide();fb.removeClass("jGraduate_tab_current");var tb;switch(z.paint.type){case "linearGradient":tb=$(I+" .jGraduate_tab_lingrad");break;case "radialGradient":tb=$(I+" .jGraduate_tab_radgrad");break;
default:tb=$(I+" .jGraduate_tab_color")}z.show();setTimeout(function(){tb.addClass("jGraduate_tab_current").click()},10)}else alert("Container element must have an id attribute to maintain unique id strings for sub-elements.")})}})();jQuery&&function(){var a=$(window),u=$(document);$.extend($.fn,{contextMenu:function(e,b){if(e.menu==undefined)return false;if(e.inSpeed==undefined)e.inSpeed=150;if(e.outSpeed==undefined)e.outSpeed=75;if(e.inSpeed==0)e.inSpeed=-1;if(e.outSpeed==0)e.outSpeed=-1;$(this).each(function(){var m=$(this),A=$(m).offset(),c=$("#"+e.menu);c.addClass("contextMenu");$(this).bind("mousedown",function(d){$(this).on("mouseup",function(o){var z=$(this);z.unbind("mouseup");$(".contextMenu").hide();if(d.button===2||
e.allowLeft||d.ctrlKey&&svgedit.browser.isMac())svgedit.browser.isTouch()||g(o,d,z)})});svgedit.browser.isTouch()&&$(this).bind("taphold",function(d){var o=$(this);o.unbind("mouseup");g(d,d,o)});var g=function(d,o,z){if(typeof o=="undefined")o=d;d.stopPropagation();if(m.hasClass("disabled")||o.altKey)return false;var E=d.pageX,q=d.pageY;if(svgedit.browser.isTouch()){E=d.originalEvent.touches[0].pageX;q=d.originalEvent.touches[0].pageY}d=a.width()-c.width();o=a.height()-c.height();if(E>d-15)E=d-15;
if(q>o-30)q=o-30;if(svgedit.browser.isTouch())q-=c.height()/2;u.unbind("click");c.css({top:q,left:E}).fadeIn(e.inSpeed);c.find("A").mouseover(function(){c.find("LI.hover").removeClass("hover");$(this).parent().addClass("hover")}).mouseout(function(){c.find("LI.hover").removeClass("hover")});u.keypress(function(I){switch(I.keyCode){case 38:if(c.find("LI.hover").length){c.find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover");c.find("LI.hover").length||c.find("LI:last").addClass("hover")}else c.find("LI:last").addClass("hover");
break;case 40:if(c.find("LI.hover").length==0)c.find("LI:first").addClass("hover");else{c.find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover");c.find("LI.hover").length||c.find("LI:first").addClass("hover")}break;case 13:c.find("LI.hover A").trigger("click");break;case 27:u.trigger("click")}});c.find("A").unbind("mouseup");c.find("LI:not(.disabled) A").mouseup(function(){u.unbind("click").unbind("keypress");$(".contextMenu").hide();b&&b($(this).attr("href").substr(1),
$(z),{x:E-A.left,y:q-A.top,docX:E,docY:q});return false});setTimeout(function(){u.click(function(){u.unbind("click").unbind("keypress");c.fadeOut(e.outSpeed);return false})},0)};if($.browser.mozilla)$("#"+e.menu).each(function(){$(this).css({MozUserSelect:"none"})});else $.browser.msie?$("#"+e.menu).each(function(){$(this).bind("selectstart.disableTextSelect",function(){return false})}):$("#"+e.menu).each(function(){$(this).bind("mousedown.disableTextSelect",function(){return false})});$(m).add($("UL.contextMenu")).bind("contextmenu",
function(){return false})});return $(this)},disableContextMenuItems:function(e){if(e==undefined){$(this).find("LI").addClass("disabled");return $(this)}$(this).each(function(){if(e!=undefined)for(var b=e.split(","),m=0;m<b.length;m++)$(this).find('A[href="'+b[m]+'"]').parent().addClass("disabled")});return $(this)},enableContextMenuItems:function(e){if(e==undefined){$(this).find("LI.disabled").removeClass("disabled");return $(this)}$(this).each(function(){if(e!=undefined)for(var b=e.split(","),m=
0;m<b.length;m++)$(this).find('A[href="'+b[m]+'"]').parent().removeClass("disabled")});return $(this)},disableContextMenu:function(){$(this).each(function(){$(this).addClass("disabled")});return $(this)},enableContextMenu:function(){$(this).each(function(){$(this).removeClass("disabled")});return $(this)},destroyContextMenu:function(){$(this).each(function(){$(this).unbind("mousedown").unbind("mouseup")});return $(this)}})}(jQuery);(function(){function a(u,e,b){var m=a.resolve(u);if(null==m){b=b||u;e=e||"root";m=Error('Failed to require "'+b+'" from "'+e+'"');m.path=b;m.parent=e;m.require=true;throw m;}e=a.modules[m];if(!e.exports){e.exports={};e.client=e.component=true;e.call(this,e.exports,a.relative(m),e)}return e.exports}a.modules={};a.aliases={};a.resolve=function(u){if(u.charAt(0)==="/")u=u.slice(1);for(var e=[u,u+".js",u+".json",u+"/index.js",u+"/index.json"],b=0;b<e.length;b++){u=e[b];if(a.modules.hasOwnProperty(u))return u;
if(a.aliases.hasOwnProperty(u))return a.aliases[u]}};a.normalize=function(u,e){var b=[];if("."!=e.charAt(0))return e;u=u.split("/");e=e.split("/");for(var m=0;m<e.length;++m)if(".."==e[m])u.pop();else"."!=e[m]&&""!=e[m]&&b.push(e[m]);return u.concat(b).join("/")};a.register=function(u,e){a.modules[u]=e};a.alias=function(u,e){if(!a.modules.hasOwnProperty(u))throw Error('Failed to alias "'+u+'", it does not exist');a.aliases[e]=u};a.relative=function(u){function e(m){var A=e.resolve(m);return a(A,u,
m)}var b=a.normalize(u,"..");e.resolve=function(m){var A=m.charAt(0);if("/"==A)return m.slice(1);if("."==A)return a.normalize(b,m);A=u.split("/");var c;a:{for(c=A.length;c--;)if(A[c]==="deps"){c=c;break a}c=-1}(c=c+1)||(c=0);return m=A.slice(0,c+1).join("/")+"/deps/"+m};e.exists=function(m){return a.modules.hasOwnProperty(e.resolve(m))};return e};a.register("component-emitter/index.js",function(u,e,b){function m(A){if(A){for(var c in m.prototype)A[c]=m.prototype[c];return A}}b.exports=m;m.prototype.on=
function(A,c){this._callbacks=this._callbacks||{};(this._callbacks[A]=this._callbacks[A]||[]).push(c);return this};m.prototype.once=function(A,c){function g(){d.off(A,g);c.apply(this,arguments)}var d=this;this._callbacks=this._callbacks||{};c._off=g;this.on(A,g);return this};m.prototype.off=m.prototype.removeListener=m.prototype.removeAllListeners=function(A,c){this._callbacks=this._callbacks||{};var g=this._callbacks[A];if(!g)return this;if(1==arguments.length){delete this._callbacks[A];return this}var d=
g.indexOf(c._off||c);~d&&g.splice(d,1);return this};m.prototype.emit=function(A){this._callbacks=this._callbacks||{};var c=[].slice.call(arguments,1),g=this._callbacks[A];if(g){g=g.slice(0);for(var d=0,o=g.length;d<o;++d)g[d].apply(this,c)}return this};m.prototype.listeners=function(A){this._callbacks=this._callbacks||{};return this._callbacks[A]||[]};m.prototype.hasListeners=function(A){return!!this.listeners(A).length}});a.register("dropzone/index.js",function(u,e,b){b.exports=e("./lib/dropzone.js")});
a.register("dropzone/lib/dropzone.js",function(u,e,b){(function(){var m,A,c,g,d,o={}.hasOwnProperty,z=function(q,I){function R(){this.constructor=q}for(var s in I)if(o.call(I,s))q[s]=I[s];R.prototype=I.prototype;q.prototype=new R;q.__super__=I.prototype;return q},E=[].slice;A=typeof Emitter!=="undefined"&&Emitter!==null?Emitter:e("emitter");g=function(){};m=function(q){function I(s,v){var M,N,K;this.element=s;this.version=I.version;this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,
"");this.clickableElements=[];this.listeners=[];this.files=[];if(typeof this.element==="string")this.element=document.querySelector(this.element);if(!(this.element&&this.element.nodeType!=null))throw Error("Invalid dropzone element.");if(this.element.dropzone)throw Error("Dropzone already attached.");I.instances.push(this);s.dropzone=this;M=(K=I.optionsForElement(this.element))!=null?K:{};this.options=R({},this.defaultOptions,M,v!=null?v:{});if(this.options.url==null)this.options.url=this.element.action;
if(!this.options.url)throw Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");if(this.options.acceptedMimeTypes){this.options.acceptedFiles=this.options.acceptedMimeTypes;delete this.options.acceptedMimeTypes}this.options.method=this.options.method.toUpperCase();if(this.options.forceFallback||!I.isBrowserSupported())return this.options.fallback.call(this);
if((N=this.getExistingFallback())&&N.parentNode)N.parentNode.removeChild(N);this.previewsContainer=this.options.previewsContainer?I.getElement(this.options.previewsContainer,"previewsContainer"):this.element;if(this.options.clickable)this.clickableElements=this.options.clickable===true?[this.element]:I.getElements(this.options.clickable,"clickable");this.init()}var R;z(I,q);I.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","selectedfiles","addedfile","removedfile",
"thumbnail","error","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset"];I.prototype.defaultOptions={url:null,method:"post",withCredentials:false,parallelUploads:2,uploadMultiple:false,maxFilesize:256,paramName:"file",createImageThumbnails:true,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,params:{},clickable:true,ignoreHiddenFiles:true,
acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:true,addRemoveLinks:false,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MB). Max filesize: {{maxFilesize}}MB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",
dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,accept:function(s,v){return v()},init:function(){return g},forceFallback:false,fallback:function(){var s,v,M,N,K;this.element.className=""+this.element.className+" dz-browser-not-supported";K=this.element.getElementsByTagName("div");M=0;for(N=K.length;M<N;M++){s=K[M];if(/(^| )dz-message($| )/.test(s.className)){v=s;s.className="dz-message"}}if(!v){v=
I.createElement('<div class="dz-message"><span></span></div>');this.element.appendChild(v)}if(s=v.getElementsByTagName("span")[0])s.textContent=this.options.dictFallbackMessage;return this.element.appendChild(this.getFallbackForm())},resize:function(s){var v,M,N;v={srcX:0,srcY:0,srcWidth:s.width,srcHeight:s.height};M=s.width/s.height;N=this.options.thumbnailWidth/this.options.thumbnailHeight;if(s.height<this.options.thumbnailHeight||s.width<this.options.thumbnailWidth){v.trgHeight=v.srcHeight;v.trgWidth=
v.srcWidth}else if(M>N){v.srcHeight=s.height;v.srcWidth=v.srcHeight*N}else{v.srcWidth=s.width;v.srcHeight=v.srcWidth/N}v.srcX=(s.width-v.srcWidth)/2;v.srcY=(s.height-v.srcHeight)/2;return v},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:g,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},
selectedfiles:function(){if(this.element===this.previewsContainer)return this.element.classList.add("dz-started")},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(s){var v=this;s.previewElement=I.createElement(this.options.previewTemplate);s.previewTemplate=s.previewElement;this.previewsContainer.appendChild(s.previewElement);s.previewElement.querySelector("[data-dz-name]").textContent=s.name;s.previewElement.querySelector("[data-dz-size]").innerHTML=this.filesize(s.size);
if(this.options.addRemoveLinks){s._removeLink=I.createElement('<a class="dz-remove" href="javascript:undefined;">'+this.options.dictRemoveFile+"</a>");s._removeLink.addEventListener("click",function(M){M.preventDefault();M.stopPropagation();if(s.status===I.UPLOADING){if(window.confirm(v.options.dictCancelUploadConfirmation))return v.removeFile(s)}else if(v.options.dictRemoveFileConfirmation){if(window.confirm(v.options.dictRemoveFileConfirmation))return v.removeFile(s)}else return v.removeFile(s)});
return s.previewElement.appendChild(s._removeLink)}},removedfile:function(s){var v;return(v=s.previewElement)!=null?v.parentNode.removeChild(s.previewElement):void 0},thumbnail:function(s,v){var M;s.previewElement.classList.remove("dz-file-preview");s.previewElement.classList.add("dz-image-preview");M=s.previewElement.querySelector("[data-dz-thumbnail]");M.alt=s.name;return M.src=v},error:function(s,v){s.previewElement.classList.add("dz-error");return s.previewElement.querySelector("[data-dz-errormessage]").textContent=
v},processing:function(s){s.previewElement.classList.add("dz-processing");if(s._removeLink)return s._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:g,uploadprogress:function(s,v){return s.previewElement.querySelector("[data-dz-uploadprogress]").style.width=""+v+"%"},totaluploadprogress:g,sending:g,sendingmultiple:g,success:function(s){return s.previewElement.classList.add("dz-success")},successmultiple:g,canceled:function(s){return this.emit("error",s,"Upload canceled.")},
canceledmultiple:g,complete:function(s){if(s._removeLink)return s._removeLink.textContent=this.options.dictRemoveFile},completemultiple:g,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-details">\n    <div class="dz-filename"><span data-dz-name></span></div>\n    <div class="dz-size" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-success-mark"><span>\u2714</span></div>\n  <div class="dz-error-mark"><span>\u2718</span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'};
R=function(){var s,v,M,N,K,Z,U;N=arguments[0];M=2<=arguments.length?E.call(arguments,1):[];Z=0;for(U=M.length;Z<U;Z++){v=M[Z];for(s in v){K=v[s];N[s]=K}}return N};I.prototype.getAcceptedFiles=function(){var s,v,M,N,K;N=this.files;K=[];v=0;for(M=N.length;v<M;v++){s=N[v];s.accepted&&K.push(s)}return K};I.prototype.getRejectedFiles=function(){var s,v,M,N,K;N=this.files;K=[];v=0;for(M=N.length;v<M;v++){s=N[v];s.accepted||K.push(s)}return K};I.prototype.getQueuedFiles=function(){var s,v,M,N,K;N=this.files;
K=[];v=0;for(M=N.length;v<M;v++){s=N[v];s.status===I.QUEUED&&K.push(s)}return K};I.prototype.getUploadingFiles=function(){var s,v,M,N,K;N=this.files;K=[];v=0;for(M=N.length;v<M;v++){s=N[v];s.status===I.UPLOADING&&K.push(s)}return K};I.prototype.init=function(){var s,v,M,N,K,Z,U=this;this.element.tagName==="form"&&this.element.setAttribute("enctype","multipart/form-data");this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(I.createElement('<div class="dz-default dz-message"><span>'+
this.options.dictDefaultMessage+"</span></div>"));if(this.clickableElements.length){M=function(){U.hiddenFileInput&&document.body.removeChild(U.hiddenFileInput);U.hiddenFileInput=document.createElement("input");U.hiddenFileInput.setAttribute("type","file");U.hiddenFileInput.setAttribute("multiple","multiple");U.options.acceptedFiles!=null&&U.hiddenFileInput.setAttribute("accept",U.options.acceptedFiles);U.hiddenFileInput.style.visibility="hidden";U.hiddenFileInput.style.position="absolute";U.hiddenFileInput.style.top=
"0";U.hiddenFileInput.style.left="0";U.hiddenFileInput.style.height="0";U.hiddenFileInput.style.width="0";document.body.appendChild(U.hiddenFileInput);return U.hiddenFileInput.addEventListener("change",function(){var S;S=U.hiddenFileInput.files;if(S.length){U.emit("selectedfiles",S);U.handleFiles(S)}return M()})};M()}this.URL=(s=window.URL)!=null?s:window.webkitURL;Z=this.events;N=0;for(K=Z.length;N<K;N++){s=Z[N];this.on(s,this.options[s])}this.on("uploadprogress",function(){return U.updateTotalUploadProgress()});
this.on("removedfile",function(){return U.updateTotalUploadProgress()});this.on("canceled",function(S){return U.emit("complete",S)});v=function(S){S.stopPropagation();return S.preventDefault?S.preventDefault():S.returnValue=false};this.listeners=[{element:this.element,events:{dragstart:function(S){return U.emit("dragstart",S)},dragenter:function(S){v(S);return U.emit("dragenter",S)},dragover:function(S){v(S);return U.emit("dragover",S)},dragleave:function(S){return U.emit("dragleave",S)},drop:function(S){v(S);
U.drop(S);return U.emit("drop",S)},dragend:function(S){return U.emit("dragend",S)}}}];this.clickableElements.forEach(function(S){return U.listeners.push({element:S,events:{click:function(V){if(S!==U.element||V.target===U.element||I.elementInside(V.target,U.element.querySelector(".dz-message")))return U.hiddenFileInput.click()}}})});this.enable();return this.options.init.call(this)};I.prototype.destroy=function(){var s;this.disable();this.removeAllFiles(true);if((s=this.hiddenFileInput)!=null?s.parentNode:
void 0){this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);this.hiddenFileInput=null}return delete this.element.dropzone};I.prototype.updateTotalUploadProgress=function(){var s,v,M,N,K,Z;v=M=0;if(this.getAcceptedFiles().length){Z=this.getAcceptedFiles();N=0;for(K=Z.length;N<K;N++){s=Z[N];M+=s.upload.bytesSent;v+=s.upload.total}s=100*M/v}else s=100;return this.emit("totaluploadprogress",s,v,M)};I.prototype.getFallbackForm=function(){var s,v;if(s=this.getExistingFallback())return s;s=
'<div class="dz-fallback">';if(this.options.dictFallbackText)s+="<p>"+this.options.dictFallbackText+"</p>";s+='<input type="file" name="'+this.options.paramName+(this.options.uploadMultiple?"[]":"")+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><button type="submit">Upload!</button></div>';s=I.createElement(s);if(this.element.tagName!=="FORM"){v=I.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>');v.appendChild(s)}else{this.element.setAttribute("enctype",
"multipart/form-data");this.element.setAttribute("method",this.options.method)}return v!=null?v:s};I.prototype.getExistingFallback=function(){var s,v,M,N,K;v=function(Z){var U,S,V;S=0;for(V=Z.length;S<V;S++){U=Z[S];if(/(^| )fallback($| )/.test(U.className))return U}};K=["div","form"];M=0;for(N=K.length;M<N;M++){s=K[M];if(s=v(this.element.getElementsByTagName(s)))return s}};I.prototype.setupEventListeners=function(){var s,v,M,N,K,Z,U;Z=this.listeners;U=[];N=0;for(K=Z.length;N<K;N++){s=Z[N];U.push(function(){var S,
V;S=s.events;V=[];for(v in S){M=S[v];V.push(s.element.addEventListener(v,M,false))}return V}())}return U};I.prototype.removeEventListeners=function(){var s,v,M,N,K,Z,U;Z=this.listeners;U=[];N=0;for(K=Z.length;N<K;N++){s=Z[N];U.push(function(){var S,V;S=s.events;V=[];for(v in S){M=S[v];V.push(s.element.removeEventListener(v,M,false))}return V}())}return U};I.prototype.disable=function(){var s,v,M,N,K;this.clickableElements.forEach(function(Z){return Z.classList.remove("dz-clickable")});this.removeEventListeners();
N=this.files;K=[];v=0;for(M=N.length;v<M;v++){s=N[v];K.push(this.cancelUpload(s))}return K};I.prototype.enable=function(){this.clickableElements.forEach(function(s){return s.classList.add("dz-clickable")});return this.setupEventListeners()};I.prototype.filesize=function(s){var v;if(s>=1E11){s/=1E11;v="TB"}else if(s>=1E8){s/=1E8;v="GB"}else if(s>=1E5){s/=1E5;v="MB"}else if(s>=100){s/=100;v="KB"}else{s*=10;v="b"}return"<strong>"+Math.round(s)/10+"</strong> "+v};I.prototype.drop=function(s){var v;if(s.dataTransfer){v=
s.dataTransfer.files;this.emit("selectedfiles",v);if(v.length)(s=s.dataTransfer.items)&&s.length&&(s[0].webkitGetAsEntry!=null||s[0].getAsEntry!=null)?this.handleItems(s):this.handleFiles(v)}};I.prototype.handleFiles=function(s){var v,M,N,K;K=[];M=0;for(N=s.length;M<N;M++){v=s[M];K.push(this.addFile(v))}return K};I.prototype.handleItems=function(s){var v,M,N,K;N=0;for(K=s.length;N<K;N++){M=s[N];if(M.webkitGetAsEntry!=null){v=M.webkitGetAsEntry();if(v.isFile)this.addFile(M.getAsFile());else v.isDirectory&&
this.addDirectory(v,v.name)}else this.addFile(M.getAsFile())}};I.prototype.accept=function(s,v){return s.size>this.options.maxFilesize*1024*1024?v(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(s.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):I.isValidFile(s,this.options.acceptedFiles)?this.options.accept.call(this,s,v):v(this.options.dictInvalidFileType)};I.prototype.addFile=function(s){var v=this;s.upload={progress:0,total:s.size,bytesSent:0};this.files.push(s);
s.status=I.ADDED;this.emit("addedfile",s);this.options.createImageThumbnails&&s.type.match(/image.*/)&&s.size<=this.options.maxThumbnailFilesize*1024*1024&&this.createThumbnail(s);return this.accept(s,function(M){if(M){s.accepted=false;return v._errorProcessing([s],M)}else{s.accepted=true;return v.enqueueFile(s)}})};I.prototype.enqueueFiles=function(s){var v,M,N;M=0;for(N=s.length;M<N;M++){v=s[M];this.enqueueFile(v)}return null};I.prototype.enqueueFile=function(s){var v=this;if(s.status===I.ADDED){s.status=
I.QUEUED;if(this.options.autoProcessQueue)return setTimeout(function(){return v.processQueue()},1)}else throw Error("This file can't be queued because it has already been processed or was rejected.");};I.prototype.addDirectory=function(s,v){var M=this;return s.createReader().readEntries(function(N){var K,Z;K=0;for(Z=N.length;K<Z;K++){s=N[K];if(s.isFile)s.file(function(U){if(!(M.options.ignoreHiddenFiles&&U.name.substring(0,1)===".")){U.fullPath=""+v+"/"+U.name;return M.addFile(U)}});else s.isDirectory&&
M.addDirectory(s,""+v+"/"+s.name)}},function(N){return typeof console!=="undefined"&&console!==null?typeof console.log==="function"?console.log(N):void 0:void 0})};I.prototype.removeFile=function(s){s.status===I.UPLOADING&&this.cancelUpload(s);this.files=d(this.files,s);this.emit("removedfile",s);if(this.files.length===0)return this.emit("reset")};I.prototype.removeAllFiles=function(s){var v,M,N,K;if(s==null)s=false;K=this.files.slice();M=0;for(N=K.length;M<N;M++){v=K[M];if(v.status!==I.UPLOADING||
s)this.removeFile(v)}return null};I.prototype.createThumbnail=function(s){var v,M=this;v=new FileReader;v.onload=function(){var N;N=new Image;N.onload=function(){var K,Z,U,S,V,ca,ta;s.width=N.width;s.height=N.height;U=M.options.resize.call(M,s);if(U.trgWidth==null)U.trgWidth=M.options.thumbnailWidth;if(U.trgHeight==null)U.trgHeight=M.options.thumbnailHeight;K=document.createElement("canvas");Z=K.getContext("2d");K.width=U.trgWidth;K.height=U.trgHeight;Z.drawImage(N,(S=U.srcX)!=null?S:0,(V=U.srcY)!=
null?V:0,U.srcWidth,U.srcHeight,(ca=U.trgX)!=null?ca:0,(ta=U.trgY)!=null?ta:0,U.trgWidth,U.trgHeight);K=K.toDataURL("image/png");return M.emit("thumbnail",s,K)};return N.src=v.result};return v.readAsDataURL(s)};I.prototype.processQueue=function(){var s,v,M,N;v=this.options.parallelUploads;s=M=this.getUploadingFiles().length;if(!(M>=v)){N=this.getQueuedFiles();if(N.length>0)if(this.options.uploadMultiple)return this.processFiles(N.slice(0,v-M));else for(;s<v;){if(!N.length)break;this.processFile(N.shift());
s++}}};I.prototype.processFile=function(s){return this.processFiles([s])};I.prototype.processFiles=function(s){var v,M,N;M=0;for(N=s.length;M<N;M++){v=s[M];v.processing=true;v.status=I.UPLOADING;this.emit("processing",v)}this.options.uploadMultiple&&this.emit("processingmultiple",s);return this.uploadFiles(s)};I.prototype._getFilesWithXhr=function(s){var v;return function(){var M,N,K,Z;K=this.files;Z=[];M=0;for(N=K.length;M<N;M++){v=K[M];v.xhr===s&&Z.push(v)}return Z}.call(this)};I.prototype.cancelUpload=
function(s){var v,M,N,K;if(s.status===I.UPLOADING){M=this._getFilesWithXhr(s.xhr);N=0;for(K=M.length;N<K;N++){v=M[N];v.status=I.CANCELED}s.xhr.abort();s=0;for(N=M.length;s<N;s++){v=M[s];this.emit("canceled",v)}this.options.uploadMultiple&&this.emit("canceledmultiple",M)}else if((v=s.status)===I.ADDED||v===I.QUEUED){s.status=I.CANCELED;this.emit("canceled",s);this.options.uploadMultiple&&this.emit("canceledmultiple",[s])}if(this.options.autoProcessQueue)return this.processQueue()};I.prototype.uploadFile=
function(s){return this.uploadFiles([s])};I.prototype.uploadFiles=function(s){var v,M,N,K,Z,U,S,V,ca,ta,na,ga,W,ba=this;ca=new XMLHttpRequest;K=0;for(Z=s.length;K<Z;K++){v=s[K];v.xhr=ca}ca.open(this.options.method,this.options.url,true);ca.withCredentials=!!this.options.withCredentials;S=null;N=function(){var ja,pa,ka;ka=[];ja=0;for(pa=s.length;ja<pa;ja++){v=s[ja];ka.push(ba._errorProcessing(s,S||ba.options.dictResponseError.replace("{{statusCode}}",ca.status),ca))}return ka};V=function(ja){var pa,
ka,la;if(ja!=null){pa=100*ja.loaded/ja.total;ka=0;for(la=s.length;ka<la;ka++){v=s[ka];v.upload={progress:pa,total:ja.total,bytesSent:ja.loaded}}}else{ja=true;pa=100;ka=0;for(la=s.length;ka<la;ka++){v=s[ka];v.upload.progress===100&&v.upload.bytesSent===v.upload.total||(ja=false);v.upload.progress=pa;v.upload.bytesSent=v.upload.total}if(ja)return}la=[];ja=0;for(ka=s.length;ja<ka;ja++){v=s[ja];la.push(ba.emit("uploadprogress",v,pa,v.upload.bytesSent))}return la};ca.onload=function(ja){var pa;if(s[0].status!==
I.CANCELED)if(ca.readyState===4){S=ca.responseText;if(ca.getResponseHeader("content-type")&&~ca.getResponseHeader("content-type").indexOf("application/json"))try{S=JSON.parse(S)}catch(ka){ja=ka;S="Invalid JSON response from server."}V();return 200<=(pa=ca.status)&&pa<300?ba._finished(s,S,ja):N()}};ca.onerror=function(){if(s[0].status!==I.CANCELED)return N()};((ta=ca.upload)!=null?ta:ca).onprogress=V;Z={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};this.options.headers&&
R(Z,this.options.headers);for(M in Z){K=Z[M];ca.setRequestHeader(M,K)}M=new FormData;if(this.options.params){Z=this.options.params;for(U in Z){K=Z[U];M.append(U,K)}}U=0;for(K=s.length;U<K;U++){v=s[U];this.emit("sending",v,ca,M)}this.options.uploadMultiple&&this.emit("sendingmultiple",s,ca,M);if(this.element.tagName==="FORM"){W=this.element.querySelectorAll("input, textarea, select, button");ta=0;for(ga=W.length;ta<ga;ta++){U=W[ta];K=U.getAttribute("name");Z=U.getAttribute("type");if(!Z||(na=Z.toLowerCase())!==
"checkbox"&&na!=="radio"||U.checked)M.append(K,U.value)}}na=0;for(U=s.length;na<U;na++){v=s[na];M.append(""+this.options.paramName+(this.options.uploadMultiple?"[]":""),v,v.name)}return ca.send(M)};I.prototype._finished=function(s,v,M){var N,K,Z;K=0;for(Z=s.length;K<Z;K++){N=s[K];N.status=I.SUCCESS;this.emit("success",N,v,M);this.emit("complete",N)}if(this.options.uploadMultiple){this.emit("successmultiple",s,v,M);this.emit("completemultiple",s)}if(this.options.autoProcessQueue)return this.processQueue()};
I.prototype._errorProcessing=function(s,v,M){var N,K,Z;K=0;for(Z=s.length;K<Z;K++){N=s[K];N.status=I.ERROR;this.emit("error",N,v,M);this.emit("complete",N)}if(this.options.uploadMultiple){this.emit("errormultiple",s,v,M);this.emit("completemultiple",s)}if(this.options.autoProcessQueue)return this.processQueue()};return I}(A);m.version="3.6.2";m.options={};m.optionsForElement=function(q){if(q.id)return m.options[c(q.id)]};m.instances=[];m.forElement=function(q){if(typeof q==="string")q=document.querySelector(q);
if((q!=null?q.dropzone:void 0)==null)throw Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return q.dropzone};m.autoDiscover=true;m.discover=function(){var q,I,R,s,v;if(document.querySelectorAll)I=document.querySelectorAll(".dropzone");else{I=[];q=function(M){var N,K,Z,U;U=[];K=0;for(Z=M.length;K<Z;K++){N=M[K];/(^| )dropzone($| )/.test(N.className)?
U.push(I.push(N)):U.push(void 0)}return U};q(document.getElementsByTagName("div"));q(document.getElementsByTagName("form"))}v=[];R=0;for(s=I.length;R<s;R++){q=I[R];m.optionsForElement(q)!==false?v.push(new m(q)):v.push(void 0)}return v};m.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i];m.isBrowserSupported=function(){var q,I,R,s,v;q=true;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a")){v=m.blacklistedBrowsers;
R=0;for(s=v.length;R<s;R++){I=v[R];if(I.test(navigator.userAgent))q=false}}else q=false;else q=false;return q};d=function(q,I){var R,s,v,M;M=[];s=0;for(v=q.length;s<v;s++){R=q[s];R!==I&&M.push(R)}return M};c=function(q){return q.replace(/[\-_](\w)/g,function(I){return I[1].toUpperCase()})};m.createElement=function(q){var I;I=document.createElement("div");I.innerHTML=q;return I.childNodes[0]};m.elementInside=function(q,I){if(q===I)return true;for(;q=q.parentNode;)if(q===I)return true;return false};
m.getElement=function(q,I){var R;if(typeof q==="string")R=document.querySelector(q);else if(q.nodeType!=null)R=q;if(R==null)throw Error("Invalid `"+I+"` option provided. Please provide a CSS selector or a plain HTML element.");return R};m.getElements=function(q,I){var R,s,v,M,N;if(q instanceof Array){s=[];try{v=0;for(M=q.length;v<M;v++){R=q[v];s.push(this.getElement(R,I))}}catch(K){s=null}}else if(typeof q==="string"){s=[];N=document.querySelectorAll(q);v=0;for(M=N.length;v<M;v++){R=N[v];s.push(R)}}else if(q.nodeType!=
null)s=[q];if(!(s!=null&&s.length))throw Error("Invalid `"+I+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return s};m.isValidFile=function(q,I){var R,s,v,M,N;if(!I)return true;I=I.split(",");s=q.type;R=s.replace(/\/.*$/,"");M=0;for(N=I.length;M<N;M++){v=I[M];v=v.trim();if(v.charAt(0)==="."){if(q.name.indexOf(v,q.name.length-v.length)!==-1)return true}else if(/\/\*$/.test(v)){if(R===v.replace(/\/.*$/,""))return true}else if(s===v)return true}return false};
if(typeof jQuery!=="undefined"&&jQuery!==null)jQuery.fn.dropzone=function(q){return this.each(function(){return new m(this,q)})};if(typeof b!=="undefined"&&b!==null)b.exports=m;else window.Dropzone=m;m.ADDED="added";m.QUEUED="queued";m.ACCEPTED=m.QUEUED;m.UPLOADING="uploading";m.PROCESSING=m.UPLOADING;m.CANCELED="canceled";m.ERROR="error";m.SUCCESS="success";m._autoDiscoverFunction=function(){if(m.autoDiscover)return m.discover()};(function(q,I){var R,s,v,M,N,K,Z,U,S;v=false;S=true;s=q.document;U=
s.documentElement;R=s.addEventListener?"addEventListener":"attachEvent";Z=s.addEventListener?"removeEventListener":"detachEvent";K=s.addEventListener?"":"on";M=function(ca){if(!(ca.type==="readystatechange"&&s.readyState!=="complete")){(ca.type==="load"?q:s)[Z](K+ca.type,M,false);if(!v&&(v=true))return I.call(q,ca.type||ca)}};N=function(){try{U.doScroll("left")}catch(ca){setTimeout(N,50);return}return M("poll")};if(s.readyState!=="complete"){if(s.createEventObject&&U.doScroll){try{S=!q.frameElement}catch(V){}S&&
N()}s[R](K+"DOMContentLoaded",M,false);s[R](K+"readystatechange",M,false);return q[R](K+"load",M,false)}})(window,m._autoDiscoverFunction)}).call(this)});a.alias("component-emitter/index.js","dropzone/deps/emitter/index.js");a.alias("component-emitter/index.js","emitter/index.js");if(typeof exports=="object")module.exports=a("dropzone");else if(typeof define=="function"&&define.amd)define(function(){return a("dropzone")});else this.Dropzone=a("dropzone")})();var svgedit=svgedit||{};
(function(){if(!svgedit.browser)svgedit.browser={};var a=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;svgedit.browser.supportsSvg=function(){return a};if(svgedit.browser.supportsSvg()){var u=navigator.userAgent,e=document.createElementNS("http://www.w3.org/2000/svg","svg"),b=!!window.opera,m=u.indexOf("AppleWebKit")>=0,A=u.indexOf("Gecko/")>=0,c=u.indexOf("MSIE")>=0,g=u.indexOf("Chrome/")>=0,d=u.indexOf("Windows")>=0,o=u.indexOf("Macintosh")>=
0,z="ontouchstart"in window,E=!!e.querySelector,q=!!document.evaluate,I=function(){var U=document.createElementNS("http://www.w3.org/2000/svg","path");U.setAttribute("d","M0,0 10,10");var S=U.pathSegList;U=U.createSVGPathSegLinetoAbs(5,5);try{S.replaceItem(U,0);return true}catch(V){}return false}(),R=function(){var U=document.createElementNS("http://www.w3.org/2000/svg","path");U.setAttribute("d","M0,0 10,10");var S=U.pathSegList;U=U.createSVGPathSegLinetoAbs(5,5);try{S.insertItemBefore(U,0);return true}catch(V){}return false}(),
s=function(){var U=document.createElementNS("http://www.w3.org/2000/svg","svg"),S=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(U);S.setAttribute("x",5);U.appendChild(S);var V=document.createElementNS("http://www.w3.org/2000/svg","text");V.textContent="a";S.appendChild(V);S=V.getStartPositionOfChar(0);S=S.x;document.documentElement.removeChild(U);return S===0}(),v=function(){var U=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(U);
var S=document.createElementNS("http://www.w3.org/2000/svg","path");S.setAttribute("d","M0,0 C0,0 10,10 10,0");U.appendChild(S);S=S.getBBox();document.documentElement.removeChild(U);return S.height>4&&S.height<5}(),M=function(){var U=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(U);var S=document.createElementNS("http://www.w3.org/2000/svg","path");S.setAttribute("d","M0,0 10,0");var V=document.createElementNS("http://www.w3.org/2000/svg","path");
V.setAttribute("d","M5,0 15,0");var ca=document.createElementNS("http://www.w3.org/2000/svg","g");ca.appendChild(S);ca.appendChild(V);U.appendChild(ca);S=ca.getBBox();document.documentElement.removeChild(U);return S.width==15}(),N=function(){var U=document.createElementNS("http://www.w3.org/2000/svg","rect");U.setAttribute("x",0.1);(U=U.cloneNode(false).getAttribute("x").indexOf(",")==-1)||$.alert("NOTE: This version of Opera is known to contain bugs in SVG-edit.\n\t\tPlease upgrade to the <a href='http://opera.com'>latest version</a> in which the problems have been fixed.");
return U}(),K=function(){var U=document.createElementNS("http://www.w3.org/2000/svg","rect");U.setAttribute("style","vector-effect:non-scaling-stroke");return U.style.vectorEffect==="non-scaling-stroke"}(),Z=function(){var U=document.createElementNS("http://www.w3.org/2000/svg","rect").transform.baseVal,S=e.createSVGTransform();U.appendItem(S);return U.getItem(0)==S}();svgedit.browser.isOpera=function(){return b};svgedit.browser.isWebkit=function(){return m};svgedit.browser.isGecko=function(){return A};
svgedit.browser.isIE=function(){return c};svgedit.browser.isChrome=function(){return g};svgedit.browser.isWindows=function(){return d};svgedit.browser.isMac=function(){return o};svgedit.browser.isTouch=function(){return z};svgedit.browser.supportsSelectors=function(){return E};svgedit.browser.supportsXpath=function(){return q};svgedit.browser.supportsPathReplaceItem=function(){return I};svgedit.browser.supportsPathInsertItemBefore=function(){return R};svgedit.browser.supportsPathBBox=function(){return v};
svgedit.browser.supportsHVLineContainerBBox=function(){return M};svgedit.browser.supportsGoodTextCharPos=function(){return s};svgedit.browser.supportsEditableText=function(){return b};svgedit.browser.supportsGoodDecimals=function(){return N};svgedit.browser.supportsNonScalingStroke=function(){return K};svgedit.browser.supportsNativeTransformLists=function(){return Z}}else window.location="browser-not-supported.html"})();svgedit=svgedit||{};
(function(){if(!svgedit.transformlist)svgedit.transformlist={};var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),u={};svgedit.transformlist.SVGTransformList=function(e){this._elem=e||null;this._xforms=[];this._update=function(){var b="";a.createSVGMatrix();for(var m=0;m<this.numberOfItems;++m){var A=this._list.getItem(m);b=b;A=A;var c=A.matrix,g="";switch(A.type){case 1:g="matrix("+[c.a,c.b,c.c,c.d,c.e,c.f].join(",")+")";break;case 2:g="translate("+c.e+","+c.f+")";break;case 3:g=
c.a==c.d?"scale("+c.a+")":"scale("+c.a+","+c.d+")";break;case 4:var d=0;g=0;if(A.angle!=0){d=1-c.a;g=(d*c.f+c.b*c.e)/(d*d+c.b*c.b);d=(c.e-c.b*g)/d}g="rotate("+A.angle+" "+d+","+g+")"}b=b+(g+" ")}this._elem.setAttribute("transform",b)};this._list=this;this._init=function(){var b=this._elem.getAttribute("transform");if(b)for(var m=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,A=true;A;){A=b.match(m);b=b.replace(m,"");if(A&&A[1]){var c=A[1].split(/\s*\(/),g=c[0];c=c[1].match(/\s*(.*?)\s*\)/);
c[1]=c[1].replace(/(\d)-/g,"$1 -");var d=c[1].split(/[, ]+/),o="abcdef".split(""),z=a.createSVGMatrix();$.each(d,function(I,R){d[I]=parseFloat(R);if(g=="matrix")z[o[I]]=d[I]});c=a.createSVGTransform();var E="set"+g.charAt(0).toUpperCase()+g.slice(1),q=g=="matrix"?[z]:d;if(g=="scale"&&q.length==1)q.push(q[0]);else if(g=="translate"&&q.length==1)q.push(0);else if(g=="rotate"&&q.length==1){q.push(0);q.push(0)}c[E].apply(c,q);this._list.appendItem(c)}}};this._removeFromOtherLists=function(b){if(b){var m=
false,A;for(A in u){for(var c=u[A],g=0,d=c._xforms.length;g<d;++g)if(c._xforms[g]==b){m=true;c.removeItem(g);break}if(m)break}}};this.numberOfItems=0;this.clear=function(){this.numberOfItems=0;this._xforms=[]};this.initialize=function(b){this.numberOfItems=1;this._removeFromOtherLists(b);this._xforms=[b]};this.getItem=function(b){if(b<this.numberOfItems&&b>=0)return this._xforms[b];throw{code:1};};this.insertItemBefore=function(b,m){var A=null;if(m>=0)if(m<this.numberOfItems){this._removeFromOtherLists(b);
A=Array(this.numberOfItems+1);for(var c=0;c<m;++c)A[c]=this._xforms[c];A[c]=b;for(var g=c+1;c<this.numberOfItems;++g,++c)A[g]=this._xforms[c];this.numberOfItems++;this._xforms=A;A=b;this._list._update()}else A=this._list.appendItem(b);return A};this.replaceItem=function(b,m){var A=null;if(m<this.numberOfItems&&m>=0){this._removeFromOtherLists(b);A=this._xforms[m]=b;this._list._update()}return A};this.removeItem=function(b){if(b<this.numberOfItems&&b>=0){for(var m=this._xforms[b],A=Array(this.numberOfItems-
1),c=0;c<b;++c)A[c]=this._xforms[c];for(b=c;b<this.numberOfItems-1;++b,++c)A[b]=this._xforms[c+1];this.numberOfItems--;this._xforms=A;this._list._update();return m}else throw{code:1};};this.appendItem=function(b){this._removeFromOtherLists(b);this._xforms.push(b);this.numberOfItems++;this._list._update();return b}};svgedit.transformlist.resetListMap=function(){u={}};svgedit.transformlist.removeElementFromListMap=function(e){e.id&&u[e.id]&&delete u[e.id]};svgedit.transformlist.getTransformList=function(e){if(svgedit.browser.supportsNativeTransformLists())if(e.transform)return e.transform.baseVal;
else if(e.gradientTransform)return e.gradientTransform.baseVal;else{if(e.patternTransform)return e.patternTransform.baseVal}else{var b=e.id;b||(b="temp");var m=u[b];if(!m||b=="temp"){u[b]=new svgedit.transformlist.SVGTransformList(e);u[b]._init();m=u[b]}return m}return null}})();svgedit=svgedit||{};
(function(){if(!svgedit.math)svgedit.math={};var a=document.createElementNS("http://www.w3.org/2000/svg","svg");svgedit.math.transformPoint=function(u,e,b){return{x:b.a*u+b.c*e+b.e,y:b.b*u+b.d*e+b.f}};svgedit.math.isIdentity=function(u){return u.a===1&&u.b===0&&u.c===0&&u.d===1&&u.e===0&&u.f===0};svgedit.math.matrixMultiply=function(){for(var u=arguments,e=u.length,b=u[e-1];e-- >1;)b=u[e-1].multiply(b);if(Math.abs(b.a)<1.0E-14)b.a=0;if(Math.abs(b.b)<1.0E-14)b.b=0;if(Math.abs(b.c)<1.0E-14)b.c=0;if(Math.abs(b.d)<
1.0E-14)b.d=0;if(Math.abs(b.e)<1.0E-14)b.e=0;if(Math.abs(b.f)<1.0E-14)b.f=0;return b};svgedit.math.hasMatrixTransform=function(u){if(!u)return false;for(var e=u.numberOfItems;e--;){var b=u.getItem(e);if(b.type==1&&!svgedit.math.isIdentity(b.matrix))return true}return false};svgedit.math.transformBox=function(u,e,b,m,A){var c={x:u,y:e},g={x:u+b,y:e};b={x:u+b,y:e+m};u={x:u,y:e+m};e=svgedit.math.transformPoint;c=e(c.x,c.y,A);var d=m=c.x,o=c.y,z=c.y;g=e(g.x,g.y,A);m=Math.min(m,g.x);d=Math.max(d,g.x);
o=Math.min(o,g.y);z=Math.max(z,g.y);u=e(u.x,u.y,A);m=Math.min(m,u.x);d=Math.max(d,u.x);o=Math.min(o,u.y);z=Math.max(z,u.y);b=e(b.x,b.y,A);m=Math.min(m,b.x);d=Math.max(d,b.x);o=Math.min(o,b.y);z=Math.max(z,b.y);return{tl:c,tr:g,bl:u,br:b,aabox:{x:m,y:o,width:d-m,height:z-o}}};svgedit.math.transformListToTransform=function(u,e,b){if(u==null)return a.createSVGTransformFromMatrix(a.createSVGMatrix());e=e==undefined?0:e;b=b==undefined?u.numberOfItems-1:b;e=parseInt(e);b=parseInt(b);if(e>b){var m=b;b=e;
e=m}m=a.createSVGMatrix();for(e=e;e<=b;++e){var A=e>=0&&e<u.numberOfItems?u.getItem(e).matrix:a.createSVGMatrix();m=svgedit.math.matrixMultiply(m,A)}return a.createSVGTransformFromMatrix(m)};svgedit.math.getMatrix=function(u){u=svgedit.transformlist.getTransformList(u);return svgedit.math.transformListToTransform(u).matrix};svgedit.math.snapToAngle=function(u,e,b,m){var A=Math.PI/4;b=b-u;var c=m-e;m=Math.sqrt(b*b+c*c);A=Math.round(Math.atan2(c,b)/A)*A;return{x:u+m*Math.cos(A),y:e+m*Math.sin(A),a:A}};
svgedit.math.rectsIntersect=function(u,e){if(!u||!e)return false;return e.x<u.x+u.width&&e.x+e.width>u.x&&e.y<u.y+u.height&&e.y+e.height>u.y}})();svgedit=svgedit||{};
(function(){if(!svgedit.units)svgedit.units={};var a=["x","x1","cx","rx","width"],u=["y","y1","cy","ry","height"],e=$.merge(["r","radius"],a);$.merge(e,u);var b,m={px:1};svgedit.units.init=function(c){b=c;c=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(c);var g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("width","1em");g.setAttribute("height","1ex");g.setAttribute("x","1in");c.appendChild(g);g=g.getBBox();document.body.removeChild(c);
c=g.x;m.em=g.width;m.ex=g.height;m["in"]=c;m.cm=c/2.54;m.mm=c/25.4;m.pt=c/72;m.pc=c/6;m["%"]=0};svgedit.units.getTypeMap=function(){return m};svgedit.units.shortFloat=function(c){var g=b.getRoundDigits();if(isNaN(c)){if($.isArray(c))return svgedit.units.shortFloat(c[0])+","+svgedit.units.shortFloat(c[1])}else return+(+c).toFixed(g);return parseFloat(c).toFixed(g)-0};svgedit.units.convertUnit=function(c,g){g=g||b.getBaseUnit();return svgedit.unit.shortFloat(c/m[g])};svgedit.units.setUnitAttr=function(c,
g,d){isNaN(d)||c.getAttribute(g);c.setAttribute(g,d)};var A={line:["x1","x2","y1","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],foreignObject:["x","y","width","height"],rect:["x","y","width","height"],image:["x","y","width","height"],use:["x","y","width","height"],text:["x","y"]};svgedit.units.convertAttrs=function(c){var g=c.tagName,d=b.getBaseUnit();if(g=A[g])for(var o=g.length,z=0;z<o;z++){var E=g[z],q=c.getAttribute(E);if(q)isNaN(q)||c.setAttribute(E,q/m[d]+d)}};svgedit.units.convertToNum=
function(c,g){if(!isNaN(g))return g-0;if(g.substr(-1)==="%"){var d=g.substr(0,g.length-1)/100,o=b.getWidth(),z=b.getHeight();return a.indexOf(c)>=0?d*o:u.indexOf(c)>=0?d*z:d*Math.sqrt(o*o+z*z)/Math.sqrt(2)}else{o=g.substr(-2);d=g.substr(0,g.length-2);return d*m[o]}};svgedit.units.isValidUnit=function(c,g,d){var o=false;if(e.indexOf(c)>=0)if(isNaN(g)){g=g.toLowerCase();$.each(m,function(q){if(!o)if(RegExp("^-?[\\d\\.]+"+q+"$").test(g))o=true})}else o=true;else if(c=="id"){c=false;try{var z=b.getElement(g);
c=z==null||z===d}catch(E){}return c}else o=true;return o}})();svgedit=svgedit||{};
(function(){function a(c){if(svgedit.browser.supportsHVLineContainerBBox())try{return c.getBBox()}catch(g){}var d=$.data(c,"ref"),o=null;if(d){var z=$(d).children().clone().attr("visibility","hidden");$(A).append(z);o=z.filter("line, path")}else o=$(c).find("line, path");var E=false;if(o.length){o.each(function(){var q=this.getBBox();if(!q.width||!q.height)E=true});if(E){c=d?z:$(c).children();ret=getStrokedBBox(c)}else ret=c.getBBox()}else ret=c.getBBox();d&&z.remove();return ret}if(!svgedit.utilities)svgedit.utilities=
{};var u="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),e=null,b=null,m=null,A=null;svgedit.utilities.init=function(c){e=c;b=c.getDOMDocument();m=c.getDOMContainer();A=c.getSVGRoot()};svgedit.utilities.toXml=function(c){return $("<p/>").text(c).html()};svgedit.utilities.fromXml=function(c){return $("<p/>").html(c).text()};svgedit.utilities.encode64=function(c){c=svgedit.utilities.convertToXMLReferences(c);if(window.btoa)return window.btoa(c);
var g=Array(Math.floor((c.length+2)/3)*4),d,o,z,E,q,I,R=0,s=0;do{d=c.charCodeAt(R++);o=c.charCodeAt(R++);z=c.charCodeAt(R++);E=d>>2;d=(d&3)<<4|o>>4;q=(o&15)<<2|z>>6;I=z&63;if(isNaN(o))q=I=64;else if(isNaN(z))I=64;g[s++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(E);g[s++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d);g[s++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(q);g[s++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(I)}while(R<
c.length);return g.join("")};svgedit.utilities.decode64=function(c){if(window.atob)return window.atob(c);var g="",d,o,z="",E,q="",I=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(I++));o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(I++));E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(I++));q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(I++));
d=d<<2|o>>4;o=(o&15)<<4|E>>2;z=(E&3)<<6|q;g+=String.fromCharCode(d);if(E!=64)g+=String.fromCharCode(o);if(q!=64)g+=String.fromCharCode(z)}while(I<c.length);return unescape(g)};svgedit.utilities.convertToXMLReferences=function(c){for(var g="",d=0;d<c.length;d++){var o=c.charCodeAt(d);if(o<128)g+=c[d];else if(o>127)g+="&#"+o+";"}return g};svgedit.utilities.text2xml=function(c){if(c.indexOf("<svg:svg")>=0)c=c.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns");var g;try{var d=window.DOMParser?
new DOMParser:new ActiveXObject("Microsoft.XMLDOM");d.async=false}catch(o){throw Error("XML Parser could not be instantiated");}try{g=d.loadXML?d.loadXML(c)?d:false:d.parseFromString(c,"text/xml")}catch(z){throw Error("Error parsing XML string");}return g};svgedit.utilities.bboxToObj=function(c){return{x:c.x,y:c.y,width:c.width,height:c.height}};svgedit.utilities.walkTree=function(c,g){if(c&&c.nodeType==1){g(c);for(var d=c.childNodes.length;d--;)svgedit.utilities.walkTree(c.childNodes.item(d),g)}};
svgedit.utilities.walkTreePost=function(c,g){if(c&&c.nodeType==1){for(var d=c.childNodes.length;d--;)svgedit.utilities.walkTree(c.childNodes.item(d),g);g(c)}};svgedit.utilities.getUrlFromAttr=function(c){if(c)if(c.indexOf('url("')===0)return c.substring(5,c.indexOf('"',6));else if(c.indexOf("url('")===0)return c.substring(5,c.indexOf("'",6));else if(c.indexOf("url(")===0)return c.substring(4,c.indexOf(")"));return null};svgedit.utilities.getHref=function(c){if(c)return c.getAttributeNS("http://www.w3.org/1999/xlink",
"href")};svgedit.utilities.setHref=function(c,g){c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g)};svgedit.utilities.findDefs=function(c){c=e.getSVGContent().documentElement;var g=c.getElementsByTagNameNS("http://www.w3.org/2000/svg","defs");return g=g.length>0?g[0]:c.insertBefore(c.ownerDocument.createElementNS("http://www.w3.org/2000/svg","defs"),c.firstChild.nextSibling)};svgedit.utilities.getPathBBox=function(c){var g=c.pathSegList,d=g.numberOfItems;c=[[],[]];var o=g.getItem(0),
z=[o.x,o.y];for(o=0;o<d;o++){var E=g.getItem(o);if(typeof E.x!="undefined"){c[0].push(z[0]);c[1].push(z[1]);if(E.x1){for(var q=[E.x1,E.y1],I=[E.x2,E.y2],R=[E.x,E.y],s=0;s<2;s++){E=function(Z){return Math.pow(1-Z,3)*z[s]+3*Math.pow(1-Z,2)*Z*q[s]+3*(1-Z)*Math.pow(Z,2)*I[s]+Math.pow(Z,3)*R[s]};var v=6*z[s]-12*q[s]+6*I[s],M=-3*z[s]+9*q[s]-9*I[s]+3*R[s],N=3*q[s]-3*z[s];if(M==0){if(v!=0){v=-N/v;0<v&&v<1&&c[s].push(E(v))}}else{N=Math.pow(v,2)-4*N*M;if(!(N<0)){var K=(-v+Math.sqrt(N))/(2*M);0<K&&K<1&&c[s].push(E(K));
v=(-v-Math.sqrt(N))/(2*M);0<v&&v<1&&c[s].push(E(v))}}}z=R}else{c[0].push(E.x);c[1].push(E.y)}}}g=Math.min.apply(null,c[0]);d=Math.max.apply(null,c[0])-g;o=Math.min.apply(null,c[1]);c=Math.max.apply(null,c[1])-o;return{x:g,y:o,width:d,height:c}};svgedit.utilities.getBBox=function(c){var g=c||e.getSelectedElements()[0];if(c.nodeType!=1)return null;c=null;var d=g.nodeName;switch(d){case "text":if(g.textContent===""){g.textContent="a";c=g.getBBox();g.textContent=""}else try{c=g.getBBox()}catch(o){}break;
case "path":if(svgedit.browser.supportsPathBBox())try{c=g.getBBox()}catch(z){}else c=svgedit.utilities.getPathBBox(g);break;case "g":case "a":c=a(g);break;default:if(d==="use")c=a(g,true);if(d==="use")c||(c=g.getBBox());else if(~u.indexOf(d))try{c=g.getBBox()}catch(E){g=$(g).closest("foreignObject");if(g.length)try{c=g[0].getBBox()}catch(q){c=null}else c=null}}if(c)c=svgedit.utilities.bboxToObj(c);return c};svgedit.utilities.getRotationAngle=function(c,g){var d=c||e.getSelectedElements()[0];d=svgedit.transformlist.getTransformList(d);
if(!d)return 0;for(var o=d.numberOfItems,z=0;z<o;++z){var E=d.getItem(z);if(E.type==4)return g?E.angle*Math.PI/180:E.angle}return 0};svgedit.utilities.getElem=svgedit.browser.supportsSelectors()?function(c){return A.querySelector("#"+c)}:svgedit.browser.supportsXpath()?function(c){return b.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+c+'"]',m,function(){return"http://www.w3.org/2000/svg"},9,null).singleNodeValue}:function(c){return $(A).find("[id="+c+"]")[0]};svgedit.utilities.assignAttributes=
function(c,g,d,o){d||(d=0);svgedit.browser.isOpera()||A.suspendRedraw(d);for(var z in g)if(d=z.substr(0,4)==="xml:"?"http://www.w3.org/XML/1998/namespace":z.substr(0,6)==="xlink:"?"http://www.w3.org/1999/xlink":null)c.setAttributeNS(d,z,g[z]);else o?svgedit.units.setUnitAttr(c,z,g[z]):c.setAttribute(z,g[z]);svgedit.browser.isOpera()||A.unsuspendRedraw(null)};svgedit.utilities.cleanupElement=function(c){var g=A.suspendRedraw(60),d={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none",
"stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0},o;for(o in d){var z=d[o];c.getAttribute(o)==z&&c.removeAttribute(o)}A.unsuspendRedraw(g)}})();svgedit=svgedit||{};
(function(){if(!svgedit.sanitize)svgedit.sanitize={};var a={};a["http://www.w3.org/1999/xlink"]="xlink";a["http://www.w3.org/XML/1998/namespace"]="xml";a["http://www.w3.org/2000/xmlns/"]="xmlns";a["http://svg-edit.googlecode.com"]="se";a["http://www.w3.org/1999/xhtml"]="xhtml";a["http://www.w3.org/1998/Math/MathML"]="mathml";var u={};$.each(a,function(m,A){u[A]=m});var e={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray",
"stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],clipPath:["class",
"clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],feGaussianBlur:["class","color-interpolation-filters","id","requiredFeatures","stdDeviation"],filter:["class","color-interpolation-filters",
"filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage",
"transform","font-family","font-size","font-style","font-weight","text-anchor","data-locked"],image:["class","clip-path","clip-rule","filter","height","id","mask","opacity","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y"],line:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x",
"y"],metadata:["class","id"],path:["class","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox",
"width","x","xlink:href","y"],polygon:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid",
"marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask",
"opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se",
"xmlns:xlink","y"],"switch":["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule",
"filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","xml:space","y"],textPath:["class","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","clip-path","clip-rule","dx","dy","fill",
"fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","xml:space","y"],use:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],
mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],
semantics:[]},b={};$.each(e,function(m,A){var c={};$.each(A,function(g,d){if(d.indexOf(":")>=0){var o=d.split(":");c[o[1]]=u[o[0]]}else c[d]=d=="xmlns"?"http://www.w3.org/2000/xmlns/":null});b[m]=c});svgedit.sanitize.getNSMap=function(){return a};svgedit.sanitize.sanitizeSvg=function(m){if(m.nodeType==3){m.nodeValue=m.nodeValue.replace(/^\s+|\s+$/g,"");m.nodeValue.length||m.parentNode.removeChild(m)}if(m.nodeType==1){var A=m.parentNode;if(m.ownerDocument&&A){var c=e[m.nodeName],g=b[m.nodeName];if(c!=
undefined){for(var d=[],o=m.attributes.length;o--;){var z=m.attributes.item(o),E=z.nodeName,q=z.localName,I=z.namespaceURI;if(!(g.hasOwnProperty(q)&&I==g[q]&&I!="http://www.w3.org/2000/xmlns/")&&!(I=="http://www.w3.org/2000/xmlns/"&&a[z.nodeValue])){E.indexOf("se:")==0&&d.push([E,z.nodeValue]);m.removeAttributeNS(I,q)}if(svgedit.browser.isGecko())switch(E){case "transform":case "gradientTransform":case "patternTransform":q=z.nodeValue.replace(/(\d)-/g,"$1 -");m.setAttribute(E,q)}if(E=="style"){z=
z.nodeValue.split(";");for(E=z.length;E--;){q=z[E].split(":");c.indexOf(q[0])>=0&&m.setAttribute(q[0],q[1])}m.removeAttribute("style")}}$.each(d,function(R,s){m.setAttributeNS("http://svg-edit.googlecode.com",s[0],s[1])});if((o=svgedit.utilities.getHref(m))&&["filter","linearGradient","pattern","radialGradient","textPath","use"].indexOf(m.nodeName)>=0)if(o[0]!="#"){svgedit.utilities.setHref(m,"");m.removeAttributeNS("http://www.w3.org/1999/xlink","href")}if(m.nodeName=="use"&&!svgedit.utilities.getHref(m))A.removeChild(m);
else{$.each(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(R,s){var v=m.getAttribute(s);if(v)if((v=svgedit.utilities.getUrlFromAttr(v))&&v[0]!=="#"){m.setAttribute(s,"");m.removeAttribute(s)}});for(o=m.childNodes.length;o--;)svgedit.sanitize.sanitizeSvg(m.childNodes.item(o))}}else{for(c=[];m.hasChildNodes();)c.push(A.insertBefore(m.firstChild,m));A.removeChild(m);for(o=c.length;o--;)svgedit.sanitize.sanitizeSvg(c[o])}}}}})();svgedit=svgedit||{};
(function(){if(!svgedit.history)svgedit.history={};svgedit.history.HistoryEventTypes={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"};svgedit.history.MoveElementCommand=function(a,u,e,b){this.elem=a;this.text=b?"Move "+a.tagName+" to "+b:"Move "+a.tagName;this.oldNextSibling=u;this.oldParent=e;this.newNextSibling=a.nextSibling;this.newParent=a.parentNode};svgedit.history.MoveElementCommand.type=function(){return"svgedit.history.MoveElementCommand"};svgedit.history.MoveElementCommand.prototype.type=
svgedit.history.MoveElementCommand.type;svgedit.history.MoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.MoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.MoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.MoveElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.InsertElementCommand=function(a,u){this.elem=a;this.text=u||"Create "+a.tagName;this.parent=a.parentNode;this.nextSibling=this.elem.nextSibling};svgedit.history.InsertElementCommand.type=function(){return"svgedit.history.InsertElementCommand"};svgedit.history.InsertElementCommand.prototype.type=
svgedit.history.InsertElementCommand.type;svgedit.history.InsertElementCommand.prototype.getText=function(){return this.text};svgedit.history.InsertElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.parent.insertBefore(this.elem,this.nextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.InsertElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.parent=this.elem.parentNode;this.elem=this.elem.parentNode.removeChild(this.elem);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.InsertElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.RemoveElementCommand=function(a,u,e,b){this.elem=a;this.text=b||"Delete "+a.tagName;this.nextSibling=u;this.parent=e;svgedit.transformlist.removeElementFromListMap(a)};svgedit.history.RemoveElementCommand.type=function(){return"svgedit.history.RemoveElementCommand"};
svgedit.history.RemoveElementCommand.prototype.type=svgedit.history.RemoveElementCommand.type;svgedit.history.RemoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.RemoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.parent=this.elem.parentNode;this.elem=this.parent.removeChild(this.elem);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,
this)};svgedit.history.RemoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.nextSibling==null&&window.console&&console.log("Error: reference element was lost");this.parent.insertBefore(this.elem,this.nextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.RemoveElementCommand.prototype.elements=function(){return[this.elem]};
svgedit.history.ChangeElementCommand=function(a,u,e){this.elem=a;this.text=e?"Change "+a.tagName+" "+e:"Change "+a.tagName;this.newValues={};this.oldValues=u;for(var b in u)this.newValues[b]=b=="#text"?a.textContent:b=="#href"?svgedit.utilities.getHref(a):a.getAttribute(b)};svgedit.history.ChangeElementCommand.type=function(){return"svgedit.history.ChangeElementCommand"};svgedit.history.ChangeElementCommand.prototype.type=svgedit.history.ChangeElementCommand.type;svgedit.history.ChangeElementCommand.prototype.getText=
function(){return this.text};svgedit.history.ChangeElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);var u=false,e;for(e in this.newValues){if(this.newValues[e])if(e=="#text")this.elem.textContent=this.newValues[e];else e=="#href"?svgedit.utilities.setHref(this.elem,this.newValues[e]):this.elem.setAttribute(e,this.newValues[e]);else if(e=="#text")this.elem.textContent="";else{this.elem.setAttribute(e,"");this.elem.removeAttribute(e)}if(e==
"transform")u=true}if(!u)if(u=svgedit.utilities.getRotationAngle(this.elem)){e=elem.getBBox();u=["rotate(",u," ",e.x+e.width/2,",",e.y+e.height/2,")"].join("");u!=elem.getAttribute("transform")&&elem.setAttribute("transform",u)}a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);var u=false,e;for(e in this.oldValues){if(this.oldValues[e])if(e==
"#text")this.elem.textContent=this.oldValues[e];else e=="#href"?svgedit.utilities.setHref(this.elem,this.oldValues[e]):this.elem.setAttribute(e,this.oldValues[e]);else if(e=="#text")this.elem.textContent="";else this.elem.removeAttribute(e);if(e=="transform")u=true}if(!u)if(u=svgedit.utilities.getRotationAngle(this.elem)){e=this.elem.getBBox();u=["rotate(",u," ",e.x+e.width/2,",",e.y+e.height/2,")"].join("");u!=this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",u)}svgedit.transformlist.removeElementFromListMap(this.elem);
a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.BatchCommand=function(a){this.text=a||"Batch Command";this.stack=[]};svgedit.history.BatchCommand.type=function(){return"svgedit.history.BatchCommand"};svgedit.history.BatchCommand.prototype.type=svgedit.history.BatchCommand.type;svgedit.history.BatchCommand.prototype.getText=function(){return this.text};svgedit.history.BatchCommand.prototype.apply=
function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);for(var u=this.stack.length,e=0;e<u;++e)this.stack[e].apply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.BatchCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);for(var u=this.stack.length-1;u>=0;u--)this.stack[u].unapply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,
this)};svgedit.history.BatchCommand.prototype.elements=function(){for(var a=[],u=this.stack.length;u--;)for(var e=this.stack[u].elements(),b=e.length;b--;)a.indexOf(e[b])==-1&&a.push(e[b]);return a};svgedit.history.BatchCommand.prototype.addSubCommand=function(a){this.stack.push(a)};svgedit.history.BatchCommand.prototype.isEmpty=function(){return this.stack.length==0};svgedit.history.UndoManager=function(a){this.handler_=a||null;this.undoStackPointer=0;this.undoStack=[];this.undoChangeStackPointer=
-1;this.undoableChangeStack=[]};svgedit.history.UndoManager.prototype.resetUndoStack=function(){this.undoStack=[];this.undoStackPointer=0};svgedit.history.UndoManager.prototype.getUndoStackSize=function(){return this.undoStackPointer};svgedit.history.UndoManager.prototype.getRedoStackSize=function(){return this.undoStack.length-this.undoStackPointer};svgedit.history.UndoManager.prototype.getNextUndoCommandText=function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():
""};svgedit.history.UndoManager.prototype.getNextRedoCommandText=function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""};svgedit.history.UndoManager.prototype.undo=function(){this.undoStackPointer>0&&this.undoStack[--this.undoStackPointer].unapply(this.handler_)};svgedit.history.UndoManager.prototype.redo=function(){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&this.undoStack[this.undoStackPointer++].apply(this.handler_)};
svgedit.history.UndoManager.prototype.addCommandToHistory=function(a){if(this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0)this.undoStack=this.undoStack.splice(0,this.undoStackPointer);this.undoStack.push(a);this.undoStackPointer=this.undoStack.length};svgedit.history.UndoManager.prototype.beginUndoableChange=function(a,u){for(var e=++this.undoChangeStackPointer,b=u.length,m=Array(b),A=Array(b);b--;){var c=u[b];if(c!=null){A[b]=c;m[b]=c.getAttribute(a)}}this.undoableChangeStack[e]=
{attrName:a,oldValues:m,elements:A}};svgedit.history.UndoManager.prototype.finishUndoableChange=function(){for(var a=this.undoChangeStackPointer--,u=this.undoableChangeStack[a],e=u.elements.length,b=u.attrName,m=new svgedit.history.BatchCommand("Change "+b);e--;){var A=u.elements[e];if(A!=null){var c={};c[b]=u.oldValues[e];c[b]!=A.getAttribute(b)&&m.addSubCommand(new svgedit.history.ChangeElementCommand(A,c,b))}}this.undoableChangeStack[a]=null;return m}})();svgedit=svgedit||{};
(function(){if(!svgedit.select)svgedit.select={};var a,u,e;svgedit.select.Selector=function(b,m){this.id=b;this.selectedElement=m;this.locked=true;this.selectorGroup=a.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}});this.selectorRect=this.selectorGroup.appendChild(a.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#4F80FF","stroke-width":"1","shape-rendering":"crispEdges",style:"pointer-events:none"}}));svgedit.browser.isTouch()&&this.selectorRect.setAttribute("stroke-opacity",
0.3);this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};this.reset(this.selectedElement)};svgedit.select.Selector.prototype.reset=function(b){this.locked=true;this.selectedElement=b;this.resize();this.selectorGroup.setAttribute("display","inline")};svgedit.select.Selector.prototype.updateGripCursors=function(b){var m=[];b=Math.round(b/45);if(b<0)b+=8;for(var A in e.selectorGrips)m.push(A);for(;b>0;){m.push(m.shift());b--}b=0;for(A in e.selectorGrips){e.selectorGrips[A].setAttribute("style",
"cursor:"+m[b]+"-resize");b++}};svgedit.select.Selector.prototype.showGrips=function(b){e.selectorGripsGroup.setAttribute("display",b?"inline":"none");var m=this.selectedElement;this.hasGrips=b;if(m&&b){this.selectorGroup.appendChild(e.selectorGripsGroup);this.updateGripCursors(svgedit.utilities.getRotationAngle(m))}};svgedit.select.Selector.prototype.resize=function(){var b=this.selectorRect,m=e,A=m.selectorGrips,c=this.selectedElement,g=c.getAttribute("stroke-width"),d=a.currentZoom(),o=1/d;if(c.getAttribute("stroke")!==
"none"&&!isNaN(g))o+=g/2;var z=c.tagName;if(z==="text")o+=2/d;g=svgedit.transformlist.getTransformList(c);g=svgedit.math.transformListToTransform(g).matrix;g.e*=d;g.f*=d;var E=svgedit.utilities.getBBox(c);if(z==="g"&&!$.data(c,"gsvg"))if(z=a.getStrokedBBox(c.childNodes))E=z;z=E.x;var q=E.y,I=E.width;E=E.height;o*=d;d=svgedit.math.transformBox(z*d,q*d,I*d,E*d,g);g=d.aabox;z=g.x-o;q=g.y-o;I=g.width+o*2;var R=g.height+o*2;g=z+I/2;E=q+R/2;if(c=svgedit.utilities.getRotationAngle(c)){z=a.svgRoot().createSVGTransform();
z.setRotate(-c,g,E);z=z.matrix;d.tl=svgedit.math.transformPoint(d.tl.x,d.tl.y,z);d.tr=svgedit.math.transformPoint(d.tr.x,d.tr.y,z);d.bl=svgedit.math.transformPoint(d.bl.x,d.bl.y,z);d.br=svgedit.math.transformPoint(d.br.x,d.br.y,z);z=d.tl;I=z.x;R=z.y;var s=z.x,v=z.y;z=Math.min;q=Math.max;I=z(I,z(d.tr.x,z(d.bl.x,d.br.x)))-o;R=z(R,z(d.tr.y,z(d.bl.y,d.br.y)))-o;s=q(s,q(d.tr.x,q(d.bl.x,d.br.x)))+o;v=q(v,q(d.tr.y,q(d.bl.y,d.br.y)))+o;z=I;q=R;I=s-I;R=v-R}o=a.svgRoot().suspendRedraw(100);b.setAttribute("d",
"M"+z+","+q+" L"+(z+I)+","+q+" "+(z+I)+","+(q+R)+" "+z+","+(q+R)+"z");this.selectorGroup.setAttribute("transform",c?"rotate("+[c,g,E].join(",")+")":"");if(svgedit.browser.isTouch()){z-=15.75;q-=15.75}else{z-=4;q-=4}this.gripCoords={nw:[z,q].map(Math.round),ne:[z+I,q].map(Math.round),sw:[z,q+R].map(Math.round),se:[z+I,q+R].map(Math.round),n:[z+I/2,q].map(Math.round),w:[z,q+R/2].map(Math.round),e:[z+I,q+R/2].map(Math.round),s:[z+I/2,q+R].map(Math.round)};for(var M in this.gripCoords){b=this.gripCoords[M];
A[M].setAttribute("x",b[0]);A[M].setAttribute("y",b[1])}this.rotateCoords={nw:[z,q],ne:[z+I+8,q],sw:[z,q+R+8],se:[z+I+8,q+R+8]};for(M in this.rotateCoords){b=this.rotateCoords[M];m.rotateGrips[M].setAttribute("cx",b[0]);m.rotateGrips[M].setAttribute("cy",b[1])}a.svgRoot().unsuspendRedraw(o)};svgedit.select.SelectorManager=function(){this.rubberBandBox=this.selectorParentGroup=null;this.selectors=[];this.selectorMap={};this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};
this.selectorGripsGroup=null;this.rotateGrips={nw:null,ne:null,se:null,sw:null};this.initGroup()};svgedit.select.SelectorManager.prototype.initGroup=function(){this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.parentNode.removeChild(this.selectorParentGroup);this.selectorParentGroup=a.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}});this.selectorGripsGroup=a.createSVGElement({element:"g",attr:{display:"none"}});this.selectorParentGroup.appendChild(this.selectorGripsGroup);
a.svgRoot().appendChild(this.selectorParentGroup);this.selectorMap={};this.selectors=[];this.rubberBandBox=null;for(var b in this.rotateGrips){var m=a.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate_"+b,fill:"#000",r:8,stroke:"#000","fill-opacity":0,"stroke-opacity":0,"stroke-width":0,style:"cursor:url("+u.imgPath+"rotate.png) 12 12, auto;"}});$.data(m,"dir",b);$.data(m,"type","rotate");this.rotateGrips[b]=this.selectorGripsGroup.appendChild(m)}for(b in this.selectorGrips){m=a.createSVGElement({element:"rect",
attr:{id:"selectorGrip_resize_"+b,width:8,height:8,fill:"#4F80FF",stroke:"rgba(0,0,0,0)","stroke-width":1,style:"cursor:"+b+"-resize","pointer-events":"all"}});if(svgedit.browser.isTouch()){m.setAttribute("width",30.5);m.setAttribute("height",30.5);m.setAttribute("fill-opacity",0.3)}$.data(m,"dir",b);$.data(m,"type","resize");this.selectorGrips[b]=this.selectorGripsGroup.appendChild(m)}if(!$("#canvasBackground").length){b=u.dimensions;b=a.createSVGElement({element:"svg",attr:{id:"canvasBackground",
width:b[0],height:b[1],x:0,y:0,overflow:svgedit.browser.isWebkit()?"none":"visible",style:"pointer-events:none"}});m=a.createSVGElement({element:"defs",attr:{id:"placeholder_defs"}});var A=a.createSVGElement({element:"pattern",attr:{id:"checkerPattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20,viewBox:"0 0 10 10"}}),c=a.createSVGElement({element:"rect",attr:{x:0,y:0,width:10,height:10,fill:"#fff"}}),g=a.createSVGElement({element:"rect",attr:{x:0,y:0,width:5,height:5,fill:"#eee"}}),
d=a.createSVGElement({element:"rect",attr:{x:5,y:5,width:5,height:5,fill:"#eee"}}),o=a.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":1,stroke:"#000",fill:"url(#checkerPattern)",style:"pointer-events:none"}});b.appendChild(m);m.appendChild(A);A.appendChild(c);A.appendChild(g);A.appendChild(d);b.appendChild(o);a.svgRoot().insertBefore(b,a.svgContent())}};svgedit.select.SelectorManager.prototype.requestSelector=function(b){if(b==null)return null;var m=this.selectors.length;
if(typeof this.selectorMap[b.id]=="object"){this.selectorMap[b.id].locked=true;return this.selectorMap[b.id]}for(var A=0;A<m;++A)if(this.selectors[A]&&!this.selectors[A].locked){this.selectors[A].locked=true;this.selectors[A].reset(b);this.selectorMap[b.id]=this.selectors[A];return this.selectors[A]}this.selectors[m]=new svgedit.select.Selector(m,b);this.selectorParentGroup.appendChild(this.selectors[m].selectorGroup);this.selectorMap[b.id]=this.selectors[m];return this.selectors[m]};svgedit.select.SelectorManager.prototype.releaseSelector=
function(b){if(b!=null)for(var m=this.selectors.length,A=this.selectorMap[b.id],c=0;c<m;++c)if(this.selectors[c]&&this.selectors[c]==A){A.locked==false&&console.log("WARNING! selector was released but was already unlocked");delete this.selectorMap[b.id];A.locked=false;A.selectedElement=null;A.showGrips(false);try{A.selectorGroup.setAttribute("display","none")}catch(g){}break}};svgedit.select.SelectorManager.prototype.getRubberBandBox=function(){if(!this.rubberBandBox)this.rubberBandBox=this.selectorParentGroup.appendChild(a.createSVGElement({element:"rect",
attr:{id:"selectorRubberBand",fill:"none",stroke:"#666","stroke-width":1,"stroke-dasharray":"3,2",display:"none",style:"pointer-events:none"}}));return this.rubberBandBox};svgedit.select.init=function(b,m){u=b;a=m;e=new svgedit.select.SelectorManager;a.createSVGElement({element:"g",attr:{id:"hover_group"}})};svgedit.select.getSelectorManager=function(){return e}})();svgedit=svgedit||{};
(function(){if(!svgedit.draw)svgedit.draw={};var a="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),u={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},e=u.LET_DOCUMENT_DECIDE;svgedit.draw.Layer=function(b,m){this.name_=b;this.group_=m};svgedit.draw.Layer.prototype.getName=function(){return this.name_};svgedit.draw.Layer.prototype.getGroup=function(){return this.group_};svgedit.draw.randomizeIds=function(b,m){e=b==false?u.NEVER_RANDOMIZE:
u.ALWAYS_RANDOMIZE;if(e==u.ALWAYS_RANDOMIZE&&!m.getNonce())m.setNonce(Math.floor(Math.random()*100001));else e==u.NEVER_RANDOMIZE&&m.getNonce()&&m.clearNonce()};svgedit.draw.Drawing=function(b,m){if(!b||!b.tagName||!b.namespaceURI||b.tagName!="svg"||b.namespaceURI!="http://www.w3.org/2000/svg")throw"Error: svgedit.draw.Drawing instance initialized without a <svg> element";this.svgElem_=b;this.obj_num=0;this.idPrefix=m||"svg_";this.releasedNums=[];this.all_layers=[];this.current_layer=null;this.nonce_=
"";var A=this.svgElem_.getAttributeNS("http://svg-edit.googlecode.com","nonce");if(A&&e!=u.NEVER_RANDOMIZE)this.nonce_=A;else e==u.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(Math.random()*100001))};svgedit.draw.Drawing.prototype.getElem_=function(b){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+b):$(this.svgElem_).find("[id="+b+"]")[0]};svgedit.draw.Drawing.prototype.getSvgElem=function(){return this.svgElem_};svgedit.draw.Drawing.prototype.getNonce=function(){return this.nonce_};
svgedit.draw.Drawing.prototype.setNonce=function(b){this.svgElem_.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:se","http://svg-edit.googlecode.com");this.svgElem_.setAttributeNS("http://svg-edit.googlecode.com","se:nonce",b);this.nonce_=b};svgedit.draw.Drawing.prototype.clearNonce=function(){this.nonce_=""};svgedit.draw.Drawing.prototype.getId=function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num};svgedit.draw.Drawing.prototype.getNextId=function(){var b=
this.obj_num,m=false;if(this.releasedNums.length>0){this.obj_num=this.releasedNums.pop();m=true}else this.obj_num++;for(var A=this.getId();this.getElem_(A);){if(m){this.obj_num=b;m=false}this.obj_num++;A=this.getId()}if(m)this.obj_num=b;return A};svgedit.draw.Drawing.prototype.releaseId=function(b){var m=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if(typeof b!="string"||b.indexOf(m)!=0)return false;b=parseInt(b.substr(m.length));if(typeof b!="number"||b<=0||this.releasedNums.indexOf(b)!=-1)return false;
this.releasedNums.push(b);return true};svgedit.draw.Drawing.prototype.getNumLayers=function(){return this.all_layers.length};svgedit.draw.Drawing.prototype.hasLayer=function(b){for(var m=0;m<this.getNumLayers();m++)if(this.all_layers[m][0]==b)return true;return false};svgedit.draw.Drawing.prototype.getLayerName=function(b){if(b>=0&&b<this.getNumLayers())return this.all_layers[b][0];return""};svgedit.draw.Drawing.prototype.getCurrentLayer=function(){return this.current_layer};svgedit.draw.Drawing.prototype.getCurrentLayerName=
function(){for(var b=0;b<this.getNumLayers();++b)if(this.all_layers[b][1]==this.current_layer)return this.getLayerName(b);return""};svgedit.draw.Drawing.prototype.setCurrentLayer=function(b){for(var m=0;m<this.getNumLayers();++m)if(b==this.getLayerName(m)){if(this.current_layer!=this.all_layers[m][1]){this.current_layer.setAttribute("style","pointer-events:none");this.current_layer=this.all_layers[m][1];this.current_layer.setAttribute("style","pointer-events:all")}return true}return false};svgedit.draw.Drawing.prototype.deleteCurrentLayer=
function(){if(this.current_layer&&this.getNumLayers()>1){var b=this.current_layer.parentNode.removeChild(this.current_layer);this.identifyLayers();return b}return null};svgedit.draw.Drawing.prototype.identifyLayers=function(){this.all_layers=[];for(var b=this.svgElem_.childNodes.length,m=[],A=[],c=null,g=false,d=0;d<b;++d){var o=this.svgElem_.childNodes.item(d);if(o&&o.nodeType==1)if(o.tagName=="g"){g=true;var z=$("title",o).text();if(!z&&svgedit.browser.isOpera()&&o.querySelectorAll)z=$(o.querySelectorAll("title")).text();
if(z){A.push(z);this.all_layers.push([z,o]);c=o;svgedit.utilities.walkTree(o,function(E){E.setAttribute("style","pointer-events:inherit")});c.setAttribute("style","pointer-events:none")}else m.push(o)}else if(~a.indexOf(o.nodeName)){svgedit.utilities.getBBox(o);m.push(o)}}b=this.svgElem_.ownerDocument;if(m.length>0||!g){for(d=1;A.indexOf("Layer "+d)>=0;)d++;A="Layer "+d;c=b.createElementNS("http://www.w3.org/2000/svg","g");g=b.createElementNS("http://www.w3.org/2000/svg","title");g.textContent=A;
c.appendChild(g);for(g=0;g<m.length;++g)c.appendChild(m[g]);this.svgElem_.appendChild(c);this.all_layers.push([A,c])}svgedit.utilities.walkTree(c,function(E){E.setAttribute("style","pointer-events:inherit")});this.current_layer=c.getAttribute("data-locked")==="true"?this.all_layers.slice(-2)[0][1]:c;this.current_layer.setAttribute("style","pointer-events:all")};svgedit.draw.Drawing.prototype.createLayer=function(b){var m=this.svgElem_.ownerDocument,A=m.createElementNS("http://www.w3.org/2000/svg",
"g");m=m.createElementNS("http://www.w3.org/2000/svg","title");m.textContent=b;A.appendChild(m);this.svgElem_.appendChild(A);this.identifyLayers();return A};svgedit.draw.Drawing.prototype.getLayerVisibility=function(b){for(var m=null,A=0;A<this.getNumLayers();++A)if(this.getLayerName(A)==b){m=this.all_layers[A][1];break}if(!m)return false;return m.getAttribute("display")!="none"};svgedit.draw.Drawing.prototype.setLayerVisibility=function(b,m){if(typeof m!="boolean")return null;for(var A=null,c=0;c<
this.getNumLayers();++c)if(this.getLayerName(c)==b){A=this.all_layers[c][1];break}if(!A)return null;A.getAttribute("display");A.setAttribute("display",m?"inline":"none");return A};svgedit.draw.Drawing.prototype.getLayerOpacity=function(b){for(var m=0;m<this.getNumLayers();++m)if(this.getLayerName(m)==b){(b=this.all_layers[m][1].getAttribute("opacity"))||(b="1.0");return parseFloat(b)}return null};svgedit.draw.Drawing.prototype.setLayerOpacity=function(b,m){if(!(typeof m!="number"||m<0||m>1))for(var A=
0;A<this.getNumLayers();++A)if(this.getLayerName(A)==b){this.all_layers[A][1].setAttribute("opacity",m);break}}})();svgedit=svgedit||{};
(function(){if(!svgedit.path)svgedit.path={};var a={pathNodeTooltip:"Drag node to move it. Double-click node to change segment type",pathCtrlPtTooltip:"Drag control point to adjust curve properties"},u={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},e=[],b=false,m={};svgedit.path.setLinkControlPoints=function(g){b=g};var A=svgedit.path.path=null;svgedit.path.init=
function(g){A=g;e=[0,"ClosePath"];$.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],function(d,o){e.push(o+"Abs");e.push(o+"Rel")})};svgedit.path.insertItemBefore=function(g,d,o){g=g.pathSegList;if(svgedit.browser.supportsPathInsertItemBefore())g.insertItemBefore(d,o);else{for(var z=g.numberOfItems,E=[],q=0;q<z;q++){var I=g.getItem(q);E.push(I)}g.clear();for(q=0;q<z;q++){q==o&&g.appendItem(d);g.appendItem(E[q])}}};
svgedit.path.ptObjToArr=function(g,d){for(var o=u[g],z=o.length,E=Array(z),q=0;q<z;q++)E[q]=d[o[q]];return E};svgedit.path.getGripPt=function(g,d){var o={x:d?d.x:g.item.x,y:d?d.y:g.item.y},z=g.path;if(z.matrix)o=svgedit.math.transformPoint(o.x,o.y,z.matrix);o.x*=A.getCurrentZoom();o.y*=A.getCurrentZoom();return o};svgedit.path.getPointFromGrip=function(g,d){var o={x:g.x,y:g.y};if(d.matrix){g=svgedit.math.transformPoint(o.x,o.y,d.imatrix);o.x=g.x;o.y=g.y}o.x/=A.getCurrentZoom();o.y/=A.getCurrentZoom();
return o};svgedit.path.addPointGrip=function(g,d,o){var z=svgedit.path.getGripContainer(),E=svgedit.utilities.getElem("pathpointgrip_"+g);if(!E){E=document.createElementNS("http://www.w3.org/2000/svg","rect");svgedit.utilities.assignAttributes(E,{id:"pathpointgrip_"+g,display:"none",width:svgedit.browser.isTouch()?30:5,height:svgedit.browser.isTouch()?30:5,fill:"#fff",stroke:"#4F80FF","shape-rendering":"crispEdges","stroke-width":1,cursor:"move",style:"pointer-events:all","xlink:title":a.pathNodeTooltip});
E=z.appendChild(E);$("#pathpointgrip_"+g).dblclick(function(){svgedit.path.path&&svgedit.path.path.setSegType()})}if(d&&o)svgedit.utilities.assignAttributes(E,{x:d-(svgedit.browser.isTouch()?15:2.5),y:o-(svgedit.browser.isTouch()?15:2.5),display:"inline"});return E};svgedit.path.getGripContainer=function(){var g=svgedit.utilities.getElem("pathpointgrip_container");if(!g){g=svgedit.utilities.getElem("selectorParentGroup").appendChild(document.createElementNS("http://www.w3.org/2000/svg","g"));g.id=
"pathpointgrip_container"}return g};svgedit.path.addCtrlGrip=function(g){var d=svgedit.utilities.getElem("ctrlpointgrip_"+g);if(d)return d;d=document.createElementNS("http://www.w3.org/2000/svg","circle");svgedit.utilities.assignAttributes(d,{id:"ctrlpointgrip_"+g,display:"none",r:svgedit.browser.isTouch()?15:3,fill:"#4F80FF",stroke:"#4F80FF","stroke-opacity":0,"stroke-width":"3",cursor:"move",style:"pointer-events:all","xlink:title":a.pathCtrlPtTooltip});svgedit.path.getGripContainer().appendChild(d);
return d};svgedit.path.getCtrlLine=function(g){var d=svgedit.utilities.getElem("ctrlLine_"+g);if(d)return d;d=document.createElementNS("http://www.w3.org/2000/svg","line");svgedit.utilities.assignAttributes(d,{id:"ctrlLine_"+g,stroke:"#4F80FF","stroke-width":1,style:"pointer-events:none"});svgedit.path.getGripContainer().appendChild(d);return d};svgedit.path.getPointGrip=function(g,d){var o=svgedit.path.addPointGrip(g.index);if(d){var z=svgedit.path.getGripPt(g);svgedit.utilities.assignAttributes(o,
{x:z.x-(svgedit.browser.isTouch()?15:2.5),y:z.y-(svgedit.browser.isTouch()?15:2.5),display:"inline"})}return o};svgedit.path.getControlPoints=function(g){var d=g.item,o=g.index;if(!d||!("x1"in d)||!("x2"in d))return null;var z={};svgedit.path.getGripContainer();for(var E=[svgedit.path.path.segs[o-1].item,d],q=1;q<3;q++){var I=o+"c"+q,R=z["c"+q+"_line"]=svgedit.path.getCtrlLine(I),s=svgedit.path.getGripPt(g,{x:d["x"+q],y:d["y"+q]}),v=svgedit.path.getGripPt(g,{x:E[q-1].x,y:E[q-1].y});svgedit.utilities.assignAttributes(R,
{x1:s.x,y1:s.y,x2:v.x,y2:v.y,display:"inline"});z["c"+q+"_line"]=R;pointGrip=z["c"+q]=svgedit.path.addCtrlGrip(I);svgedit.utilities.assignAttributes(pointGrip,{cx:s.x,cy:s.y,display:"inline"});z["c"+q]=pointGrip}return z};svgedit.path.replacePathSeg=function(g,d,o,z){z=z||svgedit.path.path.elem;g=z["createSVGPathSeg"+e[g]].apply(z,o);if(svgedit.browser.supportsPathReplaceItem())z.pathSegList.replaceItem(g,d);else{o=z.pathSegList;z=o.numberOfItems;for(var E=[],q=0;q<z;q++){var I=o.getItem(q);E.push(I)}o.clear();
for(q=0;q<z;q++)q==d?o.appendItem(g):o.appendItem(E[q])}};svgedit.path.getSegSelector=function(g,d){var o=g.index,z=svgedit.utilities.getElem("segline_"+o);if(!z){var E=svgedit.path.getGripContainer();z=document.createElementNS("http://www.w3.org/2000/svg","path");svgedit.utilities.assignAttributes(z,{id:"segline_"+o,display:"none",fill:"none",stroke:"#0ff","stroke-opacity":1,"shape-rendering":"crispEdges","stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"});E.appendChild(z)}if(d){o=g.prev;
if(!o){z.setAttribute("display","none");return z}o=svgedit.path.getGripPt(o);svgedit.path.replacePathSeg(2,0,[o.x,o.y],z);E=svgedit.path.ptObjToArr(g.type,g.item,true);for(var q=0;q<E.length;q+=2){o=svgedit.path.getGripPt(g,{x:E[q],y:E[q+1]});E[q]=o.x;E[q+1]=o.y}svgedit.path.replacePathSeg(g.type,1,E,z)}return z};svgedit.path.smoothControlPoints=this.smoothControlPoints=function(g,d,o){var z=g.x-o.x,E=g.y-o.y,q=d.x-o.x,I=d.y-o.y;if((z!=0||E!=0)&&(q!=0||I!=0)){g=Math.atan2(E,z);d=Math.atan2(I,q);z=
Math.sqrt(z*z+E*E);q=Math.sqrt(q*q+I*I);E=A.getSVGRoot().createSVGPoint();I=A.getSVGRoot().createSVGPoint();if(g<0)g+=2*Math.PI;if(d<0)d+=2*Math.PI;var R=Math.abs(g-d),s=Math.abs(Math.PI-R)/2;if(g-d>0){g=R<Math.PI?g+s:g-s;d=R<Math.PI?d-s:d+s}else{g=R<Math.PI?g-s:g+s;d=R<Math.PI?d+s:d-s}E.x=z*Math.cos(g)+o.x;E.y=z*Math.sin(g)+o.y;I.x=q*Math.cos(d)+o.x;I.y=q*Math.sin(d)+o.y;return[E,I]}};svgedit.path.Segment=function(g,d){this.selected=false;this.index=g;this.item=d;this.type=d.pathSegType;this.ctrlpts=
[];this.segsel=this.ptgrip=null};svgedit.path.Segment.prototype.showCtrlPts=function(g){for(var d in this.ctrlpts)this.ctrlpts[d].setAttribute("display",g?"inline":"none")};svgedit.path.Segment.prototype.selectCtrls=function(){$("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill","#4F80FF")};svgedit.path.Segment.prototype.show=function(g){if(this.ptgrip){this.ptgrip.setAttribute("display",g?"inline":"none");this.segsel.setAttribute("display",g?"inline":"none");this.showCtrlPts(g)}};
svgedit.path.Segment.prototype.select=function(g){if(this.ptgrip){this.ptgrip.setAttribute("stroke",g?"#4F80FF":"#4F80FF");this.ptgrip.setAttribute("fill",g?"#4F80FF":"#fff");this.segsel.setAttribute("display",g?"inline":"none");this.ctrlpts&&this.selectCtrls(g);this.selected=g}};svgedit.path.Segment.prototype.addGrip=function(){this.ptgrip=svgedit.path.getPointGrip(this,true);this.ctrlpts=svgedit.path.getControlPoints(this,true);this.segsel=svgedit.path.getSegSelector(this,true)};svgedit.path.Segment.prototype.update=
function(g){if(this.ptgrip){var d=svgedit.path.getGripPt(this),o=svgedit.browser.isTouch()?15:2.5;svgedit.utilities.assignAttributes(this.ptgrip,this.ptgrip.nodeName=="rect"?{x:d.x-o,y:d.y-o}:{cx:d.x,cy:d.y});svgedit.path.getSegSelector(this,true);if(this.ctrlpts){if(g){this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.type=this.item.pathSegType}svgedit.path.getControlPoints(this)}}};svgedit.path.Segment.prototype.move=function(g,d){var o=this.item;o=this.ctrlpts?[o.x+=g,o.y+=
d,o.x1,o.y1,o.x2+=g,o.y2+=d]:[o.x+=g,o.y+=d];svgedit.path.replacePathSeg(this.type,this.index,o);if(this.next&&this.next.ctrlpts){o=this.next.item;o=[o.x,o.y,o.x1+=g,o.y1+=d,o.x2,o.y2];svgedit.path.replacePathSeg(this.next.type,this.next.index,o)}if(this.mate){o=this.mate.item;o=[o.x+=g,o.y+=d];svgedit.path.replacePathSeg(this.mate.type,this.mate.index,o)}this.update(true);this.next&&this.next.update(true)};svgedit.path.Segment.prototype.setLinked=function(g){var d,o,z;if(g==2){o=1;d=this.next;if(!d)return;
z=this.item}else{o=2;d=this.prev;if(!d)return;z=d.item}var E=d.item;E["x"+o]=z.x+z.x-this.item["x"+g];E["y"+o]=z.y+z.y-this.item["y"+g];svgedit.path.replacePathSeg(d.type,d.index,[E.x,E.y,E.x1,E.y1,E.x2,E.y2]);d.update(true)};svgedit.path.Segment.prototype.moveCtrl=function(g,d,o){var z=this.item;z["x"+g]+=d;z["y"+g]+=o;svgedit.path.replacePathSeg(this.type,this.index,[z.x,z.y,z.x1,z.y1,z.x2,z.y2]);this.update(true)};svgedit.path.Segment.prototype.setType=function(g,d){svgedit.path.replacePathSeg(g,
this.index,d);this.type=g;this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.showCtrlPts(g===6);this.ctrlpts=svgedit.path.getControlPoints(this);this.update(true)};svgedit.path.Path=function(g){if(!g||g.tagName!=="path")throw"svgedit.path.Path constructed without a <path> element";this.elem=g;this.segs=[];this.selected_pts=[];svgedit.path.path=this;this.init()};svgedit.path.Path.prototype.init=function(){$(svgedit.path.getGripContainer()).find("*").attr("display","none");var g=
this.elem.pathSegList,d=g.numberOfItems;this.segs=[];this.selected_pts=[];this.first_seg=null;for(var o=0;o<d;o++){var z=g.getItem(o);z=new svgedit.path.Segment(o,z);z.path=this;this.segs.push(z)}g=this.segs;z=null;for(o=0;o<d;o++){var E=g[o],q=o+1>=d?null:g[o+1],I=o-1<0?null:g[o-1];if(E.type===2){if(I&&I.type!==1){q=g[z];q.next=g[z+1];q.next.prev=q;q.addGrip()}z=o}else if(q&&q.type===1){E.next=g[z+1];E.next.prev=E;E.mate=g[z];E.addGrip();if(this.first_seg==null)this.first_seg=E}else if(q){if(E.type!==
1){E.addGrip();if(q&&q.type!==2){E.next=q;E.next.prev=E}}}else if(E.type!==1){q=g[z];q.next=g[z+1];q.next.prev=q;q.addGrip();E.addGrip();if(!this.first_seg)this.first_seg=g[z]}}return this};svgedit.path.Path.prototype.eachSeg=function(g){for(var d=this.segs.length,o=0;o<d;o++)if(g.call(this.segs[o],o)===false)break};svgedit.path.Path.prototype.addSeg=function(g){var d=this.segs[g];if(d.prev){var o=d.prev,z;switch(d.item.pathSegType){case 4:var E=(d.item.x+o.item.x)/2,q=(d.item.y+o.item.y)/2;z=this.elem.createSVGPathSegLinetoAbs(E,
q);break;case 6:z=(o.item.x+d.item.x1)/2;var I=(d.item.x1+d.item.x2)/2,R=(d.item.x2+d.item.x)/2,s=(z+I)/2;I=(I+R)/2;E=(s+I)/2;var v=(o.item.y+d.item.y1)/2,M=(d.item.y1+d.item.y2)/2;o=(d.item.y2+d.item.y)/2;var N=(v+M)/2;M=(M+o)/2;q=(N+M)/2;z=this.elem.createSVGPathSegCurvetoCubicAbs(E,q,z,v,s,N);svgedit.path.replacePathSeg(d.type,g,[d.item.x,d.item.y,I,M,R,o])}svgedit.path.insertItemBefore(this.elem,z,g)}};svgedit.path.Path.prototype.deleteSeg=function(g){var d=this.segs[g],o=this.elem.pathSegList;
d.show(false);var z=d.next;if(d.mate){var E=[z.item.x,z.item.y];svgedit.path.replacePathSeg(2,z.index,E);svgedit.path.replacePathSeg(4,d.index,E);o.removeItem(d.mate.index)}else{if(!d.prev){E=[z.item.x,z.item.y];svgedit.path.replacePathSeg(2,d.next.index,E)}o.removeItem(g)}};svgedit.path.Path.prototype.subpathIsClosed=function(g){var d=false;svgedit.path.path.eachSeg(function(o){if(o<=g)return true;if(this.type===2)return false;else if(this.type===1){d=true;return false}});return d};svgedit.path.Path.prototype.removePtFromSelection=
function(g){var d=this.selected_pts.indexOf(g);if(d!=-1){this.segs[g].select(false);this.selected_pts.splice(d,1)}};svgedit.path.Path.prototype.clearSelection=function(){this.eachSeg(function(){this.select(false)});this.selected_pts=[]};svgedit.path.Path.prototype.storeD=function(){this.last_d=this.elem.getAttribute("d")};svgedit.path.Path.prototype.show=function(g){this.eachSeg(function(){this.show(g)});g&&this.selectPt(this.first_seg.index);return this};svgedit.path.Path.prototype.movePts=function(g,
d){for(var o=this.selected_pts.length;o--;)this.segs[this.selected_pts[o]].move(g,d)};svgedit.path.Path.prototype.moveCtrl=function(g,d){var o=this.segs[this.selected_pts[0]];o.moveCtrl(this.dragctrl,g,d);b&&o.setLinked(this.dragctrl)};svgedit.path.Path.prototype.setSegType=function(g){this.storeD();for(var d=this.selected_pts.length,o;d--;){var z=this.segs[this.selected_pts[d]],E=z.prev;if(E){if(!g){o="Toggle Path Segment Type";g=z.type==6?4:6}g-=0;var q=z.item.x,I=z.item.y,R=E.item.x;E=E.item.y;
var s;switch(g){case 6:if(z.olditem){R=z.olditem;s=[q,I,R.x1,R.y1,R.x2,R.y2]}else{s=q-R;var v=I-E;s=[q,I,R+s/3,E+v/3,q-s/3,I-v/3]}break;case 4:s=[q,I];z.olditem=z.item}z.setType(g,s)}}svgedit.path.path.endChanges(o)};svgedit.path.Path.prototype.selectPt=function(g,d){this.clearSelection();g==null&&this.eachSeg(function(o){if(this.prev)g=o});this.addPtsToSelection(g);if(d){this.dragctrl=d;b&&this.segs[g].setLinked(d)}};svgedit.path.Path.prototype.update=function(){var g=this.elem;if(svgedit.utilities.getRotationAngle(g)){this.matrix=
svgedit.math.getMatrix(g);this.imatrix=this.matrix.inverse()}else this.imatrix=this.matrix=null;this.eachSeg(function(d){this.item=g.pathSegList.getItem(d);this.update()});return this};svgedit.path.getPath_=function(g){var d=m[g.id];d||(d=m[g.id]=new svgedit.path.Path(g));return d};svgedit.path.removePath_=function(g){g in m&&delete m[g]};var c=function(g,d,o,z,E,q,I){dx=g-o;dy=d-z;r=Math.sqrt(dx*dx+dy*dy);theta=Math.atan2(dy,dx)+I;dx=r*Math.cos(theta)+o;dy=r*Math.sin(theta)+z;dx-=E;dy-=q;r=Math.sqrt(dx*
dx+dy*dy);theta=Math.atan2(dy,dx)-I;return{x:(r*Math.cos(theta)+E)/1,y:(r*Math.sin(theta)+q)/1}};svgedit.path.recalcRotatedPath=function(){var g=svgedit.path.path.elem,d=svgedit.utilities.getRotationAngle(g,true);if(d){var o=svgedit.utilities.getBBox(g),z=svgedit.path.path.oldbbox,E=z.x+z.width/2;z=z.y+z.height/2;var q=o.x+o.width/2;o=o.y+o.height/2;q=q-E;var I=o-z;o=Math.sqrt(q*q+I*I);I=Math.atan2(I,q)+d;q=o*Math.cos(I)+E;o=o*Math.sin(I)+z;I=g.pathSegList;for(var R=I.numberOfItems;R;){R-=1;var s=
I.getItem(R),v=s.pathSegType;if(v!=1){var M=c(s.x,s.y,E,z,q,o,d);M=[M.x,M.y];if(s.x1!=null&&s.x2!=null){c_vals1=c(s.x1,s.y1,E,z,q,o,d);c_vals2=c(s.x2,s.y2,E,z,q,o,d);M.splice(M.length,0,c_vals1.x,c_vals1.y,c_vals2.x,c_vals2.y)}svgedit.path.replacePathSeg(v,R,M)}}svgedit.utilities.getBBox(g);E=svgroot.createSVGTransform();g=svgedit.transformlist.getTransformList(g);E.setRotate(d*180/Math.PI,q,o);g.replaceItem(E,0)}};svgedit.path.clearData=function(){m={}}})();if(!window.console){window.console={};window.console.log=function(){};window.console.dir=function(){}}if(window.opera){window.console.log=function(a){opera.postError(a)};window.console.dir=function(){}}
(function(){var a=jQuery.fn.attr;jQuery.fn.attr=function(u,e){var b=this.length;if(!b)return a.apply(this,arguments);for(var m=0;m<b;m++){var A=this[m];if(A.namespaceURI==="http://www.w3.org/2000/svg")if(e!==undefined)A.setAttribute(u,e);else if($.isArray(u)){b=u.length;for(m={};b--;){var c=u[b],g=A.getAttribute(c);if(g||g==="0")g=isNaN(g)?g:g-0;m[c]=g}return m}else if(typeof u==="object")for(c in u)A.setAttribute(c,u[c]);else{if((g=A.getAttribute(u))||g==="0")g=isNaN(g)?g:g-0;return g}else return a.apply(this,
arguments)}return this}})();
$.SvgCanvas=function(a,u){function e(f,k){for(var l=svgedit.utilities.getBBox(f),D=0;D<2;D++){var C=D===0?"fill":"stroke",J=f.getAttribute(C);if(J&&J.indexOf("url(")===0){J=T(J);if(J.tagName==="linearGradient"){var F=J.getAttribute("x1")||0,B=J.getAttribute("y1")||0,H=J.getAttribute("x2")||1,h=J.getAttribute("y2")||0;F=l.width*F+l.x;B=l.height*B+l.y;H=l.width*H+l.x;h=l.height*h+l.y;F=K(F,B,k);h=K(H,h,k);H={};H.x1=(F.x-l.x)/l.width;H.y1=(F.y-l.y)/l.height;H.x2=(h.x-l.x)/l.width;H.y2=(h.y-l.y)/l.height;
J=J.cloneNode(true);$(J).attr(H);J.id=oa();gb().appendChild(J);f.setAttribute(C,"url(#"+J.id+")")}}}}var b="http://www.w3.org/2000/svg",m={show_outside_canvas:true,selectNew:true,dimensions:[640,480]};u&&$.extend(m,u);var A=m.dimensions,c=this,g=a.ownerDocument,d=g.importNode(svgedit.utilities.text2xml('<svg id="svgroot" xmlns="'+b+'" xlinkns="http://www.w3.org/1999/xlink" width="'+A[0]+'" height="'+A[1]+'" x="'+A[0]+'" y="'+A[1]+'" overflow="visible"><defs><filter id="canvashadow" filterUnits="objectBoundingBox"><feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/><feOffset in="blur" dx="5" dy="5" result="offsetBlur"/><feMerge><feMergeNode in="offsetBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs></svg>').documentElement,
true);a.appendChild(d);var o=g.createElementNS(b,"svg");(c.clearSvgContentElement=function(){for(;o.firstChild;)o.removeChild(o.firstChild);$(o).attr({id:"svgcontent",width:A[0],height:A[1],x:A[0],y:A[1],overflow:m.show_outside_canvas?"visible":"hidden",xmlns:b,"xmlns:se":"http://svg-edit.googlecode.com","xmlns:xlink":"http://www.w3.org/1999/xlink"}).appendTo(d);var f=g.createComment(" Created with Method Draw - http://github.com/duopixel/Method-Draw/ ");o.appendChild(f)})();var z="svg_";c.setIdPrefix=
function(f){z=f};c.current_drawing_=new svgedit.draw.Drawing(o,z);var E=c.getCurrentDrawing=function(){return c.current_drawing_},q=1,I=null,R={shape:{fill:(m.initFill.color=="none"?"":"#")+m.initFill.color,fill_paint:null,fill_opacity:m.initFill.opacity,stroke:"#"+m.initStroke.color,stroke_paint:null,stroke_opacity:m.initStroke.opacity,stroke_width:m.initStroke.width,stroke_dasharray:"none",opacity:m.initOpacity}};R.text=$.extend(true,{},R.shape);$.extend(R.text,{fill:"#000000",stroke_width:0,font_size:24,
font_family:"Helvetica, Arial, sans-serif"});var s=R.shape,v=Array(1),M=this.addSvgElementFromJson=function(f){var k=svgedit.utilities.getElem(f.attr.id),l=E().getCurrentLayer();if(k&&f.element!=k.tagName){l.removeChild(k);k=null}if(!k){k=g.createElementNS(b,f.element);if(l)(I||l).appendChild(k)}f.curStyles&&svgedit.utilities.assignAttributes(k,{fill:s.fill,stroke:s.stroke,"stroke-width":s.stroke_width,"stroke-dasharray":s.stroke_dasharray,"stroke-opacity":s.stroke_opacity,"fill-opacity":s.fill_opacity,
opacity:s.opacity/2,style:"pointer-events:inherit"},100);svgedit.utilities.assignAttributes(k,f.attr,100);svgedit.utilities.cleanupElement(k);return k},N=c.getTransformList=svgedit.transformlist.getTransformList,K=svgedit.math.transformPoint,Z=c.matrixMultiply=svgedit.math.matrixMultiply,U=c.hasMatrixTransform=svgedit.math.hasMatrixTransform,S=c.transformListToTransform=svgedit.math.transformListToTransform,V=svgedit.math.snapToAngle,ca=svgedit.math.getMatrix;svgedit.units.init({getBaseUnit:function(){return m.baseUnit},
getElement:svgedit.utilities.getElem,getHeight:function(){return o.getAttribute("height")/q},getWidth:function(){return o.getAttribute("width")/q},getRoundDigits:function(){return $a.round_digits}});var ta=c.convertToNum=svgedit.units.convertToNum;svgedit.utilities.init({getDOMDocument:function(){return g},getDOMContainer:function(){return a},getSVGRoot:function(){return d},getSelectedElements:function(){return v},getSVGContent:function(){return o}});var na=c.getUrlFromAttr=svgedit.utilities.getUrlFromAttr,
ga=c.getHref=svgedit.utilities.getHref,W=c.setHref=svgedit.utilities.setHref,ba=svgedit.utilities.getPathBBox;c.getBBox=svgedit.utilities.getBBox;var ja=c.getRotationAngle=svgedit.utilities.getRotationAngle,pa=c.getElem=svgedit.utilities.getElem,ka=c.assignAttributes=svgedit.utilities.assignAttributes,la=this.cleanupElement=svgedit.utilities.cleanupElement,za=svgedit.sanitize.getNSMap(),Aa=c.sanitizeSvg=svgedit.sanitize.sanitizeSvg,Ja=svgedit.history.MoveElementCommand,Ia=svgedit.history.InsertElementCommand,
Fa=svgedit.history.RemoveElementCommand,Ma=svgedit.history.ChangeElementCommand,Da=svgedit.history.BatchCommand;c.undoMgr=new svgedit.history.UndoManager({handleHistoryEvent:function(f,k){var l=svgedit.history.HistoryEventTypes;if(f==l.BEFORE_UNAPPLY||f==l.BEFORE_APPLY)c.clearSelection();else if(f==l.AFTER_APPLY||f==l.AFTER_UNAPPLY){var D=k.elements();c.pathActions.clear();P("changed",D);D=k.type();l=f==l.AFTER_APPLY;if(D==Ja.type())(l?k.newParent:k.oldParent)==o&&c.identifyLayers();else if(D==Ia.type()||
D==Fa.type()){k.parent==o&&c.identifyLayers();if(D==Ia.type())l&&Ta(k.elem);else l||Ta(k.elem);k.elem.tagName==="use"&&Gb(k.elem)}else if(D==Ma.type()){k.elem.tagName=="title"&&k.elem.parentNode.parentNode==o&&c.identifyLayers();l=l?k.newValues:k.oldValues;l.stdDeviation&&c.setBlurOffsets(k.elem.parentNode,l.stdDeviation)}}}});var xa=function(f){c.undoMgr.addCommandToHistory(f)};svgedit.select.init(m,{createSVGElement:function(f){return c.addSvgElementFromJson(f)},svgRoot:function(){return d},svgContent:function(){return o},
currentZoom:function(){return q},getStrokedBBox:function(f){return c.getStrokedBBox([f])}});var ra=this.selectorManager=svgedit.select.getSelectorManager();svgedit.path.init({getCurrentZoom:function(){return q},getSVGRoot:function(){return d}});svgedit.utilities.snapToGrid=function(f){var k=m.snappingStep,l=m.baseUnit;if(l!=="px")k*=svgedit.units.getTypeMap()[l];return f=Math.round(f/k)*k};var wa=svgedit.utilities.snapToGrid,kb={exportNoBlur:"Blurred elements will appear as un-blurred",exportNoforeignObject:"foreignObject elements will not appear",
exportNoDashArray:"Strokes will appear filled",exportNoText:"Text may not appear as expected"},vb=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],cb=$.data,Ta=function(f){var k=$(f).attr(vb),l;for(l in k){var D=k[l];if(D&&D.indexOf("url(")===0){D=na(D).substr(1);if(!pa(D)){gb().appendChild(sb[D]);delete sb[D]}}}f=f.getElementsByTagName("*");if(f.length){k=0;for(l=f.length;k<l;k++)Ta(f[k])}},Va={},Ga=m.imgPath+"logo.png",ua=[],$a={round_digits:5},Ka=false,Sa=
null,Ha="select",db="none",lb={},Ua=R.text,Xa=s,wb=null,sa=null,hb=[],eb={},sb={};c.clipBoard=[];var ib=this.runExtensions=function(f,k,l){var D=false;if(l)D=[];$.each(eb,function(C,J){if(f in J)if(l)D.push(J[f](k));else D=J[f](k)});return D};this.addExtension=function(f,k){if(f in eb)console.log('Cannot add extension "'+f+'", an extension by that name already exists"');else{var l=$.isFunction(k)?k($.extend(c.getPrivateMethods(),{svgroot:d,svgcontent:o,nonce:E().getNonce(),selectorManager:ra})):k;
eb[f]=l;P("extension_added",l)}};var ab=this.round=function(f){return parseInt(f*q)/q},ob=this.getIntersectionList=function(f){if(sa==null)return null;var k=I||E().getCurrentLayer();hb.length||(hb=fb(k));var l=null;try{l=k.getIntersectionList(f,null)}catch(D){}if(l==null||typeof l.item!="function"){l=[];if(f)f=f;else{f=sa.getBBox();k={};for(var C in f)k[C]=f[C]/q;f=k}for(C=hb.length;C--;)f.width&&f.width&&svgedit.math.rectsIntersect(f,hb[C].bbox)&&l.push(hb[C].elem)}return l};getStrokedBBox=this.getStrokedBBox=
function(f){f||(f=pb());if(!f.length)return false;var k=function(h){try{var n=svgedit.utilities.getBBox(h),p=svgedit.utilities.getRotationAngle(h);if(p&&p%90||svgedit.math.hasMatrixTransform(svgedit.transformlist.getTransformList(h))){p=false;if(["ellipse","path","line","polyline","polygon"].indexOf(h.tagName)>=0)n=p=c.convertToPath(h,true);else if(h.tagName=="rect"){var w=h.getAttribute("rx"),G=h.getAttribute("ry");if(w||G)n=p=c.convertToPath(h,true)}if(!p){var L=h.cloneNode(true),O=document.createElementNS(b,
"g"),Q=h.parentNode;Q.appendChild(O);O.appendChild(L);n=svgedit.utilities.bboxToObj(O.getBBox());Q.removeChild(O)}}return n}catch(aa){console.log(h,aa)}},l;$.each(f,function(){if(!l)if(this.parentNode)l=k(this)});if(l==null)return null;var D=l.x+l.width,C=l.y+l.height,J=l.x,F=l.y,B=function(h){var n=h.getAttribute("stroke-width"),p=0;if(h.getAttribute("stroke")!="none"&&!isNaN(n))p+=n/2;return p},H=[];$.each(f,function(h,n){var p=k(n);if(p){var w=B(n);J=Math.min(J,p.x-w);F=Math.min(F,p.y-w);H.push(p)}});
l.x=J;l.y=F;$.each(f,function(h,n){var p=H[h];if(p&&n.nodeType==1){var w=B(n);D=Math.max(D,p.x+p.width+w);C=Math.max(C,p.y+p.height+w)}});l.width=D-J;l.height=C-F;return l};var pb=this.getVisibleElements=function(f){f||(f=$(o).children());f.find("#canvas_background").length&&f.splice(0,1);var k=[];$(f).children().each(function(l,D){try{D.getBBox()&&k.push(D)}catch(C){}});return k.reverse()},fb=this.getVisibleElementsAndBBoxes=function(f){f||(f=$(o).children());var k=[];$(f).children().each(function(l,
D){try{D.getBBox()&&k.push({elem:D,bbox:getStrokedBBox([D])})}catch(C){}});return k.reverse()},tb=this.groupSvgElem=function(f){var k=document.createElementNS(b,"g");f.parentNode.replaceChild(k,f);$(k).append(f).data("gsvg",f)[0].id=oa()},ma=function(f){var k=document.createElementNS(f.namespaceURI,f.nodeName);k.removeAttribute("id");$.each(f.attributes,function(D,C){C.localName!="-moz-math-font-style"&&k.setAttributeNS(C.namespaceURI,C.nodeName,C.nodeValue)});if(svgedit.browser.isWebkit()&&f.nodeName==
"path"){var l=La.convertPath(f);k.setAttribute("d",l)}$.each(f.childNodes,function(D,C){switch(C.nodeType){case 1:k.appendChild(ma(C));break;case 3:k.textContent=C.nodeValue}});if($(f).data("gsvg"))$(k).data("gsvg",k.firstChild);else if($(f).data("symbol")){f=$(f).data("symbol");$(k).data("ref",f).data("symbol",f)}else k.tagName=="image"&&Fb(k);k.id=oa();return k},da,oa,P;(function(f){var k={};da=f.getId=function(){return E().getId()};oa=f.getNextId=function(){return E().getNextId()};P=f.call=function(l,
D){if(k[l])return k[l](this,D)};f.bind=function(l,D){var C=k[l];k[l]=D;return C}})(c);this.prepareSvg=function(f){this.sanitizeSvg(f.documentElement);f=f.getElementsByTagNameNS(b,"path");for(var k=0,l=f.length;k<l;++k){var D=f[k];D.setAttribute("d",La.convertPath(D));La.fixEnd(D)}};var T=this.getRefElem=function(f){return pa(na(f).substr(1))},fa=function(f){if(!svgedit.browser.isGecko())return f;var k=f.cloneNode(true);f.parentNode.insertBefore(k,f);f.parentNode.removeChild(f);ra.releaseSelector(f);
v[0]=k;ra.requestSelector(k).showGrips(true);return k};this.setRotationAngle=function(f,k){f=parseFloat(f);var l=v[0];if(l){var D=l.getAttribute("transform"),C=svgedit.utilities.getBBox(l),J=C.x+C.width/2,F=C.y+C.height/2;C=N(l);C.numberOfItems>0&&C.getItem(0).type==4&&C.removeItem(0);if(f!=0){J=K(J,F,S(C).matrix);F=d.createSVGTransform();F.setRotate(f,J.x,J.y);C.numberOfItems?C.insertItemBefore(F,0):C.appendItem(F)}else C.numberOfItems==0&&l.removeAttribute("transform");if(!k){C=l.getAttribute("transform");
l.setAttribute("transform",D);Ya("transform",C,v);P("changed",v)}pa("pathpointgrip_container");l=ra.requestSelector(v[0]);l.resize();l.updateGripCursors(f)}};var Ea=this.recalculateAllSelectedDimensions=function(){for(var f=new Da(db=="none"?"position":"size"),k=v.length;k--;){var l=Ra(v[k]);l&&f.addSubCommand(l)}if(!f.isEmpty()){xa(f);P("changed",v)}},Oa=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],Wa=function(f){console.log([f.a,f.b,f.c,f.d,f.e,f.f])},Za=this.remapElement=
function(f,k,l){var D=m.gridSnapping&&f.parentNode.parentNode.localName==="svg",C=function(){if(D)for(var p in k)k[p]=wa(k[p]);ka(f,k,1E3,true)};box=svgedit.utilities.getBBox(f);for(var J=0;J<2;J++){var F=J===0?"fill":"stroke",B=f.getAttribute(F);if(B&&B.indexOf("url(")===0)if(l.a<0||l.d<0){B=T(B).cloneNode(true);if(l.a<0){var H=B.getAttribute("x1"),h=B.getAttribute("x2");B.setAttribute("x1",-(H-1));B.setAttribute("x2",-(h-1))}if(l.d<0){H=B.getAttribute("y1");h=B.getAttribute("y2");B.setAttribute("y1",
-(H-1));B.setAttribute("y2",-(h-1))}B.id=oa();gb().appendChild(B);f.setAttribute(F,"url(#"+B.id+")")}}J=f.tagName;if(J==="g"||J==="text"||J==="use")if(l.a==1&&l.b==0&&l.c==0&&l.d==1&&(l.e!=0||l.f!=0)){F=S(f).matrix;F=Z(F.inverse(),l,F);k.x=parseFloat(k.x)+F.e;k.y=parseFloat(k.y)+F.f}else{F=N(f);B=d.createSVGTransform();B.setMatrix(Z(S(F).matrix,l));F.clear();F.appendItem(B)}switch(J){case "foreignObject":case "rect":case "image":if(J==="image"&&(l.a<0||l.d<0)){F=N(f);B=d.createSVGTransform();B.setMatrix(Z(S(F).matrix,
l));F.clear();F.appendItem(B)}else{F=K(k.x,k.y,l);k.width=l.a*k.width;k.height=l.d*k.height;k.x=F.x+Math.min(0,k.width);k.y=F.y+Math.min(0,k.height);k.width=Math.abs(k.width);k.height=Math.abs(k.height)}C();break;case "ellipse":J=K(k.cx,k.cy,l);k.cx=J.x;k.cy=J.y;k.rx=l.a*k.rx;k.ry=l.d*k.ry;k.rx=Math.abs(k.rx);k.ry=Math.abs(k.ry);C();break;case "circle":J=K(k.cx,k.cy,l);k.cx=J.x;k.cy=J.y;J=svgedit.math.transformBox(box.x,box.y,box.width,box.height,l);k.r=Math.min((J.tr.x-J.tl.x)/2,(J.bl.y-J.tl.y)/
2);if(k.r)k.r=Math.abs(k.r);C();break;case "line":F=K(k.x1,k.y1,l);H=K(k.x2,k.y2,l);k.x1=F.x;k.y1=F.y;k.x2=H.x;k.y2=H.y;case "text":l=f.querySelectorAll("tspan");for(J=l.length;J--;){F=ta("x",f.getAttribute("x"));B=ta("x",l[J].getAttribute("x"));H=ta("y",f.getAttribute("y"));h=ta("y",l[J].getAttribute("y"));var n={};if(!isNaN(F)&&!isNaN(B)&&F!=0&&B!=0&&k.x)n.x=k.x-(F-B);if(!isNaN(H)&&!isNaN(h)&&H!=0&&h!=0&&k.y)n.y=k.y-(H-h);if(n.x||n.y)ka(l[J],n,1E3,true)}C();break;case "use":C();break;case "g":(C=
$(f).data("gsvg"))&&ka(C,k,1E3,true);break;case "polyline":case "polygon":C=k.points.length;for(J=0;J<C;++J){h=k.points[J];h=K(h.x,h.y,l);k.points[J].x=h.x;k.points[J].y=h.y}C=k.points.length;l="";for(J=0;J<C;++J){h=k.points[J];l+=h.x+","+h.y+" "}f.setAttribute("points",l);break;case "path":F=f.pathSegList;C=F.numberOfItems;k.d=Array(C);for(J=0;J<C;++J){B=F.getItem(J);k.d[J]={type:B.pathSegType,x:B.x,y:B.y,x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,r1:B.r1,r2:B.r2,angle:B.angle,largeArcFlag:B.largeArcFlag,sweepFlag:B.sweepFlag}}C=
k.d.length;J=k.d[0];n=K(J.x,J.y,l);k.d[0].x=n.x;k.d[0].y=n.y;for(J=1;J<C;++J){B=k.d[J];F=B.type;if(F%2==0){h=K(B.x!=undefined?B.x:n.x,B.y!=undefined?B.y:n.y,l);F=K(B.x1,B.y1,l);H=K(B.x2,B.y2,l);B.x=h.x;B.y=h.y;B.x1=F.x;B.y1=F.y;B.x2=H.x;B.y2=H.y}else{B.x=l.a*B.x;B.y=l.d*B.y;B.x1=l.a*B.x1;B.y1=l.d*B.y1;B.x2=l.a*B.x2;B.y2=l.d*B.y2}B.r1=l.a*B.r1;B.r2=l.d*B.r2}l="";C=k.d.length;for(J=0;J<C;++J){B=k.d[J];F=B.type;l+=Oa[F];switch(F){case 13:case 12:l+=B.x+" ";break;case 15:case 14:l+=B.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:l+=
B.x+","+B.y+" ";break;case 7:case 6:l+=B.x1+","+B.y1+" "+B.x2+","+B.y2+" "+B.x+","+B.y+" ";break;case 9:case 8:l+=B.x1+","+B.y1+" "+B.x+","+B.y+" ";break;case 11:case 10:l+=B.r1+","+B.r2+" "+B.angle+" "+ +B.largeArcFlag+" "+ +B.sweepFlag+" "+B.x+","+B.y+" ";break;case 17:case 16:l+=B.x2+","+B.y2+" "+B.x+","+B.y+" "}}f.setAttribute("d",l)}},nb=function(f,k,l){f=T(f).firstChild;var D=N(f),C=d.createSVGTransform();C.setTranslate(k,l);D.appendItem(C);Ra(f)},Ra=this.recalculateDimensions=function(f){if(f==
null)return null;var k=N(f);if(k&&k.numberOfItems>0){for(var l=k.numberOfItems;l--;){var D=k.getItem(l);if(D.type===0)k.removeItem(l);else if(D.type===1)svgedit.math.isIdentity(D.matrix)&&k.removeItem(l);else D.type===4&&D.angle===0&&k.removeItem(l)}if(k.numberOfItems===1&&ja(f))return null}if(!k||k.numberOfItems==0){f.removeAttribute("transform");return null}if(k){l=k.numberOfItems;for(var C=[];l--;){D=k.getItem(l);if(D.type===1)C.push([D.matrix,l]);else if(C.length)C=[]}if(C.length===2){l=d.createSVGTransformFromMatrix(Z(C[1][0],
C[0][0]));k.removeItem(C[0][1]);k.removeItem(C[1][1]);k.insertItemBefore(l,C[1][1])}l=k.numberOfItems;if(l>=2&&k.getItem(l-2).type===1&&k.getItem(l-1).type===2){C=d.createSVGTransform();D=Z(k.getItem(l-2).matrix,k.getItem(l-1).matrix);C.setMatrix(D);k.removeItem(l-2);k.removeItem(l-2);k.appendItem(C)}}switch(f.tagName){case "line":case "polyline":case "polygon":case "path":break;default:if(k.numberOfItems===1&&k.getItem(0).type===1||k.numberOfItems===2&&k.getItem(0).type===1&&k.getItem(0).type===
4)return null}var J=$(f).data("gsvg");l=new Da("Transform");var F={},B=null;D=[];switch(f.tagName){case "line":D=["x1","y1","x2","y2"];break;case "circle":D=["cx","cy","r"];break;case "ellipse":D=["cx","cy","rx","ry"];break;case "foreignObject":case "rect":case "image":D=["width","height","x","y"];break;case "use":case "text":case "tspan":D=["x","y"];break;case "polygon":case "polyline":B={};B.points=f.getAttribute("points");C=f.points;var H=C.numberOfItems;F.points=Array(H);for(var h=0;h<H;++h){var n=
C.getItem(h);F.points[h]={x:n.x,y:n.y}}break;case "path":B={};B.d=f.getAttribute("d");F.d=f.getAttribute("d")}if(D.length){F=$(f).attr(D);$.each(F,function(Ca,Pa){F[Ca]=ta(Ca,Pa)})}else if(J)F={x:$(J).attr("x")||0,y:$(J).attr("y")||0};if(B==null){B=$.extend(true,{},F);$.each(B,function(Ca,Pa){B[Ca]=ta(Ca,Pa)})}B.transform=Sa?Sa:"";if(f.tagName=="g"&&!J||f.tagName=="a"){C=svgedit.utilities.getBBox(f);var p={x:C.x+C.width/2,y:C.y+C.height/2},w=K(C.x+C.width/2,C.y+C.height/2,S(k).matrix);D=d.createSVGMatrix();
if(C=ja(f)){h=C*Math.PI/180;H=Math.abs(h)>1.0E-10?Math.sin(h)/(1-Math.cos(h)):2/h;for(h=0;h<k.numberOfItems;++h){D=k.getItem(h);if(D.type==4){D=D.matrix;p.y=(H*D.e+D.f)/2;p.x=(D.e-H*D.f)/2;k.removeItem(h);break}}}h=D=J=0;var G=k.numberOfItems;if(G)var L=k.getItem(0).matrix;if(G>=3&&k.getItem(G-2).type==3&&k.getItem(G-3).type==2&&k.getItem(G-1).type==2){h=3;var O=k.getItem(G-3).matrix,Q=k.getItem(G-2).matrix,aa=k.getItem(G-1).matrix;H=f.childNodes;for(n=H.length;n--;){var ea=H.item(n);D=J=0;if(ea.nodeType==
1){var X=N(ea);if(X){D=S(X).matrix;J=ja(ea);var ha=Sa,ia=[];Sa=ea.getAttribute("transform");if(J||U(X)){var Y=d.createSVGTransform();Y.setMatrix(Z(O,Q,aa,D));X.clear();X.appendItem(Y);ia.push(Y)}else{J=Z(D.inverse(),aa,D);Y=d.createSVGMatrix();Y.e=-J.e;Y.f=-J.f;D=Z(Y.inverse(),D.inverse(),O,Q,aa,D,J.inverse());var qa=d.createSVGTransform(),va=d.createSVGTransform(),Ba=d.createSVGTransform();qa.setTranslate(J.e,J.f);va.setScale(D.a,D.d);Ba.setTranslate(Y.e,Y.f);X.appendItem(Ba);X.appendItem(va);X.appendItem(qa);
ia.push(Ba);ia.push(va);ia.push(qa)}l.addSubCommand(Ra(ea));Sa=ha}}}k.removeItem(G-1);k.removeItem(G-2);k.removeItem(G-3)}else if(G>=3&&k.getItem(G-1).type==1){h=3;D=S(k).matrix;Y=d.createSVGTransform();Y.setMatrix(D);k.clear();k.appendItem(Y)}else if((G==1||G>1&&k.getItem(1).type!=3)&&k.getItem(0).type==2){h=2;J=S(k).matrix;k.removeItem(0);D=S(k).matrix.inverse();D=Z(D,J);J=D.e;D=D.f;if(J!=0||D!=0){H=f.childNodes;n=H.length;for(G=[];n--;){ea=H.item(n);if(ea.nodeType==1){if(ea.getAttribute("clip-path")){ha=
ea.getAttribute("clip-path");if(G.indexOf(ha)===-1){nb(ha,J,D);G.push(ha)}}ha=Sa;Sa=ea.getAttribute("transform");if(X=N(ea)){O=d.createSVGTransform();O.setTranslate(J,D);X.numberOfItems?X.insertItemBefore(O,0):X.appendItem(O);l.addSubCommand(Ra(ea));X=f.getElementsByTagNameNS(b,"use");ea="#"+ea.id;for(O=X.length;O--;){Q=X.item(O);if(ea==ga(Q)){aa=d.createSVGTransform();aa.setTranslate(-J,-D);N(Q).insertItemBefore(aa,0);l.addSubCommand(Ra(Q))}}Sa=ha}}}G=[];Sa=ha}}else if(G==1&&k.getItem(0).type==1&&
!C){h=1;D=k.getItem(0).matrix;H=f.childNodes;for(n=H.length;n--;){ea=H.item(n);if(ea.nodeType==1){ha=Sa;Sa=ea.getAttribute("transform");if(X=N(ea)){J=Z(D,S(X).matrix);G=d.createSVGTransform();G.setMatrix(J);X.clear();X.appendItem(G,0);l.addSubCommand(Ra(ea));Sa=ha;ha=ea.getAttribute("stroke-width");ea.getAttribute("stroke")!=="none"&&!isNaN(ha)&&ea.setAttribute("stroke-width",ha*((Math.abs(J.a)+Math.abs(J.d))/2))}}}k.clear()}else{if(C){p=d.createSVGTransform();p.setRotate(C,w.x,w.y);k.numberOfItems?
k.insertItemBefore(p,0):k.appendItem(p)}k.numberOfItems==0&&f.removeAttribute("transform");return null}if(h==2){if(C){w={x:p.x+L.e,y:p.y+L.f};p=d.createSVGTransform();p.setRotate(C,w.x,w.y);k.numberOfItems?k.insertItemBefore(p,0):k.appendItem(p)}}else if(h==3){D=S(k).matrix;L=d.createSVGTransform();L.setRotate(C,p.x,p.y);L=L.matrix;p=d.createSVGTransform();p.setRotate(C,w.x,w.y);w=p.matrix.inverse();ha=D.inverse();w=Z(ha,w,L,D);J=w.e;D=w.f;if(J!=0||D!=0){H=f.childNodes;for(n=H.length;n--;){ea=H.item(n);
if(ea.nodeType==1){ha=Sa;Sa=ea.getAttribute("transform");X=N(ea);O=d.createSVGTransform();O.setTranslate(J,D);X.numberOfItems?X.insertItemBefore(O,0):X.appendItem(O);l.addSubCommand(Ra(ea));Sa=ha}}}if(C)k.numberOfItems?k.insertItemBefore(p,0):k.appendItem(p)}}else{C=svgedit.utilities.getBBox(f);if(!C&&f.tagName!="path")return null;D=d.createSVGMatrix();if(J=ja(f)){p={x:C.x+C.width/2,y:C.y+C.height/2};w=K(C.x+C.width/2,C.y+C.height/2,S(k).matrix);h=J*Math.PI/180;H=Math.abs(h)>1.0E-10?Math.sin(h)/(1-
Math.cos(h)):2/h;for(h=0;h<k.numberOfItems;++h){D=k.getItem(h);if(D.type==4){D=D.matrix;p.y=(H*D.e+D.f)/2;p.x=(D.e-H*D.f)/2;k.removeItem(h);break}}}h=0;G=k.numberOfItems;if(!svgedit.browser.isWebkit())if((L=f.getAttribute("fill"))&&L.indexOf("url(")===0){L=T(L);ha="pattern";if(L.tagName!==ha)ha="gradient";if(L.getAttribute(ha+"Units")==="userSpaceOnUse"){D=S(k).matrix;C=N(L);C=S(C).matrix;D=Z(D,C);C="matrix("+[D.a,D.b,D.c,D.d,D.e,D.f].join(",")+")";L.setAttribute(ha+"Transform",C)}}if(G>=3&&k.getItem(G-
2).type==3&&k.getItem(G-3).type==2&&k.getItem(G-1).type==2){h=3;D=S(k,G-3,G-1).matrix;k.removeItem(G-1);k.removeItem(G-2);k.removeItem(G-3)}else if(G==4&&k.getItem(G-1).type==1){h=3;D=S(k).matrix;Y=d.createSVGTransform();Y.setMatrix(D);k.clear();k.appendItem(Y);D=d.createSVGMatrix()}else if((G==1||G>1&&k.getItem(1).type!=3)&&k.getItem(0).type==2){h=2;L=k.getItem(0).matrix;ha=S(k,1).matrix;C=ha.inverse();D=Z(C,L,ha);k.removeItem(0)}else if(G==1&&k.getItem(0).type==1&&!J){D=S(k).matrix;switch(f.tagName){case "line":F=
$(f).attr(["x1","y1","x2","y2"]);case "polyline":case "polygon":F.points=f.getAttribute("points");if(F.points){C=f.points;H=C.numberOfItems;F.points=Array(H);for(h=0;h<H;++h){n=C.getItem(h);F.points[h]={x:n.x,y:n.y}}}case "path":F.d=f.getAttribute("d");h=1;k.clear()}}else{h=4;if(J){p=d.createSVGTransform();p.setRotate(J,w.x,w.y);k.numberOfItems?k.insertItemBefore(p,0):k.appendItem(p)}k.numberOfItems==0&&f.removeAttribute("transform");return null}if(h==1||h==2||h==3)Za(f,F,D);if(h==2){if(J){U(k)||
(w={x:p.x+D.e,y:p.y+D.f});p=d.createSVGTransform();p.setRotate(J,w.x,w.y);k.numberOfItems?k.insertItemBefore(p,0):k.appendItem(p)}}else if(h==3&&J){D=S(k).matrix;L=d.createSVGTransform();L.setRotate(J,p.x,p.y);L=L.matrix;p=d.createSVGTransform();p.setRotate(J,w.x,w.y);w=p.matrix.inverse();ha=D.inverse();w=Z(ha,w,L,D);Za(f,F,w);if(J)k.numberOfItems?k.insertItemBefore(p,0):k.appendItem(p)}}k.numberOfItems==0&&f.removeAttribute("transform");l.addSubCommand(new Ma(f,B));return l},mb=null,ya=this.clearSelection=
function(f){if(v[0]!=null)for(var k=v.length,l=0;l<k;++l){var D=v[l];if(D==null)break;ra.releaseSelector(D);v[l]=null}f||P("selected",v)},qb=this.addToSelection=function(f,k){if(f.length!=0){for(var l=0;l<v.length;){if(v[l]==null)break;++l}for(var D=f.length;D--;){var C=f[D];if(C&&svgedit.utilities.getBBox(C)){if(C.tagName==="a"&&C.childNodes.length===1)C=C.firstChild;if(v.indexOf(C)==-1){v[l]=C;l++;C=ra.requestSelector(C);v.length>1&&C.showGrips(false)}}}P("selected",v);k||v.length==1?ra.requestSelector(v[0]).showGrips(true):
ra.requestSelector(v[0]).showGrips(false);for(v.sort(function(J,F){if(J&&F&&J.compareDocumentPosition)return 3-(F.compareDocumentPosition(J)&6);else if(J==null)return 1});v[0]==null;)v.shift(0)}},rb=this.selectOnly=function(f,k){ya(true);qb(f,k)};this.removeFromSelection=function(f){if(v[0]!=null)if(f.length!=0){var k=Array(v.length);j=0;len=v.length;for(var l=0;l<len;++l){var D=v[l];if(D)if(f.indexOf(D)==-1){k[j]=D;j++}else ra.releaseSelector(D)}v=k}};this.selectAllInCurrentLayer=function(){var f=
E().getCurrentLayer();if(f){Ha="select";rb($(I||f).children())}};var Bb=this.getMouseTarget=function(f){if(f==null||f.target==null)return null;f=f.target;if(f.correspondingUseElement)f=f.correspondingUseElement;if(["http://www.w3.org/1998/Math/MathML","http://www.w3.org/1999/xhtml"].indexOf(f.namespaceURI)>=0&&f.id!="svgcanvas")for(;f.nodeName!="foreignObject";){f=f.parentNode;if(!f)return d}var k=E().getCurrentLayer();if([d,a,o,k].indexOf(f)>=0)return d;if($(f).closest("#selectorParentGroup").length)return ra.selectorParentGroup;
for(;f.parentNode&&f.parentNode!==(I||k);)f=f.parentNode;return f};(function(){var f=null,k=null,l=null,D=null,C=null,J={},F={minx:null,miny:null,maxx:null,maxy:null};$(a).mousedown(function(B){if(!c.spaceKey){var H=B.button===2;mb=o.getScreenCTM().inverse();isBotchedZoom=svgedit.browser.isGecko();var h=K(B.pageX,B.pageY,mb),n=h.x*(isBotchedZoom?1:q);h=h.y*(isBotchedZoom?1:q);B.preventDefault();if(H)Ha="select";n=n/q;h=h/q;var p=Bb(B);if(p.tagName==="a"&&p.childNodes.length===1)p=p.firstChild;var w=
D=k=n,G=C=l=h;if(m.gridSnapping){n=wa(n);h=wa(h);k=wa(k);l=wa(l)}if(p==ra.selectorParentGroup&&v[0]!=null){p=B.target;var L=cb(p,"type");if(L=="rotate"){Ha="rotate";current_rotate_mode=cb(p,"dir")}else if(L=="resize"){Ha="resize";db=cb(p,"dir")}p=v[0]}Sa=p.getAttribute("transform");L=N(p);switch(Ha){case "select":Ka=true;db="none";if(H)Ka=false;if(p!=d){if(v.indexOf(p)==-1){B.shiftKey||ya(true);qb([p]);wb=p;La.clear()}if(!H)for(H=0;H<v.length;++H)if(v[H]!=null){var O=N(v[H]);O.numberOfItems?O.insertItemBefore(d.createSVGTransform(),
0):O.appendItem(d.createSVGTransform())}}else if(!H){ya();Ha="multiselect";if(sa==null)sa=ra.getRubberBandBox();D*=q;C*=q;ka(sa,{x:D,y:C,width:0,height:0,display:"inline"},100)}break;case "zoom":Ka=true;if(sa==null)sa=ra.getRubberBandBox();ka(sa,{x:w*q,y:w*q,width:0,height:0,display:"inline"},100);break;case "resize":Ka=true;k=n;l=h;J=svgedit.utilities.getBBox($("#selectedBox0")[0]);var Q={};$.each(J,function(aa,ea){Q[aa]=ea/q});J=Q;H=ja(p)?1:0;if(U(L)){L.insertItemBefore(d.createSVGTransform(),H);
L.insertItemBefore(d.createSVGTransform(),H);L.insertItemBefore(d.createSVGTransform(),H)}else{L.appendItem(d.createSVGTransform());L.appendItem(d.createSVGTransform());L.appendItem(d.createSVGTransform());if(svgedit.browser.supportsNonScalingStroke()){if(n=svgedit.browser.isWebkit())O=function(aa){var ea=aa.getAttributeNS(null,"stroke");aa.removeAttributeNS(null,"stroke");setTimeout(function(){aa.setAttributeNS(null,"stroke",ea)},0)};p.style.vectorEffect="non-scaling-stroke";n&&O(p);h=p.getElementsByTagName("*");
w=h.length;for(H=0;H<w;H++){h[H].style.vectorEffect="non-scaling-stroke";n&&O(h[H])}}}break;case "fhellipse":case "fhrect":case "fhpath":Ka=true;f=w+","+G+" ";O=s.stroke_width==0?1:s.stroke_width;M({element:"polyline",curStyles:true,attr:{points:f,id:oa(),fill:"none",opacity:s.opacity/2,"stroke-linecap":"round",style:"pointer-events:none"}});F.minx=w;F.maxx=w;F.miny=G;F.maxy=G;break;case "image":Ka=true;O=M({element:"image",attr:{x:n,y:h,width:0,height:0,id:oa(),opacity:s.opacity/2,style:"pointer-events:inherit"}});
W(O,Ga);Fb(O);break;case "square":case "rect":Ka=true;k=n;l=h;M({element:"rect",curStyles:true,attr:{x:n,y:h,width:0,height:0,id:oa(),opacity:s.opacity/2}});break;case "line":Ka=true;O=s.stroke_width==0?1:s.stroke_width;M({element:"line",curStyles:true,attr:{x1:n,y1:h,x2:n,y2:h,id:oa(),stroke:s.stroke,"stroke-width":O,"stroke-dasharray":s.stroke_dasharray,"stroke-linejoin":s.stroke_linejoin,"stroke-linecap":s.stroke_linecap,"stroke-opacity":s.stroke_opacity,fill:"none",opacity:s.opacity/2,style:"pointer-events:none"}});
break;case "circle":Ka=true;M({element:"circle",curStyles:true,attr:{cx:n,cy:h,r:0,id:oa(),opacity:s.opacity/2}});break;case "ellipse":Ka=true;M({element:"ellipse",curStyles:true,attr:{cx:n,cy:h,rx:0,ry:0,id:oa(),opacity:s.opacity/2}});break;case "text":Ka=true;M({element:"text",curStyles:true,attr:{x:n,y:h,id:oa(),fill:Ua.fill,"stroke-width":Ua.stroke_width,"font-size":Ua.font_size,"font-family":Ua.font_family,"text-anchor":"left","xml:space":"preserve",opacity:s.opacity}});break;case "path":case "pathedit":k*=
q;l*=q;La.mouseDown(B,p,k,l);Ka=true;break;case "textedit":k*=q;l*=q;bb.mouseDown(B,p,k,l);Ka=true;break;case "rotate":Ka=true;c.undoMgr.beginUndoableChange("transform",v);document.getElementById("workarea").className="rotate"}O=ib("mouseDown",{event:B,start_x:k,start_y:l,selectedElements:v},true);$.each(O,function(aa,ea){if(ea&&ea.started)Ka=true});if(Ha)document.getElementById("workarea").className=Ha=="resize"?B.target.style.cursor:Ha}}).mousemove(function(B){if(!(B.originalEvent.touches&&B.originalEvent.touches.length>
1))if(Ka)if(!(B.button===1||c.spaceKey)){var H=v[0],h=K(B.pageX,B.pageY,mb),n=h.x*(isBotchedZoom?1:q);h=h.y*(isBotchedZoom?1:q);var p=pa(da()),w=x=n/q,G=y=h/q;if(m.gridSnapping){x=wa(x);y=wa(y)}B.preventDefault();switch(Ha){case "select":if(v[0]!==null){w=x-k;var L=y-l;if(m.gridSnapping){w=wa(w);L=wa(L)}if(B.shiftKey){var O=V(k,l,x,y);x=O.x;y=O.y}if(w!=0||L!=0){G=v.length;for(var Q=0;Q<G;++Q){H=v[Q];if(H==null)break;var aa=d.createSVGTransform();p=N(H);if(O){w=O.x-k;L=O.y-l}aa.setTranslate(w,L);p.numberOfItems?
p.replaceItem(aa,0):p.appendItem(aa);ra.requestSelector(H).resize()}if(B.altKey)if(!c.addClones){c.addClones=c.cloneSelectedElements(0,0,aa);c.removeClones=function(){c.addClones&&c.addClones.forEach(function(va){va.parentNode&&va.parentNode.removeChild(va);c.addClones=false})};window.addEventListener("keyup",c.removeClones)}P("transition",v)}}break;case "multiselect":w*=q;G*=q;ka(sa,{x:Math.min(D,w),y:Math.min(C,G),width:Math.abs(w-D),height:Math.abs(G-C)},100);p=[];w=[];O=ob();G=v.length;for(Q=
0;Q<G;++Q){L=O.indexOf(v[Q]);if(L==-1)p.push(v[Q]);else O[L]=null}G=O.length;for(Q=0;Q<G;++Q)O[Q]&&w.push(O[Q]);p.length>0&&c.removeFromSelection(p);w.length>0&&qb(w);break;case "resize":p=N(H);w=(O=U(p))?J:svgedit.utilities.getBBox(H);G=w.x;Q=w.y;var ea=w.width,X=w.height;w=x-k;L=y-l;if(m.gridSnapping){w=wa(w);L=wa(L);X=wa(X);ea=wa(ea)}if(aa=ja(H)){var ha=Math.sqrt(w*w+L*L);L=Math.atan2(L,w)-aa*Math.PI/180;w=ha*Math.cos(L);L=ha*Math.sin(L)}if(db.indexOf("n")==-1&&db.indexOf("s")==-1)L=0;if(db.indexOf("e")==
-1&&db.indexOf("w")==-1)w=0;var ia=ha=0,Y=X?(X+L)/X:1,qa=ea?(ea+w)/ea:1;if(db.indexOf("n")>=0){Y=X?(X-L)/X:1;ia=X}if(db.indexOf("w")>=0){qa=ea?(ea-w)/ea:1;ha=ea}w=d.createSVGTransform();L=d.createSVGTransform();ea=d.createSVGTransform();if(m.gridSnapping){G=wa(G);ha=wa(ha);Q=wa(Q);ia=wa(ia)}w.setTranslate(-(G+ha),-(Q+ia));if(B.shiftKey)if(qa==1)qa=Y;else Y=qa;L.setScale(qa,Y);ea.setTranslate(G+ha,Q+ia);if(O){O=aa?1:0;p.replaceItem(w,2+O);p.replaceItem(L,1+O);p.replaceItem(ea,0+O)}else{O=p.numberOfItems;
p.replaceItem(ea,O-3);p.replaceItem(L,O-2);p.replaceItem(w,O-1)}ra.requestSelector(H).resize();P("transition",v);break;case "zoom":w*=q;G*=q;ka(sa,{x:Math.min(D*q,w),y:Math.min(C*q,G),width:Math.abs(w-D*q),height:Math.abs(G-C*q)},100);break;case "text":ka(p,{x:x,y:y},1E3);break;case "line":w=null;window.opera||d.suspendRedraw(1E3);if(m.gridSnapping){x=wa(x);y=wa(y)}G=x;O=y;if(B.shiftKey){O=V(k,l,G,O);G=O.x;O=O.y}p.setAttributeNS(null,"x2",G);p.setAttributeNS(null,"y2",O);window.opera||d.unsuspendRedraw(w);
break;case "foreignObject":case "square":case "rect":case "image":w=Math.abs(x-k);O=Math.abs(y-l);if(Ha=="square"||B.shiftKey){w=O=Math.max(w,O);G=k<x?k:k-w;Q=l<y?l:l-O}else{G=Math.min(k,x);Q=Math.min(l,y)}if(B.altKey){w*=2;O*=2;G=k-w/2;Q=l-O/2}if(m.gridSnapping){w=wa(w);O=wa(O);G=wa(G);Q=wa(Q)}ka(p,{width:w,height:O,x:G,y:Q},1E3);break;case "circle":w=$(p).attr(["cx","cy"]);O=w.cx;G=w.cy;w=Math.sqrt((x-O)*(x-O)+(y-G)*(y-G));if(m.gridSnapping)w=wa(w);p.setAttributeNS(null,"r",w);break;case "ellipse":w=
$(p).attr(["cx","cy"]);O=Math.abs(k+(x-k)/2);G=Math.abs(l+(y-l)/2);w=null;window.opera||d.suspendRedraw(1E3);if(m.gridSnapping){x=wa(x);O=wa(O);y=wa(y);G=wa(G)}Q=Math.abs(k-O);L=Math.abs(l-G);if(B.shiftKey){L=Q;G=y>l?l+Q:l-Q}if(B.altKey){O=k;G=l;Q=Math.abs(x-O);L=B.shiftKey?Q:Math.abs(y-G)}p.setAttributeNS(null,"rx",Q);p.setAttributeNS(null,"ry",L);p.setAttributeNS(null,"cx",O);p.setAttributeNS(null,"cy",G);window.opera||d.unsuspendRedraw(w);break;case "fhellipse":case "fhrect":F.minx=Math.min(w,
F.minx);F.maxx=Math.max(w,F.maxx);F.miny=Math.min(G,F.miny);F.maxy=Math.max(G,F.maxy);case "fhpath":f+=+w+","+G+" ";p.setAttributeNS(null,"points",f);break;case "path":case "pathedit":x*=q;y*=q;if(m.gridSnapping){x=wa(x);y=wa(y);k=wa(k);l=wa(l)}if(B.shiftKey){if(O=svgedit.path.path){p=O.dragging?O.dragging[0]:k;O=O.dragging?O.dragging[1]:l}else{p=k;O=l}O=V(p,O,x,y);x=O.x;y=O.y}if(sa&&sa.getAttribute("display")!=="none"){w*=q;G*=q;ka(sa,{x:Math.min(D*q,w),y:Math.min(C*q,G),width:Math.abs(w-D*q),height:Math.abs(G-
C*q)},100)}La.mouseMove(B,x,y);break;case "textedit":x*=q;y*=q;bb.mouseMove(n,h);break;case "rotate":w=svgedit.utilities.getBBox(H);O=w.x+w.width/2;G=w.y+w.height/2;p=ca(H);p=K(O,G,p);O=p.x;G=p.y;p=w.x;Q=w.y;if(current_rotate_mode=="nw")p=w.x+w.width;if(current_rotate_mode=="se")Q=w.y+w.height;if(current_rotate_mode=="sw"){p=w.x+w.width;Q=w.y+w.height}compensation_angle=(Math.atan2(G-Q,O-p)*(180/Math.PI)-90)%360;aa=(Math.atan2(G-y,O-x)*(180/Math.PI)-90)%360;aa+=compensation_angle;if(m.gridSnapping)aa=
wa(aa);if(B.shiftKey)aa=Math.round(aa/45)*45;c.setRotationAngle(aa<-180?360+aa:aa,true);P("transition",v)}ib("mouseMove",{event:B,mouse_x:n,mouse_y:h,selected:H})}}).click(function(B){B.preventDefault();return false}).dblclick(function(B){var H=B.target.parentNode,h=Bb(B),n=h.tagName;if(H!==I){if(n==="text"&&Ha!=="textedit"){B=K(B.pageX,B.pageY,mb);bb.select(h,B.x,B.y)}if((n==="g"||n==="a")&&ja(h)){Db(h);h=v[0];ya(true)}I&&Eb();H.tagName!=="g"&&H.tagName!=="a"||H===E().getCurrentLayer()||h===ra.selectorParentGroup||
Kb(h)}}).mouseup(function(B){c.addClones=false;window.removeEventListener("keyup",c.removeClones);v=v.filter(Boolean);if(B.button!==2){var H=wb;wb=null;if(Ka){var h=K(B.pageX,B.pageY,mb),n=h.x*q;h=h.y*q;var p=n/q,w=h/q,G=pa(da()),L=false;Ka=false;switch(Ha){case "resize":case "multiselect":if(sa!=null){sa.setAttribute("display","none");hb=[]}Ha="select";case "select":if(v[0]!=null){if(v.length==1){n=v[0];switch(n.tagName){case "g":case "use":case "image":case "foreignObject":break;default:Xa.fill=
n.getAttribute("fill");Xa.fill_opacity=n.getAttribute("fill-opacity");Xa.stroke=n.getAttribute("stroke");Xa.stroke_opacity=n.getAttribute("stroke-opacity");Xa.stroke_width=n.getAttribute("stroke-width");Xa.stroke_dasharray=n.getAttribute("stroke-dasharray");Xa.stroke_linejoin=n.getAttribute("stroke-linejoin");Xa.stroke_linecap=n.getAttribute("stroke-linecap")}if(n.tagName=="text"){Ua.font_size=n.getAttribute("font-size");Ua.font_family=n.getAttribute("font-family")}ra.requestSelector(n).showGrips(true)}Ea();
D=(n=svgedit.browser.isGecko())?D*q:D;C=n?C*q:C;n=Math.abs(w-C);if(n>1||n>1){B=v.length;for(n=0;n<B;++n){if(v[n]==null)break;v[n].firstChild||ra.requestSelector(v[n]).resize()}}else{n=B.target;if(v[0].nodeName==="path"&&v[1]==null)La.select(v[0]);else B.shiftKey&&H!=n&&c.removeFromSelection([n])}if(svgedit.browser.supportsNonScalingStroke())if(B=v[0]){B.removeAttribute("style");svgedit.utilities.walkTree(B,function(aa){aa.removeAttribute("style")})}}return;case "zoom":sa!=null&&sa.setAttribute("display",
"none");P("zoomed",{x:Math.min(D,p),y:Math.min(C,w),width:Math.abs(p-D),height:Math.abs(w-C),factor:B.altKey?0.5:2});return;case "fhpath":H=G.getAttribute("points");w=H.indexOf(",");if(L=w>=0?H.indexOf(",",w+1)>=0:H.indexOf(" ",H.indexOf(" ")+1)>=0)G=La.smoothPolylineIntoPath(G);break;case "line":H=$(G).attr(["x1","x2","y1","y2"]);L=H.x1!=H.x2||H.y1!=H.y2;break;case "foreignObject":case "square":case "rect":case "image":H=$(G).attr(["width","height"]);L=H.width!=0||H.height!=0||Ha==="image";break;
case "circle":L=G.getAttribute("r")!=0;break;case "ellipse":H=$(G).attr(["rx","ry"]);L=H.rx!=null||H.ry!=null;break;case "fhellipse":if(F.maxx-F.minx>0&&F.maxy-F.miny>0){G=M({element:"ellipse",curStyles:true,attr:{cx:(F.minx+F.maxx)/2,cy:(F.miny+F.maxy)/2,rx:(F.maxx-F.minx)/2,ry:(F.maxy-F.miny)/2,id:da()}});P("changed",[G]);L=true}break;case "fhrect":if(F.maxx-F.minx>0&&F.maxy-F.miny>0){G=M({element:"rect",curStyles:true,attr:{x:F.minx,y:F.miny,width:F.maxx-F.minx,height:F.maxy-F.miny,id:da()}});
P("changed",[G]);L=true}break;case "text":L=true;rb([G]);bb.start(G);break;case "path":G=null;Ka=true;H=La.mouseUp(B,G,n,h);G=H.element;L=H.keep;break;case "pathedit":L=true;G=null;La.mouseUp(B);break;case "textedit":L=false;G=null;bb.mouseUp(B,n,h);break;case "rotate":L=true;G=null;Ha="select";H=c.undoMgr.finishUndoableChange();H.isEmpty()||xa(H);Ea();P("changed",v)}n=ib("mouseUp",{event:B,mouse_x:n,mouse_y:h},true);$.each(n,function(aa,ea){if(ea){L=ea.keep||L;G=ea.element;Ka=ea.started||Ka}});if(!L&&
G!=null){E().releaseId(da());G.parentNode.removeChild(G);G=null;for(n=B.target;n.parentNode.parentNode.tagName=="g";)n=n.parentNode;if((Ha!="path"||!drawn_path)&&n.parentNode.id!="selectorParentGroup"&&n.id!="svgcanvas"&&n.id!="svgroot"){c.setMode("select");rb([n],true)}}else if(G!=null){c.addedNew=true;B=0.2;var O;if(false.beginElement&&G.getAttribute("opacity")!=s.opacity){O=$(false).clone().attr({to:s.opacity,dur:B}).appendTo(G);try{O[0].beginElement()}catch(Q){}}else B=0;setTimeout(function(){O&&
O.remove();G.setAttribute("opacity",s.opacity);G.setAttribute("style","pointer-events:inherit");la(G);if(Ha==="path")La.toEditMode(G);else m.selectNew&&rb([G],true);xa(new Ia(G));P("changed",[G])},B*1E3)}Sa=null}}});$(a).bind("mousewheel DOMMouseScroll",function(B){if(B.shiftKey){B.preventDefault();mb=o.getScreenCTM().inverse();var H=K(B.pageX,B.pageY,mb);H={x:H.x,y:H.y,width:0,height:0};if(B.wheelDelta)if(B.wheelDelta>=120)H.factor=2;else{if(B.wheelDelta<=-120)H.factor=0.5}else if(B.detail)if(B.detail>
0)H.factor=0.5;else if(B.detail<0)H.factor=2;H.factor&&P("zoomed",H)}})})();var Fb=function(f){$(f).click(function(k){k.preventDefault()})},bb=c.textActions=function(){function f(X){var ha=h.value==="";$(h).focus();if(!arguments.length)if(ha)X=0;else{if(h.selectionEnd!==h.selectionStart)return;X=h.selectionEnd}var ia;ia=G[X];ha||h.setSelectionRange(X,X);n=pa("text_cursor");if(!n){n=document.createElementNS(b,"line");ka(n,{id:"text_cursor",stroke:"#333","stroke-width":1});n=pa("selectorParentGroup").appendChild(n)}w||
(w=setInterval(function(){var Y=n.getAttribute("display")==="none";n.setAttribute("display",Y?"inline":"none")},600));ha=J(ia.x,L.y);ia=J(ia.x,L.y+L.height);ka(n,{x1:ha.x,y1:ha.y,x2:ia.x,y2:ia.y,visibility:"visible",display:"inline"});p&&p.setAttribute("d","M 0 0")}function k(X,ha,ia){if(X===ha)f(ha);else{ia||h.setSelectionRange(X,ha);p=pa("text_selectblock");if(!p){p=document.createElementNS(b,"path");ka(p,{id:"text_selectblock",fill:"green",opacity:0.5,style:"pointer-events:none"});pa("selectorParentGroup").appendChild(p)}X=
G[X];var Y=G[ha];n.setAttribute("visibility","hidden");ha=J(X.x,L.y);ia=J(X.x+(Y.x-X.x),L.y);var qa=J(X.x,L.y+L.height);X=J(X.x+(Y.x-X.x),L.y+L.height);ka(p,{d:"M"+ha.x+","+ha.y+" L"+ia.x+","+ia.y+" "+X.x+","+X.y+" "+qa.x+","+qa.y+"z",display:"inline"})}}function l(X,ha){var ia=d.createSVGPoint();ia.x=X;ia.y=ha;if(G.length==1)return 0;ia=H.getCharNumAtPosition(ia);if(ia<0){ia=G.length-2;if(X<=G[0].x)ia=0}else if(ia>=G.length-2)ia=G.length-2;var Y=G[ia];X>Y.x+Y.width/2&&ia++;return ia}function D(X,
ha,ia){var Y=h.selectionStart;X=l(X,ha);k(Math.min(Y,X),Math.max(Y,X),!ia)}function C(X,ha){var ia={x:X,y:ha};ia.x/=q;ia.y/=q;if(O){var Y=K(ia.x,ia.y,O.inverse());ia.x=Y.x;ia.y=Y.y}return ia}function J(X,ha){var ia={x:X,y:ha};if(O){var Y=K(ia.x,ia.y,O);ia.x=Y.x;ia.y=Y.y}ia.x*=q;ia.y*=q;return ia}function F(X){k(0,H.textContent.length);$(this).unbind(X)}function B(X){if(ea&&H){var ha=K(X.pageX,X.pageY,mb);ha=C(ha.x*q,ha.y*q);ha=l(ha.x,ha.y);var ia=H.textContent,Y=ia.substr(0,ha).replace(/[a-z0-9]+$/i,
"").length;ia=ia.substr(ha).match(/^[a-z0-9]+/i);k(Y,(ia?ia[0].length:0)+ha);$(X.target).click(F);setTimeout(function(){$(X.target).unbind("click",F)},300)}}var H,h,n,p,w,G=[],L,O,Q,aa,ea;return{select:function(X,ha,ia){H=X;bb.toEditMode(ha,ia)},start:function(X){H=X;bb.toEditMode()},mouseDown:function(X,ha,ia,Y){X=C(ia,Y);h.focus();f(l(X.x,X.y));Q=ia;aa=Y},mouseMove:function(X,ha){var ia=C(X,ha);D(ia.x,ia.y)},mouseUp:function(X,ha,ia){var Y=C(ha,ia);D(Y.x,Y.y,true);X.target!==H&&ha<Q+2&&ha>Q-2&&
ia<aa+2&&ia>aa-2&&bb.toSelectMode(true)},setCursor:f,toEditMode:function(X,ha){rb([H],false);ea=false;Ha="textedit";ra.requestSelector(H).showGrips(false);ra.requestSelector(H);bb.init();$(H).css("cursor","text");if(arguments.length){var ia=C(X,ha);f(l(ia.x,ia.y))}else f();setTimeout(function(){ea=true},300)},toSelectMode:function(X){Ha="select";clearInterval(w);w=null;p&&$(p).attr("display","none");n&&$(n).attr("visibility","hidden");$(H).css("cursor","move");if(X){ya();$(H).css("cursor","move");
P("selected",[H]);qb([H],true)}H&&!H.textContent.length&&c.deleteSelectedElements();$(h).blur();H=false},setInputElem:function(X){h=X},clear:function(){Ha=="textedit"&&bb.toSelectMode()},init:function(){if(H){if(!H.parentNode){H=v[0];ra.requestSelector(H).showGrips(false)}var X=H.textContent.length,ha=H.getAttribute("transform");L=svgedit.utilities.getBBox(H);O=ha?ca(H):null;G=Array(X);h.focus();$(H).unbind("dblclick",B).dblclick(B);if(!X)var ia={x:L.x+L.width/2,width:0};for(ha=0;ha<X;ha++){var Y=
H.getStartPositionOfChar(ha);ia=H.getEndPositionOfChar(ha);if(!svgedit.browser.supportsGoodTextCharPos()){var qa=c.contentW*q;Y.x-=qa;ia.x-=qa;Y.x/=q;ia.x/=q}G[ha]={x:Y.x,y:L.y,width:ia.x-Y.x,height:L.height}}G.push({x:ia.x,width:0});k(h.selectionStart,h.selectionEnd,true)}}}}(),La=c.pathActions=function(){var f=false,k,l,D;svgedit.path.Path.prototype.endChanges=function(F){if(svgedit.browser.isWebkit()){var B=this.elem;B.setAttribute("d",La.convertPath(B))}F=new Ma(this.elem,{d:this.last_d},F);xa(F);
P("changed",[this.elem])};svgedit.path.Path.prototype.addPtsToSelection=function(F){$.isArray(F)||(F=[F]);for(var B=0;B<F.length;B++){var H=F[B],h=this.segs[H];h.ptgrip&&this.selected_pts.indexOf(H)==-1&&H>=0&&this.selected_pts.push(H)}this.selected_pts.sort();B=this.selected_pts.length;for(F=Array(B);B--;){h=this.segs[this.selected_pts[B]];h.select(true);F[B]=h.ptgrip}La.canDeleteNodes=true;La.closed_subpath=this.subpathIsClosed(this.selected_pts[0]);P("selected",F)};var C=k=null,J=false;this.lastCtrlPoint=
[0,0];return{mouseDown:function(F,B,H,h){if(Ha==="path"){mouse_x=H;mouse_y=h;H=mouse_x/q;B=mouse_y/q;h=pa("path_stretch_line");l=[H,B];if(m.gridSnapping){H=wa(H);B=wa(B);mouse_x=wa(mouse_x);mouse_y=wa(mouse_y)}if(!h){h=document.createElementNS(b,"path");ka(h,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"});h=pa("selectorParentGroup").appendChild(h)}h.setAttribute("display","inline");this.stretchy=h;var n=null;if(C){n=C.pathSegList;for(var p=n.numberOfItems,w=6/q,G=false;p;){p--;
var L=n.getItem(p),O=L.x;L=L.y;if(H>=O-w&&H<=O+w&&B>=L-w&&B<=L+w){G=true;break}}w=da();svgedit.path.removePath_(w);w=pa(w);O=n.numberOfItems;if(G){if(p<=1&&O>=2){H=n.getItem(0).x;B=n.getItem(0).y;p=svgedit.path.first_grip?svgedit.path.first_grip[0]/q:n.getItem(0).x;G=svgedit.path.first_grip?svgedit.path.first_grip[1]/q:n.getItem(0).y;F=h.pathSegList.getItem(1);F=F.pathSegType===4?C.createSVGPathSegLinetoAbs(H,B):C.createSVGPathSegCurvetoCubicAbs(H,B,F.x1/q,F.y1/q,p,G);H=C.createSVGPathSegClosePath();
n.appendItem(F);n.appendItem(H)}else if(O<3)return n=false;$(h).remove();element=w;C=null;Ka=false;if(f){svgedit.path.path.matrix&&Za(w,{},svgedit.path.path.matrix.inverse());H=w.getAttribute("d");h=$(svgedit.path.path.elem).attr("d");$(svgedit.path.path.elem).attr("d",h+H);$(w).remove();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();svgedit.path.path.init();La.toEditMode(svgedit.path.path.elem);svgedit.path.path.selectPt();return false}}else{if(!$.contains(a,Bb(F))){console.log("Clicked outside canvas");
return false}n=C.pathSegList.numberOfItems;p=C.pathSegList.getItem(n-1);w=p.x;p=p.y;if(F.shiftKey){B=V(w,p,H,B);H=B.x;B=B.y}F=h.pathSegList.getItem(1);F=F.pathSegType===4?C.createSVGPathSegLinetoAbs(ab(H),ab(B)):C.createSVGPathSegCurvetoCubicAbs(ab(H),ab(B),F.x1/q,F.y1/q,F.x2/q,F.y2/q);C.pathSegList.appendItem(F);H*=q;B*=q;h.setAttribute("d",["M",H,B,H,B].join(" "));h=svgedit.path.addCtrlGrip("1c1");F=svgedit.path.addCtrlGrip("0c2");w=svgedit.path.getCtrlLine(1);p=svgedit.path.getCtrlLine(2);h.setAttribute("cx",
H);h.setAttribute("cy",B);F.setAttribute("cx",H);F.setAttribute("cy",B);w.setAttribute("x1",H);w.setAttribute("x2",H);w.setAttribute("y1",B);w.setAttribute("y2",B);p.setAttribute("x1",H);p.setAttribute("x2",H);p.setAttribute("y1",B);p.setAttribute("y2",B);h=n;if(f)h+=svgedit.path.path.segs.length;svgedit.path.addPointGrip(h,H,B)}n=true}else{d_attr="M"+H+","+B+" ";C=M({element:"path",curStyles:true,attr:{d:d_attr,id:oa(),opacity:s.opacity/2}});h.setAttribute("d",["M",mouse_x,mouse_y,mouse_x,mouse_y].join(" "));
h=f?svgedit.path.path.segs.length:0;svgedit.path.addPointGrip(h,mouse_x,mouse_y);svgedit.path.first_grip=null}}else if(svgedit.path.path){svgedit.path.path.storeD();w=F.target.id;if(w.substr(0,14)=="pathpointgrip_"){B=svgedit.path.path.cur_pt=parseInt(w.substr(14));svgedit.path.path.dragging=[H,h];w=svgedit.path.path.segs[B];if(F.shiftKey)w.selected?svgedit.path.path.removePtFromSelection(B):svgedit.path.path.addPtsToSelection(B);else{if(svgedit.path.path.selected_pts.length<=1||!w.selected)svgedit.path.path.clearSelection();
svgedit.path.path.addPtsToSelection(B)}}else if(w.indexOf("ctrlpointgrip_")==0){svgedit.path.path.dragging=[H,h];F=w.split("_")[1].split("c");B=F[0]-0;n=F=F[1]-0;p=svgedit.path.path.segs[B];svgedit.path.path.selectPt(B,F);if(n==2){G=1;w=p.next}else{G=2;w=p.prev}if(!w)return;F=function(Q,aa){return Math.sqrt(Math.pow(Q.x-aa.x,2)+Math.pow(Q.y-aa.y,2))};B={x:p.item["x"+n],y:p.item["y"+n]};n=n==2?{x:p.item.x,y:p.item.y}:{x:w.item.x,y:w.item.y};p={x:w.item["x"+G],y:w.item["y"+G]};w=F(B,n);F=F(p,n);B=Math.abs(Math.round(Math.atan2(B.y-
n.y,B.x-n.x)*(180/Math.PI),0)-Math.round(Math.atan2(p.y-n.y,p.x-n.x)*(180/Math.PI),0))==180;if(Math.abs(w-F)<5&&B){svgedit.path.setLinkControlPoints(true);svgedit.path.is_linked=true}else{svgedit.path.setLinkControlPoints(false);svgedit.path.is_linked=false}}if(!svgedit.path.path.dragging){if(sa==null)sa=ra.getRubberBandBox();ka(sa,{x:H*q,y:h*q,width:0,height:0,display:"inline"},100)}}},mouseMove:function(F,B,H){J=true;var h=!F.altKey;if(Ha==="path"){if(C){var n=C.pathSegList,p=n.numberOfItems-1,
w=svgedit.path.addCtrlGrip("1c1"),G=svgedit.path.addCtrlGrip("0c2");if(l){var L=G.getAttribute("cx")/q||0,O=G.getAttribute("cy")/q||0;w.setAttribute("cx",B);w.setAttribute("cy",H);w.setAttribute("display","inline");F=l[0];w=l[1];n.getItem(p);var Q=B/q,aa=H/q;L=h?F+(F-Q):L;h=h?w+(w-aa):O;G.setAttribute("cx",L*q);G.setAttribute("cy",h*q);G.setAttribute("display","inline");G=svgedit.path.getCtrlLine(1);O=svgedit.path.getCtrlLine(2);ka(G,{x1:B,y1:H,x2:F*q,y2:w*q,display:"inline"});ka(O,{x1:L*q,y1:h*q,
x2:F*q,y2:w*q,display:"inline"});if(p===0)D=[B,H];else{n=n.getItem(p-1);B=n.x;H=n.y;if(n.pathSegType===6){B+=B-n.x2;H+=H-n.y2}else if(D){B=D[0]/q;H=D[1]/q}svgedit.path.replacePathSeg(6,p,[F,w,this.lastCtrlPoint[0]/q,this.lastCtrlPoint[1]/q,L,h],C)}}else if(h=this.stretchy){p=n.getItem(p);n=B;w=H;if(F.target.id==="pathpointgrip_0"&&svgedit.path.first_grip){n=svgedit.path.first_grip[0];w=svgedit.path.first_grip[1]}if(p.pathSegType===6)svgedit.path.replacePathSeg(6,1,[B,H,(this.lastCtrlPoint[0]/q||p.x+
(p.x-p.x2))*q,(this.lastCtrlPoint[1]/q||p.y+(p.y-p.y2))*q,n,w],h);else D?svgedit.path.replacePathSeg(6,1,[B,H,D[0],D[1],B,H],h):svgedit.path.replacePathSeg(4,1,[B,H],h)}}}else if(svgedit.path.path.dragging){n=svgedit.path.getPointFromGrip({x:svgedit.path.path.dragging[0],y:svgedit.path.path.dragging[1]},svgedit.path.path);F=svgedit.path.getPointFromGrip({x:B,y:H},svgedit.path.path);p=F.x-n.x;n=F.y-n.y;svgedit.path.path.dragging=[B,H];!h||!svgedit.path.is_linked?svgedit.path.setLinkControlPoints(false):
svgedit.path.setLinkControlPoints(true);svgedit.path.path.dragctrl?svgedit.path.path.moveCtrl(p,n):svgedit.path.path.movePts(p,n)}else{svgedit.path.path.selected_pts=[];svgedit.path.path.eachSeg(function(){if(this.next||this.prev){var ea=sa.getBBox(),X=svgedit.path.getGripPt(this);ea=svgedit.math.rectsIntersect(ea,{x:X.x,y:X.y,width:0,height:0});this.select(ea);ea&&svgedit.path.path.selected_pts.push(this.index)}})}},mouseUp:function(F,B,H,h){var n=pa("ctrlpointgrip_1c1"),p=pa("ctrlpointgrip_0c2");
this.lastCtrlPoint=n?[n.getAttribute("cx"),n.getAttribute("cy")]:[H,h];if(!svgedit.path.first_grip&&p)svgedit.path.first_grip=[p.getAttribute("cx"),p.getAttribute("cy")];if(Ha==="path"){l=null;if(!C){B=pa(da());Ka=false;D=null}return{keep:true,element:B}}if(svgedit.path.path.dragging){B=svgedit.path.path.cur_pt;svgedit.path.path.dragging=false;svgedit.path.path.dragctrl=false;svgedit.path.path.update();J&&svgedit.path.path.endChanges("Move path point(s)");!F.shiftKey&&!J&&svgedit.path.path.selectPt(B)}else if(sa&&
sa.getAttribute("display")!="none"){sa.setAttribute("display","none");sa.getAttribute("width")<=2&&sa.getAttribute("height")<=2&&La.toSelectMode(F.target)}else La.toSelectMode(F.target);J=false},toEditMode:function(F){svgedit.path.path=svgedit.path.getPath_(F);Ha="pathedit";ya();svgedit.path.path.show(true).update();svgedit.path.path.oldbbox=svgedit.utilities.getBBox(svgedit.path.path.elem);f=false},toSelectMode:function(F){var B=F==svgedit.path.path.elem;Ha="select";svgedit.path.path.show(false);
k=false;ya();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();if(B){P("selected",[F]);qb([F],true)}},addSubPath:function(F){if(F){Ha="path";f=true}else{La.clear(true);La.toEditMode(svgedit.path.path.elem)}},select:function(F){if(k===F){La.toEditMode(F);Ha="pathedit"}else k=F},reorient:function(){var F=v[0];if(F)if(ja(F)!=0){var B=new Da("Reorient path"),H={d:F.getAttribute("d"),transform:F.getAttribute("transform")};B.addSubCommand(new Ma(F,H));ya();this.resetOrientation(F);xa(B);svgedit.path.getPath_(F).show(false).matrix=
null;this.clear();qb([F],true);P("changed",v)}},clear:function(F){k=null;if(C){var B=pa(da());$(pa("path_stretch_line")).remove();F&&$(B).remove();$(pa("pathpointgrip_container")).find("*").attr("display","none");C=D=null;Ka=false}else Ha=="pathedit"&&this.toSelectMode();svgedit.path.path&&svgedit.path.path.init().show(false)},resetOrientation:function(F){if(F==null||F.nodeName!="path")return false;var B=N(F),H=S(B).matrix;B.clear();F.removeAttribute("transform");B=F.pathSegList;for(var h=B.numberOfItems,
n=0;n<h;++n){var p=B.getItem(n),w=p.pathSegType;if(w!=1){var G=[];$.each(["",1,2],function(L,O){var Q=p["x"+O],aa=p["y"+O];if(Q!==undefined&&aa!==undefined){Q=K(Q,aa,H);G.splice(G.length,0,Q.x,Q.y)}});svgedit.path.replacePathSeg(w,n,G,F)}}e(F,H)},zoomChange:function(){Ha=="pathedit"&&svgedit.path.path.update()},getNodePoint:function(){if(svgedit.path.path){var F=svgedit.path.path.segs[svgedit.path.path.selected_pts.length?svgedit.path.path.selected_pts[0]:1];return{x:F.item.x,y:F.item.y,type:F.type}}},
linkControlPoints:function(F){svgedit.path.setLinkControlPoints(F)},clonePathNode:function(){svgedit.path.path.storeD();for(var F=svgedit.path.path.selected_pts,B=F.length,H=[];B--;){var h=F[B];svgedit.path.path.addSeg(h);H.push(h+B);H.push(h+B+1)}svgedit.path.path.init().addPtsToSelection(H);svgedit.path.path.endChanges("Clone path node(s)")},opencloseSubPath:function(){var F=svgedit.path.path.selected_pts;if(F.length===1){var B=svgedit.path.path.elem,H=B.pathSegList,h=F[0],n=null,p=null;svgedit.path.path.eachSeg(function(O){if(this.type===
2&&O<=h)p=this.item;if(O<=h)return true;if(this.type===2){n=O;return false}else if(this.type===1)return n=false});if(n==null)n=svgedit.path.path.segs.length-1;if(n!==false){var w=B.createSVGPathSegLinetoAbs(p.x,p.y),G=B.createSVGPathSegClosePath();if(n==svgedit.path.path.segs.length){H.appendItem(w);H.appendItem(G)}else{svgedit.path.insertItemBefore(B,G,n);svgedit.path.insertItemBefore(B,w,n)}svgedit.path.path.init().selectPt(n+1)}else if(svgedit.path.path.segs[h].mate){H.removeItem(h);H.removeItem(h);
svgedit.path.path.init().selectPt(h-1)}else{for(F=0;F<H.numberOfItems;F++){var L=H.getItem(F);if(L.pathSegType===2)w=F;else if(F===h)H.removeItem(w);else if(L.pathSegType===1&&h<F){G=F-1;H.removeItem(F);break}}for(F=h-w-1;F--;)svgedit.path.insertItemBefore(B,H.getItem(w),G);B=H.getItem(w);svgedit.path.replacePathSeg(2,w,[B.x,B.y]);F=h;svgedit.path.path.init().selectPt(0)}}},deletePathNode:function(){if(La.canDeleteNodes){svgedit.path.path.storeD();for(var F=svgedit.path.path.selected_pts,B=F.length;B--;)svgedit.path.path.deleteSeg(F[B]);
var H=function(){var h=svgedit.path.path.elem.pathSegList,n=h.numberOfItems,p=function(L,O){for(;O--;)h.removeItem(L)};if(n<=1)return true;for(;n--;){var w=h.getItem(n);if(w.pathSegType===1){w=h.getItem(n-1);var G=h.getItem(n-2);if(w.pathSegType===2){p(n-1,2);H();break}else if(G.pathSegType===2){p(n-2,3);H();break}}else if(w.pathSegType===2)if(n>0){w=h.getItem(n-1).pathSegType;if(w===2){p(n-1,1);H();break}else if(w===1&&h.numberOfItems-1===n){p(n,1);H();break}}}return false};H();if(svgedit.path.path.elem.pathSegList.numberOfItems<=
1){c.setMode("select");c.deleteSelectedElements()}else{svgedit.path.path.init();svgedit.path.path.clearSelection();if(window.opera){F=$(svgedit.path.path.elem);F.attr("d",F.attr("d"))}svgedit.path.path.endChanges("Delete path node(s)")}}},smoothPolylineIntoPath:function(F){var B=F.points,H=B.numberOfItems;if(H>=4){var h=B.getItem(0),n=null;F=[];F.push(["M",h.x,",",h.y," C"].join(""));for(var p=1;p<=H-4;p+=3){var w=B.getItem(p),G=B.getItem(p+1),L=B.getItem(p+2);if(n)if((h=svgedit.path.smoothControlPoints(n,
w,h))&&h.length==2){w=F[F.length-1].split(",");w[2]=h[0].x;w[3]=h[0].y;F[F.length-1]=w.join(",");w=h[1]}F.push([w.x,w.y,G.x,G.y,L.x,L.y].join(","));h=L;n=G}for(F.push("L");p<H;++p){G=B.getItem(p);F.push([G.x,G.y].join(","))}F=F.join(" ");F=M({element:"path",curStyles:true,attr:{id:da(),d:F,fill:"none"}})}return F},setSegType:function(F){svgedit.path.path.setSegType(F)},moveNode:function(F,B){var H=svgedit.path.path.selected_pts;if(H.length){svgedit.path.path.storeD();H=svgedit.path.path.segs[H[0]];
var h={x:0,y:0};h[F]=B-H.item[F];H.move(h.x,h.y);svgedit.path.path.endChanges("Move path point")}},fixEnd:function(F){for(var B=F.pathSegList,H=B.numberOfItems,h,n=0;n<H;++n){var p=B.getItem(n);if(p.pathSegType===2)h=p;if(p.pathSegType===1){p=B.getItem(n-1);if(p.x!=h.x||p.y!=h.y){B=F.createSVGPathSegLinetoAbs(h.x,h.y);svgedit.path.insertItemBefore(F,B,n);La.fixEnd(F);break}}}svgedit.browser.isWebkit()&&F.setAttribute("d",La.convertPath(F))},convertPath:function(F,B){for(var H=F.pathSegList,h=H.numberOfItems,
n=0,p=0,w="",G=null,L=0;L<h;++L){var O=H.getItem(L),Q=O.x||0,aa=O.y||0,ea=O.x1||0,X=O.y1||0,ha=O.x2||0,ia=O.y2||0,Y=O.pathSegType,qa=Oa[Y]["to"+(B?"Lower":"Upper")+"Case"](),va=function(Ba,Ca,Pa){Ca=Ca?" "+Ca.join(" "):"";Pa=Pa?" "+svgedit.units.shortFloat(Pa):"";$.each(Ba,function(Qa,Na){Ba[Qa]=svgedit.units.shortFloat(Na)});w+=qa+Ba.join(" ")+Ca+Pa};switch(Y){case 1:w+="z";break;case 12:Q-=n;case 13:if(B){n+=Q;qa="l"}else{Q+=n;n=Q;qa="L"}va([[Q,p]]);break;case 14:aa-=p;case 15:if(B){p+=aa;qa="l"}else{aa+=
p;p=aa;qa="L"}va([[n,aa]]);break;case 2:case 4:case 18:Q-=n;aa-=p;case 5:case 3:if(G&&H.getItem(L-1).pathSegType===1&&!B){n=G[0];p=G[1]}case 19:if(B){n+=Q;p+=aa}else{Q+=n;aa+=p;n=Q;p=aa}if(Y===3)G=[n,p];va([[Q,aa]]);break;case 6:Q-=n;ea-=n;ha-=n;aa-=p;X-=p;ia-=p;case 7:if(B){n+=Q;p+=aa}else{Q+=n;ea+=n;ha+=n;aa+=p;X+=p;ia+=p;n=Q;p=aa}va([[ea,X],[ha,ia],[Q,aa]]);break;case 8:Q-=n;ea-=n;aa-=p;X-=p;case 9:if(B){n+=Q;p+=aa}else{Q+=n;ea+=n;aa+=p;X+=p;n=Q;p=aa}va([[ea,X],[Q,aa]]);break;case 10:Q-=n;aa-=
p;case 11:if(B){n+=Q;p+=aa}else{Q+=n;aa+=p;n=Q;p=aa}va([[O.r1,O.r2]],[O.angle,O.largeArcFlag?1:0,O.sweepFlag?1:0],[Q,aa]);break;case 16:Q-=n;ha-=n;aa-=p;ia-=p;case 17:if(B){n+=Q;p+=aa}else{Q+=n;ha+=n;aa+=p;ia+=p;n=Q;p=aa}va([[ha,ia],[Q,aa]])}}return w}}}(),yb=this.removeUnusedDefElems=function(){var f=o.getElementsByTagNameNS(b,"defs");if(!f||!f.length)return 0;for(var k=[],l=0,D=["fill","stroke","filter","marker-start","marker-mid","marker-end"],C=D.length,J=o.getElementsByTagNameNS(b,"*"),F=J.length,
B=0;B<F;B++){for(var H=J[B],h=0;h<C;h++)if(H){var n=na(H.getAttribute(D[h]));n&&k.push(n.substr(1))}(H=ga(H))&&H.indexOf("#")===0&&k.push(H.substr(1))}f=$(f).find("linearGradient, radialGradient, filter, marker, svg, symbol");defelem_ids=[];for(B=f.length;B--;){D=f[B];C=D.id;if(k.indexOf(C)<0){sb[C]=D;D.parentNode.removeChild(D);l++}}return l};this.svgCanvasToString=function(){for(;yb()>0;);La.clear(true);$.each(o.childNodes,function(l,D){l&&D.nodeType===8&&D.data.indexOf("Created with")>=0&&o.insertBefore(D,
o.firstChild)});if(I){Eb();rb([I])}$("#canvasGrid").attr("display","none");var f=[];$(o).find("g:data(gsvg)").each(function(){for(var l=this.attributes,D=l.length,C=0;C<D;C++)if(l[C].nodeName=="id"||l[C].nodeName=="style")D--;if(D<=0){l=this.firstChild;f.push(l);$(this).replaceWith(l)}});var k=this.svgToString(o,0);f.length&&$(f).each(function(){tb(this)});return k};this.svgToString=function(f,k){var l=[],D=svgedit.utilities.toXml,C=m.baseUnit,J=RegExp("^-?[\\d\\.]+"+C+"$");if(f){la(f);var F=f.attributes,
B,H,h=f.childNodes;for(H=0;H<k;H++)l.push(" ");l.push("<");l.push(f.nodeName);if(f.id==="svgcontent"){H=zb();if(C!=="px"){H.w=svgedit.units.convertUnit(H.w,C)+C;H.h=svgedit.units.convertUnit(H.h,C)+C}l.push(' width="'+H.w+'" height="'+H.h+'" xmlns="'+b+'"');var n={};$(f).find("*").andSelf().each(function(){$.each(this.attributes,function(L,O){var Q=O.namespaceURI;if(Q&&!n[Q]&&za[Q]!=="xmlns"&&za[Q]!=="xml"){n[Q]=true;l.push(" xmlns:"+za[Q]+'="'+Q+'"')}})});H=F.length;for(C=["width","height","xmlns",
"x","y","viewBox","id","overflow"];H--;){B=F.item(H);var p=D(B.nodeValue);if(B.nodeName.indexOf("xmlns:")!==0)if(p!=""&&C.indexOf(B.localName)==-1)if(!B.namespaceURI||za[B.namespaceURI]){l.push(" ");l.push(B.nodeName);l.push('="');l.push(p);l.push('"')}}}else{if(f.nodeName==="defs"&&!f.firstChild)return;var w=["-moz-math-font-style","_moz-math-font-style"];for(H=F.length-1;H>=0;H--){B=F.item(H);p=D(B.nodeValue);if(!(w.indexOf(B.localName)>=0))if(p!="")if(p.indexOf("pointer-events")!==0)if(!(B.localName===
"class"&&p.indexOf("se_")===0)){l.push(" ");if(B.localName==="d")p=La.convertPath(f,true);if(isNaN(p)){if(J.test(p))p=svgedit.units.shortFloat(p)+C}else p=svgedit.units.shortFloat(p);if($a.apply&&f.nodeName==="image"&&B.localName==="href"&&$a.images&&$a.images==="embed"){var G=Va[p];if(G)p=G}if(!B.namespaceURI||B.namespaceURI==b||za[B.namespaceURI]){l.push(B.nodeName);l.push('="');l.push(p);l.push('"')}}}}if(f.hasChildNodes()){l.push(">");k++;F=false;for(H=0;H<h.length;H++){C=h.item(H);switch(C.nodeType){case 1:l.push("\n");
l.push(this.svgToString(h.item(H),k));break;case 3:C=C.nodeValue.replace(/^\s+|\s+$/g,"");if(C!=""){F=true;l.push(D(C)+"")}break;case 4:l.push("\n");l.push(Array(k+1).join(" "));l.push("<![CDATA[");l.push(C.nodeValue);l.push("]]\>");break;case 8:l.push("\n");l.push(Array(k+1).join(" "));l.push("<!--");l.push(C.data);l.push("--\>")}}k--;if(!F){l.push("\n");for(H=0;H<k;H++)l.push(" ")}l.push("</");l.push(f.nodeName);l.push(">")}else l.push("/>")}return l.join("")};this.embedImage=function(f,k){$(new Image).load(function(){var l=
document.createElement("canvas");l.width=this.width;l.height=this.height;l.getContext("2d").drawImage(this,0,0);try{var D=";svgedit_url="+encodeURIComponent(f);D=l.toDataURL().replace(";base64",D+";base64");Va[f]=D}catch(C){Va[f]=false}Ga=f;k&&k(Va[f])}).attr("src",f)};this.setGoodImage=function(f){Ga=f};this.open=function(){};this.save=function(f){ya();f&&$.extend($a,f);$a.apply=true;f=this.svgCanvasToString();P("saved",f)};this.rasterExport=function(){ya();var f=[],k={feGaussianBlur:kb.exportNoBlur,
foreignObject:kb.exportNoforeignObject,"[stroke-dasharray]":kb.exportNoDashArray},l=$(o);if(!("font"in $("<canvas>")[0].getContext("2d")))k.text=kb.exportNoText;$.each(k,function(D,C){l.find(D).length&&f.push(C)});k=this.svgCanvasToString();P("exported",{svg:k,issues:f})};this.getSvgString=function(){$a.apply=false;return this.svgCanvasToString()};this.randomizeIds=function(){arguments.length>0&&arguments[0]==false?svgedit.draw.randomizeIds(false,E()):svgedit.draw.randomizeIds(true,E())};var Hb=this.uniquifyElems=
function(f){var k={},l=["filter","linearGradient","pattern","radialGradient","symbol","textPath","use"];svgedit.utilities.walkTree(f,function(B){if(B.nodeType==1){if(B.id){B.id in k||(k[B.id]={elem:null,attrs:[],hrefs:[]});k[B.id].elem=B}$.each(vb,function(h,n){var p=B.getAttributeNode(n);if(p){var w=svgedit.utilities.getUrlFromAttr(p.value);if(w=w?w.substr(1):null){w in k||(k[w]={elem:null,attrs:[],hrefs:[]});k[w].attrs.push(p)}}});var H=svgedit.utilities.getHref(B);if(H&&l.indexOf(B.nodeName)>=
0)if(H=H.substr(1)){H in k||(k[H]={elem:null,attrs:[],hrefs:[]});k[H].hrefs.push(B)}}});for(var D in k)if(D){var C=k[D].elem;if(C){f=oa();C.id=f;C=k[D].attrs;for(var J=C.length;J--;){var F=C[J];F.ownerElement.setAttribute(F.name,"url(#"+f+")")}C=k[D].hrefs;for(J=C.length;J--;)svgedit.utilities.setHref(C[J],"#"+f)}}},Gb=this.setUseData=function(f){var k=$(f);if(f.tagName!=="use")k=k.find("use");k.each(function(){var l=ga(this).substr(1);if(l=pa(l)){$(this).data("ref",l);if(l.tagName=="symbol"||l.tagName==
"svg")$(this).data("symbol",l).data("ref",l)}})},Ib=this.convertGradients=function(f){var k=$(f).find("linearGradient, radialGradient");if(!k.length&&svgedit.browser.isWebkit())k=$(f).find("*").filter(function(){return this.tagName.indexOf("Gradient")>=0});k.each(function(){if($(this).attr("gradientUnits")==="userSpaceOnUse"){var l=$(o).find('[fill="url(#'+this.id+')"],[stroke="url(#'+this.id+')"]');if(l.length)if(l=svgedit.utilities.getBBox(l[0]))if(this.tagName==="linearGradient"){var D=$(this).attr(["x1",
"y1","x2","y2"]),C=this.gradientTransform.baseVal;if(C&&C.numberOfItems>0){var J=S(C).matrix;C=K(D.x1,D.y1,J);J=K(D.x2,D.y2,J);D.x1=C.x;D.y1=C.y;D.x2=J.x;D.y2=J.y;this.removeAttribute("gradientTransform")}$(this).attr({x1:(D.x1-l.x)/l.width,y1:(D.y1-l.y)/l.height,x2:(D.x2-l.x)/l.width,y2:(D.y2-l.y)/l.height});this.removeAttribute("gradientUnits")}}})},Lb=this.convertToGroup=function(f){f||(f=v[0]);var k=$(f),l=new Da,D;if(k.data("gsvg")){l=$(f.firstChild).attr(["x","y"]);$(f.firstChild.firstChild).unwrap();
$(f).removeData("gsvg");D=N(f);var C=d.createSVGTransform();C.setTranslate(l.x,l.y);D.appendItem(C);Ra(f);P("selected",[f])}else if(k.data("symbol")){f=k.data("symbol");D=k.attr("transform");C=k.attr(["x","y"]);var J=f.getAttribute("viewBox");if(J){J=J.split(" ");C.x-=+J[0];C.y-=+J[1]}D+=" translate("+(C.x||0)+","+(C.y||0)+")";C=k.prev();l.addSubCommand(new Fa(k[0],k[0].nextSibling,k[0].parentNode));k.remove();J=$(o).find("use:data(symbol)").length;k=g.createElementNS(b,"g");for(var F=f.childNodes,
B=0;B<F.length;B++)k.appendChild(F[B].cloneNode(true));if(svgedit.browser.isGecko()){F=$(gb()).children("linearGradient,radialGradient,pattern").clone();$(k).append(F)}D&&k.setAttribute("transform",D);D=f.parentNode;Hb(k);svgedit.browser.isGecko()&&$(gb()).append($(k).find("linearGradient,radialGradient,pattern"));k.id=oa();C.after(k);if(D){if(!J){C=f.nextSibling;D.removeChild(f);l.addSubCommand(new Fa(f,C,D))}l.addSubCommand(new Ia(k))}Gb(k);svgedit.browser.isGecko()?Ib(gb()):Ib(k);svgedit.utilities.walkTreePost(k,
function(H){try{Ra(H)}catch(h){console.log(h)}});$(k).find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=oa()});rb([k]);(f=Db(k,true))&&l.addSubCommand(f);xa(l)}else console.log("Unexpected element to ungroup:",f)};this.setSvgString=function(f){try{var k=svgedit.utilities.text2xml(f);this.prepareSvg(k);var l=new Da("Change Source"),D=o.nextSibling,C=d.removeChild(o);l.addSubCommand(new Fa(C,D,d));o=g.adoptNode?g.adoptNode(k.documentElement):
g.importNode(k.documentElement,true);d.appendChild(o);var J=$(o);c.current_drawing_=new svgedit.draw.Drawing(o,z);var F=E().getNonce();F?P("setnonce",F):P("unsetnonce");J.find("image").each(function(){var O=this;Fb(O);var Q=ga(this);if(Q.indexOf("data:")===0){var aa=Q.match(/svgedit_url=(.*?);/);if(aa){var ea=decodeURIComponent(aa[1]);$(new Image).load(function(){O.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",ea)}).attr("src",ea)}}c.embedImage(Q)});J.find("svg").each(function(){if(!$(this).closest("defs").length){Hb(this);
var O=this.parentNode;if(O.childNodes.length===1&&O.nodeName==="g"){$(O).data("gsvg",this);O.id=O.id||oa()}else tb(this)}});J.find("linearGradient, radialGradient, pattern").appendTo(gb());Gb(J);Ib(J[0]);svgedit.utilities.walkTreePost(o,function(O){try{Ra(O)}catch(Q){console.log(Q)}});var B={id:"svgcontent",overflow:m.show_outside_canvas?"visible":"hidden"},H=false;if(J.attr("viewBox")){var h=J.attr("viewBox").split(" ");B.width=h[2];B.height=h[3]}else $.each(["width","height"],function(O,Q){var aa=
J.attr(Q);aa||(aa="100%");if((aa+"").substr(-1)==="%")H=true;else B[Q]=ta(Q,aa)});xb();J.children().find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=oa()});if(H){var n=getStrokedBBox();B.width=n.width+n.x;B.height=n.height+n.y}if(B.width<=0)B.width=200;if(B.height<=0)B.height=200;J.attr(B);this.contentW=B.width;this.contentH=B.height;$("#canvas_width").val(this.contentW);$("#canvas_height").val(this.contentH);var p=
$("#canvas_background");if(p.length){var w=p.attr("fill-opacity");w=w?parseInt(w)*100:100;fill=this.getPaint(p.attr("fill"),w,"canvas")}else fill=this.getPaint("none",100,"canvas");methodDraw.paintBox.canvas.setPaint(fill);l.addSubCommand(new Ia(o));var G=J.attr(["width","height"]);l.addSubCommand(new Ma(d,G));q=1;svgedit.transformlist.resetListMap();ya();svgedit.path.clearData();d.appendChild(ra.selectorParentGroup);xa(l);P("changed",[o])}catch(L){console.log(L);return false}return true};this.getPaint=
function(f,k,l){var D=null;if(f.indexOf("url(#")===0){f=(f=svgCanvas.getRefElem(f))?f.cloneNode(true):$("#"+l+"_color defs *")[0];D={alpha:k};D[f.tagName]=f}else D=f.indexOf("#")===0?{alpha:k,solidColor:f.substr(1)}:{alpha:k,solidColor:"none"};return new $.jGraduate.Paint(D)};this.importSvgString=function(f){try{var k=svgedit.utilities.encode64(f.length+f).substr(0,32),l=false;if(lb[k])if($(lb[k].symbol).parents("#svgroot").length)l=true;var D=new Da("Import SVG");if(l)var C=lb[k].symbol,J=lb[k].xform;
else{var F=svgedit.utilities.text2xml(f);this.prepareSvg(F);var B;B=g.adoptNode?g.adoptNode(F.documentElement):g.importNode(F.documentElement,true);Hb(B);var H=ta("width",B.getAttribute("width")),h=ta("height",B.getAttribute("height")),n=B.getAttribute("viewBox"),p=n?n.split(" "):[0,0,H,h];for(f=0;f<4;++f)p[f]=+p[f];o.getAttribute("width");var w=+o.getAttribute("height");J=h>H?"scale("+w/3/p[3]+")":"scale("+w/3/p[2]+")";J="translate(0) "+J+" translate(0)";C=g.createElementNS(b,"symbol");var G=gb();
for(svgedit.browser.isGecko()&&$(B).find("linearGradient, radialGradient, pattern").appendTo(G);B.firstChild;)C.appendChild(B.firstChild);var L=B.attributes;for(B=0;B<L.length;B++){var O=L[B];C.setAttribute(O.nodeName,O.nodeValue)}C.id=oa();lb[k]={symbol:C,xform:J};gb().appendChild(C);D.addSubCommand(new Ia(C))}var Q=g.createElementNS(b,"use");Q.id=oa();W(Q,"#"+C.id);(I||E().getCurrentLayer()).appendChild(Q);D.addSubCommand(new Ia(Q));ya();Q.setAttribute("transform",J);Ra(Q);$(Q).data("symbol",C).data("ref",
C);qb([Q]);xa(D);P("changed",[o])}catch(aa){console.log(aa);return false}return true};var xb=c.identifyLayers=function(){Eb();E().identifyLayers()};this.createLayer=function(f){var k=new Da("Create Layer");f=E().createLayer(f);k.addSubCommand(new Ia(f));xa(k);ya();P("changed",[f])};this.cloneLayer=function(f){var k=new Da("Duplicate Layer"),l=g.createElementNS(b,"g"),D=g.createElementNS(b,"title");D.textContent=f;l.appendChild(D);D=E().getCurrentLayer();$(D).after(l);D=D.childNodes;for(var C=0;C<
D.length;C++){var J=D[C];J.localName!="title"&&l.appendChild(ma(J))}ya();xb();k.addSubCommand(new Ia(l));xa(k);c.setCurrentLayer(f);P("changed",[l])};this.deleteCurrentLayer=function(){var f=E().getCurrentLayer(),k=f.nextSibling,l=f.parentNode;if(f=E().deleteCurrentLayer()){var D=new Da("Delete Layer");D.addSubCommand(new Fa(f,k,l));xa(D);ya();P("changed",[l]);return true}return false};this.setCurrentLayer=function(f){(f=E().setCurrentLayer(svgedit.utilities.toXml(f)))&&ya();return f};this.renameCurrentLayer=
function(f){var k=E();if(k.current_layer){var l=k.current_layer;if(!c.setCurrentLayer(f)){for(var D=new Da("Rename Layer"),C=0;C<k.getNumLayers();++C)if(k.all_layers[C][1]==l)break;var J=k.getLayerName(C);k.all_layers[C][0]=svgedit.utilities.toXml(f);var F=l.childNodes.length;for(C=0;C<F;++C){var B=l.childNodes.item(C);if(B&&B.tagName=="title"){for(;B.firstChild;)B.removeChild(B.firstChild);B.textContent=f;D.addSubCommand(new Ma(B,{"#text":J}));xa(D);P("changed",[l]);return true}}}k.current_layer=
l}return false};this.setCurrentLayerPosition=function(f){var k=E();if(k.current_layer&&f>=0&&f<k.getNumLayers()){for(var l=0;l<k.getNumLayers();++l)if(k.all_layers[l][1]==k.current_layer)break;if(l==k.getNumLayers())return false;if(l!=f){var D=null,C=k.current_layer.nextSibling;if(f>l){if(f<k.getNumLayers()-1)D=k.all_layers[f+1][1]}else D=k.all_layers[f][1];o.insertBefore(k.current_layer,D);xa(new Ja(k.current_layer,C,o));xb();c.setCurrentLayer(k.getLayerName(f));return true}}return false};this.setLayerVisibility=
function(f,k){var l=E(),D=l.getLayerVisibility(f),C=l.setLayerVisibility(f,k);if(C)xa(new Ma(C,{display:D?"inline":"none"},"Layer Visibility"));else return false;if(C==l.getCurrentLayer()){ya();La.clear()}return true};this.moveSelectedToLayer=function(f){for(var k=null,l=E(),D=0;D<l.getNumLayers();++D)if(l.getLayerName(D)==f){k=l.all_layers[D][1];break}if(!k)return false;f=new Da("Move Elements to Layer");l=v;for(D=l.length;D--;){var C=l[D];if(C){var J=C.nextSibling,F=C.parentNode;k.appendChild(C);
f.addSubCommand(new Ja(C,J,F))}}xa(f);return true};this.mergeLayer=function(f){var k=new Da("Merge Layer"),l=E(),D=$(l.current_layer).prev()[0];if(D){for(k.addSubCommand(new Fa(l.current_layer,l.current_layer.nextSibling,o));l.current_layer.firstChild;){var C=l.current_layer.firstChild;if(C.localName=="title"){k.addSubCommand(new Fa(C,C.nextSibling,l.current_layer));l.current_layer.removeChild(C)}else{var J=C.nextSibling;D.appendChild(C);k.addSubCommand(new Ja(C,J,l.current_layer))}}o.removeChild(l.current_layer);
if(!f){ya();xb();P("changed",[o]);xa(k)}l.current_layer=D;return k}};this.mergeAllLayers=function(){var f=new Da("Merge all Layers"),k=E();for(k.current_layer=k.all_layers[k.getNumLayers()-1][1];$(o).children("g").length>1;)f.addSubCommand(c.mergeLayer(true));ya();xb();P("changed",[o]);xa(f)};var Eb=this.leaveContext=function(){var f=ua.length;if(f){for(var k=0;k<f;k++){var l=ua[k],D=cb(l,"orig_opac");D!==1?l.setAttribute("opacity",D):l.removeAttribute("opacity");l.setAttribute("style","pointer-events: inherit")}ua=
[];ya(true);P("contextset",null)}I=null},Kb=this.setContext=function(f){Eb();if(typeof f==="string")f=pa(f);I=f;$(f).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var k=this.getAttribute("opacity")||1;cb(this,"orig_opac",k);this.setAttribute("opacity",k*0.33);this.setAttribute("style","pointer-events: none");ua.push(this)});ya();P("contextset",I)};this.clear=function(){La.clear();ya();c.clearSvgContentElement();c.current_drawing_=new svgedit.draw.Drawing(o);c.createLayer("Layer 1");
c.undoMgr.resetUndoStack();ra.initGroup();sa=ra.getRubberBandBox();P("cleared")};this.linkControlPoints=La.linkControlPoints;this.getContentElem=function(){return o};this.getRootElem=function(){return d};this.getSelectedElems=function(){return v};var zb=this.getResolution=function(){var f=o.getAttribute("width")/q,k=o.getAttribute("height")/q;return{w:f,h:k,zoom:q}};this.getZoom=function(){return q};this.getVersion=function(){return"svgcanvas.js ($Rev: 2082 $)"};this.setUiStrings=function(f){$.extend(kb,
f.notification)};this.setConfig=function(f){$.extend(m,f)};this.getTitle=function(f){if(f=f||v[0]){f=$(f).data("gsvg")||$(f).data("symbol")||f;f=f.childNodes;for(var k=0;k<f.length;k++)if(f[k].nodeName=="title")return f[k].textContent;return""}};this.setGroupTitle=function(f){var k=v[0];k=$(k).data("gsvg")||k;var l=$(k).children("title"),D=new Da("Set Label");if(f.length)if(l.length){l=l[0];D.addSubCommand(new Ma(l,{"#text":l.textContent}));l.textContent=f}else{l=g.createElementNS(b,"title");l.textContent=
f;$(k).prepend(l);D.addSubCommand(new Ia(l))}else{D.addSubCommand(new Fa(l[0],l.nextSibling,k));l.remove()}xa(D)};this.getDocumentTitle=function(){return c.getTitle(o)};this.setDocumentTitle=function(f){for(var k=o.childNodes,l=false,D="",C=new Da("Change Image Title"),J=0;J<k.length;J++)if(k[J].nodeName=="title"){l=k[J];D=l.textContent;break}if(!l){l=g.createElementNS(b,"title");o.insertBefore(l,o.firstChild)}if(f.length)l.textContent=f;else l.parentNode.removeChild(l);C.addSubCommand(new Ma(l,{"#text":D}));
xa(C)};this.getEditorNS=function(f){f&&o.setAttribute("xmlns:se","http://svg-edit.googlecode.com");return"http://svg-edit.googlecode.com"};this.setResolution=function(f,k){var l=zb(),D=l.w;l=l.h;var C;if(f=="fit"){var J=getStrokedBBox();if(J){C=new Da("Fit Canvas to Content");var F=pb();qb(F);var B=[],H=[];$.each(F,function(){B.push(J.x*-1);H.push(J.y*-1)});F=c.moveSelectedElements(B,H,true);C.addSubCommand(F);ya();f=Math.round(J.width);k=Math.round(J.height)}else return false}if(f!=D||k!=l){F=d.suspendRedraw(1E3);
C||(C=new Da("Change Image Dimensions"));f=ta("width",f);k=ta("height",k);o.setAttribute("width",f);o.setAttribute("height",k);this.contentW=f;this.contentH=k;C.addSubCommand(new Ma(o,{width:D,height:l}));o.setAttribute("viewBox",[0,0,f/q,k/q].join(" "));C.addSubCommand(new Ma(o,{viewBox:["0 0",D,l].join(" ")}));xa(C);d.unsuspendRedraw(F);if(background=document.getElementById("canvas_background")){background.setAttribute("x",-1);background.setAttribute("y",-1);background.setAttribute("width",f+2);
background.setAttribute("height",k+2)}P("changed",[o])}return[f,k]};this.getOffset=function(){return $(o).attr(["x","y"])};this.setBBoxZoom=function(f,k,l){var D=0.85,C=function(J){if(!J)return false;var F=Math.min(Math.round(k/J.width*100*D)/100,Math.round(l/J.height*100*D)/100);c.setZoom(F);return{zoom:F,bbox:J}};if(typeof f=="object"){f=f;if(f.width==0||f.height==0){c.setZoom(f.zoom?f.zoom:q*f.factor);return{zoom:q,bbox:f}}return C(f)}switch(f){case "selection":if(!v[0])return;f=$.map(v,function(J){if(J)return J});
f=getStrokedBBox(f);break;case "canvas":f=zb();D=0.95;f={width:f.w,height:f.h,x:0,y:0};break;case "content":f=getStrokedBBox();break;case "layer":f=getStrokedBBox(pb(E().getCurrentLayer()));break;default:return}return C(f)};this.setZoom=function(f){var k=zb();o.setAttribute("viewBox","0 0 "+k.w/f+" "+k.h/f);q=f;$.each(v,function(l,D){D&&ra.requestSelector(D).resize()});La.zoomChange();ib("zoomChanged",f)};this.getMode=function(){return Ha};this.setMode=function(f){La.clear();bb.clear();$("#workarea").attr("class",
f);Xa=v[0]&&v[0].nodeName=="text"?Ua:s;Ha=f};this.getColor=function(f){return Xa[f]};this.setColor=function(f,k,l){s[f]=k;Xa[f+"_paint"]={type:"solidColor"};for(var D=[],C=v.length;C--;){var J=v[C];if(J)if(J.tagName=="g")svgedit.utilities.walkTree(J,function(F){F.nodeName!="g"&&D.push(F)});else if(f=="fill")J.tagName!="polyline"&&J.tagName!="line"&&D.push(J);else D.push(J)}if(D.length>0)if(l)Ab(f,k,D);else{Ya(f,k,D);P("changed",D)}};var gb=function(){var f=o.getElementsByTagNameNS(b,"defs");if(f.length>
0)f=f[0];else{f=g.createElementNS(b,"defs");o.firstChild?o.insertBefore(f,o.firstChild.nextSibling):o.appendChild(f)}return f},Nb=this.setGradient=function(f){if(!(!Xa[f+"_paint"]||Xa[f+"_paint"].type=="solidColor")){var k=c[f+"Grad"],l=Mb(k),D=gb();if(l)k=l;else{k=D.appendChild(g.importNode(k,true));k.id=oa()}c.setColor(f,"url(#"+k.id+")");if(f=="canvas")(f=document.getElementById("canvas_background"))&&f.setAttribute("fill","url(#"+k.id+")")}},Mb=function(f){var k=gb();k=$(k).find("linearGradient, radialGradient");
for(var l=k.length,D=["r","cx","cy","fx","fy"];l--;){var C=k[l];if(f.tagName=="linearGradient"){if(f.getAttribute("x1")!=C.getAttribute("x1")||f.getAttribute("y1")!=C.getAttribute("y1")||f.getAttribute("x2")!=C.getAttribute("x2")||f.getAttribute("y2")!=C.getAttribute("y2"))continue}else{var J=$(f).attr(D),F=$(C).attr(D),B=false;$.each(D,function(G,L){if(J[L]!=F[L])B=true});if(B)continue}var H=f.getElementsByTagNameNS(b,"stop"),h=C.getElementsByTagNameNS(b,"stop");if(H.length==h.length){for(var n=
H.length;n--;){var p=H[n],w=h[n];if(p.getAttribute("offset")!=w.getAttribute("offset")||p.getAttribute("stop-opacity")!=w.getAttribute("stop-opacity")||p.getAttribute("stop-color")!=w.getAttribute("stop-color"))break}if(n==-1)return C}}return null};this.setPaint=function(f,k){var l=new $.jGraduate.Paint(k);this.setPaintOpacity(f,l.alpha/100,true);Xa[f+"_paint"]=l;switch(l.type){case "solidColor":if(l.solidColor!="none"&&l.solidColor!="#none")this.setColor(f,"#"+l.solidColor);else{this.setColor(f,
"none");document.querySelector(f=="fill"?"#fill_color rect":"#stroke_color rect").setAttribute("fill","none")}break;case "linearGradient":case "radialGradient":c[f+"Grad"]=l[l.type];Nb(f)}};this.getStrokeWidth=function(){return Xa.stroke_width};this.setStrokeWidth=function(f){if(f==0&&["line","path"].indexOf(Ha)>=0)c.setStrokeWidth(1);else{Xa.stroke_width=f;for(var k=[],l=v.length;l--;){var D=v[l];if(D)D.tagName=="g"?svgedit.utilities.walkTree(D,function(C){C.nodeName!="g"&&k.push(C)}):k.push(D)}if(k.length>
0){Ya("stroke-width",f,k);P("changed",v)}}};this.setStrokeAttr=function(f,k){s[f.replace("-","_")]=k;for(var l=[],D=v.length;D--;){var C=v[D];if(C)C.tagName=="g"?svgedit.utilities.walkTree(C,function(J){J.nodeName!="g"&&l.push(J)}):l.push(C)}if(l.length>0){Ya(f,k,l);P("changed",v)}};this.getStyle=function(){return s};this.getOpacity=function(){return s.opacity};this.setOpacity=function(f){s.opacity=f;Ya("opacity",f)};this.getFillOpacity=function(){return s.fill_opacity};this.getStrokeOpacity=function(){return s.stroke_opacity};
this.setPaintOpacity=function(f,k,l){s[f+"_opacity"]=k;l?Ab(f+"-opacity",k):Ya(f+"-opacity",k)};this.getBlur=function(f){var k=0;if(f)if(f.getAttribute("filter"))if(f=pa(f.id+"_blur"))k=f.firstChild.getAttribute("stdDeviation");return k};(function(){function f(){var C=c.undoMgr.finishUndoableChange();k.addSubCommand(C);xa(k);l=k=null}var k=null,l=null,D=false;c.setBlurNoUndo=function(C){if(l)if(C===0){Ab("filter","");D=true}else{var J=v[0];D&&Ab("filter","url(#"+J.id+"_blur)");if(svgedit.browser.isWebkit()){J.removeAttribute("filter");
J.setAttribute("filter","url(#"+J.id+"_blur)")}Ab("stdDeviation",C,[l.firstChild]);c.setBlurOffsets(l,C)}else c.setBlur(C)};c.setBlurOffsets=function(C,J){if(J>3)ka(C,{x:"-50%",y:"-50%",width:"200%",height:"200%"},100);else if(!svgedit.browser.isWebkit()){C.removeAttribute("x");C.removeAttribute("y");C.removeAttribute("width");C.removeAttribute("height")}};c.setBlur=function(C,J){if(k)f();else{var F=v[0],B=F.id;l=pa(B+"_blur");C-=0;var H=new Da;if(l){if(C===0)l=null}else{var h=M({element:"feGaussianBlur",
attr:{"in":"SourceGraphic",stdDeviation:C}});l=M({element:"filter",attr:{id:B+"_blur"}});l.appendChild(h);gb().appendChild(l);H.addSubCommand(new Ia(l))}h={filter:F.getAttribute("filter")};if(C===0){F.removeAttribute("filter");H.addSubCommand(new Ma(F,h))}else{Ya("filter","url(#"+B+"_blur)");H.addSubCommand(new Ma(F,h));c.setBlurOffsets(l,C);k=H;c.undoMgr.beginUndoableChange("stdDeviation",[l?l.firstChild:null]);if(J){c.setBlurNoUndo(C);f()}}}}})();this.getBold=function(){var f=true;v.filter(Boolean).forEach(function(k){if(k.getAttribute("font-weight")!=
"bold")f=false});return f};this.setBold=function(f){var k=v.filter(Boolean);k.forEach(function(l){if(l!=null&&l.tagName=="text")Ya("font-weight",f?"bold":"normal")});k[0].textContent||bb.setCursor()};this.getItalic=function(){var f=true;v.filter(Boolean).forEach(function(k){if(k.getAttribute("font-style")!="italic")f=false});return f};this.setItalic=function(f){var k=v.filter(Boolean);k.forEach(function(l){if(l!=null&&l.tagName=="text")Ya("font-style",f?"italic":"normal")});k[0].textContent||bb.setCursor()};
this.getFontFamily=function(){return Ua.font_family};this.setFontFamily=function(f){Ua.font_family=f;Ya("font-family",f);v[0]&&!v[0].textContent&&bb.setCursor()};this.setFontColor=function(f){Ua.fill=f;Ya("fill",f)};this.getFontSize=function(){return Ua.fill};this.getFontSize=function(){return Ua.font_size};this.setFontSize=function(f){Ua.font_size=f;Ya("font-size",f);v[0].textContent||bb.setCursor()};this.getText=function(){var f=v[0];if(f==null)return"";return f.textContent};this.setTextContent=
function(f){Ya("#text",f);bb.init(f);bb.setCursor()};this.setImageURL=function(f){var k=v[0];if(k){var l=$(k).attr(["width","height"]);l=!l.width||!l.height;var D=ga(k);if(D!==f)l=true;else if(!l)return;var C=new Da("Change Image URL");W(k,f);C.addSubCommand(new Ma(k,{"#href":D}));l?$(new Image).load(function(){var J=$(k).attr(["width","height"]);$(k).attr({width:this.width,height:this.height});ra.requestSelector(k).resize();C.addSubCommand(new Ma(k,J));xa(C);P("changed",[k])}).attr("src",f):xa(C)}};
this.setLinkURL=function(f){var k=v[0];if(k){if(k.tagName!=="a"){k=$(k).parents("a");if(k.length)k=k[0];else return}var l=ga(k);if(l!==f){var D=new Da("Change Link URL");W(k,f);D.addSubCommand(new Ma(k,{"#href":l}));xa(D)}}};this.elementsAreSame=function(f){return!f.length||f[0]==null?null:v.every(function(k){return k&&v[0]?k.nodeName==v[0].nodeName:null})};this.setRectRadius=function(f){c.elementsAreSame(v)&&v[0].tagName=="rect"&&v.forEach(function(k){var l=k.getAttribute("rx");if(l!=f){k.setAttribute("rx",
f);k.setAttribute("ry",f);xa(new Ma(k,{rx:l,ry:l},"Radius"));P("changed",[k])}})};this.makeHyperlink=function(f){c.groupSelectedElements("a",f)};this.removeHyperlink=function(){c.ungroupSelectedElement()};this.setSegType=function(f){La.setSegType(f)};this.convertToPath=function(f,k){if(f==null)$.each(v,function(ea,X){X&&c.convertToPath(X)});else{if(!k)var l=new Da("Convert element to Path");var D=k?{}:{fill:s.fill,"fill-opacity":s.fill_opacity,stroke:s.stroke,"stroke-width":s.stroke_width,"stroke-dasharray":s.stroke_dasharray,
"stroke-linejoin":s.stroke_linejoin,"stroke-linecap":s.stroke_linecap,"stroke-opacity":s.stroke_opacity,opacity:s.opacity,visibility:"hidden"};$.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){if(f.getAttribute(this))D[this]=f.getAttribute(this)});var C=M({element:"path",attr:D}),J=f.getAttribute("transform");J&&C.setAttribute("transform",J);var F=f.id,B=f.parentNode;f.nextSibling?B.insertBefore(C,f):B.appendChild(C);var H="",h=function(ea){$.each(ea,function(X,ha){var ia=
ha[1];H+=ha[0];for(var Y=0;Y<ia.length;Y+=2)H+=ia[Y]+","+ia[Y+1]+" "})},n=1.81;switch(f.tagName){case "ellipse":case "circle":var p=$(f).attr(["rx","ry","cx","cy"]),w=p.cx,G=p.cy,L=p.rx;p=p.ry;if(f.tagName=="circle")L=p=$(f).attr("r");h([["M",[w-L,G]],["C",[w-L,G-p/n,w-L/n,G-p,w,G-p]],["C",[w+L/n,G-p,w+L,G-p/n,w+L,G]],["C",[w+L,G+p/n,w+L/n,G+p,w,G+p]],["C",[w-L/n,G+p,w-L,G+p/n,w-L,G]],["Z",[]]]);break;case "path":H=f.getAttribute("d");break;case "line":p=$(f).attr(["x1","y1","x2","y2"]);H="M"+p.x1+
","+p.y1+"L"+p.x2+","+p.y2;break;case "polyline":case "polygon":H="M"+f.getAttribute("points");break;case "rect":p=$(f).attr(["rx","ry"]);L=p.rx;p=p.ry;var O=f.getBBox();w=O.x;G=O.y;var Q=O.width;O=O.height;n=4-n;if(!L&&!p)h([["M",[w,G]],["L",[w+Q,G]],["L",[w+Q,G+O]],["L",[w,G+O]],["L",[w,G]],["Z",[]]]);else{p||(p=L);h([["M",[w,G+p]],["C",[w,G+p/n,w+L/n,G,w+L,G]],["L",[w+Q-L,G]],["C",[w+Q-L/n,G,w+Q,G+p/n,w+Q,G+p]],["L",[w+Q,G+O-p]],["C",[w+Q,G+O-p/n,w+Q-L/n,G+O,w+Q-L,G+O]],["L",[w+L,G+O]],["C",[w+
L/n,G+O,w,G+O-p/n,w,G+O-p]],["L",[w,G+p]],["Z",[]]])}break;default:C.parentNode.removeChild(C)}H&&C.setAttribute("d",H);if(k){La.resetOrientation(C);l=false;try{l=C.getBBox()}catch(aa){}C.parentNode.removeChild(C);return l}else{if(J){J=N(C);U(J)&&La.resetOrientation(C)}l.addSubCommand(new Fa(f,f.nextSibling,B));l.addSubCommand(new Ia(C));ya();f.parentNode.removeChild(f);C.setAttribute("id",F);C.removeAttribute("visibility");qb([C],true);xa(l)}}};var Ab=this.changeSelectedAttributeNoUndo=function(f,
k,l){var D=d.suspendRedraw(1E3);Ha=="pathedit"&&La.moveNode(f,k);l=l||v;for(var C=l.length,J=["g","polyline","path"];C--;){var F=l[C];if(F!=null){Ha==="textedit"&&f!=="#text"&&F.textContent.length&&bb.toSelectMode(F);if((f==="x"||f==="y")&&J.indexOf(F.tagName)>=0){var B=getStrokedBBox([F]);c.moveSelectedElements((f==="x"?k-B.x:0)*q,(f==="y"?k-B.y:0)*q,true)}else{B=f==="#text"?F.textContent:F.getAttribute(f);if(B==null)B="";if(B!==String(k)){if(f=="#text"){svgedit.utilities.getBBox(F);F.textContent=
k}else f=="#href"?W(F,k):F.setAttribute(f,k);v.indexOf(F)>=0&&setTimeout(function(){F.parentNode&&ra.requestSelector(F).resize()},0);B=ja(F);if(B!=0&&f!="transform")for(var H=N(F),h=H.numberOfItems;h--;)if(H.getItem(h).type==4){H.removeItem(h);var n=svgedit.utilities.getBBox(F),p=K(n.x+n.width/2,n.y+n.height/2,S(H).matrix);n=p.x;p=p.y;var w=d.createSVGTransform();w.setRotate(B,n,p);H.insertItemBefore(w,h);break}}}}}d.unsuspendRedraw(D)},Ya=this.changeSelectedAttribute=function(f,k,l){l=l||v;c.undoMgr.beginUndoableChange(f,
l);Ab(f,k,l);f=c.undoMgr.finishUndoableChange();f.isEmpty()||xa(f)};this.deleteSelectedElements=function(){for(var f=new Da("Delete Elements"),k=v.length,l=[],D=0;D<k;++D){var C=v[D];if(C==null)break;var J=C.parentNode,F=C;ra.releaseSelector(F);svgedit.path.removePath_(F.id);if(J.tagName==="a"&&J.childNodes.length===1){F=J;J=J.parentNode}var B=F.nextSibling;F=J.removeChild(F);l.push(C);v[D]=null;f.addSubCommand(new Fa(F,B,J))}f.isEmpty()||xa(f);P("changed",l);ya()};this.cutSelectedElements=function(){for(var f=
new Da("Cut Elements"),k=v.length,l=[],D=0;D<k;++D){var C=v[D];if(C==null)break;var J=C.parentNode,F=C;ra.releaseSelector(F);svgedit.path.removePath_(F.id);var B=F.nextSibling;F=J.removeChild(F);l.push(C);v[D]=null;f.addSubCommand(new Fa(F,B,J))}f.isEmpty()||xa(f);P("changed",l);ya();c.clipBoard=l};this.copySelectedElements=function(){c.clipBoard=$.merge([],v)};this.pasteElements=function(){var f=c.clipBoard,k=f.length;if(k){for(var l=[],D=new Da("Paste elements");k--;){var C=f[k];if(C){var J=ma(C);
if(!pa(C.id))J.id=C.id;l.push(J);(I||E().getCurrentLayer()).appendChild(J);D.addSubCommand(new Ia(J))}}svgCanvas.clearSelection();setTimeout(function(){rb(l)},100);xa(D);P("changed",l)}};this.groupSelectedElements=function(f){f||(f="g");var k="";switch(f){case "a":k="Make hyperlink";var l="";if(arguments.length>1)l=arguments[1];break;default:f="g";k="Group Elements"}k=new Da(k);var D=M({element:f,attr:{id:oa()}});f==="a"&&W(D,l);k.addSubCommand(new Ia(D));for(l=v.length;l--;){var C=v[l];if(C!=null){if(C.parentNode.tagName===
"a"&&C.parentNode.childNodes.length===1)C=C.parentNode;var J=C.nextSibling,F=C.parentNode;D.appendChild(C);k.addSubCommand(new Ja(C,J,F))}}k.isEmpty()||xa(k);rb([D],true)};var Db=this.pushGroupProperties=function(f,k){var l=f.childNodes,D=l.length,C=f.getAttribute("transform"),J=N(f),F=S(J).matrix,B=new Da("Push group properties"),H=0,h=ja(f),n=$(f).attr(["filter","opacity"]),p,w;for(H=0;H<D;H++){var G=l[H];if(G.nodeType===1){if(n.opacity!==null&&n.opacity!==1){G.getAttribute("opacity");var L=Math.round((G.getAttribute("opacity")||
1)*n.opacity*100)/100;Ya("opacity",L,[G])}if(n.filter){var O=L=this.getBlur(G);w||(w=this.getBlur(f));if(L)L=w-0+(L-0);else if(L===0)L=w;if(O)p=T(G.getAttribute("filter"));else if(p){p=ma(p);gb().appendChild(p)}else p=T(n.filter);p.id=G.id+"_"+(p.firstChild.tagName==="feGaussianBlur"?"blur":"filter");Ya("filter","url(#"+p.id+")",[G]);if(L){Ya("stdDeviation",L,[p.firstChild]);c.setBlurOffsets(p,L)}}L=N(G);if(~G.tagName.indexOf("Gradient"))L=null;if(L)if(G.tagName!=="defs")if(J.numberOfItems){if(h&&
J.numberOfItems==1){var Q=J.getItem(0).matrix,aa=d.createSVGMatrix();if(O=ja(G))aa=L.getItem(0).matrix;var ea=svgedit.utilities.getBBox(G),X=S(L).matrix,ha=K(ea.x+ea.width/2,ea.y+ea.height/2,X);ea=h+O;X=d.createSVGTransform();X.setRotate(ea,ha.x,ha.y);Q=Z(Q,aa,X.matrix.inverse());O&&L.removeItem(0);if(ea)L.numberOfItems?L.insertItemBefore(X,0):L.appendItem(X);if(Q.e||Q.f){O=d.createSVGTransform();O.setTranslate(Q.e,Q.f);L.numberOfItems?L.insertItemBefore(O,0):L.appendItem(O)}}else{O=G.getAttribute("transform");
Q={};Q.transform=O?O:"";O=d.createSVGTransform();Q=S(L).matrix;aa=Q.inverse();Q=Z(aa,F,Q);O.setMatrix(Q);L.appendItem(O)}(G=Ra(G))&&B.addSubCommand(G)}}}if(C){Q={};Q.transform=C;f.setAttribute("transform","");f.removeAttribute("transform");B.addSubCommand(new Ma(f,Q))}if(k&&!B.isEmpty())return B};this.ungroupSelectedElement=function(){var f=v[0];if($(f).data("gsvg")||$(f).data("symbol"))Lb(f);else if(f.tagName==="use"){var k=pa(ga(f).substr(1));$(f).data("symbol",k).data("ref",k);Lb(f)}else{k=$(f).parents("a");
if(k.length)f=k[0];if(f.tagName==="g"||f.tagName==="a"){k=new Da("Ungroup Elements");var l=Db(f,true);l&&k.addSubCommand(l);l=f.parentNode;for(var D=f.nextSibling,C=Array(f.childNodes.length),J=0;f.firstChild;){var F=f.firstChild,B=F.nextSibling,H=F.parentNode;if(F.tagName==="title"){k.addSubCommand(new Fa(F,F.nextSibling,H));H.removeChild(F)}else{C[J++]=F=l.insertBefore(F,D);k.addSubCommand(new Ja(F,B,H))}}ya();D=f.nextSibling;f=l.removeChild(f);k.addSubCommand(new Fa(f,D,l));k.isEmpty()||xa(k);
qb(C)}}};this.moveToTopSelectedElement=function(){var f=v.filter(Boolean).reverse(),k=new Da("Move to top");f.forEach(function(l){l=l;var D=l.parentNode,C=l.nextSibling;l=l.parentNode.appendChild(l);if(C!=l.nextSibling){k.addSubCommand(new Ja(l,C,D,"top"));P("changed",[l])}k.isEmpty()||xa(k)})};this.moveToBottomSelectedElement=function(){var f=v.filter(Boolean).reverse(),k=new Da("Move to top");f.forEach(function(l){l=l;var D=l.parentNode,C=l.nextSibling,J=l.parentNode.firstChild;if(J.tagName=="title")J=
J.nextSibling;if(J.tagName=="defs")J=J.nextSibling;l=l.parentNode.insertBefore(l,J);if(C!=l.nextSibling){k.addSubCommand(new Ja(l,C,D,"bottom"));P("changed",[l])}});k.isEmpty()||xa(k)};this.moveUpDownSelected=function(f){var k=v.filter(Boolean);f=="Down"&&k.reverse();var l=new Da("Move "+f);k.forEach(function(D){hb=[];var C,J,F=$(ob(getStrokedBBox([D]))).toArray();f=="Down"&&F.reverse();$.each(F,function(){if(J){C=this;return false}else if(this==D)J=true});if(C){F=D.parentNode;var B=D.nextSibling;
$(C)[f=="Down"?"before":"after"](D);if(B!=D.nextSibling){l.addSubCommand(new Ja(D,B,F,"Move "+f));P("changed",[D])}}});l.isEmpty()||xa(l)};this.moveSelectedElements=function(f,k,l){if(f.constructor!=Array){f/=q;k/=q}l=l||true;for(var D=new Da("position"),C=v.length;C--;){var J=v[C];if(J!=null){var F=d.createSVGTransform(),B=N(J);f.constructor==Array?F.setTranslate(f[C],k[C]):F.setTranslate(f,k);B.numberOfItems?B.insertItemBefore(F,0):B.appendItem(F);(F=Ra(J))&&D.addSubCommand(F);ra.requestSelector(J).resize()}}if(!D.isEmpty()){l&&
xa(D);P("changed",v);return D}};this.cloneSelectedElements=function(f,k,l){for(var D=new Da("Clone Elements"),C=v.length,J=0;J<C;++J){var F=v[J];if(F==null)break}C=v.slice(0,J);this.clearSelection(true);J=C.length;for(clones=[];J--;){F=C[J];var B=ma(C[J]),H=I||E().getCurrentLayer();if(l){tlist=N(B);tlist.removeItem(l);Ra(B);H.insertBefore(B,F)}else H.appendChild(B);clones.push(B);D.addSubCommand(new Ia(B))}if(!D.isEmpty()){qb(C.reverse());l||this.moveSelectedElements(f,k,false);xa(D)}return clones};
this.alignSelectedElements=function(f,k){var l=[],D=Number.MAX_VALUE,C=Number.MIN_VALUE,J=Number.MAX_VALUE,F=Number.MIN_VALUE,B=Number.MIN_VALUE,H=Number.MIN_VALUE,h=v.length;if(h){for(var n=0;n<h;++n){if(v[n]==null)break;l[n]=getStrokedBBox([v[n]]);switch(k){case "smallest":if((f=="l"||f=="c"||f=="r")&&(B==Number.MIN_VALUE||B>l[n].width)||(f=="t"||f=="m"||f=="b")&&(H==Number.MIN_VALUE||H>l[n].height)){D=l[n].x;J=l[n].y;C=l[n].x+l[n].width;F=l[n].y+l[n].height;B=l[n].width;H=l[n].height}break;case "largest":if((f==
"l"||f=="c"||f=="r")&&(B==Number.MIN_VALUE||B<l[n].width)||(f=="t"||f=="m"||f=="b")&&(H==Number.MIN_VALUE||H<l[n].height)){D=l[n].x;J=l[n].y;C=l[n].x+l[n].width;F=l[n].y+l[n].height;B=l[n].width;H=l[n].height}break;default:if(l[n].x<D)D=l[n].x;if(l[n].y<J)J=l[n].y;if(l[n].x+l[n].width>C)C=l[n].x+l[n].width;if(l[n].y+l[n].height>F)F=l[n].y+l[n].height}}if(k=="page"){J=D=0;C=c.contentW;F=c.contentH}B=Array(h);H=Array(h);for(n=0;n<h;++n){if(v[n]==null)break;var p=l[n];B[n]=0;H[n]=0;switch(f){case "l":B[n]=
D-p.x;break;case "c":B[n]=(D+C)/2-(p.x+p.width/2);break;case "r":B[n]=C-(p.x+p.width);break;case "t":H[n]=J-p.y;break;case "m":H[n]=(J+F)/2-(p.y+p.height/2);break;case "b":H[n]=F-(p.y+p.height)}}this.moveSelectedElements(B,H)}};this.contentW=zb().w;this.contentH=zb().h;this.updateCanvas=function(f,k){d.setAttribute("width",f);d.setAttribute("height",k);var l=$("#canvasBackground")[0],D=o.getAttribute("x"),C=o.getAttribute("y"),J=f/2-this.contentW*q/2,F=k/2-this.contentH*q/2;ka(o,{width:this.contentW*
q,height:this.contentH*q,x:J,y:F,viewBox:"0 0 "+this.contentW+" "+this.contentH});ka(l,{width:o.getAttribute("width"),height:o.getAttribute("height"),x:J,y:F});(l=pa("background_image"))&&ka(l,{width:"100%",height:"100%"});ra.selectorParentGroup.setAttribute("transform","translate("+J+","+F+")");return{x:J,y:F,old_x:D,old_y:C,d_x:J-D,d_y:F-C}};this.setBackground=function(f,k){var l=pa("canvasBackground"),D=$(l).find("rect")[0],C=pa("background_image");D.setAttribute("fill",f);if(k){if(!C){C=g.createElementNS(b,
"image");ka(C,{id:"background_image",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})}W(C,k);l.appendChild(C)}else C&&C.parentNode.removeChild(C)};this.cycleElement=function(f){var k=v[0],l=false,D=pb(I||E().getCurrentLayer());if(D.length){if(k==null){f=f?D.length-1:0;l=D[f]}else for(var C=D.length;C--;)if(D[C]==k){f=f?C-1:C+1;if(f>=D.length)f=0;else if(f<0)f=D.length-1;l=D[f];break}rb([l],true);P("selected",v)}};this.clear();this.getPrivateMethods=function(){return{addCommandToHistory:xa,
setGradient:Nb,addSvgElementFromJson:M,assignAttributes:ka,BatchCommand:Da,call:P,ChangeElementCommand:Ma,copyElem:ma,ffClone:fa,findDefs:gb,findDuplicateGradient:Mb,getElem:pa,getId:da,getIntersectionList:ob,getMouseTarget:Bb,getNextId:oa,getPathBBox:ba,getUrlFromAttr:na,hasMatrixTransform:U,identifyLayers:xb,InsertElementCommand:Ia,isIdentity:svgedit.math.isIdentity,logMatrix:Wa,matrixMultiply:Z,MoveElementCommand:Ja,preventClickDefault:Fb,recalculateAllSelectedDimensions:Ea,recalculateDimensions:Ra,
remapElement:Za,RemoveElementCommand:Fa,removeUnusedDefElems:yb,round:ab,runExtensions:ib,sanitizeSvg:Aa,SVGEditTransformList:svgedit.transformlist.SVGTransformList,toString:toString,transformBox:svgedit.math.transformBox,transformListToTransform:S,transformPoint:K,walkTree:svgedit.utilities.walkTree}}};(function(){document.addEventListener("touchstart",touchHandler,true);document.addEventListener("touchmove",touchHandler,true);document.addEventListener("touchend",touchHandler,true);document.addEventListener("touchcancel",touchHandler,true);if(!window.methodDraw)window.methodDraw=function(a){function u(d,o){var z=e.setSvgString(d)!==false;o=o||a.noop;z?o(true):a.alert(uiStrings.notification.errorLoadingSVG,function(){o(false)})}var e,b={},m=false;curConfig={canvas_expansion:1,dimensions:[740,520],
initFill:{color:"fff",opacity:1},initStroke:{width:1.5,color:"000",opacity:1},initOpacity:1,imgPath:"images/",extPath:"extensions/",jGraduatePath:"lib/jgraduate/images/",extensions:[],initTool:"select",wireframe:false,colorPickerCSS:false,gridSnapping:false,gridColor:"#000",baseUnit:"px",snappingStep:10,showRulers:svgedit.browser.isTouch()?false:true,show_outside_canvas:false,no_save_warning:true,initFont:"Helvetica, Arial, sans-serif"};uiStrings=b.uiStrings={common:{ok:"OK",cancel:"Cancel",key_up:"Up",
key_down:"Down",key_backspace:"Backspace",key_del:"Del"},layers:{layer:"Layer"},notification:{invalidAttrValGiven:"Invalid value given",noContentToFitTo:"No content to fit to",dupeLayerName:"There is already a layer named that!",enterUniqueLayerName:"Please enter a unique layer name",enterNewLayerName:"Please enter the new layer name",layerHasThatName:"Layer already has that name",QmoveElemsToLayer:'Move selected elements to layer "%s"?',QwantToClear:"<strong>Do you want to clear the drawing?</strong>\nThis will also erase your undo history",
QwantToOpen:"Do you want to open a new file?\nThis will also erase your undo history",QerrorsRevertToSource:"There were parsing errors in your SVG source.\nRevert back to original SVG source?",QignoreSourceChanges:"Ignore changes made to SVG source?",featNotSupported:"Feature not supported",enterNewImgURL:"Enter the new image URL",defsFailOnSave:"NOTE: Due to a bug in your browser, this image may appear wrong (missing gradients or elements). It will however appear correct once actually saved.",loadingImage:"Loading image, please wait...",
saveFromBrowser:'Select "Save As..." in your browser to save this image as a %s file.',noteTheseIssues:"Also note the following issues: ",unsavedChanges:"There are unsaved changes.",enterNewLinkURL:"Enter the new hyperlink URL",errorLoadingSVG:"Error: Unable to load SVG data",URLloadFail:"Unable to load from URL",retrieving:'Retrieving "%s" ...'}};var A={},c={};b.curConfig=curConfig;b.tool_scale=1;b.setConfig=function(d){a.extend(true,curConfig,d);if(d.extensions)curConfig.extensions=d.extensions};
b.setCustomHandlers=function(d){b.ready(function(){if(d.open){a('#tool_open > input[type="file"]').remove();a("#tool_open").show();e.open=d.open}if(d.save){b.show_save_warning=false;e.bind("saved",d.save)}d.pngsave&&e.bind("exported",d.pngsave);c=d})};b.randomizeIds=function(){e.randomizeIds(arguments)};b.init=function(){(function(){var h=window.opener;if(h)try{var n=h.document.createEvent("Event");n.initEvent("methodDrawReady",true,true);h.document.documentElement.dispatchEvent(n)}catch(p){}})();
(function(){a("body").toggleClass("touch",svgedit.browser.isTouch());var h=a.deparam.querystring(true);if(!a.isEmptyObject(h)){if(h.dimensions)h.dimensions=h.dimensions.split(",");if(h.extensions)h.extensions=h.extensions.split(",");if(h.bkgd_color)h.bkgd_color="#"+h.bkgd_color;methodDraw.setConfig(h);var n=h.source,p=a.param.querystring();if(!n)if(p.indexOf("source=data:")>=0)n=p.match(/source=(data:[^&]*)/)[1];if(n)if(n.indexOf("data:")===0){n=n.replace(/ /g,"+");b.loadFromDataURI(n)}else b.loadFromString(n);
else if(p.indexOf("paramurl=")!==-1)methodDraw.loadFromURL(p.substr(9));else h.url&&methodDraw.loadFromURL(h.url)}})();a("#canvas_width").val(curConfig.dimensions[0]);a("#canvas_height").val(curConfig.dimensions[1]);var d=function(){a.each(curConfig.extensions,function(){var h=this;a.getScript(curConfig.extPath+h,function(n){if(!n){n=document.createElement("script");n.src=curConfig.extPath+h;document.querySelector("head").appendChild(n)}})})};document.location.protocol==="file:"?setTimeout(d,100):
d();a.svgIcons(curConfig.imgPath+"svg_edit_icons.svg",{w:27,h:27,id_match:false,no_img:true,fallback_path:curConfig.imgPath,fallback:{logo:"logo.png",select:"select.png",select_node:"select_node.png",pencil:"pencil.png",pen:"line.png",rect:"square.png",ellipse:"ellipse.png",path:"path.png",text:"text.png",image:"image.png",zoom:"zoom.png","delete":"delete.png",spapelib:"shapelib.png",node_delete:"node_delete.png",align_left:"align-left.png",align_center:"align-center.png",align_right:"align-right.png",
align_top:"align-top.png",align_middle:"align-middle.png",align_bottom:"align-bottom.png",arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#logo":"logo","#tool_select":"select","#tool_fhpath":"pencil","#tool_line":"pen","#tool_rect,#tools_rect_show":"rect","#tool_ellipse,#tools_ellipse_show":"ellipse","#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_node_clone":"node_clone","#tool_node_delete":"node_delete","#tool_add_subpath":"add_subpath",
"#tool_openclose_path":"open_path","#tool_alignleft, #tool_posleft":"align_left","#tool_aligncenter, #tool_poscenter":"align_center","#tool_alignright, #tool_posright":"align_right","#tool_aligntop, #tool_postop":"align_top","#tool_alignmiddle, #tool_posmiddle":"align_middle","#tool_alignbottom, #tool_posbottom":"align_bottom","#cur_position":"align","#zoomLabel":"zoom"},resize:{"#logo .svg_icon":15,".flyout_arrow_horiz .svg_icon":5,"#fill_bg .svg_icon, #stroke_bg .svg_icon":svgedit.browser.isTouch()?
24:24,".palette_item:first .svg_icon":svgedit.browser.isTouch()?30:16,"#zoomLabel .svg_icon":16,"#zoom_dropdown .svg_icon":7},callback:function(){a(".toolbar_button button > svg, .toolbar_button button > img").each(function(){a(this).parent().prepend(this)});a(".tool_button, .tool_button_current").addClass("loaded");var h=a("#tools_left");if(h.length!=0){h.offset();h.outerHeight()}a(".tools_flyout").each(function(){var n=a("#"+this.id+"_show"),p=n.attr("data-curopt");if(!n.children("svg, img").length){p=
a(p).children().clone();if(p.length){p[0].removeAttribute("style");n.append(p)}}});methodDraw.runCallbacks();setTimeout(function(){a(".flyout_arrow_horiz:empty").each(function(){a(this).append(a.getSvgIcon("arrow_right").width(5).height(5))})},1)}});a("#rulers").on("dblclick",function(h){a("#base_unit_container").css({top:h.pageY-10,left:h.pageX-50,display:"block"})});a("#base_unit_container").on("mouseleave mouseenter",function(){t=setTimeout(function(){a("#base_unit_container").fadeOut(500)},200);
event.type=="mouseover"&&clearTimeout(t)});a("#base_unit").on("change",function(){savePreferences()});b.canvas=e=new a.SvgCanvas(document.getElementById("svgcanvas"),curConfig);b.show_save_warning=false;b.paintBox={fill:null,stroke:null,canvas:null};d=navigator.platform.indexOf("Mac")>=0;var o=navigator.userAgent.indexOf("AppleWebKit")>=0,z=d?"meta+":"ctrl+",E=e.pathActions,q=e.undoMgr,I=svgedit.utilities,R=curConfig.imgPath+"placeholder.svg",s=a("#workarea"),v=a("#cmenu_canvas"),M=null,N=1,K="toolbars",
Z="";d||a(".shortcut").each(function(){var h=a(this).text();a(this).text(h.split("\u2318").join("Ctrl+"))});(function(){a("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *",containment:"window"});var h=a("#dialog_box"),n=a("#dialog_buttons"),p=function(w,G,L,O){a("#dialog_content").html("<p>"+G.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt",w=="prompt");n.empty();var Q=a('<input type="button" value="'+uiStrings.common.ok+'">').appendTo(n);w!="alert"&&a('<input type="button" value="'+
uiStrings.common.cancel+'">').appendTo(n).on("click touchstart",function(){h.hide();L(false)});if(w=="prompt"){var aa=a('<input type="text">').prependTo(n);aa.val(O||"");aa.bind("keydown","return",function(){Q.trigger("click touchstart")})}w=="process"&&Q.hide();h.show();Q.on("click touchstart",function(){h.hide();var ea=w=="prompt"?aa.val():true;L&&L(ea)}).focus();w=="prompt"&&aa.focus()};a.alert=function(w,G){p("alert",w,G)};a.confirm=function(w,G){p("confirm",w,G)};a.process_cancel=function(w,
G){p("process",w,G)};a.prompt=function(w,G,L){p("prompt",w,L,G)}})();var U=function(){var h=a(".tool_button_current");if(h.length&&h[0].id!=="tool_select"){h.removeClass("tool_button_current").addClass("tool_button");a("#tool_select").addClass("tool_button_current").removeClass("tool_button")}e.setMode("select")},S=null,V=false,ca=false,ta="",na=function(h,n){var p=e.getResolution(),w=s;a("#svgcanvas").position();if(w=e.setBBoxZoom(n,w.width()-15,w.height()-15)){var G=w.zoom;w=w.bbox;if(G<0.001)xa({value:0.1});
else{typeof animatedZoom!="undefined"&&h.cancelAnimationFrame(animatedZoom);var L=Date.now(),O=G-p.zoom;a("#zoom");var Q=p.zoom,aa=function(){var ea=(Date.now()-L)/500;ea=Math.pow(ea-1,3)+1;e.setZoom(Q+O*ea);J();if(ea<1&&ea>-0.9)h.animatedZoom=requestAnimationFrame(aa);else{a("#zoom").val(parseInt(G*100));a("option","#zoom_select").removeAttr("selected");a("option[value="+parseInt(G*100)+"]","#zoom_select").attr("selected","selected")}};aa();e.getMode()=="zoom"&&w.width&&U();xb()}}};a("#cur_context_panel").delegate("a",
"click",function(){var h=a(this);h.attr("data-root")?e.leaveContext():e.setContext(h.text());e.clearSelection();return false});var ga=function(){b.paintBox.fill.prep();b.paintBox.stroke.prep()},W={},ba=function(h){a.each(h,function(n,p){var w=a(n).children(),G=n+"_show",L=a(G),O=false;w.addClass("tool_button").unbind("click mousedown mouseup").each(function(ea){var X=p[ea];W[X.sel]=X.fn;if(X.isDefault)O=ea;ea=function(ha){var ia=X;if(ha.type==="keydown"){var Y=a(ia.parent+"_show").hasClass("tool_button_current"),
qa=a(ia.parent+"_show").attr("data-curopt");a.each(h[X.parent],function(Ba,Ca){if(Ca.sel==qa)ia=!ha.shiftKey||!Y?Ca:h[X.parent][Ba+1]||h[X.parent][0]})}if(a(this).hasClass("disabled"))return false;ra(G)&&ia.fn();var va=ia.icon?a.getSvgIcon(ia.icon,true):a(ia.sel).children().eq(0).clone();va[0].setAttribute("width",L.width());va[0].setAttribute("height",L.height());L.children(":not(.flyout_arrow_horiz)").remove();L.append(va).attr("data-curopt",ia.sel)};a(this).mouseup(ea);X.key&&a(document).bind("keydown",
X.key[0]+" shift+"+X.key[0],ea)});if(O)L.attr("data-curopt",p[O].sel);else L.attr("data-curopt")||L.attr("data-curopt",p[0].sel);var Q,aa=a(G).position();a(n).css({left:aa.left+34,top:aa.top+77});L.mousedown(function(ea){a("#workarea").one("mousedown",function(){a("#tools_shapelib").hide()});a("#tools_shapelib").is(":visible")&&ra(G,false);if(L.hasClass("disabled"))return false;var X=a(n),ha=aa.left+34,ia=X.width()*-1,Y=X.data("shown_popop")?200:0;if(ea.currentTarget.id==="tools_shapelib_show")Y=
X.data("shown_popop")?0:0;Q=setTimeout(function(){L.data("isLibrary")?X.css("left",ha).show():X.css("left",ia).show().animate({left:ha},50);X.data("shown_popop",true)},Y);ea.preventDefault()}).mouseup(function(){clearTimeout(Q);var ea=a(this).attr("data-curopt");if(L.data("isLibrary")&&a(G.replace("_show","")).is(":visible"))ra(G,true);else ra(G)&&ea in W&&W[ea]()})});ka()},ja=function(h,n){return a("<div>",{"class":"tools_flyout",id:h}).appendTo("#svg_editor").append(n)},pa=function(){a(".tools_flyout").each(function(){var h=
a("#"+this.id+"_show"),n=h.offset();h=h.outerWidth();a(this).css({left:(n.left+h)*N,top:n.top})})},ka=function(){a(".tools_flyout").each(function(){var h=a("#"+this.id+"_show");if(!h.data("isLibrary")){var n=[];a(this).children().each(function(){n.push(this.title)});h[0].title=n.join(" / ")}})},la,za=function(h,n,p){var w=null;if(h.indexOf("url(#")===0){h=(h=e.getRefElem(h))?h.cloneNode(true):a("#"+p+"_color defs *")[0];w={alpha:n};w[h.tagName]=h}else w=h.indexOf("#")===0?{alpha:n,solidColor:h.substr(1)}:
{alpha:n,solidColor:"none"};return new a.jGraduate.Paint(w)},Aa=e.getResolution();if(curConfig.baseUnit!=="px"){Aa.w=svgedit.units.convertUnit(Aa.w)+curConfig.baseUnit;Aa.h=svgedit.units.convertUnit(Aa.h)+curConfig.baseUnit}var Ja=function(h){e.createLayer("background");cur_shape=e.addSvgElementFromJson({element:"rect",attr:{x:-1,y:-1,width:Aa.w+2,height:Aa.h+2,stroke:"none",id:"canvas_background",opacity:1,fill:h||"#fff",style:"pointer-events:none"}});e.setCurrentLayer("Layer 1");e.setCurrentLayerPosition("1")};
document.getElementById("canvas_background")||Ja();document.getElementById("canvas_background").getAttribute("fill");var Ia=b.setImageURL=function(h){h||(h=R);e.setImageURL(h);a("#image_url").val(h)},Fa=function(){var h=S;if(h!=null&&!h.parentNode)h=null;if(V&&V[0]!=null&&!V[0].parentNode)V=false;var n=e.getCurrentDrawing().getCurrentLayerName(),p=e.getMode(),w=curConfig.baseUnit!=="px"?curConfig.baseUnit:null,G=p=="pathedit";if(G){a(".context_panel").hide();a("#path_node_panel").show();a("#stroke_panel").hide();
n=E.getNodePoint();a("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button");a("#tool_node_delete").toggleClass("disabled",!E.canDeleteNodes);zb("#tool_openclose_path",E.closed_subpath?"open_path":"close_path");if(n){G=a("#seg_type");if(w){n.x=svgedit.units.convertUnit(n.x);n.y=svgedit.units.convertUnit(n.y)}a("#path_node_x").val(Math.round(n.x));a("#path_node_y").val(Math.round(n.y));if(n.type){G.val(n.type).removeAttr("disabled");a("#seg_type_label").html(n.type==4?"Straight":
"Curve")}else G.val(4).attr("disabled","disabled")}a("#tools_top").removeClass("multiselected");a("#stroke_panel").hide();a("#canvas_panel").hide()}else{var L=a("#cmenu_canvas li");a(".context_panel").hide();a(".menu_item","#edit_menu").addClass("disabled");a(".menu_item","#object_menu").addClass("disabled");if(V){V=V.filter(Boolean);(h=e.elementsAreSame(V)?V[0]:null)&&a("#tools_top").addClass("multiselected")}if(!h&&!V){a("#tools_top").removeClass("multiselected");a("#stroke_panel").hide();a("#canvas_panel").show()}if(h!=
null){a("#stroke_panel").show();var O=h.nodeName,Q=e.getRotationAngle(h);a("#angle").val(Math.round(Q));Q=e.getBlur(h);a("#blur").val(Q);if(!G&&p!="pathedit"){a("#selected_panel").show();a(".action_selected").removeClass("disabled");var aa,ea;if(["g","polyline","path"].indexOf(O)>=0)if(p=e.getStrokedBBox([h])){aa=p.x;ea=p.y}if(w){aa=svgedit.units.convertUnit(aa);ea=svgedit.units.convertUnit(ea)}a("#"+O+"_x").val(Math.round(aa));a("#"+O+"_y").val(Math.round(ea));if(O==="polyline"){a("#path_x").val(Math.round(aa));
a("#path_y").val(Math.round(ea))}["image","text","path","g","use"].indexOf(O)==-1&&a(".action_path_convert_selected").removeClass("disabled");O==="path"&&a(".action_path_selected").removeClass("disabled")}w=null;if(X==="a"){w=e.getHref(h);a("#g_panel").show()}if(h.parentNode.tagName==="a")if(!a(h).siblings().length){a("#a_panel").show();w=e.getHref(h.parentNode)}a("#tool_make_link, #tool_make_link").toggle(!w);w&&a("#link_url").val(w);w={g:[],a:[],rect:["rx","width","height","x","y"],image:["width",
"height","x","y"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:["x","y"],use:[],path:[]};var X=h.tagName;a(h).data("gsvg")&&a("#g_panel").show();if(X=="path"||X=="polyline")a("#path_panel").show();if(w[X]){w=w[X];a("#"+X+"_panel").show();X=="rect"?a("#cornerRadiusLabel").show():a("#cornerRadiusLabel").hide();a.each(w,function(ha,ia){var Y=h.getAttribute(ia);if(curConfig.baseUnit!=="px"&&h[ia])Y=svgedit.units.convertUnit(h[ia].baseVal.value);var qa=document.getElementById(X+
"_"+ia);qa.value=Math.round(Y)||0;qa.getAttribute("data-cursor")==="true"&&a.fn.dragInput.updateCursor(qa)});if(X=="text"){w=h.getAttribute("font-family");document.getElementById("font_family_dropdown").selectedIndex=3;a("#text_panel").css("display","inline");a("#tool_italic").toggleClass("active",e.getItalic());a("#tool_bold").toggleClass("active",e.getBold());a("#font_family").val(w);a("#font_size").val(h.getAttribute("font-size"));a("#text").val(h.textContent);a("#preview_font").text(w.split(",")[0].replace(/'/g,
"")).css("font-family",w);e.addedNew&&setTimeout(function(){a("#text").focus().select()},100)}else if(X=="image")Ia(e.getHref(h));else if(X==="g"||X==="use"){a("#container_panel").show();a(".action_group_selected").removeClass("disabled");e.getTitle()}}L[(X==="g"?"en":"dis")+"ableContextMenuItems"]("#ungroup");L[(X==="g"||!V?"dis":"en")+"ableContextMenuItems"]("#group")}if(V){a("#multiselected_panel").show();a(".action_multi_selected").removeClass("disabled");L.enableContextMenuItems("#group").disableContextMenuItems("#ungroup")}h||
L.disableContextMenuItems("#delete,#cut,#copy,#group,#ungroup,#move_front,#move_up,#move_down,#move_back");q.getUndoStackSize()>0?a("#tool_undo").removeClass("disabled"):a("#tool_undo").addClass("disabled");q.getRedoStackSize()>0?a("#tool_redo").removeClass("disabled"):a("#tool_redo").addClass("disabled");e.addedNew=false;if(h&&!G||V){a("#selLayerNames").removeAttr("disabled").val(n);v.enableContextMenuItems("#delete,#cut,#copy,#move_front,#move_up,#move_down,#move_back,#add_document")}}};a("#text").on("focus",
function(){});a("#text").on("blur",function(){});e.bind("selected",function(h,n){var p=e.getMode();p==="select"&&U();if(p==="pathedit")return Fa();S=n.length==1||n[1]==null?n[0]:null;n=n.filter(Boolean);V=n.length>=2?n:false;if(e.elementsAreSame(V))S=V[0];if(S!=null){a("#multiselected_panel").hide();if(S!=null)switch(S.tagName){case "use":a(".context_panel").hide();a("#use_panel").show();break;case "image":a(".context_panel").hide();a("#image_panel").show();break;case "foreignObject":a(".context_panel").hide();
break;case "g":case "a":p=null;for(var w=S.getElementsByTagName("*"),G=0,L=w.length;G<L;G++){var O=w[G].getAttribute("stroke-width");if(G===0)p=O;else if(p!==O)p=null}a("#stroke_width").val(p===null?"0":p);Fa();break;default:a("#stroke_width").val(S.getAttribute("stroke-width")||0);p=S.getAttribute("stroke-dasharray")||"none";a("option","#stroke_style").removeAttr("selected");a('#stroke_style option[value="'+p+'"]').attr("selected","selected");a("#stroke_style").trigger("change");a.fn.dragInput.updateCursor(a("#stroke_width")[0]);
a.fn.dragInput.updateCursor(a("#blur")[0])}if(S!=null){p=(S.getAttribute("opacity")||1)*100;a("#group_opacity").val(p);a.fn.dragInput.updateCursor(a("#group_opacity")[0])}V.length&&a("#tools_top").addClass("multiselected")}else if(V.length){a(".context_panel").hide();a("#tools_top").removeClass("multiselected");a("#multiselected_panel").show()}else{a(".context_panel").hide();a("#canvas_panel").show();a("#tools_top").removeClass("multiselected")}e.runExtensions("selectedChanged",{elems:n,selectedElement:S,
multiselected:V})});e.bind("transition",function(h,n){var p=e.getMode(),w=n[0];if(w){V=n.length>=2&&n[1]!=null?n:null;if(!V)switch(p){case "rotate":p=e.getRotationAngle(w);a("#angle").val(Math.round(p));rotateCursor(p);a("#tool_reorient").toggleClass("disabled",p==0)}e.runExtensions("elementTransition",{elems:n})}});e.bind("changed",function(h,n){var p=e.getMode();p==="select"&&U();for(var w=0;w<n.length;++w){var G=n[w];if(G&&G.tagName==="svg")J();else if(G&&S&&S.parentNode==null)S=G}b.show_save_warning=
true;Fa();if(S&&p==="select"){b.paintBox.fill.update();b.paintBox.stroke.update()}e.runExtensions("elementChanged",{elems:n})});e.bind("saved",function(h,n){b.show_save_warning=false;n='<?xml version="1.0"?>\n'+n;var p=navigator.userAgent;if(~p.indexOf("MSIE"))Eb(0,true);else{var w=h.open("data:image/svg+xml;base64,"+I.encode64(n)),G=a.pref("save_notice_done");if(G!=="all"){var L=uiStrings.notification.saveFromBrowser.replace("%s","SVG");if(p.indexOf("Gecko/")!==-1)if(n.indexOf("<defs")!==-1){L+=
"\n\n"+uiStrings.notification.defsFailOnSave;a.pref("save_notice_done","all");G="all"}else a.pref("save_notice_done","part");else a.pref("save_notice_done","all");G!=="part"&&w.alert(L)}}});e.bind("exported",function(h,n){var p=n.issues;a("#export_canvas").length||a("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var w=a("#export_canvas")[0];w.width=e.contentW;w.height=e.contentH;canvg(w,n.svg,{renderCallback:function(){var G=w.toDataURL("image/png");M.location.href=G;if(a.pref("export_notice_done")!==
"all"){G=uiStrings.notification.saveFromBrowser.replace("%s","PNG");if(p.length)G+="\n\n"+uiStrings.notification.noteTheseIssues+"\n \u2022 "+p.join("\n \u2022 ");a.pref("export_notice_done","all");M.alert(G)}}})});e.bind("zoomed",na);e.bind("contextset",function(h,n){var p="";if(n){var w="";p='<a href="#" data-root="y">'+e.getCurrentDrawing().getCurrentLayerName()+"</a>";a(n).parentsUntil("#svgcontent > g").andSelf().each(function(){if(this.id){w+=" > "+this.id;p+=this!==n?' > <a href="#">'+this.id+
"</a>":" > "+this.id}});ta=w}else ta=null;a("#cur_context_panel").toggle(!!n).html(p)});e.bind("extension_added",function(h,n){function p(){if(la){clearTimeout(la);la=null}G||(la=setTimeout(function(){G=true;Mb(A.iconsize)},50))}var w=false,G=false,L=true,O=function(){if(n.callback&&!w&&L){w=true;n.callback()}},Q=[];n.context_tools&&a.each(n.context_tools,function(ia,Y){var qa=Y.container_id?' id="'+Y.container_id+'"':"",va=a("#"+Y.panel);va.length||(va=a("<div>",{id:Y.panel}).appendTo("#tools_top").hide());
switch(Y.type){case "tool_button":var Ba='<div class="tool_button">'+Y.id+"</div>",Ca=a(Ba).appendTo(va);Y.events&&a.each(Y.events,function(Na,jb){a(Ca).bind(Na,jb)});break;case "select":Ba="<label"+qa+'><select id="'+Y.id+'">';a.each(Y.options,function(Na,jb){Ba+='<option value="'+Na+'"'+(Na==Y.defval?" selected":"")+">"+jb+"</option>"});Ba+="</select></label>";var Pa=a(Ba).appendTo(va).find("select");a.each(Y.events,function(Na,jb){a(Pa).bind(Na,jb)});break;case "button-select":Ba='<div id="'+Y.id+
'" class="dropdown toolset" title="'+Y.title+'"><div id="cur_'+Y.id+'" class="icon_label"></div><button></button></div>';qa=a('<ul id="'+Y.id+'_opts"></ul>').appendTo("#option_lists");Y.colnum&&qa.addClass("optcols"+Y.colnum);a(Ba).appendTo(va).children();Q.push({elem:"#"+Y.id,list:"#"+Y.id+"_opts",title:Y.title,callback:Y.events.change,cur:"#cur_"+Y.id});break;case "input":Ba="<label"+qa+'><span id="'+Y.id+'_label">'+Y.label+':</span><input id="'+Y.id+'" title="'+Y.title+'" size="'+(Y.size||"4")+
'" value="'+(Y.defval||"")+'" type="text"/></label>';var Qa=a(Ba).appendTo(va).find("input");Y.spindata&&Qa.SpinButton(Y.spindata);Y.events&&a.each(Y.events,function(Na,jb){Qa.bind(Na,jb)})}});if(n.buttons){var aa={},ea={},X=n.svgicons,ha={};a.each(n.buttons,function(ia,Y){for(var qa,va=Y.id,Ba=ia;a("#"+va).length;)va=Y.id+"_"+ ++Ba;if(X){aa[va]=Y.icon;Ba=Y.svgicon?Y.svgicon:Y.id;if(Y.type=="app_menu")ea["#"+va+" > div"]=Ba;else ea["#"+va]=Ba}else qa=Y.type=="menu"?"":a('<img src="'+Y.icon+'">');
var Ca,Pa;switch(Y.type){case "mode_flyout":case "mode":Ca="tool_button";if(Y.cls)Ca+=" "+Y.cls;Pa="#tools_left";break;case "context":Ca="tool_button";Pa="#"+Y.panel;a(Pa).length||a("<div>",{id:Y.panel}).appendTo("#tools_top");break;case "menu":Ca="menu_item tool_button";Pa="#"+(Y.after||Y.panel);break;case "app_menu":Ca="";Pa=Y.parent||"#main_menu ul";a(Pa).length||a("<div>",{id:Y.panel}).appendTo("#tools_top")}var Qa=a(Y.list||Y.type=="app_menu"?"<li/>":"<div/>").attr("id",va).attr("title",Y.title).addClass(Ca);
if(!Y.includeWith&&!Y.list){if("position"in Y)a(Pa).children().eq(Y.position).before(Qa);else Y.type!="menu"||!Y.after?Qa.appendTo(Pa):a(Pa).after(Qa);if(Y.type=="mode_flyout"){Ba=a(Qa);Ca=Ba.parent();if(!Ba.parent().hasClass("tools_flyout")){var Na=Ba[0].id.replace("tool_","tools_"),jb=Ba.clone().attr("id",Na+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));Ba.before(jb);Ca=ja(Na,Ba);Ca.data("isLibrary",true);jb.data("isLibrary",true)}ea["#"+Na+"_show"]=Y.id;va=ha["#"+Ca[0].id]=[{sel:"#"+
va,fn:Y.events.click,icon:Y.id,isDefault:true},ub]}else if(Y.type=="app_menu"||Y.type=="menu")Qa.append(Y.title)}else if(Y.list){Qa.addClass("push_button");a("#"+Y.list+"_opts").append(Qa);if(Y.isDefault){a("#cur_"+Y.list).append(Qa.children().clone());Ba=Y.svgicon?Y.svgicon:Y.id;ea["#cur_"+Y.list]=Ba}}else if(Y.includeWith){Pa=Y.includeWith;Ba=a(Pa.button);Ca=Ba.parent();if(!Ba.parent().hasClass("tools_flyout")){Na=Ba[0].id.replace("tool_","tools_");jb=Ba.clone().attr("id",Na+"_show").append(a("<div>",
{"class":"flyout_arrow_horiz"}));Ba.before(jb);Ca=ja(Na,Ba)}var ub=D.getButtonData(Pa.button);if(Pa.isDefault)ea["#"+Na+"_show"]=Y.id;va=ha["#"+Ca[0].id]=[{sel:"#"+va,fn:Y.events.click,icon:Y.id,key:Y.key,isDefault:Y.includeWith?Y.includeWith.isDefault:0},ub];Na="position"in Pa?Pa.position:"last";ub=Ca.children().length;if(!isNaN(Na)&&Na>=0&&Na<ub)Ca.children().eq(Na).before(Qa);else{Ca.append(Qa);va.reverse()}}X||Qa.append(qa);Y.list||a.each(Y.events,function(Cb,Jb){if(Cb=="click")if(Y.type=="mode"){Y.includeWith?
Qa.bind(Cb,Jb):Qa.bind(Cb,function(){ra(Qa)&&Jb()});if(Y.key){a(document).bind("keydown",Y.key,Jb);Y.title&&Qa.attr("title",Y.title+" ["+Y.key+"]")}}else Qa.bind(Cb,Jb);else Qa.bind(Cb,Jb)});ba(ha)});a.each(Q,function(){vb(this.elem,this.list,this.callback,{seticon:true})});if(X)L=false;a.svgIcons(X,{w:27,h:27,id_match:false,no_img:!o,fallback:aa,placement:ea,callback:function(){A.iconsize&&A.iconsize!="m"&&p();L=true;O()}})}O()});e.textActions.setInputElem(a("#text")[0]);var Ma='<div class="palette_item transparent" data-rgb="none"></div>\t\t\t\t\t\t\t\t<div class="palette_item black" data-rgb="#000000"></div>\t\t\t\t\t\t\t\t<div class="palette_item white" data-rgb="#ffffff"></div>';
["#444444","#482816","#422C10","#3B2F0E","#32320F","#293414","#1F361B","#153723","#0C372C","#083734","#0E353B","#1A333F","#273141","#332D40","#3E2A3C","#462735","#4B252D","#4D2425","#4C261D","#666666","#845335","#7B572D","#6F5C2A","#62612C","#546433","#46673D","#396849","#306856","#2D6862","#33666C","#426373","#535F75","#645A73","#74556D","#805064","#884D58","#8B4D4B","#894F3F","#999999","#C48157","#B8874D","#A98E49","#97944B","#849854","#729C62","#619E73","#559E84","#529D94","#5B9BA2","#6D97AB",
"#8391AE","#9A8AAB","#AF84A3","#BF7E96","#C97A86","#CE7975","#CC7C65","#BBBBBB","#FFB27C","#FABA6F","#E6C36A","#CFCA6D","#B8D078","#A0D58A","#8CD79F","#7DD8B5","#7AD6CA","#84D3DB","#9ACEE6","#B6C7EA","#D3BEE7","#EDB6DC","#FFAFCC","#FFAAB8","#FFA9A2","#FFAC8D","#DDDDDD","#FFE7A2","#FFF093","#FFFA8D","#FFFF91","#EEFF9F","#D1FFB4","#B9FFCE","#A8FFE9","#A4FFFF","#B1FFFF","#CBFFFF","#EDFFFF","#FFF5FF","#FFEBFF","#FFE2FF","#FFDCEC","#FFDBD2","#FFDFB8"].forEach(function(h){Ma+='<div class="palette_item" style="background-color: '+
h+';" data-rgb="'+h+'"></div>'});a("#palette").append(Ma);var Da=a("#tool_angle_indicator");a("#tool_reorient");rotateCursor=function(h){h="rotate("+h+"deg)";Da.css({"-webkit-transform":h,"-moz-transform":h,"-o-transform":h,"-ms-transform":h,transform:h})};var xa=function(h){var n=h.value/100;if(n<0.001)h.value=0.1;else{h=e.getZoom();var p=s;na(window,{width:0,height:0,x:(p[0].scrollLeft+p.width()/2)/h,y:(p[0].scrollTop+p.height()/2)/h,zoom:n},true)}};a("#stroke_style").change(function(){e.setStrokeAttr("stroke-dasharray",
a(this).val());a("#stroke_style_label").html(this.options[this.selectedIndex].text);window.opera&&a("<p/>").hide().appendTo("body").remove()});a("#seg_type").change(function(){e.setSegType(a(this).val());a("#seg_type_label").html(this.options[this.selectedIndex].text)});a("select").change(function(){a(this).blur()});a("#font_family").change(function(){e.setFontFamily(this.value)});a("#text").keyup(function(){e.setTextContent(this.value)});changeAttribute=function(h){var n=h.getAttribute("data-attr"),
p=h.getAttribute("data-multiplier")||1;p=parseFloat(p);p=h.value*p;if(!svgedit.units.isValidUnit(n,p,S)){a.alert(uiStrings.notification.invalidAttrValGiven);h.value=S.getAttribute(n);return false}e.changeSelectedAttributeNoUndo(n,p)};picking=false;a(document).on("mouseup",function(){picking=false});a("#palette").on("mousemove mousedown touchstart touchmove",".palette_item",function(h){h.preventDefault();if(h.type=="mousedown")picking=true;if(picking){var n=a("#tool_stroke").hasClass("active"),p=n?
"stroke":"fill",w=a(this).attr("data-rgb"),G=null,L=true;if(h.type=="mousedown")L=false;if(w==="transparent"||w==="initial"||w==="#none"){w="none";G=new a.jGraduate.Paint}else G=new a.jGraduate.Paint({alpha:100,solidColor:w.substr(1)});b.paintBox[p].setPaint(G);if(n){e.setColor("stroke",w,L);w!="none"&&e.getStrokeOpacity()!=1&&e.setPaintOpacity("stroke",1)}else{e.setColor("fill",w,L);w!="none"&&e.getFillOpacity()!=1&&e.setPaintOpacity("fill",1)}}}).bind("contextmenu",function(h){h.preventDefault()});
a("#toggle_stroke_tools").toggle(function(){a(".stroke_tool").css("display","table-cell");a(this).addClass("expanded");Db()},function(){a(".stroke_tool").css("display","none");a(this).removeClass("expanded");Db()});var ra=function(h,n){if(a(h).hasClass("disabled"))return false;if(a(h).parent().hasClass("tools_flyout"))return true;var p=p||"normal";n||a(".tools_flyout").fadeOut(p);a("#styleoverrides").text("");a(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");a(h).addClass("tool_button_current").removeClass("tool_button");
return true};(function(){var h=null,n=null,p=s[0],w=false,G=false;a("#svgcanvas").on("mousemove mouseup touchend",function(L){if(w!==false){p.scrollLeft-=L.clientX-h;p.scrollTop-=L.clientY-n;h=L.clientX;n=L.clientY;if(L.type==="mouseup"||L.type==="touchend")w=false;return false}}).on("mousedown touchmove",function(L){if(L.button===1||G===true||L.originalEvent.touches&&L.originalEvent.touches.length>=2){w=true;h=L.clientX;n=L.clientY;return false}});a(window).mouseup(function(){w=false});a(document).bind("keydown",
"space",function(L){L.preventDefault();e.spaceKey=G=true}).bind("keyup","space",function(L){L.preventDefault();e.spaceKey=G=false}).bind("keydown","alt",function(){e.getMode()==="zoom"&&s.addClass("out")}).bind("keyup","alt",function(){e.getMode()==="zoom"&&s.removeClass("out")})})();var wa=a(".menu"),kb=function(h){h.target.style.background="#fff";setTimeout(function(){h.target.style.background="#ddd"},50);setTimeout(function(){h.target.style.background="#fff"},150);setTimeout(function(){h.target.style.background=
"#ddd"},200);setTimeout(function(){h.target.style.background=""},200);setTimeout(function(){a("#menu_bar").removeClass("active")},220);return false};a(".menu_item").on("mousedown touchstart",function(h){kb(h)});a("svg, body").on("mousedown  touchstart",function(h){if(!(h.target.nodeName&&h.target.nodeName.toLowerCase()==="input"))if(!a(h.target).hasClass("menu_title")&&!a(h.target).parent().hasClass("menu_title"))!a(h.target).hasClass("disabled")&&a(h.target).hasClass("menu_item")?kb(h):a("#menu_bar").removeClass("active")});
a("#workarea").on("mousewheel",function(h,n,p,w){if(h.altKey){h.preventDefault();zoom=parseInt(a("#zoom").val());a("#zoom").val(parseInt(zoom+w*10)).change()}});a(".menu_title").on("mousedown",function(){a("#tools_shapelib").hide();a("#menu_bar").toggleClass("active");wa.removeClass("open");a(this).parent().addClass("open")}).on("mouseover",function(){wa.removeClass("open");a(this).parent().addClass("open")});b.addDropDown=function(h,n,p){if(a(h).length!=0){var w=a(h).find("button"),G=a(h).find("ul").attr("id",
a(h)[0].id+"-list");p||a("#option_lists").append(G);var L=false;p&&a(h).addClass("dropup");G.find("li").bind("mouseup",n);a(window).mouseup(function(){if(!L){w.removeClass("down");G.hide()}L=false});w.bind("mousedown",function(){if(w.hasClass("down")){w.removeClass("down");G.hide()}else{w.addClass("down");if(!p){var O=a(h).offset();G.css({top:O.top,left:O.left-110})}G.show();L=true}}).hover(function(){L=true}).mouseout(function(){L=false})}};var vb=function(h,n,p,w){var G=a(h);n=a(n);var L=false,
O=w.dropUp;O&&a(h).addClass("dropup");n.find("li").bind("mouseup",function(){if(w.seticon){zb("#cur_"+G[0].id,a(this).children());a(this).addClass("current").siblings().removeClass("current")}p.apply(this,arguments)});a(window).mouseup(function(){if(!L){G.removeClass("down");n.hide();n.css({top:0,left:0})}L=false});n.height();a(h).bind("mousedown",function(){var Q=a(h).offset();if(O){Q.top-=n.height();Q.left+=8}else Q.top+=a(h).height();a(n).offset(Q);if(G.hasClass("down")){G.removeClass("down");
n.hide();n.css({top:0,left:0})}else{G.addClass("down");n.show();L=true;return false}}).hover(function(){L=true}).mouseout(function(){L=false});w.multiclick&&n.mousedown(function(){L=true})};a("#font_family_dropdown").change(function(){var h=this.options[this.selectedIndex].value,n=this.options[this.selectedIndex].text;a("#preview_font").html(n).css("font-family",h);a("#font_family").val(h).change()});a("div","#position_opts").each(function(){this.addEventListener("mouseup",function(){var h=this.id.replace("tool_pos",
"").charAt(0);e.alignSelectedElements(h,"page")})});(function(){var h,n=function(){a(h).blur()};a("#svg_editor").find("button, select, input:not(#text)").focus(function(){h=this;K="toolbars";s.mousedown(n)}).blur(function(){K="canvas";s.unbind("mousedown",n);e.getMode()=="textedit"&&a("#text").focus()})})();var cb=function(){ra("#tool_select")&&e.setMode("select")},Ta=function(){ra("#tool_fhpath")&&e.setMode("fhpath")},Va=function(){ra("#tool_line")&&e.setMode("line")},Ga=function(){ra("#tool_rect")&&
e.setMode("rect")},ua=function(){ra("#tool_ellipse")&&e.setMode("ellipse")},$a=function(){ra("#tool_image")&&e.setMode("image")},Ka=function(){ra("#tool_zoom")&&e.setMode("zoom")},Sa=function(){if(ra("#tool_zoom")){yb();U()}},Ha=function(){ra("#tool_text")&&e.setMode("text")},db=function(){ra("#tool_path")&&e.setMode("path")},lb=function(){if(S!=null||V)e.deleteSelectedElements();E.getNodePoint()&&E.deletePathNode()},Ua=function(){if(S!=null||V){ya(a("#edit_menu"));e.cutSelectedElements()}},Xa=function(){if(S!=
null||V){ya(a("#edit_menu"));e.copySelectedElements()}},wb=function(){ya(a("#edit_menu"));var h=e.getZoom(),n=(s[0].scrollLeft+s.width()/2)/h-e.contentW;h=(s[0].scrollTop+s.height()/2)/h-e.contentH;e.pasteElements("point",n,h)},sa=function(){if(S!=null){ya(a("#object_menu"));e.moveToTopSelectedElement()}},hb=function(){if(S!=null){ya(a("#object_menu"));e.moveToBottomSelectedElement()}},eb=function(){if(S!=null){ya(a("#object_menu"));e.moveUpDownSelected("Up")}},sb=function(){if(S!=null){ya(a("#object_menu"));
e.moveUpDownSelected("Down")}},ib=function(h){if(S!=null){ya(a("#object_menu"));e.moveUpDownSelected(h)}},ab=function(){if(S!=null){e.convertToPath();var h=e.getSelectedElems();e.selectorManager.requestSelector(h[0]).reset(h[0]);e.selectorManager.requestSelector(h[0]).selectorRect.setAttribute("display","none");e.setMode("pathedit");E.toEditMode(h[0]);e.clearSelection();Fa()}},ob=function(){S!=null&&E.reorient()},pb=function(){if(S!=null||V)a.prompt(uiStrings.notification.enterNewLinkURL,"http://",
function(h){h&&e.makeHyperlink(h)})},fb=function(h,n){if(S!=null||V){if(curConfig.gridSnapping){var p=e.getZoom()*curConfig.snappingStep;h*=p;n*=p}a("input").blur();e.moveSelectedElements(h,n)}},tb=function(){},ma=function(){E.getNodePoint()&&E.clonePathNode()},da=function(){E.getNodePoint()&&E.deletePathNode()},oa=function(){var h=a("#tool_add_subpath"),n=!h.hasClass("push_button_pressed");n?h.addClass("push_button_pressed").removeClass("tool_button"):h.removeClass("push_button_pressed").addClass("tool_button");
E.addSubPath(n)},P=function(){E.opencloseSubPath()},T=function(){e.cycleElement(1)},fa=function(){e.cycleElement(0)},Ea=function(h,n){if(!(S==null||V)){h||(n*=-1);var p=a("#angle").val()*1+n;e.setRotationAngle(p);Fa()}},Oa=function(){var h=curConfig.dimensions;a.confirm(uiStrings.notification.QwantToClear,function(n){if(n){U();e.clear();e.setResolution(h[0],h[1]);J(true);yb();Fa();ga();e.runExtensions("onNewDocument")}})},Wa=function(){e.setBold(!e.getBold());Fa()},Za=function(){e.setItalic(!e.getItalic());
Fa()},nb=function(){if(!c.pngsave){var h=uiStrings.notification.loadingImage;M=window.open("data:text/html;charset=utf-8,<title>"+h+"</title><h1>"+h+"</h1>")}window.canvg?e.rasterExport():a.getScript("canvg/rgbcolor.js",function(){a.getScript("canvg/canvg.js",function(){e.rasterExport()})})},Ra=function(){e.open()},mb=function(){},ya=function(h){var n=h.prev();n.css({background:"white",color:"black"});setTimeout(function(){n.removeAttr("style")},200)},qb=function(){if(q.getUndoStackSize()>0){ya(a("#edit_menu"));
q.undo()}},rb=function(){if(q.getRedoStackSize()>0){ya(a("#edit_menu"));q.redo()}},Bb=function(){if(V){ya(a("#object_menu"));e.groupSelectedElements()}else if(S){ya(a("#object_menu"));e.ungroupSelectedElement()}},Fb=function(){ya(a("#edit_menu"));e.cloneSelectedElements(20,20)},bb=function(){var h=this.id.replace("tool_align","").charAt(0);e.alignSelectedElements(h,a("#align_relative_to").val())},La=function(){var h=document.querySelector("#tool_stroke rect");a("#tool_stroke").toggleClass("active");
a("#tool_fill").toggleClass("active");var n=document.querySelector("#tool_fill rect"),p=n.getAttribute("fill"),w=h.getAttribute("fill");h=parseFloat(h.getAttribute("stroke-opacity"));if(isNaN(h))h=100;n=parseFloat(n.getAttribute("fill-opacity"));if(isNaN(n))n=100;w=za(w,h,"stroke");p=za(p,n,"fill");b.paintBox.fill.setPaint(w,true);b.paintBox.stroke.setPaint(p,true)},yb=function(h){var n=e.getResolution();h=h?n.zoom*h:1;a("#zoom").val(h*100);e.setZoom(h);xb();J(true)},Hb=function(){ya(a("#view_menu"));
!a("#tool_wireframe").hasClass("push_button_pressed")?a("#tool_wireframe").addClass("push_button_pressed"):a("#tool_wireframe").removeClass("push_button_pressed");s.toggleClass("wireframe");if(!k){var h=a("#wireframe_rules");h.length?h.empty():a('<style id="wireframe_rules"></style>').appendTo("head");xb()}},Gb=function(){ya(a("#view_menu"));var h=!a("#tool_snap").hasClass("push_button_pressed");h?a("#tool_snap").addClass("push_button_pressed"):a("#tool_snap").removeClass("push_button_pressed");curConfig.gridSnapping=
h},Ib=function(){window.self!=window.top&&top.exit_fullscreen()},Lb=function(){ya(a("#view_menu"));if(a("#tool_rulers").hasClass("push_button_pressed")){a("#tool_rulers").removeClass("push_button_pressed");a("#show_rulers").attr("checked",false);curConfig.showRulers=false}else{a("#tool_rulers").addClass("push_button_pressed");a("#show_rulers").attr("checked",true);curConfig.showRulers=true}a("#rulers").toggle(!!curConfig.showRulers)},xb=function(){if(!k){var h="#workarea.wireframe #svgcontent * { stroke-width: "+
1/e.getZoom()+"px; }";a("#wireframe_rules").text(s.hasClass("wireframe")?h:"")}},Eb=function(h,n){if(!ca){ya(a("#view_menu"));ca=true;a("#save_output_btns").toggle(!!n);a("#tool_source_back").toggle(!n);var p=Z=e.getSvgString();a("#svg_source_textarea").val(p);a("#svg_source_editor").fadeIn();a("#svg_source_textarea").focus().select()}},Kb=function(){if(ca){if(e.setSvgString(a("#svg_source_textarea").val())){e.clearSelection();Ya();yb();ga()}else a.confirm(uiStrings.notification.QerrorsRevertToSource,
function(h){if(!h)return false;e.clearSelection();Ya();yb();ga()});U()}},zb=b.setIcon=function(h,n){var p=typeof n==="string"?a.getSvgIcon(n,true):n.clone();p?a(h).find("img").replaceWith(p):console.log("NOTE: Icon image missing: "+n)},gb;gb=function(){var h=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,n=document.getElementsByTagName("script")[0],p;for(p in n.style)if(h.test(p))return p.match(h)[0];if("WebkitOpacity"in n.style)return"Webkit";if("KhtmlOpacity"in n.style)return"Khtml";return""}();var Nb=
function(h,n){gb.toLowerCase();var p=["top","left","bottom","right"];h.each(function(){for(var w=a(this),G=w.outerWidth()*(n-1),L=w.outerHeight()*(n-1),O=0;O<4;O++){var Q=p[O],aa=w.data("orig_margin-"+Q);if(aa==null){aa=parseInt(w.css("margin-"+Q));w.data("orig_margin-"+Q,aa)}aa=aa*n;if(Q==="right")aa+=G;else if(Q==="bottom")aa+=L;w.css("margin-"+Q,aa)}})},Mb=b.setIconSize=function(h,n){if(!(h==A.size&&!n)){var p=a("#tools_top .toolset, #editor_panel > *, #history_panel > *,\t\t\t\t#main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,\t\t\t\t#g_panel > *, #tool_font_size > *, .tools_flyout"),
w=1;w=typeof h=="number"?h:{s:0.75,m:1,l:1.25,xl:1.5}[h];b.tool_scale=N=w;pa();var G=p.parents(":hidden");G.css("visibility","hidden").show();Nb(p,w);G.css("visibility","visible").hide();p=a("#tool_size_rules");if(p.length)p.empty();else p=a('<style id="tool_size_rules"></style>').appendTo("head");if(h!="m"){var L="";a.each(cssResizeRules,function(O,Q){O="#svg_editor "+O.replace(/,/g,", #svg_editor");L+=O+"{";a.each(Q,function(aa,ea){if(typeof ea==="number")var X=ea*w+"px";else if(ea[h]||ea.all)X=
ea[h]||ea.all;L+=aa+":"+X+";"});L+="}"});G="-"+gb.toLowerCase()+"-";L+="#tools_top .toolset, #editor_panel > *, #history_panel > *,\t\t\t\t#main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,\t\t\t\t#g_panel > *, #tool_font_size > *, .tools_flyout{"+G+"transform: scale("+w+");} #svg_editor div.toolset .toolset {"+G+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+G+"transform: scale("+1/w+");}";p.text(L)}pa()}},Ab=function(){a("#dialog_box").hide();
if(ca){if(ca)Z!==a("#svg_source_textarea").val()?a.confirm(uiStrings.notification.QignoreSourceChanges,function(h){h&&Ya()}):Ya();Db()}else ta&&e.leaveContext()},Ya=function(){a("#svg_source_editor").hide();ca=false;a("#svg_source_textarea").blur()};a(window).width();a(window).height();var Db=a.noop;a(window).resize(function(){J()});(function(){s.scroll(function(){if(a("#ruler_x").length!=0)a("#ruler_x")[0].scrollLeft=s[0].scrollLeft;if(a("#ruler_y").length!=0)a("#ruler_y")[0].scrollTop=s[0].scrollTop})})();
a("#url_notice").click(function(){a.alert(this.title)});a("#change_image_url").click(function(){var h=e.getHref(S);h=h.indexOf("data:")===0?"":h;a.prompt(uiStrings.notification.enterNewImgURL,h,function(n){n&&Ia(n)})});var f=function(h){var n=h[0].id=="stroke_color"?"stroke":"fill",p=h[0].id=="canvas_color";if(p)n="canvas";var w=b.paintBox[n].paint;h=n=="stroke"?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity";p=p?{right:175,top:50}:{left:50,bottom:50};a("#color_picker").draggable({cancel:".jGraduate_tabs, .jGraduate_colPick, .jGraduate_gradPick, .jPicker",
containment:"window"}).removeAttr("style").css(p).jGraduate({paint:w,window:{pickerTitle:h},images:{clientPath:curConfig.jGraduatePath},newstop:"inverse"},function(G){w=new a.jGraduate.Paint(G);b.paintBox[n].setPaint(w);e.setPaint(n,w);a("#color_picker").hide()},function(){a("#color_picker").hide()})};d=function(h,n){var p=document.getElementById("canvas_background"),w={color:"fff",opacity:1};if(n=="stroke")w=curConfig.initStroke;if(n=="fill")w=curConfig.initFill;if(n=="canvas"&&p)if(p=p.getAttribute("fill").match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))w=
{color:("0"+parseInt(p[1],10).toString(16)).slice(-2)+("0"+parseInt(p[2],10).toString(16)).slice(-2)+("0"+parseInt(p[3],10).toString(16)).slice(-2),opacity:1};p=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%"\t\t\t\t\tfill="#'+w.color+'" opacity="'+w.opacity+'"/>\t\t\t\t\t<defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml").documentElement;p=a(h)[0].appendChild(document.importNode(p,true));n==="canvas"?p.setAttribute("width",60.5):
p.setAttribute("width","100%");this.rect=p.firstChild;this.defs=p.getElementsByTagName("defs")[0];this.grad=this.defs.firstChild;this.paint=new a.jGraduate.Paint({solidColor:w.color});this.type=n;this.setPaint=function(G,L){this.paint=G;var O="none",Q=G.type,aa=G.alpha/100;switch(Q){case "solidColor":O=G[Q]=="none"||G[Q]=="one"?"none":"#"+G[Q];break;case "linearGradient":case "radialGradient":this.defs.removeChild(this.grad);this.grad=this.defs.appendChild(G[Q]);O="url(#"+(this.grad.id="gradbox_"+
this.type)+")"}this.rect.setAttribute("fill",O);this.rect.setAttribute("opacity",aa);if(this.type=="canvas")if(Q=document.getElementById("canvas_background")){Aa=e.getResolution();Q.setAttribute("x",-1);Q.setAttribute("y",-1);Q.setAttribute("width",Aa.w+2);Q.setAttribute("height",Aa.h+2);O.indexOf("url")==-1&&Q.setAttribute("fill",O)}else Ja(O);if(L){e.setColor(this.type,O,true);e.setPaintOpacity(this.type,aa,true)}};this.update=function(G){if(S){var L=this.type;switch(S.tagName){case "use":case "image":case "foreignObject":return;
case "g":case "a":for(var O=null,Q=S.getElementsByTagName("*"),aa=0,ea=Q.length;aa<ea;aa++){var X=Q[aa].getAttribute(L);if(aa===0)O=X;else if(O!==X){O=null;break}}if(O===null){Q=null;return}Q=O;O=1;break;default:O=parseFloat(S.getAttribute(L+"-opacity"));if(isNaN(O))O=1;Q=L==="fill"?"black":"none";Q=S.getAttribute(L)||Q}if(G){e.setColor(L,Q,true);e.setPaintOpacity(L,O,true)}O*=100;this.setPaint(za(Q,O,L))}};this.prep=function(){switch(this.paint.type){case "linearGradient":case "radialGradient":var G=
new a.jGraduate.Paint({copy:this.paint});e.setPaint(n,G)}}};b.paintBox.fill=new d("#fill_color","fill");b.paintBox.stroke=new d("#stroke_color","stroke");b.paintBox.canvas=new d("#canvas_color","canvas");a("#stroke_width").val(curConfig.initStroke.width);a("#group_opacity").val(curConfig.initOpacity*100);d=b.paintBox.fill.rect.cloneNode(false);d.setAttribute("style","vector-effect:non-scaling-stroke");var k=d.style.vectorEffect==="non-scaling-stroke";d.removeAttribute("style");d=b.paintBox.fill.rect.ownerDocument.createElementNS("http://www.w3.org/2000/svg",
"feGaussianBlur");typeof d.stdDeviationX==="undefined"&&a("#tool_blur").hide();a(d).remove();setTimeout(function(){e.embedImage("images/placeholder.svg",function(h){if(!h){a("#image_save_opts [value=embed]").attr("disabled","disabled");a("#image_save_opts input").val(["ref"]);A.img_save="ref";a("#image_opt_embed").css("color","#666").attr("title",uiStrings.notification.featNotSupported)}})},1E3);a("#tool_fill").click(function(){if(a("#tool_fill").hasClass("active"))f(a("#fill_color"));else{a("#tool_fill").addClass("active");
a("#tool_stroke").removeClass("active")}});a("#tool_stroke").on("click",function(){if(a("#tool_stroke").hasClass("active"))f(a("#stroke_color"));else{a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active")}});a("#tool_canvas").on("click touchstart",function(){f(a("#canvas_color"))});a("#tool_stroke").on("touchstart",function(){a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active");f(a("#stroke_color"))});a("#tool_fill").on("touchstart",function(){a("#tool_fill").addClass("active");
a("#tool_stroke").removeClass("active");f(a("#fill_color"))});a("#zoom_select").on("change",function(){var h=this.options[this.selectedIndex].text;h=h.split("%")[0];a("#zoom").val(h).trigger("change")});a(".push_button").mousedown(function(){a(this).hasClass("disabled")||a(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){a(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){a(this).removeClass("push_button_pressed").addClass("push_button")});
a(window).bind("load resize",function(){s.css("line-height",s.height()+"px")});var l=function(){var h=a("#canvas_width"),n=a("#canvas_height"),p=h.val(),w=n.val();if(p!="fit"&&!svgedit.units.isValidUnit("width",p)){a.alert(uiStrings.notification.invalidAttrValGiven);h.parent().addClass("error");return false}h.parent().removeClass("error");if(w!="fit"&&!svgedit.units.isValidUnit("height",w)){a.alert(uiStrings.notification.invalidAttrValGiven);n.parent().addClass("error");return false}n.parent().removeClass("error");
if(!e.setResolution(p,w)){a.alert(uiStrings.notification.noContentToFitTo);p=e.getResolution();h.val(p.w);n.val(p.h);return false}J()};a("#resolution").change(function(){var h=a("#canvas_width")[0],n=a("#canvas_height")[0];if(this.selectedIndex)if(this.value=="content"){h.value="fit";n.value="fit";l();var p=e.getResolution();h.value=p.w;n.value=p.h}else{var w=this.value.split("x");w[0]=parseInt(w[0]);w[1]=parseInt(w[1]);var G=w[0]-h.value,L=w[1]-n.value,O=Date.now(),Q=function(aa){aa=(aa-O)/1E3;aa=
Math.pow(aa-1,3)+1;h.value=(w[0]-G+aa*G).toFixed(0);n.value=(w[1]-L+aa*L).toFixed(0);l();if(aa>=1){aa=e.getResolution();a("#canvas_width").val(aa.w.toFixed());a("#canvas_height").val(aa.h.toFixed());a("#resolution_label").html("<div class='pull'>"+aa.w+"<span>\u00d7</span></br>"+aa.h+"</div>")}else requestAnimationFrame(Q)};Q(Date.now())}else{a("#resolution_label").html("Custom");h.removeAttribute("readonly");h.focus();h.select();if(h.value=="fit"){h.value=100;n.value=100}}});a("#zoom").change(function(){xa(this)});
a("input,select").attr("autocomplete","off");var D=function(){var h=[{sel:"#tool_select",fn:cb,evt:"click",key:["V",true]},{sel:"#tool_fhpath",fn:Ta,evt:"click",key:["Q",true]},{sel:"#tool_line",fn:Va,evt:"click",key:["L",true]},{sel:"#tool_rect",fn:Ga,evt:"click",key:["R",true],icon:"rect"},{sel:"#tool_ellipse",fn:ua,evt:"mouseup",key:["C",true],icon:"ellipse"},{sel:"#tool_path",fn:db,evt:"click",key:["P",true]},{sel:"#tool_text",fn:Ha,evt:"click",key:["T",true]},{sel:"#tool_image",fn:$a,evt:"mouseup"},
{sel:"#tool_zoom",fn:Ka,evt:"mouseup",key:["Z",true]},{sel:"#tool_clear",fn:Oa,evt:"mouseup",key:[z+"N",true]},{sel:"#tool_save",fn:function(){if(ca)Kb();else{ya(a("#file_menu"));e.save({images:A.img_save,round_digits:6})}},evt:"mouseup",key:[z+"S",true]},{sel:"#tool_export",fn:nb,evt:"mouseup"},{sel:"#tool_open",fn:Ra,evt:"mouseup"},{sel:"#tool_import",fn:mb,evt:"mouseup"},{sel:"#tool_source",fn:Eb,evt:"click",key:[z+"U",true]},{sel:"#tool_wireframe",fn:Hb,evt:"click"},{sel:"#tool_snap",fn:Gb,evt:"click"},
{sel:"#tool_rulers",fn:Lb,evt:"click"},{sel:"#tool_source_cancel,#svg_source_overlay,#tool_docprops_cancel,#tool_prefs_cancel",fn:Ab,evt:"click",key:["esc",false,false],hidekey:true},{sel:"#tool_source_save",fn:Kb,evt:"click"},{sel:"#tool_delete,#tool_delete_multi",fn:lb,evt:"click",key:["del/backspace",true]},{sel:"#tool_reorient",fn:ob,evt:"click"},{sel:"#tool_node_link",fn:tb,evt:"change"},{sel:"#tool_node_clone",fn:ma,evt:"click"},{sel:"#tool_node_delete",fn:da,evt:"click"},{sel:"#tool_openclose_path",
fn:P,evt:"click"},{sel:"#tool_add_subpath",fn:oa,evt:"click"},{sel:"#tool_move_top",fn:sa,evt:"click",key:z+"shift+up"},{sel:"#tool_move_bottom",fn:hb,evt:"click",key:z+"shift+down"},{sel:"#tool_move_up",fn:eb,evt:"click",key:[z+"up",true]},{sel:"#tool_move_down",fn:sb,evt:"click",key:[z+"down",true]},{sel:"#tool_topath",fn:ab,evt:"click"},{sel:"#tool_make_link,#tool_make_link_multi",fn:pb,evt:"click"},{sel:"#tool_clone,#tool_clone_multi",fn:Fb,evt:"click",key:[z+"D",true]},{sel:"#tool_group",fn:Bb,
evt:"click",key:[z+"G",true]},{sel:"#tool_ungroup",fn:Bb,evt:"click",key:z+"shift+G"},{sel:"#tool_unlink_use",fn:Bb,evt:"click"},{sel:"[id^=tool_align]",fn:bb,evt:"click"},{sel:"#tool_undo",fn:qb,evt:"click",key:z+"z"},{sel:"#tool_redo",fn:rb,evt:"click",key:["y",true]},{sel:"#tool_cut",fn:Ua,evt:"click",key:[z+"x",true]},{sel:"#tool_copy",fn:Xa,evt:"click",key:z+"c"},{sel:"#tool_paste",fn:wb,evt:"click",key:z+"v"},{sel:"#tool_switch",fn:La,evt:"click",key:["x",true]},{sel:"#tool_bold",fn:Wa,evt:"mousedown",
key:[z+"B",true]},{sel:"#tool_italic",fn:Za,evt:"mousedown",key:[z+"I",true]},{sel:"#copy_save_done",fn:Ab,evt:"click"},{key:"ctrl+left",fn:function(){Ea(0,1)}},{key:"ctrl+right",fn:function(){Ea(1,1)}},{key:"ctrl+shift+left",fn:function(){Ea(0,5)}},{key:"ctrl+shift+right",fn:function(){Ea(1,5)}},{key:"shift+O",fn:fa},{key:"shift+P",fn:T},{key:[z+"+",true],fn:function(){yb(2)}},{key:[z+"-",true],fn:function(){yb(0.5)}},{key:["up",true],fn:function(){fb(0,-1)}},{key:["down",true],fn:function(){fb(0,
1)}},{key:["left",true],fn:function(){fb(-1,0)}},{key:["right",true],fn:function(){fb(1,0)}},{key:"shift+up",fn:function(){fb(0,-10)}},{key:"shift+down",fn:function(){fb(0,10)}},{key:"shift+left",fn:function(){fb(-10,0)}},{key:"shift+right",fn:function(){fb(10,0)}},{key:["alt+up",true],fn:function(){e.cloneSelectedElements(0,-1)}},{key:["alt+down",true],fn:function(){e.cloneSelectedElements(0,1)}},{key:["alt+left",true],fn:function(){e.cloneSelectedElements(-1,0)}},{key:["alt+right",true],fn:function(){e.cloneSelectedElements(1,
0)}},{key:["alt+shift+up",true],fn:function(){e.cloneSelectedElements(0,-10)}},{key:["alt+shift+down",true],fn:function(){e.cloneSelectedElements(0,10)}},{key:["alt+shift+left",true],fn:function(){e.cloneSelectedElements(-10,0)}},{key:["alt+shift+right",true],fn:function(){e.cloneSelectedElements(10,0)}},{key:z+"A",fn:function(){e.selectAllInCurrentLayer()}},{key:"I",fn:function(){var p=a(".tool_button_current");if(p.length&&p[0].id!=="tool_eyedropper"){p.removeClass("tool_button_current").addClass("tool_button");
a("#tool_eyedropper").addClass("tool_button_current").removeClass("tool_button")}e.setMode("eyedropper")}},{key:z+"shift+z",fn:rb},{key:"esc",fn:Ib}],n={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"};return{setAll:function(){var p={};a.each(h,function(w,G){if(G.sel){var L=a(G.sel);if(L.length==0)return true;if(G.evt){if(svgedit.browser.isTouch()&&G.evt==="click")G.evt="mousedown";L[G.evt](G.fn)}if(G.parent&&a(G.parent+"_show").length!=0){var O=a(G.parent);O.length||(O=ja(G.parent.substr(1)));
O.append(L);a.isArray(p[G.parent])||(p[G.parent]=[]);p[G.parent].push(G)}}if(G.key){var Q=G.fn,aa=false;if(a.isArray(G.key)){O=G.key[0];if(G.key.length>1)aa=G.key[1]}else O=G.key;O+="";svgedit.browser.isMac&&O.indexOf("+")!=-1&&O.split("+")[0]=="ctrl"&&O.replace("ctrl","cmd");a.each(O.split("/"),function(X,ha){a(document).bind("keydown",ha,function(ia){Q();aa&&ia.preventDefault();return false})});if(G.sel&&!G.hidekey&&L.attr("title")){var ea=L.attr("title").split("[")[0]+" ("+O+")";n[O]=G.sel;L.parents("#main_menu").length||
L.attr("title",ea)}}});ba(p);a(window).bind("keydown","tab",function(w){if(K==="canvas"){w.preventDefault();T()}}).bind("keydown","shift+tab",function(w){if(K==="canvas"){w.preventDefault();fa()}});a("#tool_zoom").dblclick(Sa)},setTitles:function(){a.each(n,function(p,w){var G=a(w).parents("#main_menu").length;a(w).each(function(){var L=G?a(this).text().split(" [")[0]:this.title.split(" [")[0],O="";a.each(p.split("/"),function(Q,aa){var ea=aa.split("+"),X="";if(ea.length>1){X=ea[0]+"+";aa=ea[1]}O+=
(Q?"/":"")+X+(uiStrings["key_"+aa]||aa)});if(G)this.lastChild.textContent=L+" ["+O+"]";else this.title=L+" ["+O+"]"})})},getButtonData:function(p){var w;a.each(h,function(G,L){if(L.sel===p)w=L});return w}}}();D.setAll();b.ready(function(){var h=curConfig.initTool,n=a("#tools_left, #svg_editor .tools_flyout"),p=n.find("#tool_"+h);h=n.find("#"+h);(p.length?p:h.length?h:a("#tool_select")).click().mouseup();curConfig.wireframe&&a("#tool_wireframe").click();curConfig.showlayers&&toggleSidePanel();a("#rulers").toggle(!!curConfig.showRulers)});
a("#canvas_height").dragInput({min:10,max:null,step:10,callback:l,cursor:false,dragAdjust:0.1});a("#canvas_width").dragInput({min:10,max:null,step:10,callback:l,cursor:false,dragAdjust:0.1});a("#rect_width").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cy").dragInput({min:1,max:null,
step:1,callback:changeAttribute,cursor:false});a("#ellipse_rx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_ry").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cy").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_r").dragInput({min:1,
max:null,step:1,callback:changeAttribute,cursor:false});a("#image_height").dragInput({min:0,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,
cursor:false});a("#image_width").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_x").dragInput({min:null,
max:null,step:1,callback:changeAttribute,cursor:false});a("#path_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_x").dragInput({min:null,
max:null,step:1,callback:changeAttribute,cursor:false});a("#text_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#text_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_rx").dragInput({min:0,max:100,step:1,callback:changeAttribute,cursor:true});a("#stroke_width").dragInput({min:0,max:99,step:1,callback:function(h){var n=h.value;if(n==0&&
S&&["line","polyline"].indexOf(S.nodeName)>=0)n=h.value=1;e.setStrokeWidth(n)},cursor:true,smallStep:0.1,start:1.5});a("#angle").dragInput({min:-180,max:180,step:1,callback:function(h){e.setRotationAngle(h.value,true);rotateCursor(h.value);a("#tool_reorient").toggleClass("disabled",h.value==0)},cursor:false,dragAdjust:0.5});a("#font_size").dragInput({min:1,max:250,step:1,callback:function(h){e.setFontSize(h.value)},cursor:true,stepfunc:function(h,n){var p=h.value-0,w=p+n,G=w>=p;if(n===0)return p;
return p>=24?G?Math.round(p*1.1):Math.round(p/1.1):p<=1?G?p*2:p/2:w},dragAdjust:0.15});a("#group_opacity").dragInput({min:0,max:100,step:5,callback:changeAttribute,cursor:true,start:100});a("#blur").dragInput({min:0,max:10,step:0.1,callback:function(h,n){val=h.value;a("#blur").val(val);n?e.setBlur(val,true):e.setBlurNoUndo(val)},cursor:true,start:0});a("#zoom").val(e.getZoom()*100);a("#workarea").contextMenu({menu:"cmenu_canvas",inSpeed:0},function(h){switch(h){case "delete":lb();break;case "cut":Ua();
break;case "copy":Xa();break;case "paste":e.pasteElements();break;case "paste_in_place":e.pasteElements("in_place");break;case "group":e.groupSelectedElements();break;case "ungroup":e.ungroupSelectedElement();break;case "move_front":sa();break;case "move_up":ib("Up");break;case "move_down":ib("Down");break;case "move_back":hb();break;case "add_document":e.runExtensions("addDocument",{selectedElements:e.getSelectedElems()});break;default:svgedit.contextmenu&&svgedit.contextmenu.hasCustomHandler(h)&&
svgedit.contextmenu.getCustomHandler(h).call()}});a(".contextMenu li").mousedown(function(h){h.preventDefault()});a("#cmenu_canvas li").disableContextMenu();v.enableContextMenuItems("#delete,#cut,#copy");window.onbeforeunload=function(){if(q.getUndoStackSize()===0)b.show_save_warning=false;if(!curConfig.no_save_warning&&b.show_save_warning)return uiStrings.notification.unsavedChanges};b.openPrep=function(h){a("#main_menu").hide();q.getUndoStackSize()===0?h(true):a.confirm(uiStrings.notification.QwantToOpen,
h)};if(window.FileReader){d=function(h){h.stopPropagation();h.preventDefault();a("#workarea").removeAttr("style");a("#main_menu").hide();var n=null;if(n=h.type=="drop"?h.dataTransfer.files[0]:this.files[0])if(n.type.indexOf("image")!=-1)if(n.type.indexOf("svg")!=-1){h=new FileReader;h.onloadend=function(p){e.importSvgString(p.target.result,true);e.ungroupSelectedElement();e.ungroupSelectedElement();e.groupSelectedElements();e.alignSelectedElements("m","page");e.alignSelectedElements("c","page")};
h.readAsText(n)}else{h=new FileReader;h.onloadend=function(p){insertNewImage=function(O,Q){var aa=e.addSvgElementFromJson({element:"image",attr:{x:0,y:0,width:O,height:Q,id:e.getNextId(),style:"pointer-events:inherit"}});e.setHref(aa,p.target.result);e.selectOnly([aa]);e.alignSelectedElements("m","page");e.alignSelectedElements("c","page");Fa()};var w=100,G=100,L=new Image;L.src=p.target.result;document.body.appendChild(L);L.onload=function(){w=L.offsetWidth;G=L.offsetHeight;insertNewImage(w,G);document.body.removeChild(L)}};
h.readAsDataURL(n)}};s=a("#workarea");s[0].addEventListener("dragenter",function(h){h.stopPropagation();h.preventDefault();s.css({"-webkit-transform":"scale3d(1.1,1.1,1)","-moz-transform":"scale3d(1.1,1.1,1)","-o-transform":"scale(1.1)","-ms-transform":"scale3d(1.1,1.1,1)",transform:"scale3d(1.1,1.1,1)"})},false);s[0].addEventListener("dragover",function(h){h.stopPropagation();h.preventDefault()},false);s[0].addEventListener("dragleave",function(h){s.removeAttr("style");h.stopPropagation();h.preventDefault()},
false);s[0].addEventListener("drop",d,false);var C=a('<input type="file">').change(function(){var h=this;b.openPrep(function(n){if(n){e.clear();if(h.files.length==1){n=new FileReader;n.onloadend=function(p){u(p.target.result);J()};n.readAsText(h.files[0])}}})});a("#tool_open").show().prepend(C);d=a('<input type="file">').change(d);a("#tool_import").show().prepend(d)}var J=b.updateCanvas=function(h,n){var p=s.width(),w=s.height(),G=p,L=w,O=e.getZoom(),Q=s,aa=a("#svgcanvas"),ea={x:Q[0].scrollLeft+G/
2,y:Q[0].scrollTop+L/2},X=curConfig.canvas_expansion;p=Math.max(G,e.contentW*O*X);w=Math.max(L,e.contentH*O*X);p==G&&w==L?s.css("overflow","hidden"):s.css("overflow","scroll");X=aa.height()/2;var ha=aa.width()/2;aa.width(p).height(w);var ia=w/2,Y=p/2,qa=e.updateCanvas(p,w),va=Y/ha;p=p/2-G/2;w=w/2-L/2;if(n){n.x+=qa.x;n.y+=qa.y}else n={x:Y+(ea.x-ha)*va,y:ia+(ea.y-X)*va};if(h)if(e.contentW>Q.width()){s[0].scrollLeft=qa.x-10;s[0].scrollTop=qa.y-10}else{Q[0].scrollLeft=p;Q[0].scrollTop=w}else{Q[0].scrollLeft=
n.x-G/2;Q[0].scrollTop=n.y-L/2}if(curConfig.showRulers){G=aa;O=O;document.getElementById("workarea");document.getElementById("title_show");O||(O=e.getZoom());G||(G=a("#svgcanvas"));L=e.getContentElem();Q=svgedit.units.getTypeMap()[curConfig.baseUnit];for(aa=0;aa<2;aa++){ha=(ea=aa===0)?"x":"y";va=ea?"width":"height";X=L.getAttribute(ha)-0;ha=a("#ruler_"+ha+" canvas:first");$hcanv=ha.clone();ha.replaceWith($hcanv);p=$hcanv[0];ia=ha=G[va]()*2;p.parentNode.style[va]=ia+"px";Y=0;var Ba;qa=p.getContext("2d");
qa.fillStyle="rgb(200,0,0)";qa.fillRect(0,0,p.width,p.height);$hcanv.siblings().remove();if(ha>=3E4){var Ca=parseInt(ha/3E4)+1;Ba=Array(Ca);Ba[0]=qa;for(w=1;w<Ca;w++){p[va]=3E4;var Pa=p.cloneNode(true);p.parentNode.appendChild(Pa);Ba[w]=Pa.getContext("2d")}Pa[va]=ha%3E4;ha=3E4}p[va]=ha;va=Q*O;var Qa=50/va;p=1;for(w=0;w<F.length;w++){p=Ca=F[w];if(Qa<=Ca)break}Qa=p*va;qa.font="normal 9px 'Lucida Grande', sans-serif";qa.fillStyle="#777";for(var Na=X/va%p*va,jb=Na-Qa;Na<ia;Na+=Qa){jb+=Qa;w=Math.round(Na)+
0.5;if(ea){qa.moveTo(w,15);qa.lineTo(w,0)}else{qa.moveTo(15,w);qa.lineTo(0,w)}Ca=(jb-X)/va;if(p>=1)w=Math.round(Ca);else{w=(p+"").split(".")[1].length;w=Ca.toFixed(w)-0}if(w!==0&&w!==1E3&&w%1E3===0)w=w/1E3+"K";if(ea){qa.fillText(w,Na+2,8);qa.fillStyle="#777"}else{Ca=(w+"").split("");for(w=0;w<Ca.length;w++){qa.fillText(Ca[w],1,Na+9+w*9);qa.fillStyle="#777"}}Ca=Qa/10;for(w=1;w<10;w++){var ub=Math.round(Na+Ca*w)+0.5;if(Ba&&ub>ha){Y++;qa.stroke();if(Y>=Ba.length){w=10;Na=ia;continue}qa=Ba[Y];Na-=3E4;
ub=Math.round(Na+Ca*w)+0.5}var Cb=w%2?12:10;if(ea){qa.moveTo(ub,15);qa.lineTo(ub,Cb)}else{qa.moveTo(15,ub);qa.lineTo(Cb,ub)}}}qa.strokeStyle="#666";qa.stroke()}s.scroll()}},F=[];for(d=0.1;d<1E5;d*=10){F.push(1*d);F.push(2*d);F.push(5*d)}J(true);try{var B=function(h){if(window.JSON&&JSON.stringify)return JSON.stringify(h);var n=arguments.callee;if(typeof h=="boolean"||typeof h=="number")return h+"";else if(typeof h=="string")return'"'+h.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
function(G){return"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)})+'"';else if(h.length){for(var p=0;p<h.length;p++)h[p]=n(h[p]);return"["+h.join(",")+"]"}else{p=[];for(var w in h)p.push(n(w)+":"+n(h[w]));return"{"+p.join(",")+"}"}};window.addEventListener("message",function(h){var n=parseInt(h.data.substr(0,h.data.indexOf(";")));try{h.source.postMessage("SVGe"+n+";"+B(eval(h.data)),"*")}catch(p){h.source.postMessage("SVGe"+n+";error:"+p.message,"*")}},false)}catch(H){window.embed_error=H}a(function(){window.svgCanvas=
e;e.ready=methodDraw.ready});b.setLang=function(h,n){a.pref("lang",h);a("#lang_select").val(h);if(n){e.runExtensions("langChanged",h);ka();a.each({"#stroke_color":"#tool_stroke .icon_label, #tool_stroke .color_block","#fill_color":"#tool_fill label, #tool_fill .color_block","#linejoin_miter":"#cur_linejoin","#linecap_butt":"#cur_linecap"},function(p,w){a(w).attr("title",a(p)[0].title)});a("#multiselected_panel div[id^=tool_align]").each(function(){a("#tool_pos"+this.id.substr(10))[0].title=this.title})}}};
var g=[];b.ready=function(d){m?d():g.push(d)};b.runCallbacks=function(){a.each(g,function(){this()});m=true};b.loadFromString=function(d){b.ready(function(){u(d)})};b.loadFromURL=function(d,o){o||(o={});var z=o.cache,E=o.callback;b.ready(function(){a.ajax({url:d,dataType:"text",cache:!!z,success:function(q){u(q,E)},error:function(q,I,R){q.status!=404&&q.responseText?u(q.responseText,E):a.alert(uiStrings.notification.URLloadFail+": \n"+R+"",E)}})})};b.loadFromDataURI=function(d){b.ready(function(){var o=
d.substring(26);u(svgedit.utilities.decode64(o))})};b.addExtension=function(){var d=arguments;a(function(){e&&e.addExtension.apply(this,d)})};return b}(jQuery);$(methodDraw.init)})();$.fn.dragInput=function(a){return this.each(function(){this.repeating=false;this.dragCfg={min:a&&!isNaN(parseFloat(a.min))?Number(a.min):null,max:a&&!isNaN(parseFloat(a.max))?Number(a.max):null,step:a&&Number(a.step)?a.step:1,stepfunc:a&&a.stepfunc?a.stepfunc:false,dragAdjust:a&&a.dragAdjust?a.dragAdjust:1,height:70,cursor:a&&a.cursor?Boolean(a.cursor):false,start:a&&a.start?Number(a.start):0,_btn_width:20,_direction:null,_delay:null,_repeat:null,callback:a&&a.callback?a.callback:null};this.dragCfg.smallStep=
a&&a.smallStep?a.smallStep:this.dragCfg.step/2;var u=this.dragCfg.dragAdjust,e=$(this).parent(),b=$(this),m=this.dragCfg.height,A=this.dragCfg.min,c=this.dragCfg.max,g=this.dragCfg.step,d=c-A>0?(c-A)/g:200,o=d/m*g,z=0,E=this.getAttribute("data-attr"),q=methodDraw.canvas,I=svgedit.browser.isTouch(),R=true,s=d&&this.dragCfg.cursor?$("<div class='draginput_cursor' />").appendTo(e):false;b.attr("readonly","readonly");s&&!isNaN(this.dragCfg.start)&&s.css("top",this.dragCfg.start*-1/o+m);this.adjustValue=
function(v,M){var N;v=parseFloat(v);N=isNaN(this.value)?this.dragCfg.reset:$.isFunction(this.dragCfg.stepfunc)?this.dragCfg.stepfunc(this,v):Number((Number(this.value)+Number(v)).toFixed(5));if(c!==null)N=Math.min(N,c);if(A!==null)N=Math.max(N,A);s&&this.updateCursor(N);this.value=N;e.attr("data-value",N);$.isFunction(this.dragCfg.callback)&&this.dragCfg.callback(this,M)};e.toggleClass("draginput",e.is("label"));this.move=function(v,M,N){if(I)v=v.originalEvent.touches[0];if(z===0)z=M;M=(v.pageY-z)*
-1;z=v.pageY;N=M*o*u;this.adjustValue(N.toFixed(g<1?1:0))};this.stop=function(){var v=q.getSelectedElems();$("body").removeClass("dragging");e.removeClass("active");R=true;$(window).unbind("mousemove.draginput touchmove.draginput mouseup.draginput touchend.draginput");z=0;if(v[0]){v=q.undoMgr.finishUndoableChange();v.isEmpty()||q.undoMgr.addCommandToHistory(v)}this.adjustValue(0,R)};this.updateCursor=function(){var v=parseFloat(this.value)*-1/o+m;s.css("top",v)};this.launch=function(v){var M=q.getSelectedElems();
if(I)v=v.originalEvent.touches[0];var N=v.pageY,K=this.value,Z=this;q.undoMgr.beginUndoableChange(E,M);$("body").addClass("dragging");e.addClass("active");$(window).bind("mousemove.draginput touchmove.draginput",function(U){Z.move(U,N,parseFloat(K))});$(window).bind("mouseup.draginput touchend.draginput",function(){Z.stop()})};$(this).attr("readonly","readonly").attr("data-scale",o).attr("data-domain",m).attr("data-cursor",s!=false).bind("mousedown touchstart",function(v){this.blur();this.launch(v)}).bind("dblclick taphold",
function(){this.removeAttribute("readonly","readonly");this.focus();this.select()}).keydown(function(v){switch(v.keyCode){case 13:this.adjustValue(0);this.blur()}}).focus(function(){this.getAttribute("readonly")==="readonly"&&this.blur()}).blur(function(){this.setAttribute("readonly","readonly")}).bind("mousewheel",function(v,M,N,K){M=q.getSelectedElems();R&&q.undoMgr.beginUndoableChange(E,M);R=false;clearTimeout(window.undoTimeout);window.undoTimeout=setTimeout(function(){Z.stop()},200);var Z=this;
if(K>0)this.adjustValue(this.dragCfg.step);else K<0&&this.adjustValue(-this.dragCfg.step);v.preventDefault()})})};$.fn.dragInput.updateCursor=function(a){var u=parseFloat(a.value),e=parseFloat(a.getAttribute("data-scale")),b=parseFloat(a.getAttribute("data-domain"));u=u*-1/e+b+"px";a=a.parentNode.lastChild;if(a.className=="draginput_cursor")a.style.top=u};svgedit=svgedit||{};
(function(){var a=this;if(!svgedit.contextmenu)svgedit.contextmenu={};a.contextMenuExtensions={};methodDraw.ready(function(){for(menuItem in contextMenuExtensions){var u=contextMenuExtensions[menuItem];Object.keys(a.contextMenuExtensions).length==0&&$("#cmenu_canvas").append("<li class='separator'>");var e=u.shortcut||"";$("#cmenu_canvas").append("<li class='disabled'><a href='#"+u.id+"'>"+u.label+"<span class='shortcut'>"+e+"</span></a></li>")}});svgedit.contextmenu.resetCustomMenus=function(){a.contextMenuExtensions=
{}};svgedit.contextmenu.add=function(u){if(u&&u.id&&u.label&&u.action&&typeof u.action=="function")if(u.id in a.contextMenuExtensions)console.error('Cannot add extension "'+u.id+'", an extension by that name already exists"');else{console.log("Registed contextmenu item: {id:"+u.id+", label:"+u.label+"}");a.contextMenuExtensions[u.id]=u}else console.error("Menu items must be defined and have at least properties: id, label, action, where action must be a function")};svgedit.contextmenu.hasCustomHandler=
function(u){return a.contextMenuExtensions[u]&&true};svgedit.contextmenu.getCustomHandler=function(u){return a.contextMenuExtensions[u].action}})();(function(a,u){function e(m){return!a(m).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}function b(m,A){var c=m.nodeName.toLowerCase();if("area"===c){c=m.parentNode;var g=c.name;if(!m.href||!g||c.nodeName.toLowerCase()!=="map")return false;c=a("img[usemap=#"+g+"]")[0];return!!c&&e(c)}return(/input|select|textarea|button|object/.test(c)?!m.disabled:"a"==c?m.href||A:A)&&e(m)}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.17",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(m,A){return typeof m=="number"?this.each(function(){var c=
this;setTimeout(function(){a(c).focus();A&&A.call(c)},m)}):this._focus.apply(this,arguments)},scrollParent:function(){var m;a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?m=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):m=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,
"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!m.length?a(document):m},zIndex:function(m){if(m!==u)return this.css("zIndex",m);if(this.length){m=a(this[0]);for(var A;m.length&&m[0]!==document;){A=m.css("position");if(A==="absolute"||A==="relative"||A==="fixed"){A=parseInt(m.css("zIndex"),10);if(!isNaN(A)&&A!==0)return A}m=m.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(m){m.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(m,A){function c(z,E,q,I){a.each(g,function(){E-=parseFloat(a.curCSS(z,"padding"+this,true))||0;q&&(E-=parseFloat(a.curCSS(z,"border"+this+"Width",true))||0);I&&(E-=parseFloat(a.curCSS(z,"margin"+this,true))||0)});return E}var g=A==="Width"?["Left","Right"]:["Top","Bottom"],d=A.toLowerCase(),o={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,
outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+A]=function(z){if(z===u)return o["inner"+A].call(this);return this.each(function(){a(this).css(d,c(this,z)+"px")})};a.fn["outer"+A]=function(z,E){if(typeof z!="number")return o["outer"+A].call(this,z);return this.each(function(){a(this).css(d,c(this,z,true,E)+"px")})}}),a.extend(a.expr[":"],{data:function(m,A,c){return!!a.data(m,c[3])},focusable:function(m){return b(m,!isNaN(a.attr(m,"tabindex")))},tabbable:function(m){var A=a.attr(m,
"tabindex"),c=isNaN(A);return(c||A>=0)&&b(m,!c)}}),a(function(){var m=document.body,A=m.appendChild(A=document.createElement("div"));a.extend(A.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=A.offsetHeight===100;a.support.selectstart="onselectstart"in A;m.removeChild(A).style.display="none"}),a.extend(a.ui,{plugin:{add:function(m,A,c){m=a.ui[m].prototype;for(var g in c){m.plugins[g]=m.plugins[g]||[];m.plugins[g].push([A,c[g]])}},call:function(m,A,c){if((A=m.plugins[A])&&
m.element[0].parentNode)for(var g=0;g<A.length;g++)m.options[A[g][0]]&&A[g][1].apply(m.element,c)}},contains:function(m,A){return document.compareDocumentPosition?m.compareDocumentPosition(A)&16:m!==A&&m.contains(A)},hasScroll:function(m,A){if(a(m).css("overflow")==="hidden")return false;var c=A&&A==="left"?"scrollLeft":"scrollTop",g=false;if(m[c]>0)return true;m[c]=1;g=m[c]>0;m[c]=0;return g},isOverAxis:function(m,A,c){return m>A&&m<A+c},isOver:function(m,A,c,g,d,o){return a.ui.isOverAxis(m,c,d)&&
a.ui.isOverAxis(A,g,o)}}))})(jQuery);
(function(a,u){if(a.cleanData){var e=a.cleanData;a.cleanData=function(m){for(var A=0,c;(c=m[A])!=null;A++)try{a(c).triggerHandler("remove")}catch(g){}e(m)}}else{var b=a.fn.remove;a.fn.remove=function(m,A){return this.each(function(){A||(!m||a.filter(m,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(c){}});return b.call(a(this),m,A)})}}a.widget=function(m,A,c){var g=m.split(".")[0],d;m=m.split(".")[1];d=g+"-"+m;c||(c=A,A=a.Widget);a.expr[":"][d]=
function(o){return!!a.data(o,m)};a[g]=a[g]||{};a[g][m]=function(o,z){arguments.length&&this._createWidget(o,z)};A=new A;A.options=a.extend(true,{},A.options);a[g][m].prototype=a.extend(true,A,{namespace:g,widgetName:m,widgetEventPrefix:a[g][m].prototype.widgetEventPrefix||m,widgetBaseClass:d},c);a.widget.bridge(m,a[g][m])};a.widget.bridge=function(m,A){a.fn[m]=function(c){var g=typeof c=="string",d=Array.prototype.slice.call(arguments,1),o=this;c=!g&&d.length?a.extend.apply(null,[true,c].concat(d)):
c;if(g&&c.charAt(0)==="_")return o;g?this.each(function(){var z=a.data(this,m),E=z&&a.isFunction(z[c])?z[c].apply(z,d):z;if(E!==z&&E!==u){o=E;return false}}):this.each(function(){var z=a.data(this,m);z?z.option(c||{})._init():a.data(this,m,new A(c,this))});return o}};a.Widget=function(m,A){arguments.length&&this._createWidget(m,A)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(m,A){a.data(A,this.widgetName,this);this.element=a(A);this.options=
a.extend(true,{},this.options,this._getCreateOptions(),m);var c=this;this.element.bind("remove."+this.widgetName,function(){c.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(m,A){var c=m;if(arguments.length===0)return a.extend({},this.options);if(typeof m=="string"){if(A===u)return this.options[m];c={};c[m]=A}this._setOptions(c);return this},_setOptions:function(m){var A=this;a.each(m,function(c,g){A._setOption(c,g)});return this},_setOption:function(m,A){this.options[m]=A;m==="disabled"&&this.widget()[A?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
A);return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(m,A,c){var g,d=this.options[m];c=c||{};A=a.Event(A);A.type=(m===this.widgetEventPrefix?m:this.widgetEventPrefix+m).toLowerCase();A.target=this.element[0];if(m=A.originalEvent)for(g in m)g in A||(A[g]=m[g]);this.element.trigger(A,c);return!(a.isFunction(d)&&d.call(this.element[0],A,c)===false||A.isDefaultPrevented())}}})(jQuery);
(function(a){var u=false;a(document).mouseup(function(){u=false});a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(b){return e._mouseDown(b)}).bind("click."+this.widgetName,function(b){if(true===a.data(b.target,e.widgetName+".preventClickEvent")){a.removeData(b.target,e.widgetName+".preventClickEvent");b.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(e){if(!u){this._mouseStarted&&this._mouseUp(e);this._mouseDownEvent=e;var b=this,m=e.which==1,A=typeof this.options.cancel=="string"&&e.target.nodeName?a(e.target).closest(this.options.cancel).length:false;if(!m||A||!this._mouseCapture(e))return true;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){b.mouseDelayMet=true},this.options.delay));if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(e)!==
false;if(!this._mouseStarted){e.preventDefault();return true}}true===a.data(e.target,this.widgetName+".preventClickEvent")&&a.removeData(e.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(c){return b._mouseMove(c)};this._mouseUpDelegate=function(c){return b._mouseUp(c)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);e.preventDefault();return u=true}},_mouseMove:function(e){if(a.browser.msie&&
!(document.documentMode>=9)&&!e.button)return this._mouseUp(e);if(this._mouseStarted){this._mouseDrag(e);return e.preventDefault()}this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==false,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e));return!this._mouseStarted},_mouseUp:function(e){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&
(this._mouseStarted=false,e.target==this._mouseDownEvent.target&&a.data(e.target,this.widgetName+".preventClickEvent",true),this._mouseStop(e));return false},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){this.options.helper=="original"&&
!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(u){var e=this.options;
if(this.helper||e.disabled||a(u.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(u);if(!this.handle)return false;e.iframeFix&&a(e.iframeFix===true?"iframe":e.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")});return true},_mouseStart:function(u){var e=this.options;this.helper=
this._createHelper(u);this._cacheHelperProportions();a.ui.ddmanager&&(a.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:u.pageX-this.offset.left,top:u.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.originalPosition=this.position=this._generatePosition(u);this.originalPageX=u.pageX;this.originalPageY=u.pageY;e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt);e.containment&&this._setContainment();if(this._trigger("start",u)===false){this._clear();return false}this._cacheHelperProportions();a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,u);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(u,true);a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,u);return true},
_mouseDrag:function(u,e){this.position=this._generatePosition(u);this.positionAbs=this._convertPositionTo("absolute");if(!e){var b=this._uiHash();if(this._trigger("drag",u,b)===false){this._mouseUp({});return false}this.position=b.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,u);return false},_mouseStop:function(u){var e=
false;a.ui.ddmanager&&!this.options.dropBehaviour&&(e=a.ui.ddmanager.drop(this,u));this.dropped&&(e=this.dropped,this.dropped=false);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!e||this.options.revert=="valid"&&e||this.options.revert===true||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,e)){var b=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),
function(){b._trigger("stop",u)!==false&&b._clear()})}else this._trigger("stop",u)!==false&&this._clear();return false},_mouseUp:function(u){this.options.iframeFix===true&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,u);return a.ui.mouse.prototype._mouseUp.call(this,u)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(u){var e=!this.options.handle||
!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==u.target&&(e=true)});return e},_createHelper:function(u){var e=this.options;u=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[u])):e.helper=="clone"?this.element.clone().removeAttr("id"):this.element;u.parents("body").length||u.appendTo(e.appendTo=="parent"?this.element[0].parentNode:e.appendTo);u[0]!=this.element[0]&&!/(fixed|absolute)/.test(u.css("position"))&&
u.css("position","absolute");return u},_adjustOffsetFromHelper:function(u){typeof u=="string"&&(u=u.split(" "));a.isArray(u)&&(u={left:+u[0],top:+u[1]||0});"left"in u&&(this.offset.click.left=u.left+this.margins.left);"right"in u&&(this.offset.click.left=this.helperProportions.width-u.right+this.margins.left);"top"in u&&(this.offset.click.top=u.top+this.margins.top);"bottom"in u&&(this.offset.click.top=this.helperProportions.height-u.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=
this.helper.offsetParent();var u=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(u.left+=this.scrollParent.scrollLeft(),u.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)u={top:0,left:0};return{top:u.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:u.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var u=this.element.position();return{top:u.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:u.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),
10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var u=this.options;u.containment=="parent"&&(u.containment=this.helper[0].parentNode);if(u.containment=="document"||u.containment=="window")this.containment=[u.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,u.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,
(u.containment=="document"?0:a(window).scrollLeft())+a(u.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(u.containment=="document"?0:a(window).scrollTop())+(a(u.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(u.containment)&&u.containment.constructor!=Array){u=a(u.containment);var e=u[0];if(e){u.offset();var b=a(e).css("overflow")!=
"hidden";this.containment=[(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0),(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),10)||0),(b?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),10)||0)-(parseInt(a(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),
10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=u}}else u.containment.constructor==Array&&(this.containment=u.containment)},_convertPositionTo:function(u,e){e||(e=this.position);var b=u=="absolute"?1:-1,m=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,A=/(html|body)/i.test(m[0].tagName);return{top:e.top+
this.offset.relative.top*b+this.offset.parent.top*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():A?0:m.scrollTop())*b),left:e.left+this.offset.relative.left*b+this.offset.parent.left*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():A?0:m.scrollLeft())*b)}},_generatePosition:function(u){var e=this.options,b=this.cssPosition=="absolute"&&
(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,m=/(html|body)/i.test(b[0].tagName),A=u.pageX,c=u.pageY;if(this.originalPosition){var g;if(this.containment){if(this.relative_container){g=this.relative_container.offset();g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]}else g=this.containment;u.pageX-this.offset.click.left<g[0]&&(A=g[0]+this.offset.click.left);
u.pageY-this.offset.click.top<g[1]&&(c=g[1]+this.offset.click.top);u.pageX-this.offset.click.left>g[2]&&(A=g[2]+this.offset.click.left);u.pageY-this.offset.click.top>g[3]&&(c=g[3]+this.offset.click.top)}if(e.grid){c=e.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/e.grid[1])*e.grid[1]:this.originalPageY;c=g?c-this.offset.click.top<g[1]||c-this.offset.click.top>g[3]?c-this.offset.click.top<g[1]?c+e.grid[1]:c-e.grid[1]:c:c;A=e.grid[0]?this.originalPageX+Math.round((A-this.originalPageX)/
e.grid[0])*e.grid[0]:this.originalPageX;A=g?A-this.offset.click.left<g[0]||A-this.offset.click.left>g[2]?A-this.offset.click.left<g[0]?A+e.grid[0]:A-e.grid[0]:A:A}}return{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():m?0:b.scrollTop()),left:A-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<
526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():m?0:b.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(u,e,b){b=b||this._uiHash();a.ui.plugin.call(this,u,[e,b]);u=="drag"&&(this.positionAbs=this._convertPositionTo("absolute"));return a.Widget.prototype._trigger.call(this,u,e,
b)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.17"});a.ui.plugin.add("draggable","connectToSortable",{start:function(u,e){var b=a(this).data("draggable"),m=b.options,A=a.extend({},e,{item:b.element});b.sortables=[];a(m.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(b.sortables.push({instance:c,shouldRevert:c.options.revert}),
c.refreshPositions(),c._trigger("activate",u,A))})},stop:function(u,e){var b=a(this).data("draggable"),m=a.extend({},e,{item:b.element});a.each(b.sortables,function(){this.instance.isOver?(this.instance.isOver=0,b.cancelHelperRemoval=true,this.instance.cancelHelperRemoval=false,this.shouldRevert&&(this.instance.options.revert=true),this.instance._mouseStop(u),this.instance.options.helper=this.instance.options._helper,b.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):
(this.instance.cancelHelperRemoval=false,this.instance._trigger("deactivate",u,m))})},drag:function(u,e){var b=a(this).data("draggable"),m=this;a.each(b.sortables,function(){this.instance.positionAbs=b.positionAbs;this.instance.helperProportions=b.helperProportions;this.instance.offset.click=b.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(m).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",
true),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return e.helper[0]},u.target=this.instance.currentItem[0],this.instance._mouseCapture(u,true),this.instance._mouseStart(u,true,true),this.instance.offset.click.top=b.offset.click.top,this.instance.offset.click.left=b.offset.click.left,this.instance.offset.parent.left-=b.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=b.offset.parent.top-this.instance.offset.parent.top,
b._trigger("toSortable",u),b.dropped=this.instance.element,b.currentItem=b.element,this.instance.fromOutside=b),this.instance.currentItem&&this.instance._mouseDrag(u)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=true,this.instance.options.revert=false,this.instance._trigger("out",u,this.instance._uiHash(this.instance)),this.instance._mouseStop(u,true),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&
this.instance.placeholder.remove(),b._trigger("fromSortable",u),b.dropped=false)})}});a.ui.plugin.add("draggable","cursor",{start:function(){var u=a("body"),e=a(this).data("draggable").options;u.css("cursor")&&(e._cursor=u.css("cursor"));u.css("cursor",e.cursor)},stop:function(){var u=a(this).data("draggable").options;u._cursor&&a("body").css("cursor",u._cursor)}});a.ui.plugin.add("draggable","opacity",{start:function(u,e){var b=a(e.helper),m=a(this).data("draggable").options;b.css("opacity")&&(m._opacity=
b.css("opacity"));b.css("opacity",m.opacity)},stop:function(u,e){var b=a(this).data("draggable").options;b._opacity&&a(e.helper).css("opacity",b._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var u=a(this).data("draggable");u.scrollParent[0]!=document&&u.scrollParent[0].tagName!="HTML"&&(u.overflowOffset=u.scrollParent.offset())},drag:function(u){var e=a(this).data("draggable"),b=e.options,m=false;if(e.scrollParent[0]!=document&&e.scrollParent[0].tagName!="HTML"){if(!b.axis||
b.axis!="x")e.overflowOffset.top+e.scrollParent[0].offsetHeight-u.pageY<b.scrollSensitivity?e.scrollParent[0].scrollTop=m=e.scrollParent[0].scrollTop+b.scrollSpeed:u.pageY-e.overflowOffset.top<b.scrollSensitivity&&(e.scrollParent[0].scrollTop=m=e.scrollParent[0].scrollTop-b.scrollSpeed);if(!b.axis||b.axis!="y")e.overflowOffset.left+e.scrollParent[0].offsetWidth-u.pageX<b.scrollSensitivity?e.scrollParent[0].scrollLeft=m=e.scrollParent[0].scrollLeft+b.scrollSpeed:u.pageX-e.overflowOffset.left<b.scrollSensitivity&&
(e.scrollParent[0].scrollLeft=m=e.scrollParent[0].scrollLeft-b.scrollSpeed)}else{if(!b.axis||b.axis!="x")u.pageY-a(document).scrollTop()<b.scrollSensitivity?m=a(document).scrollTop(a(document).scrollTop()-b.scrollSpeed):a(window).height()-(u.pageY-a(document).scrollTop())<b.scrollSensitivity&&(m=a(document).scrollTop(a(document).scrollTop()+b.scrollSpeed));if(!b.axis||b.axis!="y")u.pageX-a(document).scrollLeft()<b.scrollSensitivity?m=a(document).scrollLeft(a(document).scrollLeft()-b.scrollSpeed):
a(window).width()-(u.pageX-a(document).scrollLeft())<b.scrollSensitivity&&(m=a(document).scrollLeft(a(document).scrollLeft()+b.scrollSpeed))}m!==false&&a.ui.ddmanager&&!b.dropBehaviour&&a.ui.ddmanager.prepareOffsets(e,u)}});a.ui.plugin.add("draggable","snap",{start:function(){var u=a(this).data("draggable"),e=u.options;u.snapElements=[];a(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=a(this),m=b.offset();this!=u.element[0]&&u.snapElements.push({item:this,
width:b.outerWidth(),height:b.outerHeight(),top:m.top,left:m.left})})},drag:function(u,e){for(var b=a(this).data("draggable"),m=b.options,A=m.snapTolerance,c=e.offset.left,g=c+b.helperProportions.width,d=e.offset.top,o=d+b.helperProportions.height,z=b.snapElements.length-1;z>=0;z--){var E=b.snapElements[z].left,q=E+b.snapElements[z].width,I=b.snapElements[z].top,R=I+b.snapElements[z].height;if(E-A<c&&c<q+A&&I-A<d&&d<R+A||E-A<c&&c<q+A&&I-A<o&&o<R+A||E-A<g&&g<q+A&&I-A<d&&d<R+A||E-A<g&&g<q+A&&I-A<o&&
o<R+A){if(m.snapMode!="inner"){var s=Math.abs(I-o)<=A,v=Math.abs(R-d)<=A,M=Math.abs(E-g)<=A,N=Math.abs(q-c)<=A;s&&(e.position.top=b._convertPositionTo("relative",{top:I-b.helperProportions.height,left:0}).top-b.margins.top);v&&(e.position.top=b._convertPositionTo("relative",{top:R,left:0}).top-b.margins.top);M&&(e.position.left=b._convertPositionTo("relative",{top:0,left:E-b.helperProportions.width}).left-b.margins.left);N&&(e.position.left=b._convertPositionTo("relative",{top:0,left:q}).left-b.margins.left)}var K=
s||v||M||N;if(m.snapMode!="outer"){s=Math.abs(I-d)<=A;v=Math.abs(R-o)<=A;M=Math.abs(E-c)<=A;N=Math.abs(q-g)<=A;s&&(e.position.top=b._convertPositionTo("relative",{top:I,left:0}).top-b.margins.top);v&&(e.position.top=b._convertPositionTo("relative",{top:R-b.helperProportions.height,left:0}).top-b.margins.top);M&&(e.position.left=b._convertPositionTo("relative",{top:0,left:E}).left-b.margins.left);N&&(e.position.left=b._convertPositionTo("relative",{top:0,left:q-b.helperProportions.width}).left-b.margins.left)}!b.snapElements[z].snapping&&
(s||v||M||N||K)&&b.options.snap.snap&&b.options.snap.snap.call(b.element,u,a.extend(b._uiHash(),{snapItem:b.snapElements[z].item}));b.snapElements[z].snapping=s||v||M||N||K}else{b.snapElements[z].snapping&&b.options.snap.release&&b.options.snap.release.call(b.element,u,a.extend(b._uiHash(),{snapItem:b.snapElements[z].item}));b.snapElements[z].snapping=false}}}});a.ui.plugin.add("draggable","stack",{start:function(){var u=a(this).data("draggable").options;u=a.makeArray(a(u.stack)).sort(function(b,
m){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(m).css("zIndex"),10)||0)});if(u.length){var e=parseInt(u[0].style.zIndex)||0;a(u).each(function(b){this.style.zIndex=e+b});this[0].style.zIndex=e+u.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(u,e){var b=a(e.helper),m=a(this).data("draggable").options;b.css("zIndex")&&(m._zIndex=b.css("zIndex"));b.css("zIndex",m.zIndex)},stop:function(u,e){var b=a(this).data("draggable").options;b._zIndex&&a(e.helper).css("zIndex",b._zIndex)}})})(jQuery);
(function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var u=this,e=this.options,b=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),m=e.values&&e.values.length||1,A=[];this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(e.disabled?" ui-slider-disabled ui-disabled":""));this.range=a([]);e.range&&(e.range===true&&(e.values||(e.values=[this._valueMin(),this._valueMin()]),e.values.length&&e.values.length!==2&&(e.values=[e.values[0],e.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(e.range==="min"||e.range==="max"?" ui-slider-range-"+e.range:"")));for(var c=b.length;c<m;c+=1)A.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=b.add(a(A.join("")).appendTo(u.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(g){g.preventDefault()}).hover(function(){e.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){e.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")});this.handles.each(function(g){a(this).data("index.ui-slider-handle",
g)});this.handles.keydown(function(g){var d=true,o=a(this).data("index.ui-slider-handle"),z,E,q;if(!u.options.disabled){switch(g.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:d=false;if(!u._keySliding){u._keySliding=true;a(this).addClass("ui-state-active");z=u._start(g,o);if(z===false)return}}z=u.options.step;u.options.values&&u.options.values.length?
E=q=u.values(o):E=q=u.value();switch(g.keyCode){case a.ui.keyCode.HOME:q=u._valueMin();break;case a.ui.keyCode.END:q=u._valueMax();break;case a.ui.keyCode.PAGE_UP:q=u._trimAlignValue(E+(u._valueMax()-u._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:q=u._trimAlignValue(E-(u._valueMax()-u._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(E===u._valueMax())return;q=u._trimAlignValue(E+z);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(E===u._valueMin())return;q=u._trimAlignValue(E-
z)}u._slide(g,o,q);return d}}).keyup(function(g){var d=a(this).data("index.ui-slider-handle");u._keySliding&&(u._keySliding=false,u._stop(g,d),u._change(g,d),a(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();
return this},_mouseCapture:function(u){var e=this.options,b,m,A,c,g;if(e.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();b=this._normValueFromMouse({x:u.pageX,y:u.pageY});m=this._valueMax()-this._valueMin()+1;c=this;this.handles.each(function(d){var o=Math.abs(b-c.values(d));m>o&&(m=o,A=a(this),g=d)});e.range===true&&this.values(1)===e.min&&(g+=1,A=a(this.handles[g]));if(this._start(u,g)===false)return false;
this._mouseSliding=true;c._handleIndex=g;A.addClass("ui-state-active").focus();e=A.offset();this._clickOffset=!a(u.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:u.pageX-e.left-A.width()/2,top:u.pageY-e.top-A.height()/2-(parseInt(A.css("borderTopWidth"),10)||0)-(parseInt(A.css("borderBottomWidth"),10)||0)+(parseInt(A.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(u,g,b);return this._animateOff=true},_mouseStart:function(){return true},_mouseDrag:function(u){var e=
this._normValueFromMouse({x:u.pageX,y:u.pageY});this._slide(u,this._handleIndex,e);return false},_mouseStop:function(u){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(u,this._handleIndex);this._change(u,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(u){var e,b;this.orientation==="horizontal"?
(e=this.elementSize.width,b=u.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,b=u.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));u=b/e;u>1&&(u=1);u<0&&(u=0);this.orientation==="vertical"&&(u=1-u);e=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+u*e)},_start:function(u,e){var b={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(b.value=this.values(e),
b.values=this.values());return this._trigger("start",u,b)},_slide:function(u,e,b){var m,A,c;this.options.values&&this.options.values.length?(m=this.values(e?0:1),this.options.values.length===2&&this.options.range===true&&(e===0&&b>m||e===1&&b<m)&&(b=m),b!==this.values(e)&&(A=this.values(),A[e]=b,c=this._trigger("slide",u,{handle:this.handles[e],value:b,values:A}),this.values(e?0:1),c!==false&&this.values(e,b,true))):b!==this.value()&&(c=this._trigger("slide",u,{handle:this.handles[e],value:b}),c!==
false&&this.value(b))},_stop:function(u,e){var b={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(b.value=this.values(e),b.values=this.values());this._trigger("stop",u,b)},_change:function(u,e){if(!this._keySliding&&!this._mouseSliding){var b={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(b.value=this.values(e),b.values=this.values());this._trigger("change",u,b)}},value:function(u){if(arguments.length){this.options.value=
this._trimAlignValue(u);this._refreshValue();this._change(null,0)}else return this._value()},values:function(u,e){var b,m,A;if(arguments.length>1){this.options.values[u]=this._trimAlignValue(e);this._refreshValue();this._change(null,u)}else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(u):this.value();b=this.options.values;m=arguments[0];for(A=0;A<b.length;A+=1){b[A]=this._trimAlignValue(m[A]);this._change(null,
A)}this._refreshValue()}},_setOption:function(u,e){var b,m=0;a.isArray(this.options.values)&&(m=this.options.values.length);a.Widget.prototype._setOption.apply(this,arguments);switch(u){case "disabled":e?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",true),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",false),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(b=0;b<m;b+=1)this._change(null,b);this._animateOff=false}},_value:function(){var u=this.options.value;return u=this._trimAlignValue(u)},_values:function(u){var e,b;if(arguments.length){e=this.options.values[u];
return e=this._trimAlignValue(e)}e=this.options.values.slice();for(b=0;b<e.length;b+=1)e[b]=this._trimAlignValue(e[b]);return e},_trimAlignValue:function(u){if(u<=this._valueMin())return this._valueMin();if(u>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,b=(u-this._valueMin())%e;u=u-b;Math.abs(b)*2>=e&&(u+=b>0?e:-e);return parseFloat(u.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var u=
this.options.range,e=this.options,b=this,m=this._animateOff?false:e.animate,A,c={},g,d,o,z;this.options.values&&this.options.values.length?this.handles.each(function(E){A=(b.values(E)-b._valueMin())/(b._valueMax()-b._valueMin())*100;c[b.orientation==="horizontal"?"left":"bottom"]=A+"%";a(this).stop(1,1)[m?"animate":"css"](c,e.animate);b.options.range===true&&(b.orientation==="horizontal"?(E===0&&b.range.stop(1,1)[m?"animate":"css"]({left:A+"%"},e.animate),E===1&&b.range[m?"animate":"css"]({width:A-
g+"%"},{queue:false,duration:e.animate})):(E===0&&b.range.stop(1,1)[m?"animate":"css"]({bottom:A+"%"},e.animate),E===1&&b.range[m?"animate":"css"]({height:A-g+"%"},{queue:false,duration:e.animate})));g=A}):(d=this.value(),o=this._valueMin(),z=this._valueMax(),A=z!==o?(d-o)/(z-o)*100:0,c[b.orientation==="horizontal"?"left":"bottom"]=A+"%",this.handle.stop(1,1)[m?"animate":"css"](c,e.animate),u==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[m?"animate":"css"]({width:A+"%"},e.animate),
u==="max"&&this.orientation==="horizontal"&&this.range[m?"animate":"css"]({width:100-A+"%"},{queue:false,duration:e.animate}),u==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[m?"animate":"css"]({height:A+"%"},e.animate),u==="max"&&this.orientation==="vertical"&&this.range[m?"animate":"css"]({height:100-A+"%"},{queue:false,duration:e.animate}))}});a.extend(a.ui.slider,{version:"1.8.17"})})(jQuery);(function(a){Math.precision=function(c,g){if(g===undefined)g=0;return Math.round(c*Math.pow(10,g))/Math.pow(10,g)};var u=function(c,g){var d=this,o=c.find("img:first"),z=0,E=100,q=100,I=0,R=100,s=100,v=0,M=0,N,K,Z=[],U=function(W){for(var ba=0;ba<Z.length;ba++)Z[ba].call(d,d,W)},S=function(W){var ba=c.offset();N={l:ba.left|0,t:ba.top|0};clearTimeout(K);K=setTimeout(function(){ta.call(d,W)},0);a(document).bind("mousemove",V).bind("mouseup",ca);W.preventDefault()},V=function(W){clearTimeout(K);K=setTimeout(function(){ta.call(d,
W)},0);W.stopPropagation();W.preventDefault();return false},ca=function(W){a(document).unbind("mouseup",ca).unbind("mousemove",V);W.stopPropagation();W.preventDefault();return false},ta=function(W){var ba=W.pageX-N.l;W=W.pageY-N.t;var ja=c.w,pa=c.h;if(ba<0)ba=0;else if(ba>ja)ba=ja;if(W<0)W=0;else if(W>pa)W=pa;na.call(d,"xy",{x:ba/ja*q+z,y:W/pa*s+I})},na=function(W,ba,ja){if(ba===undefined){if(W===undefined||W==null)W="xy";switch(W.toLowerCase()){case "x":return v;case "y":return M;default:return{x:v,
y:M}}}if(!(ja!=null&&ja==d)){var pa=false,ka,la;if(W==null)W="xy";switch(W.toLowerCase()){case "x":ka=ba&&(ba.x&&ba.x|0||ba|0)||0;break;case "y":la=ba&&(ba.y&&ba.y|0||ba|0)||0;break;default:ka=ba&&ba.x&&ba.x|0||0;la=ba&&ba.y&&ba.y|0||0}if(ka!=null){if(ka<z)ka=z;else if(ka>E)ka=E;if(v!=ka){v=ka;pa=true}}if(la!=null){if(la<I)la=I;else if(la>R)la=R;if(M!=la){M=la;pa=true}}pa&&U.call(d,ja||d)}},ga=function(W){a.isFunction(W)&&Z.push(W)};a.extend(true,d,{val:na,range:function(W,ba){if(ba===undefined){if(W===
undefined||W==null)W="all";switch(W.toLowerCase()){case "minx":return z;case "maxx":return E;case "rangex":return{minX:z,maxX:E,rangeX:q};case "miny":return I;case "maxy":return R;case "rangey":return{minY:I,maxY:R,rangeY:s};default:return{minX:z,maxX:E,rangeX:q,minY:I,maxY:R,rangeY:s}}}var ja,pa,ka,la;if(W==null)W="all";switch(W.toLowerCase()){case "minx":ja=ba&&(ba.minX&&ba.minX|0||ba|0)||0;break;case "maxx":pa=ba&&(ba.maxX&&ba.maxX|0||ba|0)||0;break;case "rangex":ja=ba&&ba.minX&&ba.minX|0||0;pa=
ba&&ba.maxX&&ba.maxX|0||0;break;case "miny":ka=ba&&(ba.minY&&ba.minY|0||ba|0)||0;break;case "maxy":la=ba&&(ba.maxY&&ba.maxY|0||ba|0)||0;break;case "rangey":ka=ba&&ba.minY&&ba.minY|0||0;la=ba&&ba.maxY&&ba.maxY|0||0;break;default:ja=ba&&ba.minX&&ba.minX|0||0;pa=ba&&ba.maxX&&ba.maxX|0||0;ka=ba&&ba.minY&&ba.minY|0||0;la=ba&&ba.maxY&&ba.maxY|0||0}if(ja!=null&&z!=ja){z=ja;q=E-z}if(pa!=null&&E!=pa){E=pa;q=E-z}if(ka!=null&&I!=ka){I=ka;s=R-I}if(la!=null&&R!=la){R=la;s=R-I}},bind:ga,unbind:function(W){if(a.isFunction(W))for(var ba;(ba=
a.inArray(W,Z))!=-1;)Z.splice(ba,1)},destroy:function(){a(document).unbind("mouseup",ca).unbind("mousemove",V);c.unbind("mousedown",S);Z=o=c=null}});o.src=g.arrow&&g.arrow.image;o.w=g.arrow&&g.arrow.width||o.width();o.h=g.arrow&&g.arrow.height||o.height();c.w=g.map&&g.map.width||c.width();c.h=g.map&&g.map.height||c.height();c.bind("mousedown",S);ga.call(d,function(){var W=0,ba=0,ja=c.w,pa=c.h,ka=o.w,la=o.h;setTimeout(function(){if(q>0)W=v==E?ja:v/q*ja|0;if(s>0)ba=M==R?pa:M/s*pa|0;if(ka>=ja)W=(ja>>
1)-(ka>>1);else W-=ka>>1;if(la>=pa)ba=(pa>>1)-(la>>1);else ba-=la>>1;o.css({left:W+"px",top:ba+"px"})},0)})},e=function(c,g,d,o){var z=this;c=c.find("td.Text input");var E=c.eq(3),q=c.eq(4),I=c.eq(5),R=c.length>7?c.eq(6):null,s=c.eq(0),v=c.eq(1),M=c.eq(2),N=c.eq(c.length>7?7:6),K=c.length>7?c.eq(8):null,Z=function(na){if(!(na.target.value==""&&na.target!=N.get(0)&&(d!=null&&na.target!=d.get(0)||d==null))){if(!V(na))return na;switch(na.target){case E.get(0):switch(na.keyCode){case 38:E.val(ca.call(z,
(E.val()<<0)+1,0,255));g.val("r",E.val(),na.target);return false;case 40:E.val(ca.call(z,(E.val()<<0)-1,0,255));g.val("r",E.val(),na.target);return false}break;case q.get(0):switch(na.keyCode){case 38:q.val(ca.call(z,(q.val()<<0)+1,0,255));g.val("g",q.val(),na.target);return false;case 40:q.val(ca.call(z,(q.val()<<0)-1,0,255));g.val("g",q.val(),na.target);return false}break;case I.get(0):switch(na.keyCode){case 38:I.val(ca.call(z,(I.val()<<0)+1,0,255));g.val("b",I.val(),na.target);return false;case 40:I.val(ca.call(z,
(I.val()<<0)-1,0,255));g.val("b",I.val(),na.target);return false}break;case R&&R.get(0):switch(na.keyCode){case 38:R.val(ca.call(z,parseFloat(R.val())+1,0,100));g.val("a",Math.precision(R.val()*255/100,o),na.target);return false;case 40:R.val(ca.call(z,parseFloat(R.val())-1,0,100));g.val("a",Math.precision(R.val()*255/100,o),na.target);return false}break;case s.get(0):switch(na.keyCode){case 38:s.val(ca.call(z,(s.val()<<0)+1,0,360));g.val("h",s.val(),na.target);return false;case 40:s.val(ca.call(z,
(s.val()<<0)-1,0,360));g.val("h",s.val(),na.target);return false}break;case v.get(0):switch(na.keyCode){case 38:v.val(ca.call(z,(v.val()<<0)+1,0,100));g.val("s",v.val(),na.target);return false;case 40:v.val(ca.call(z,(v.val()<<0)-1,0,100));g.val("s",v.val(),na.target);return false}break;case M.get(0):switch(na.keyCode){case 38:M.val(ca.call(z,(M.val()<<0)+1,0,100));g.val("v",M.val(),na.target);return false;case 40:M.val(ca.call(z,(M.val()<<0)-1,0,100));g.val("v",M.val(),na.target);return false}}}},
U=function(na){if(!(na.target.value==""&&na.target!=N.get(0)&&(d!=null&&na.target!=d.get(0)||d==null))){if(!V(na))return na;switch(na.target){case E.get(0):E.val(ca.call(z,E.val(),0,255));g.val("r",E.val(),na.target);break;case q.get(0):q.val(ca.call(z,q.val(),0,255));g.val("g",q.val(),na.target);break;case I.get(0):I.val(ca.call(z,I.val(),0,255));g.val("b",I.val(),na.target);break;case R&&R.get(0):R.val(ca.call(z,R.val(),0,100));g.val("a",Math.precision(R.val()*255/100,o),na.target);break;case s.get(0):s.val(ca.call(z,
s.val(),0,360));g.val("h",s.val(),na.target);break;case v.get(0):v.val(ca.call(z,v.val(),0,100));g.val("s",v.val(),na.target);break;case M.get(0):M.val(ca.call(z,M.val(),0,100));g.val("v",M.val(),na.target);break;case N.get(0):N.val(N.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));d&&d.val(N.val());g.val("hex",N.val()!=""?N.val():null,na.target);break;case d&&d.get(0):d.val(d.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));N.val(d.val());g.val("hex",d.val()!=""?d.val():
null,na.target);break;case K&&K.get(0):K.val(K.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,2));g.val("a",K.val()!=null?parseInt(K.val(),16):null,na.target)}}},S=function(na){if(g.val()!=null)switch(na.target){case E.get(0):E.val(g.val("r"));break;case q.get(0):q.val(g.val("g"));break;case I.get(0):I.val(g.val("b"));break;case R&&R.get(0):R.val(Math.precision(g.val("a")*100/255,o));break;case s.get(0):s.val(g.val("h"));break;case v.get(0):v.val(g.val("s"));break;case M.get(0):M.val(g.val("v"));
break;case N.get(0):case d&&d.get(0):N.val(g.val("hex"));d&&d.val(g.val("hex"));break;case K&&K.get(0):K.val(g.val("ahex").substring(6))}},V=function(na){switch(na.keyCode){case 9:case 16:case 29:case 37:case 39:return false;case "c".charCodeAt():case "v".charCodeAt():if(na.ctrlKey)return false}return true},ca=function(na,ga,W){if(na==""||isNaN(na))return ga;if(na>W)return W;if(na<ga)return ga;return na},ta=function(na,ga){var W=na.val("all");if(ga!=E.get(0))E.val(W!=null?W.r:"");if(ga!=q.get(0))q.val(W!=
null?W.g:"");if(ga!=I.get(0))I.val(W!=null?W.b:"");if(R&&ga!=R.get(0))R.val(W!=null?Math.precision(W.a*100/255,o):"");if(ga!=s.get(0))s.val(W!=null?W.h:"");if(ga!=v.get(0))v.val(W!=null?W.s:"");if(ga!=M.get(0))M.val(W!=null?W.v:"");if(ga!=N.get(0)&&(d&&ga!=d.get(0)||!d))N.val(W!=null?W.hex:"");if(d&&ga!=d.get(0)&&ga!=N.get(0))d.val(W!=null?W.hex:"");if(K&&ga!=K.get(0))K.val(W!=null?W.ahex.substring(6):"")};a.extend(true,z,{destroy:function(){E.add(q).add(I).add(R).add(s).add(v).add(M).add(N).add(d).add(K).unbind("keyup",
U).unbind("blur",S);E.add(q).add(I).add(R).add(s).add(v).add(M).unbind("keydown",Z);g.unbind(ta);K=N=M=v=s=R=I=q=E=null}});E.add(q).add(I).add(R).add(s).add(v).add(M).add(N).add(d).add(K).bind("keyup",U).bind("blur",S);E.add(q).add(I).add(R).add(s).add(v).add(M).bind("keydown",Z);g.bind(ta)};a.jPicker={List:[],Color:function(c){var g=this,d,o,z,E,q,I,R,s=[],v=function(N){for(var K=0;K<s.length;K++)s[K].call(g,g,N)},M=function(N,K,Z){if(K===undefined){if(N===undefined||N==null||N=="")N="all";if(d==
null)return null;switch(N.toLowerCase()){case "ahex":return A.rgbaToHex({r:d,g:o,b:z,a:E});case "hex":return M("ahex").substring(0,6);case "all":return{r:d,g:o,b:z,a:E,h:q,s:I,v:R,hex:M.call(g,"hex"),ahex:M.call(g,"ahex")};default:K={};for(var U=0;U<N.length;U++)switch(N.charAt(U)){case "r":if(N.length==1)K=d;else K.r=d;break;case "g":if(N.length==1)K=o;else K.g=o;break;case "b":if(N.length==1)K=z;else K.b=z;break;case "a":if(N.length==1)K=E;else K.a=E;break;case "h":if(N.length==1)K=q;else K.h=q;
break;case "s":if(N.length==1)K=I;else K.s=I;break;case "v":if(N.length==1)K=R;else K.v=R}return K=={}?M.call(g,"all"):K}}if(!(Z!=null&&Z==g)){var S=false;if(N==null)N="";if(K==null){if(d!=null){d=null;S=true}if(o!=null){o=null;S=true}if(z!=null){z=null;S=true}if(E!=null){E=null;S=true}if(q!=null){q=null;S=true}if(I!=null){I=null;S=true}if(R!=null){R=null;S=true}S&&v.call(g,Z||g)}else switch(N.toLowerCase()){case "ahex":case "hex":K=A.hexToRgba(K&&(K.ahex||K.hex)||K||"00000000");M.call(g,"rgba",{r:K.r,
g:K.g,b:K.b,a:N=="ahex"?K.a:E!=null?E:255},Z);break;default:if(K&&(K.ahex!=null||K.hex!=null)){M.call(g,"ahex",K.ahex||K.hex||"00000000",Z);break}var V={},ca=false,ta=false;if(K.r!==undefined&&!N.indexOf("r")==-1)N+="r";if(K.g!==undefined&&!N.indexOf("g")==-1)N+="g";if(K.b!==undefined&&!N.indexOf("b")==-1)N+="b";if(K.a!==undefined&&!N.indexOf("a")==-1)N+="a";if(K.h!==undefined&&!N.indexOf("h")==-1)N+="h";if(K.s!==undefined&&!N.indexOf("s")==-1)N+="s";if(K.v!==undefined&&!N.indexOf("v")==-1)N+="v";
for(U=0;U<N.length;U++)switch(N.charAt(U)){case "r":if(ta)continue;ca=true;V.r=K&&K.r&&K.r|0||K&&K|0||0;if(V.r<0)V.r=0;else if(V.r>255)V.r=255;if(d!=V.r){d=V.r;S=true}break;case "g":if(ta)continue;ca=true;V.g=K&&K.g&&K.g|0||K&&K|0||0;if(V.g<0)V.g=0;else if(V.g>255)V.g=255;if(o!=V.g){o=V.g;S=true}break;case "b":if(ta)continue;ca=true;V.b=K&&K.b&&K.b|0||K&&K|0||0;if(V.b<0)V.b=0;else if(V.b>255)V.b=255;if(z!=V.b){z=V.b;S=true}break;case "a":V.a=K&&K.a!=null?K.a|0:K!=null?K|0:255;if(V.a<0)V.a=0;else if(V.a>
255)V.a=255;if(E!=V.a){E=V.a;S=true}break;case "h":if(ca)continue;ta=true;V.h=K&&K.h&&K.h|0||K&&K|0||0;if(V.h<0)V.h=0;else if(V.h>360)V.h=360;if(q!=V.h){q=V.h;S=true}break;case "s":if(ca)continue;ta=true;V.s=K&&K.s!=null?K.s|0:K!=null?K|0:100;if(V.s<0)V.s=0;else if(V.s>100)V.s=100;if(I!=V.s){I=V.s;S=true}break;case "v":if(ca)continue;ta=true;V.v=K&&K.v!=null?K.v|0:K!=null?K|0:100;if(V.v<0)V.v=0;else if(V.v>100)V.v=100;if(R!=V.v){R=V.v;S=true}}if(S){if(ca){d=d||0;o=o||0;z=z||0;K=A.rgbToHsv({r:d,g:o,
b:z});q=K.h;I=K.s;R=K.v}else if(ta){q=q||0;I=I!=null?I:100;R=R!=null?R:100;K=A.hsvToRgb({h:q,s:I,v:R});d=K.r;o=K.g;z=K.b}E=E!=null?E:255;v.call(g,Z||g)}}}};a.extend(true,g,{val:M,bind:function(N){a.isFunction(N)&&s.push(N)},unbind:function(N){if(a.isFunction(N))for(var K;(K=a.inArray(N,s))!=-1;)s.splice(K,1)},destroy:function(){s=null}});if(c)if(c.ahex!=null)M("ahex",c);else if(c.hex!=null)M((c.a!=null?"a":"")+"hex",c.a!=null?{ahex:c.hex+A.intToHex(c.a)}:c);else if(c.r!=null&&c.g!=null&&c.b!=null)M("rgb"+
(c.a!=null?"a":""),c);else if(c.h!=null&&c.s!=null&&c.v!=null)M("hsv"+(c.a!=null?"a":""),c)},ColorMethods:{hexToRgba:function(c){c=this.validateHex(c);if(c=="")return{r:null,g:null,b:null,a:null};var g="00",d="00",o="00",z="255";if(c.length==6)c+="ff";if(c.length>6){g=c.substring(0,2);d=c.substring(2,4);o=c.substring(4,6);z=c.substring(6,c.length)}else{if(c.length>4){g=c.substring(4,c.length);c=c.substring(0,4)}if(c.length>2){d=c.substring(2,c.length);c=c.substring(0,2)}if(c.length>0)o=c.substring(0,
c.length)}return{r:this.hexToInt(g),g:this.hexToInt(d),b:this.hexToInt(o),a:this.hexToInt(z)}},validateHex:function(c){if(typeof c=="object")return"";c=c.toLowerCase().replace(/[^a-f0-9]/g,"");if(c.length>8)c=c.substring(0,8);return c},rgbaToHex:function(c){return this.intToHex(c.r)+this.intToHex(c.g)+this.intToHex(c.b)+this.intToHex(c.a)},intToHex:function(c){c=(c|0).toString(16);if(c.length==1)c="0"+c;return c.toLowerCase()},hexToInt:function(c){return parseInt(c,16)},rgbToHsv:function(c){var g=
c.r/255,d=c.g/255;c=c.b/255;var o={h:0,s:0,v:0},z=0,E=0;if(g>=d&&g>=c){E=g;z=d>c?c:d}else if(d>=c&&d>=g){E=d;z=g>c?c:g}else{E=c;z=d>g?g:d}o.v=E;o.s=E?(E-z)/E:0;if(o.s){z=E-z;o.h=g==E?(d-c)/z:d==E?2+(c-g)/z:4+(g-d)/z;o.h=parseInt(o.h*60);if(o.h<0)o.h+=360}else o.h=0;o.s=o.s*100|0;o.v=o.v*100|0;return o},hsvToRgb:function(c){var g={r:0,g:0,b:0,a:100},d=c.h,o=c.s;c=c.v;if(o==0)g.r=c==0?g.g=g.b=0:g.g=g.b=c*255/100|0;else{if(d==360)d=0;d/=60;o/=100;c/=100;var z=d|0,E=d-z;d=c*(1-o);var q=c*(1-o*E);o=c*
(1-o*(1-E));switch(z){case 0:g.r=c;g.g=o;g.b=d;break;case 1:g.r=q;g.g=c;g.b=d;break;case 2:g.r=d;g.g=c;g.b=o;break;case 3:g.r=d;g.g=q;g.b=c;break;case 4:g.r=o;g.g=d;g.b=c;break;case 5:g.r=c;g.g=d;g.b=q}g.r=g.r*255|0;g.g=g.g*255|0;g.b=g.b*255|0}return g}}};var b=a.jPicker.Color,m=a.jPicker.List,A=a.jPicker.ColorMethods;a.fn.jPicker=function(c){var g=arguments;return this.each(function(){var d=this,o=a.extend(true,{},a.fn.jPicker.defaults,c);if(a(d).get(0).nodeName.toLowerCase()=="input"){a.extend(true,
o,{window:{bindToInput:true,expandable:true,input:a(d)}});if(a(d).val()==""){o.color.active=new b({hex:null});o.color.current=new b({hex:null})}else if(A.validateHex(a(d).val())){o.color.active=new b({hex:a(d).val(),a:o.color.active.val("a")});o.color.current=new b({hex:a(d).val(),a:o.color.active.val("a")})}}if(o.window.expandable)a(d).after('<span class="jPicker"><span class="Icon"><span class="Color">&nbsp;</span><span class="Alpha">&nbsp;</span><span class="Image" title="Click To Open Color Picker">&nbsp;</span><span class="Container">&nbsp;</span></span></span>');
else o.window.liveUpdate=false;var z=parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters,E=null,q=null,I=null,R=null,s=null,v=null,M=null,N=null,K=null,Z=null,U=null,S=null,V=null,ca=null,ta=null,na=null,ga=null,W=null,ba=null,ja=null,pa=null,ka=null,la=null,za=null,Aa=null,Ja=null,Ia=null,Fa=null,Ma=function(P){var T=oa.active,fa=T.val("hex"),Ea,Oa;o.color.mode=P;switch(P){case "h":setTimeout(function(){Ta.call(d,q,"transparent");Ga.call(d,R,0);ua.call(d,R,100);Ga.call(d,s,
260);ua.call(d,s,100);Ta.call(d,I,"transparent");Ga.call(d,M,0);ua.call(d,M,100);Ga.call(d,N,260);ua.call(d,N,100);Ga.call(d,K,260);ua.call(d,K,100);Ga.call(d,Z,260);ua.call(d,Z,100);Ga.call(d,S,260);ua.call(d,S,100)},0);V.range("all",{minX:0,maxX:100,minY:0,maxY:100});ca.range("rangeY",{minY:0,maxY:360});if(T.val("ahex")==null)break;V.val("xy",{x:T.val("s"),y:100-T.val("v")},V);ca.val("y",360-T.val("h"),ca);break;case "s":setTimeout(function(){Ta.call(d,q,"transparent");Ga.call(d,R,-260);Ga.call(d,
s,-520);Ga.call(d,M,-260);Ga.call(d,N,-520);Ga.call(d,S,260);ua.call(d,S,100)},0);V.range("all",{minX:0,maxX:360,minY:0,maxY:100});ca.range("rangeY",{minY:0,maxY:100});if(T.val("ahex")==null)break;V.val("xy",{x:T.val("h"),y:100-T.val("v")},V);ca.val("y",100-T.val("s"),ca);break;case "v":setTimeout(function(){Ta.call(d,q,"000000");Ga.call(d,R,-780);Ga.call(d,s,260);Ta.call(d,I,fa);Ga.call(d,M,-520);Ga.call(d,N,260);ua.call(d,N,100);Ga.call(d,S,260);ua.call(d,S,100)},0);V.range("all",{minX:0,maxX:360,
minY:0,maxY:100});ca.range("rangeY",{minY:0,maxY:100});if(T.val("ahex")==null)break;V.val("xy",{x:T.val("h"),y:100-T.val("s")},V);ca.val("y",100-T.val("v"),ca);break;case "r":Ea=-1040;Oa=-780;V.range("all",{minX:0,maxX:255,minY:0,maxY:255});ca.range("rangeY",{minY:0,maxY:255});if(T.val("ahex")==null)break;V.val("xy",{x:T.val("b"),y:255-T.val("g")},V);ca.val("y",255-T.val("r"),ca);break;case "g":Ea=-1560;Oa=-1820;V.range("all",{minX:0,maxX:255,minY:0,maxY:255});ca.range("rangeY",{minY:0,maxY:255});
if(T.val("ahex")==null)break;V.val("xy",{x:T.val("b"),y:255-T.val("r")},V);ca.val("y",255-T.val("g"),ca);break;case "b":Ea=-2080;Oa=-2860;V.range("all",{minX:0,maxX:255,minY:0,maxY:255});ca.range("rangeY",{minY:0,maxY:255});if(T.val("ahex")==null)break;V.val("xy",{x:T.val("r"),y:255-T.val("g")},V);ca.val("y",255-T.val("b"),ca);break;case "a":setTimeout(function(){Ta.call(d,q,"transparent");Ga.call(d,R,-260);Ga.call(d,s,-520);Ga.call(d,M,260);Ga.call(d,N,260);ua.call(d,N,100);Ga.call(d,S,0);ua.call(d,
S,100)},0);V.range("all",{minX:0,maxX:360,minY:0,maxY:100});ca.range("rangeY",{minY:0,maxY:255});if(T.val("ahex")==null)break;V.val("xy",{x:T.val("h"),y:100-T.val("v")},V);ca.val("y",255-T.val("a"),ca);break;default:throw"Invalid Mode";}switch(P){case "s":case "v":case "a":setTimeout(function(){ua.call(d,R,100);ua.call(d,M,100);Ga.call(d,K,260);ua.call(d,K,100);Ga.call(d,Z,260);ua.call(d,Z,100)},0);break;case "r":case "g":case "b":setTimeout(function(){Ta.call(d,q,"transparent");Ta.call(d,I,"transparent");
ua.call(d,M,100);ua.call(d,R,100);Ga.call(d,R,Ea);Ga.call(d,s,Ea-260);Ga.call(d,M,Oa-780);Ga.call(d,N,Oa-520);Ga.call(d,K,Oa);Ga.call(d,Z,Oa-260);Ga.call(d,S,260);ua.call(d,S,100)},0)}T.val("ahex")!=null&&Da.call(d,T)},Da=function(P,T){if(T==null||T!=ca&&T!=V)wa.call(d,P,T);setTimeout(function(){kb.call(d,P);vb.call(d,P);cb.call(d,P)},0)},xa=function(P,T){var fa=oa.active;if(!(T!=V&&fa.val()==null)){var Ea=P.val("all");switch(o.color.mode){case "h":fa.val("sv",{s:Ea.x,v:100-Ea.y},T);break;case "s":case "a":fa.val("hv",
{h:Ea.x,v:100-Ea.y},T);break;case "v":fa.val("hs",{h:Ea.x,s:100-Ea.y},T);break;case "r":fa.val("gb",{g:255-Ea.y,b:Ea.x},T);break;case "g":fa.val("rb",{r:255-Ea.y,b:Ea.x},T);break;case "b":fa.val("rg",{r:Ea.x,g:255-Ea.y},T)}}},ra=function(P,T){var fa=oa.active;if(!(T!=ca&&fa.val()==null))switch(o.color.mode){case "h":fa.val("h",{h:360-P.val("y")},T);break;case "s":fa.val("s",{s:100-P.val("y")},T);break;case "v":fa.val("v",{v:100-P.val("y")},T);break;case "r":fa.val("r",{r:255-P.val("y")},T);break;
case "g":fa.val("g",{g:255-P.val("y")},T);break;case "b":fa.val("b",{b:255-P.val("y")},T);break;case "a":fa.val("a",255-P.val("y"),T)}},wa=function(P,T){if(T!=V)switch(o.color.mode){case "h":var fa=P.val("sv");V.val("xy",{x:fa!=null?fa.s:100,y:100-(fa!=null?fa.v:100)},T);break;case "s":case "a":fa=P.val("hv");V.val("xy",{x:fa&&fa.h||0,y:100-(fa!=null?fa.v:100)},T);break;case "v":fa=P.val("hs");V.val("xy",{x:fa&&fa.h||0,y:100-(fa!=null?fa.s:100)},T);break;case "r":fa=P.val("bg");V.val("xy",{x:fa&&
fa.b||0,y:255-(fa&&fa.g||0)},T);break;case "g":fa=P.val("br");V.val("xy",{x:fa&&fa.b||0,y:255-(fa&&fa.r||0)},T);break;case "b":fa=P.val("rg");V.val("xy",{x:fa&&fa.r||0,y:255-(fa&&fa.g||0)},T)}if(T!=ca)switch(o.color.mode){case "h":ca.val("y",360-(P.val("h")||0),T);break;case "s":fa=P.val("s");ca.val("y",100-(fa!=null?fa:100),T);break;case "v":fa=P.val("v");ca.val("y",100-(fa!=null?fa:100),T);break;case "r":ca.val("y",255-(P.val("r")||0),T);break;case "g":ca.val("y",255-(P.val("g")||0),T);break;case "b":ca.val("y",
255-(P.val("b")||0),T);break;case "a":fa=P.val("a");ca.val("y",255-(fa!=null?fa:255),T)}},kb=function(P){try{var T=P.val("all");ja.css({backgroundColor:T&&"#"+T.hex||"transparent"});ua.call(d,ja,T&&Math.precision(T.a*100/255,4)||0)}catch(fa){}},vb=function(P){switch(o.color.mode){case "h":Ta.call(d,q,(new b({h:P.val("h")||0,s:100,v:100})).val("hex"));break;case "s":case "a":var T=P.val("s");ua.call(d,s,100-(T!=null?T:100));break;case "v":T=P.val("v");ua.call(d,R,T!=null?T:100);break;case "r":ua.call(d,
s,Math.precision((P.val("r")||0)/255*100,4));break;case "g":ua.call(d,s,Math.precision((P.val("g")||0)/255*100,4));break;case "b":ua.call(d,s,Math.precision((P.val("b")||0)/255*100))}P=P.val("a");ua.call(d,v,Math.precision((255-(P||0))*100/255,4))},cb=function(P){switch(o.color.mode){case "h":var T=P.val("a");ua.call(d,U,Math.precision((255-(T||0))*100/255,4));break;case "s":T=P.val("hva");var fa=new b({h:T&&T.h||0,s:100,v:T!=null?T.v:100});Ta.call(d,I,fa.val("hex"));ua.call(d,N,100-(T!=null?T.v:
100));ua.call(d,U,Math.precision((255-(T&&T.a||0))*100/255,4));break;case "v":T=P.val("hsa");fa=new b({h:T&&T.h||0,s:T!=null?T.s:100,v:100});Ta.call(d,I,fa.val("hex"));ua.call(d,U,Math.precision((255-(T&&T.a||0))*100/255,4));break;case "r":case "g":case "b":fa=T=0;P=P.val("rgba");if(o.color.mode=="r"){T=P&&P.b||0;fa=P&&P.g||0}else if(o.color.mode=="g"){T=P&&P.b||0;fa=P&&P.r||0}else if(o.color.mode=="b"){T=P&&P.r||0;fa=P&&P.g||0}var Ea=fa>T?T:fa;ua.call(d,N,T>fa?Math.precision((T-fa)/(255-fa)*100,
4):0);ua.call(d,K,fa>T?Math.precision((fa-T)/(255-T)*100,4):0);ua.call(d,Z,Math.precision(Ea/255*100,4));ua.call(d,U,Math.precision((255-(P&&P.a||0))*100/255,4));break;case "a":T=P.val("a");Ta.call(d,I,P.val("hex")||"000000");ua.call(d,U,T!=null?0:100);ua.call(d,S,T!=null?100:0)}},Ta=function(P,T){P.css({backgroundColor:T&&T.length==6&&"#"+T||"transparent"})},Va=function(P,T){if(z&&(T.indexOf("AlphaBar.png")!=-1||T.indexOf("Bars.png")!=-1||T.indexOf("Maps.png")!=-1)){P.attr("pngSrc",T);P.css({backgroundImage:"none",
filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+T+"', sizingMethod='scale')"})}else P.css({backgroundImage:"url('"+T+"')"})},Ga=function(P,T){P.css({top:T+"px"})},ua=function(P,T){P.css({visibility:T>0?"visible":"hidden"});if(T>0&&T<100)if(z){var fa=P.attr("pngSrc");fa!=null&&(fa.indexOf("AlphaBar.png")!=-1||fa.indexOf("Bars.png")!=-1||fa.indexOf("Maps.png")!=-1)?P.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+fa+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity="+
T+")"}):P.css({opacity:Math.precision(T/100,4)})}else P.css({opacity:Math.precision(T/100,4)});else if(T==0||T==100)if(z){fa=P.attr("pngSrc");fa!=null&&(fa.indexOf("AlphaBar.png")!=-1||fa.indexOf("Bars.png")!=-1||fa.indexOf("Maps.png")!=-1)?P.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+fa+"', sizingMethod='scale')"}):P.css({opacity:""})}else P.css({opacity:""})},$a=function(){oa.active.val("ahex",oa.current.val("ahex"))},Ka=function(){oa.current.val("ahex",oa.active.val("ahex"))},
Sa=function(P){a(this).parents("tbody:first").find('input:radio[value!="'+P.target.value+'"]').removeAttr("checked");Ma.call(d,P.target.value)},Ha=function(){$a.call(d)},db=function(){$a.call(d);o.window.expandable&&fb.call(d);a.isFunction(ob)&&ob.call(d,oa.active,la)},lb=function(){Ka.call(d);o.window.expandable&&fb.call(d);a.isFunction(ib)&&ib.call(d,oa.active,ka)},Ua=function(){pb.call(d)},Xa=function(P){var T=P.val("hex");pa.css({backgroundColor:T&&"#"+T||"transparent"});ua.call(d,pa,Math.precision((P.val("a")||
0)*100/255,4))},wb=function(P){var T=P.val("hex");P=P.val("va");Aa.css({backgroundColor:T&&"#"+T||"transparent"});ua.call(d,Ja,Math.precision((255-(P&&P.a||0))*100/255,4));if(o.window.bindToInput&&o.window.updateInputColor)o.window.input.css({backgroundColor:T&&"#"+T||"transparent",color:P==null||P.v>75?"#000000":"#ffffff"})},sa=function(P){na=parseInt(E.css("left"));ga=parseInt(E.css("top"));W=P.pageX;ba=P.pageY;a(document).bind("mousemove",hb).bind("mouseup",eb);P.preventDefault()},hb=function(P){E.css({left:na-
(W-P.pageX)+"px",top:ga-(ba-P.pageY)+"px"});o.window.expandable&&!a.support.boxModel&&E.prev().css({left:E.css("left"),top:E.css("top")});P.stopPropagation();P.preventDefault();return false},eb=function(P){a(document).unbind("mousemove",hb).unbind("mouseup",eb);P.stopPropagation();P.preventDefault();return false},sb=function(P){P.preventDefault();P.stopPropagation();oa.active.val("ahex",a(this).attr("title")||null,P.target);return false},ib=a.isFunction(g[1])&&g[1]||null,ab=a.isFunction(g[2])&&g[2]||
null,ob=a.isFunction(g[3])&&g[3]||null,pb=function(){oa.current.val("ahex",oa.active.val("ahex"));var P=function(){if(!(!o.window.expandable||a.support.boxModel)){var T=E.find("table:first");E.before("<iframe/>");E.prev().css({width:T.width(),height:E.height(),opacity:0,position:"absolute",left:E.css("left"),top:E.css("top")})}};if(o.window.expandable){a(document.body).children("div.jPicker.Container").css({zIndex:10});E.css({zIndex:20})}switch(o.window.effects.type){case "fade":E.fadeIn(o.window.effects.speed.show,
P);break;case "slide":E.slideDown(o.window.effects.speed.show,P);break;default:E.show(o.window.effects.speed.show,P)}},fb=function(){var P=function(){o.window.expandable&&E.css({zIndex:10});!o.window.expandable||a.support.boxModel||E.prev().remove()};switch(o.window.effects.type){case "fade":E.fadeOut(o.window.effects.speed.hide,P);break;case "slide":E.slideUp(o.window.effects.speed.hide,P);break;default:E.hide(o.window.effects.speed.hide,P)}},tb=function(){var P=o.window,T=P.expandable?a(d).next().find(".Container:first"):
null;E=P.expandable?a("<div/>"):a(d);E.addClass("jPicker Container");P.expandable&&E.hide();E.get(0).onselectstart=function(ya){if(ya.target.nodeName.toLowerCase()!=="input")return false};var fa=oa.active.val("all");if(P.alphaPrecision<0)P.alphaPrecision=0;else if(P.alphaPrecision>2)P.alphaPrecision=2;var Ea='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody>'+(P.expandable?'<tr><td class="Move" colspan="5">&nbsp;</td></tr>':"")+'<tr><td rowspan="9"><h2 class="Title">'+(P.title||da.text.title)+
'</h2><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+ma.clientPath+ma.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+ma.clientPath+ma.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview"><div class="prev_div">'+
da.text.newColor+'<div class="color_preview"><span class="Active" title="'+da.tooltips.colors.newColor+'">&nbsp;</span><span class="Current" title="'+da.tooltips.colors.currentColor+'">&nbsp;</span></div></div>'+da.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+da.text.ok+'" title="'+da.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+da.text.cancel+'" title="'+da.tooltips.buttons.cancel+'"/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label title="'+
da.tooltips.hue.radio+'"><input type="radio" value="h"'+(o.color.mode=="h"?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.h:"")+'" title="'+da.tooltips.hue.textbox+'"/>&nbsp;\u00ba</td></tr><tr class="Saturation"><td class="Radio"><label title="'+da.tooltips.saturation.radio+'"><input type="radio" value="s"'+(o.color.mode=="s"?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=
null?fa.s:"")+'" title="'+da.tooltips.saturation.textbox+'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label title="'+da.tooltips.value.radio+'"><input type="radio" value="v"'+(o.color.mode=="v"?' checked="checked"':"")+'/>V:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.v:"")+'" title="'+da.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label title="'+da.tooltips.red.radio+'"><input type="radio" value="r"'+
(o.color.mode=="r"?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.r:"")+'" title="'+da.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label title="'+da.tooltips.green.radio+'"><input type="radio" value="g"'+(o.color.mode=="g"?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.g:"")+'" title="'+da.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label title="'+
da.tooltips.blue.radio+'"><input type="radio" value="b"'+(o.color.mode=="b"?' checked="checked"':"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.b:"")+'" title="'+da.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio">'+(P.alphaSupport?'<label title="'+da.tooltips.alpha.radio+'"><input type="radio" value="a"'+(o.color.mode=="a"?' checked="checked"':"")+"/>A:</label>":"&nbsp;")+'</td><td class="Text">'+(P.alphaSupport?'<input type="text" maxlength="'+
(3+P.alphaPrecision)+'" value="'+(fa!=null?Math.precision(fa.a*100/255,P.alphaPrecision):"")+'" title="'+da.tooltips.alpha.textbox+'"/>&nbsp;%':"&nbsp;")+'</td></tr><tr class="Hex"><td colspan="2" class="Text"><label title="'+da.tooltips.hex.textbox+'">#:<input type="text" maxlength="6" class="Hex" value="'+(fa!=null?fa.hex:"")+'"/></label>'+(P.alphaSupport?'<input type="text" maxlength="2" class="AHex" value="'+(fa!=null?fa.ahex.substring(6):"")+'" title="'+da.tooltips.hex.alpha+'"/></td>':"&nbsp;")+
"</tr></tbody></table>";if(P.expandable){E.html(Ea);a(document.body).children("div.jPicker.Container").length==0?a(document.body).prepend(E):a(document.body).children("div.jPicker.Container:last").after(E);E.mousedown(function(){a(document.body).children("div.jPicker.Container").css({zIndex:10});E.css({zIndex:20})});E.css({left:P.position.x=="left"?T.offset().left-530-(P.position.y=="center"?25:0)+"px":P.position.x=="center"?T.offset().left-260+"px":P.position.x=="right"?T.offset().left-10+(P.position.y==
"center"?25:0)+"px":P.position.x=="screenCenter"?(a(document).width()>>1)-260+"px":T.offset().left+parseInt(P.position.x)+"px",position:"absolute",top:P.position.y=="top"?T.offset().top-312+"px":P.position.y=="center"?T.offset().top-156+"px":P.position.y=="bottom"?T.offset().top+25+"px":T.offset().top+parseInt(P.position.y)+"px"})}else{E=a(d);E.html(Ea)}Ea=E.find("tbody:first");q=Ea.find("div.Map:first");I=Ea.find("div.Bar:first");var Oa=q.find("span"),Wa=I.find("span");R=Oa.filter(".Map1:first");
s=Oa.filter(".Map2:first");v=Oa.filter(".Map3:first");M=Wa.filter(".Map1:first");N=Wa.filter(".Map2:first");K=Wa.filter(".Map3:first");Z=Wa.filter(".Map4:first");U=Wa.filter(".Map5:first");S=Wa.filter(".Map6:first");V=new u(q,{map:{width:ma.colorMap.width,height:ma.colorMap.height},arrow:{image:ma.clientPath+ma.colorMap.arrow.file,width:ma.colorMap.arrow.width,height:ma.colorMap.arrow.height}});V.bind(xa);ca=new u(I,{map:{width:ma.colorBar.width,height:ma.colorBar.height},arrow:{image:ma.clientPath+
ma.colorBar.arrow.file,width:ma.colorBar.arrow.width,height:ma.colorBar.arrow.height}});ca.bind(ra);ta=new e(Ea,oa.active,P.expandable&&P.bindToInput?P.input:null,P.alphaPrecision);Oa=fa!=null?fa.hex:null;var Za=Ea.find(".Preview");Wa=Ea.find(".Button");ja=Za.find(".Active:first").css({backgroundColor:Oa&&"#"+Oa||"transparent"});pa=Za.find(".Current:first").css({backgroundColor:Oa&&"#"+Oa||"transparent"}).bind("click",Ha);ua.call(d,pa,Math.precision(oa.current.val("a")*100)/255,4);ka=Wa.find(".Ok:first").bind("click touchstart",
lb);la=Wa.find(".Cancel:first").bind("click touchstart",db);za=Wa.find(".Grid:first");setTimeout(function(){Va.call(d,R,ma.clientPath+"Maps.png");Va.call(d,s,ma.clientPath+"Maps.png");Va.call(d,v,ma.clientPath+"map-opacity.png");Va.call(d,M,ma.clientPath+"Bars.png");Va.call(d,N,ma.clientPath+"Bars.png");Va.call(d,K,ma.clientPath+"Bars.png");Va.call(d,Z,ma.clientPath+"Bars.png");Va.call(d,U,ma.clientPath+"bar-opacity.png");Va.call(d,S,ma.clientPath+"AlphaBar.png");Va.call(d,Za.find("div:last"),ma.clientPath+
"preview-opacity.png")},0);Ea.find("td.Radio input").bind("click  touchstart",Sa);if(oa.quickList&&oa.quickList.length>0){Wa="";for(i=0;i<oa.quickList.length;i++){if((typeof oa.quickList[i]).toString().toLowerCase()=="string")oa.quickList[i]=new b({hex:oa.quickList[i]});var nb=oa.quickList[i].val("a"),Ra=oa.quickList[i].val("ahex");if(!P.alphaSupport&&Ra)Ra=Ra.substring(0,6)+"ff";var mb=oa.quickList[i].val("hex");Wa+='<span class="QuickColor"'+(Ra&&' title="#'+Ra+'"'||"")+' style="background-color:'+
(mb&&"#"+mb||"")+";"+(mb?"":"background-image:url("+ma.clientPath+"NoColor.png)")+(P.alphaSupport&&nb&&nb<255?";opacity:"+Math.precision(nb/255,4)+";filter:Alpha(opacity="+Math.precision(nb/2.55,4)+")":"")+'">&nbsp;</span>'}Va.call(d,za,ma.clientPath+"bar-opacity.png");za.html(Wa);za.find(".QuickColor").click(sb)}Ma.call(d,o.color.mode);oa.active.bind(Da);a.isFunction(ab)&&oa.active.bind(ab);oa.current.bind(Xa);if(P.expandable){d.icon=T.parents(".Icon:first");Aa=d.icon.find(".Color:first").css({backgroundColor:Oa&&
"#"+Oa||"transparent"});Ja=d.icon.find(".Alpha:first");Va.call(d,Ja,ma.clientPath+"bar-opacity.png");ua.call(d,Ja,Math.precision((255-(fa!=null?fa.a:0))*100/255,4));Ia=d.icon.find(".Image:first").css({backgroundImage:"url('"+ma.clientPath+ma.picker.file+"')"}).bind("click",Ua);if(P.bindToInput&&P.updateInputColor)P.input.css({backgroundColor:Oa&&"#"+Oa||"transparent",color:fa==null||fa.v>75?"#000000":"#ffffff"});Fa=Ea.find(".Move:first").bind("mousedown",sa);oa.active.bind(wb)}else pb.call(d)},ma=
o.images,da=o.localization,oa={active:(typeof o.color.active).toString().toLowerCase()=="string"?new b({ahex:!o.window.alphaSupport&&o.color.active?o.color.active.substring(0,6)+"ff":o.color.active}):new b({ahex:!o.window.alphaSupport&&o.color.active.val("ahex")?o.color.active.val("ahex").substring(0,6)+"ff":o.color.active.val("ahex")}),current:(typeof o.color.active).toString().toLowerCase()=="string"?new b({ahex:!o.window.alphaSupport&&o.color.active?o.color.active.substring(0,6)+"ff":o.color.active}):
new b({ahex:!o.window.alphaSupport&&o.color.active.val("ahex")?o.color.active.val("ahex").substring(0,6)+"ff":o.color.active.val("ahex")}),quickList:o.color.quickList};a.extend(true,d,{commitCallback:ib,liveCallback:ab,cancelCallback:ob,color:oa,show:pb,hide:fb,destroy:function(){E.find("td.Radio input  touchstart").unbind("click",Sa);pa.unbind("click  touchstart",Ha);la.unbind("click  touchstart",db);ka.unbind("click  touchstart",lb);if(o.window.expandable){Ia.unbind("click",Ua);Fa.unbind("mousedown",
sa);d.icon=null}E.find(".QuickColor").unbind("click",sb);S=U=Z=K=N=M=v=s=R=I=q=null;V.destroy();V=null;ca.destroy();ca=null;ta.destroy();ab=ob=ib=za=la=ka=pa=ja=ta=null;E.html("");for(i=0;i<m.length;i++)m[i]==d&&m.splice(i,1)}});m.push(d);setTimeout(function(){tb.call(d)},0)})};a.fn.jPicker.defaults={window:{title:null,effects:{type:"slide",speed:{show:"slow",hide:"fast"}},position:{x:"screenCenter",y:"top"},expandable:false,liveUpdate:true,alphaSupport:false,alphaPrecision:0,updateInputColor:true},
color:{mode:"h",active:new b({ahex:"#ffcc00ff"}),quickList:[new b({h:360,s:33,v:100}),new b({h:360,s:66,v:100}),new b({h:360,s:100,v:100}),new b({h:360,s:100,v:75}),new b({h:360,s:100,v:50}),new b({h:180,s:0,v:100}),new b({h:30,s:33,v:100}),new b({h:30,s:66,v:100}),new b({h:30,s:100,v:100}),new b({h:30,s:100,v:75}),new b({h:30,s:100,v:50}),new b({h:180,s:0,v:90}),new b({h:60,s:33,v:100}),new b({h:60,s:66,v:100}),new b({h:60,s:100,v:100}),new b({h:60,s:100,v:75}),new b({h:60,s:100,v:50}),new b({h:180,
s:0,v:80}),new b({h:90,s:33,v:100}),new b({h:90,s:66,v:100}),new b({h:90,s:100,v:100}),new b({h:90,s:100,v:75}),new b({h:90,s:100,v:50}),new b({h:180,s:0,v:70}),new b({h:120,s:33,v:100}),new b({h:120,s:66,v:100}),new b({h:120,s:100,v:100}),new b({h:120,s:100,v:75}),new b({h:120,s:100,v:50}),new b({h:180,s:0,v:60}),new b({h:150,s:33,v:100}),new b({h:150,s:66,v:100}),new b({h:150,s:100,v:100}),new b({h:150,s:100,v:75}),new b({h:150,s:100,v:50}),new b({h:180,s:0,v:50}),new b({h:180,s:33,v:100}),new b({h:180,
s:66,v:100}),new b({h:180,s:100,v:100}),new b({h:180,s:100,v:75}),new b({h:180,s:100,v:50}),new b({h:180,s:0,v:40}),new b({h:210,s:33,v:100}),new b({h:210,s:66,v:100}),new b({h:210,s:100,v:100}),new b({h:210,s:100,v:75}),new b({h:210,s:100,v:50}),new b({h:180,s:0,v:30}),new b({h:240,s:33,v:100}),new b({h:240,s:66,v:100}),new b({h:240,s:100,v:100}),new b({h:240,s:100,v:75}),new b({h:240,s:100,v:50}),new b({h:180,s:0,v:20}),new b({h:270,s:33,v:100}),new b({h:270,s:66,v:100}),new b({h:270,s:100,v:100}),
new b({h:270,s:100,v:75}),new b({h:270,s:100,v:50}),new b({h:180,s:0,v:10}),new b({h:300,s:33,v:100}),new b({h:300,s:66,v:100}),new b({h:300,s:100,v:100}),new b({h:300,s:100,v:75}),new b({h:300,s:100,v:50}),new b({h:180,s:0,v:0}),new b({h:330,s:33,v:100}),new b({h:330,s:66,v:100}),new b({h:330,s:100,v:100}),new b({h:330,s:100,v:75}),new b({h:330,s:100,v:50}),new b]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,
height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},
saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},
alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}}})(jQuery,"1.1.6");(function(a){function u(m){var A=m||window.event,c=[].slice.call(arguments,1),g=0,d=0,o=0;m=a.event.fix(A);m.type="mousewheel";if(A.wheelDelta)g=A.wheelDelta/120;if(A.detail)g=-A.detail/3;o=g;if(A.axis!==undefined&&A.axis===A.HORIZONTAL_AXIS){o=0;d=-1*g}if(A.wheelDeltaY!==undefined)o=A.wheelDeltaY/120;if(A.wheelDeltaX!==undefined)d=-1*A.wheelDeltaX/120;c.unshift(m,g,d,o);return(a.event.dispatch||a.event.handle).apply(this,c)}var e=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var b=e.length;b;)a.event.fixHooks[e[--b]]=
a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var m=e.length;m;)this.addEventListener(e[--m],u,false);else this.onmousewheel=u},teardown:function(){if(this.removeEventListener)for(var m=e.length;m;)this.removeEventListener(e[--m],u,false);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(m){return m?this.bind("mousewheel",m):this.trigger("mousewheel")},unmousewheel:function(m){return this.unbind("mousewheel",m)}})})(jQuery);methodDraw.addExtension("view_grid",function(a){function u(o){g.attr("width");g.attr("height");var z=svgedit.units.getTypeMap()[methodDraw.curConfig.baseUnit],E=[0.01,0.1,1,10,100,1E3];b.getContentElem().getAttribute("x");var q=A;z=z*o;var I=100/z,R=1;for(o=0;o<E.length;o++){var s=E[o];R=s;if(I<=s)break}E=R*z;q.width=E;q.height=E;z=q.getContext("2d");I=E/10;z.globalAlpha=0.2;z.strokeStyle="#000";for(o=1;o<10;o++){R=Math.round(I*o)+0.5;z.moveTo(R,E);z.lineTo(R,0);z.moveTo(E,R);z.lineTo(0,R)}z.stroke();
z.beginPath();z.globalAlpha=0.5;z.moveTo(0.5,E);z.lineTo(0.5,0);z.moveTo(E,0.5);z.lineTo(0,0.5);z.stroke();q=q.toDataURL("image/png");d.setAttribute("width",E);d.setAttribute("height",E);d.parentNode.setAttribute("width",E);d.parentNode.setAttribute("height",E);b.setHref(d,q)}if(!document.getElementById("canvasGrid")){var e=document.getElementById("svgcanvas").ownerDocument,b=methodDraw.canvas,m=false;a=a.assignAttributes;var A=document.createElement("canvas");$(A).hide().appendTo("body");var c=e.createElementNS("http://www.w3.org/2000/svg",
"g");a(c,{id:"canvasGrid",width:"100%",height:"100%",x:0,y:0,overflow:"visible",display:"none"});var g=$("#canvas_background");g.after(c);c=e.createElementNS("http://www.w3.org/2000/svg","pattern");a(c,{id:"gridpattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:100,height:100});var d=e.createElementNS("http://www.w3.org/2000/svg","image");a(d,{x:0,y:0,width:100,height:100});c.appendChild(d);$("#svgroot defs").append(c);e=e.createElementNS("http://www.w3.org/2000/svg","rect");a(e,{width:"100%",height:"100%",
x:0,y:0,"stroke-width":0,stroke:"none",fill:"url(#gridpattern)",style:"pointer-events: none; display:visible;"});$("#canvasGrid").append(e)}return{name:"view_grid",zoomChanged:function(o){m&&u(o)},buttons:[{id:"view_grid",type:"menu",after:"tool_wireframe",panel:"view_menu",title:"View Grid",events:{click:function(){if($("#view_grid").hasClass("push_button_pressed")){methodDraw.curConfig.showGrid=m=false;$("#view_grid").removeClass("push_button_pressed");$("#canvasGrid").attr("display","none")}else{methodDraw.curConfig.showGrid=
m=true;$("#view_grid").addClass("push_button_pressed");$("#canvasGrid").attr("display","inline");u(b.getZoom())}}}}]}});methodDraw.addExtension("biobutton-bacteria",function(){function a(u,e){var b=svgCanvas.addSvgElementFromJson({element:"image",attr:{x:e*200,y:0,width:0,height:0,id:svgCanvas.getNextId(),style:"pointer-events:none;"}});svgCanvas.clearSelection();svgCanvas.addToSelection([b]);svgCanvas.setImageURL(u)}return{name:"Neuron",svgicons:"extensions/ext-biobutton-bacteria.xml",buttons:[{id:"biobutton-bacteria",type:"mode",title:"Add a bacteria",events:{click:function(){methodDraw.canvas.setMode("select");
a("extensions/imagelib/bacteria.svg",0);a("extensions/imagelib/bacteria_color.svg",1)}}}],mouseDown:function(){},mouseUp:function(){},callback:function(){}}});methodDraw.addExtension("biobutton-cell",function(){return{name:"Animal Cell",svgicons:"extensions/ext-biobutton-cell.xml",buttons:[{id:"biobutton-cell",type:"mode",title:"Add an animal cell",events:{click:function(){methodDraw.canvas.setMode("select");var a=svgCanvas.addSvgElementFromJson({element:"image",attr:{x:0,y:0,width:0,height:0,id:svgCanvas.getNextId(),style:"pointer-events:none;"}});svgCanvas.clearSelection();svgCanvas.addToSelection([a]);svgCanvas.setImageURL("extensions/imagelib/animal_cell.svg")}}}],
mouseDown:function(){},mouseUp:function(){},callback:function(){}}});methodDraw.addExtension("biobutton-neuron",function(){function a(u,e){var b=svgCanvas.addSvgElementFromJson({element:"image",attr:{x:e*110,y:0,width:0,height:0,id:svgCanvas.getNextId(),style:"pointer-events:none;"}});svgCanvas.clearSelection();svgCanvas.addToSelection([b]);svgCanvas.setImageURL(u)}return{name:"Neuron",svgicons:"extensions/ext-biobutton-neuron.xml",buttons:[{id:"biobutton-neuron",type:"mode",title:"Add a neuron",events:{click:function(){methodDraw.canvas.setMode("select");a("extensions/imagelib/neuron_bipolar.svg",
0);a("extensions/imagelib/neuron_multipolares.svg",1);a("extensions/imagelib/neuron_pseudounipolares.svg",2);a("extensions/imagelib/neuron_unipolar.svg",3)}}}],mouseDown:function(){},mouseUp:function(){},callback:function(){}}});methodDraw.addExtension("mathjax",function(){function a(){var A=$("#mathjax_code_textarea").val();MathJax.Hub.queue.Push(["Text",u,"\\displaystyle{"+A+"}"]);MathJax.Hub.queue.Push(function(){var c=$(".MathJax_SVG");c=$(c.html());c.find("use").each(function(){var g,d,o;g=$(this).attr("href")?$(this).attr("href").slice(1):$(this).attr("xlink:href").slice(1);var z=$("#"+g).clone().removeAttr("id");g=$(this).attr("x");d=$(this).attr("y");if((o=$(this).attr("transform"))&&(g||d))z.attr("transform",o+" translate("+
g+","+d+")");else if(o)z.attr("transform",o);else if(g||d)z.attr("transform","translate("+g+","+d+")");$(this).replaceWith(z)});c.removeAttr("style");c.attr("xmlns","http://www.w3.org/2000/svg");svgCanvas.importSvgString($("<div>").append(c.clone()).html(),true);svgCanvas.ungroupSelectedElement();svgCanvas.moveSelectedElements(e,b,true)})}var u,e,b,m=false;$.extend(methodDraw.uiStrings,{mathjax:{embed_svg:"Save as mathematics",embed_mathml:"Save as figure",svg_save_warning:"The math will be transformed into a figure is manipulatable like everything else. You will not be able to manipulate the TeX-code anymore. ",
mathml_save_warning:"Advised. The math will be saved as a figure.",title:"Mathematics code editor"}});return{name:"MatJax",svgicons:"extensions/mathjax-icons.xml",buttons:[{id:"tool_mathjax",type:"mode",title:"Add Mathematics",events:{click:function(){if(m===false){$('<div id="mathjax">                <!-- Here is where MathJax creates the math --\>                  <div id="mathjax_creator" class="tex2jax_process" style="display:none">                    $${}$$                  </div>                  <div id="mathjax_overlay"></div>                  <div id="mathjax_container">                    <div id="tool_mathjax_back" class="toolbar_button">                      <button id="tool_mathjax_save">OK</button>                      <button id="tool_mathjax_cancel">Cancel</button>                    </div>                    <fieldset>                      <legend id="mathjax_legend">Mathematics Editor</legend>                      <label>                        <span id="mathjax_explication">Please type your mathematics in                         <a href="http://en.wikipedia.org/wiki/Help:Displaying_a_formula" target="_blank">TeX</a> code.</span></label>                      <textarea id="mathjax_code_textarea" spellcheck="false"></textarea>                    </fieldset>                  </div>                </div>').insertBefore("#dialog_box").hide();
$("#mathjax_container").draggable({cancel:"button,fieldset",containment:"window"});$("#tool_mathjax_cancel").prepend($.getSvgIcon("cancel",true)).on("click touched",function(){$("#mathjax").hide()});$("#tool_mathjax_save").prepend($.getSvgIcon("ok",true)).on("click touched",function(){a();$("#mathjax").hide()});$("body").addClass("tex2jax_ignore");$.getScript("https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js").done(function(){MathJax.Hub.queue.Push(function(){u=
MathJax.Hub.getAllJax("#mathjax_creator")[0];console.log(u);m=true;console.log("MathJax Loaded")})}).fail(function(){console.log("Failed loadeing MathJax.");$.alert("Failed loading MathJax. You will not be able to change the mathematics.")})}svgCanvas.setMode("mathjax")}}}],mouseDown:function(){if(svgCanvas.getMode()==="mathjax")return{started:true}},mouseUp:function(A){if(svgCanvas.getMode()==="mathjax"){var c=svgCanvas.getZoom();e=A.mouse_x/c;b=A.mouse_y/c;$("#mathjax").show();return{started:false}}},
callback:function(){$("<style>").text("\t\t\t\t#mathjax fieldset{\t\t\t\t\tpadding: 5px;\t\t\t\t\tmargin: 5px;\t\t\t\t\tborder: 1px solid #DDD;\t\t\t\t}\t\t\t\t#mathjax label{\t\t\t\t\tdisplay: block;\t\t\t\t\tmargin: .5em;\t\t\t\t}\t\t\t\t#mathjax legend {\t\t\t\t\tmax-width:195px;\t\t\t\t}\t\t\t\t#mathjax_overlay {\t\t\t\t\tposition: absolute;\t\t\t\t\ttop: 0;\t\t\t\t\tleft: 0;\t\t\t\t\tright: 0;\t\t\t\t\tbottom: 0;\t\t\t\t\tbackground-color: black;\t\t\t\t\topacity: 0.6;\t\t\t\t\tz-index: 20000;\t\t\t\t}\t\t\t\t\t\t\t\t#mathjax_container {\t\t\t\t\tposition: absolute;\t\t\t\t\ttop: 50px;\t\t\t\t\tpadding: 10px;\t\t\t\t\tbackground-color: #B0B0B0;\t\t\t\t\tborder: 1px outset #777;\t\t\t\t\topacity: 1.0;\t\t\t\t\tfont-family: Verdana, Helvetica, sans-serif;\t\t\t\t\tfont-size: .8em;\t\t\t\t\tz-index: 20001;\t\t\t\t}\t\t\t\t\t\t\t\t#tool_mathjax_back {\t\t\t\t\tmargin-left: 1em;\t\t\t\t\toverflow: auto;\t\t\t\t}\t\t\t\t\t\t\t\t#mathjax_legend{\t\t\t\t\tfont-weight: bold;\t\t\t\t\tfont-size:1.1em;\t\t\t\t}\t\t\t\t\t\t\t\t#mathjax_code_textarea {\\n          margin: 5px .7em;\t\t\t\t\toverflow: hidden;          width: 416px;\t\t\t\t\tdisplay: block;\t\t\t\t\theight: 100px;\t\t\t\t}\t\t\t").appendTo("head")}}});(function(){for(var a=0,u=["ms","moz","webkit","o"],e=0;e<u.length&&!window.requestAnimationFrame;++e){window.requestAnimationFrame=window[u[e]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[u[e]+"CancelAnimationFrame"]||window[u[e]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(b){var m=(new Date).getTime(),A=Math.max(0,16-(m-a)),c=window.setTimeout(function(){b(m+A)},A);a=m+A;return c};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=
function(b){clearTimeout(b)}})();(function(a){function u(q){var I=q.originalEvent;if(!I.touches||I.targetTouches.length===1&&I.touches.length===1){c.call(this,q);q=a(this);q.bind(z,e);q.bind(o,b)}else{clearTimeout(E);A.call(this)}}function e(q){if(E!=null){var I=q.originalEvent;q=I.changedTouches?I.changedTouches[0].pageX:I.pageX;I=I.changedTouches?I.changedTouches[0].pageY:I.pageY;var R=a(this).data("taphold.point");q=q-R.x;I=I-R.y;if(Math.sqrt(q*q+I*I)>d){clearTimeout(E);A.call(this)}}}function b(){clearTimeout(E);A.call(this)}
function m(q){A.call(this);a(this).data("taphold.handler").call(this,q)}function A(){E=null;a(this).unbind(z,e);a(this).unbind(o,b)}function c(q){if(E==null){var I=this;E=setTimeout(function(){m.call(I,q)},g);var R=q.originalEvent,s={};s.x=R.changedTouches?R.changedTouches[0].pageX:R.pageX;s.y=R.changedTouches?R.changedTouches[0].pageY:R.pageY;a(this).data("taphold.point",s)}}var g=1E3,d=5,o="touchend",z="touchmove",E=null;a.event.special.taphold={setup:function(){},add:function(q){a(this).data("taphold.handler",
q.handler);q.data?a(this).bind("touchstart",q.data,u):a(this).bind("touchstart",u)},remove:function(q){clearTimeout(E);A.call(this);q.data?a(this).unbind("touchstart",q.data,u):a(this).unbind("touchstart",u)},teardown:function(){}}})(jQuery);
